var Gu=Object.defineProperty,$u=Object.defineProperties;var Wu=Object.getOwnPropertyDescriptors;var Ys=Object.getOwnPropertySymbols;var Yu=Object.prototype.hasOwnProperty,Xu=Object.prototype.propertyIsEnumerable;var Ca=(h,a,t)=>a in h?Gu(h,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[a]=t,wi=(h,a)=>{for(var t in a||(a={}))Yu.call(a,t)&&Ca(h,t,a[t]);if(Ys)for(var t of Ys(a))Xu.call(a,t)&&Ca(h,t,a[t]);return h},Mn=(h,a)=>$u(h,Wu(a));var ge=(h,a,t)=>(Ca(h,typeof a!="symbol"?a+"":a,t),t);var oe=(h,a,t)=>new Promise((i,r)=>{var n=d=>{try{o(t.next(d))}catch(g){r(g)}},u=d=>{try{o(t.throw(d))}catch(g){r(g)}},o=d=>d.done?i(d.value):Promise.resolve(d.value).then(n,u);o((t=t.apply(h,a)).next())});import{p as Xs,i as Ks,j as qs,k as je,l as oi,r as jt,o as nt,m as ct,n as Ge,q as Ku,s as He,w as at,F as Yi,a as dn,T as Fe,t as cn,u as qu,v as Nn,x as hn,y as Zs,A as Da,B as Zu,C as Ju,D as Qu,E as xt,G as We,d as Bi,f as Pt,H as zn,I as Vn,J as Ra,M as zr,N as or,O as Ti,P as wr,Q as lr,R as Hn,S as ef}from"./vendor.8c1ac885.js";import{i as st,C as Xi,d as Js,w as tf,t as rf,b as Qs,a as nf,c as af,h as eo}from"./index.50e7e7b3.js";const sf=60*1e3,of=60*sf,Tr=24*of;var Ki={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(h){(function(a,t,i,r){var n=["","webkit","Moz","MS","ms","o"],u=t.createElement("div"),o="function",d=Math.round,g=Math.abs,v=Date.now;function p(M,V,q){return setTimeout(_(M,q),V)}function e(M,V,q){return Array.isArray(M)?(s(M,q[V],q),!0):!1}function s(M,V,q){var le;if(!!M)if(M.forEach)M.forEach(V,q);else if(M.length!==r)for(le=0;le<M.length;)V.call(q,M[le],le,M),le++;else for(le in M)M.hasOwnProperty(le)&&V.call(q,M[le],le,M)}function l(M,V,q){var le="DEPRECATED METHOD: "+V+`
`+q+` AT 
`;return function(){var be=new Error("get-stack-trace"),Re=be&&be.stack?be.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",tt=a.console&&(a.console.warn||a.console.log);return tt&&tt.call(a.console,le,Re),M.apply(this,arguments)}}var f;typeof Object.assign!="function"?f=function(V){if(V===r||V===null)throw new TypeError("Cannot convert undefined or null to object");for(var q=Object(V),le=1;le<arguments.length;le++){var be=arguments[le];if(be!==r&&be!==null)for(var Re in be)be.hasOwnProperty(Re)&&(q[Re]=be[Re])}return q}:f=Object.assign;var c=l(function(V,q,le){for(var be=Object.keys(q),Re=0;Re<be.length;)(!le||le&&V[be[Re]]===r)&&(V[be[Re]]=q[be[Re]]),Re++;return V},"extend","Use `assign`."),y=l(function(V,q){return c(V,q,!0)},"merge","Use `assign`.");function m(M,V,q){var le=V.prototype,be;be=M.prototype=Object.create(le),be.constructor=M,be._super=le,q&&f(be,q)}function _(M,V){return function(){return M.apply(V,arguments)}}function E(M,V){return typeof M==o?M.apply(V&&V[0]||r,V):M}function w(M,V){return M===r?V:M}function k(M,V,q){s(U(V),function(le){M.addEventListener(le,q,!1)})}function x(M,V,q){s(U(V),function(le){M.removeEventListener(le,q,!1)})}function S(M,V){for(;M;){if(M==V)return!0;M=M.parentNode}return!1}function B(M,V){return M.indexOf(V)>-1}function U(M){return M.trim().split(/\s+/g)}function R(M,V,q){if(M.indexOf&&!q)return M.indexOf(V);for(var le=0;le<M.length;){if(q&&M[le][q]==V||!q&&M[le]===V)return le;le++}return-1}function C(M){return Array.prototype.slice.call(M,0)}function A(M,V,q){for(var le=[],be=[],Re=0;Re<M.length;){var tt=V?M[Re][V]:M[Re];R(be,tt)<0&&le.push(M[Re]),be[Re]=tt,Re++}return q&&(V?le=le.sort(function(yt,mt){return yt[V]>mt[V]}):le=le.sort()),le}function b(M,V){for(var q,le,be=V[0].toUpperCase()+V.slice(1),Re=0;Re<n.length;){if(q=n[Re],le=q?q+be:V,le in M)return le;Re++}return r}var O=1;function W(){return O++}function K(M){var V=M.ownerDocument||M;return V.defaultView||V.parentWindow||a}var G=/mobile|tablet|ip(ad|hone|od)|android/i,F="ontouchstart"in a,j=b(a,"PointerEvent")!==r,N=F&&G.test(navigator.userAgent),$="touch",Z="pen",te="mouse",ae="kinect",Ee=25,Te=1,Ae=2,De=4,ze=8,Ce=1,Oe=2,$e=4,D=8,fe=16,ne=Oe|$e,Y=D|fe,H=ne|Y,J=["x","y"],ce=["clientX","clientY"];function he(M,V){var q=this;this.manager=M,this.callback=V,this.element=M.element,this.target=M.options.inputTarget,this.domHandler=function(le){E(M.options.enable,[M])&&q.handler(le)},this.init()}he.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(K(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(K(this.element),this.evWin,this.domHandler)}};function ee(M){var V,q=M.options.inputClass;return q?V=q:j?V=Qt:N?V=yi:F?V=ji:V=Ai,new V(M,Se)}function Se(M,V,q){var le=q.pointers.length,be=q.changedPointers.length,Re=V&Te&&le-be==0,tt=V&(De|ze)&&le-be==0;q.isFirst=!!Re,q.isFinal=!!tt,Re&&(M.session={}),q.eventType=V,Le(M,q),M.emit("hammer.input",q),M.recognize(q),M.session.prevInput=q}function Le(M,V){var q=M.session,le=V.pointers,be=le.length;q.firstInput||(q.firstInput=Ye(V)),be>1&&!q.firstMultiple?q.firstMultiple=Ye(V):be===1&&(q.firstMultiple=!1);var Re=q.firstInput,tt=q.firstMultiple,lt=tt?tt.center:Re.center,yt=V.center=et(le);V.timeStamp=v(),V.deltaTime=V.timeStamp-Re.timeStamp,V.angle=Zt(lt,yt),V.distance=gt(lt,yt),ke(q,V),V.offsetDirection=Et(V.deltaX,V.deltaY);var mt=qe(V.deltaTime,V.deltaX,V.deltaY);V.overallVelocityX=mt.x,V.overallVelocityY=mt.y,V.overallVelocity=g(mt.x)>g(mt.y)?mt.x:mt.y,V.scale=tt?ki(tt.pointers,le):1,V.rotation=tt?ft(tt.pointers,le):0,V.maxPointers=q.prevInput?V.pointers.length>q.prevInput.maxPointers?V.pointers.length:q.prevInput.maxPointers:V.pointers.length,Ne(q,V);var Ht=M.element;S(V.srcEvent.target,Ht)&&(Ht=V.srcEvent.target),V.target=Ht}function ke(M,V){var q=V.center,le=M.offsetDelta||{},be=M.prevDelta||{},Re=M.prevInput||{};(V.eventType===Te||Re.eventType===De)&&(be=M.prevDelta={x:Re.deltaX||0,y:Re.deltaY||0},le=M.offsetDelta={x:q.x,y:q.y}),V.deltaX=be.x+(q.x-le.x),V.deltaY=be.y+(q.y-le.y)}function Ne(M,V){var q=M.lastInterval||V,le=V.timeStamp-q.timeStamp,be,Re,tt,lt;if(V.eventType!=ze&&(le>Ee||q.velocity===r)){var yt=V.deltaX-q.deltaX,mt=V.deltaY-q.deltaY,Ht=qe(le,yt,mt);Re=Ht.x,tt=Ht.y,be=g(Ht.x)>g(Ht.y)?Ht.x:Ht.y,lt=Et(yt,mt),M.lastInterval=V}else be=q.velocity,Re=q.velocityX,tt=q.velocityY,lt=q.direction;V.velocity=be,V.velocityX=Re,V.velocityY=tt,V.direction=lt}function Ye(M){for(var V=[],q=0;q<M.pointers.length;)V[q]={clientX:d(M.pointers[q].clientX),clientY:d(M.pointers[q].clientY)},q++;return{timeStamp:v(),pointers:V,center:et(V),deltaX:M.deltaX,deltaY:M.deltaY}}function et(M){var V=M.length;if(V===1)return{x:d(M[0].clientX),y:d(M[0].clientY)};for(var q=0,le=0,be=0;be<V;)q+=M[be].clientX,le+=M[be].clientY,be++;return{x:d(q/V),y:d(le/V)}}function qe(M,V,q){return{x:V/M||0,y:q/M||0}}function Et(M,V){return M===V?Ce:g(M)>=g(V)?M<0?Oe:$e:V<0?D:fe}function gt(M,V,q){q||(q=J);var le=V[q[0]]-M[q[0]],be=V[q[1]]-M[q[1]];return Math.sqrt(le*le+be*be)}function Zt(M,V,q){q||(q=J);var le=V[q[0]]-M[q[0]],be=V[q[1]]-M[q[1]];return Math.atan2(be,le)*180/Math.PI}function ft(M,V){return Zt(V[1],V[0],ce)+Zt(M[1],M[0],ce)}function ki(M,V){return gt(V[0],V[1],ce)/gt(M[0],M[1],ce)}var Ut={mousedown:Te,mousemove:Ae,mouseup:De},Ft="mousedown",Mi="mousemove mouseup";function Ai(){this.evEl=Ft,this.evWin=Mi,this.pressed=!1,he.apply(this,arguments)}m(Ai,he,{handler:function(V){var q=Ut[V.type];q&Te&&V.button===0&&(this.pressed=!0),q&Ae&&V.which!==1&&(q=De),!!this.pressed&&(q&De&&(this.pressed=!1),this.callback(this.manager,q,{pointers:[V],changedPointers:[V],pointerType:te,srcEvent:V}))}});var Fr={pointerdown:Te,pointermove:Ae,pointerup:De,pointercancel:ze,pointerout:ze},Ni={2:$,3:Z,4:te,5:ae},Ci="pointerdown",Jt="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Ci="MSPointerDown",Jt="MSPointerMove MSPointerUp MSPointerCancel");function Qt(){this.evEl=Ci,this.evWin=Jt,he.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}m(Qt,he,{handler:function(V){var q=this.store,le=!1,be=V.type.toLowerCase().replace("ms",""),Re=Fr[be],tt=Ni[V.pointerType]||V.pointerType,lt=tt==$,yt=R(q,V.pointerId,"pointerId");Re&Te&&(V.button===0||lt)?yt<0&&(q.push(V),yt=q.length-1):Re&(De|ze)&&(le=!0),!(yt<0)&&(q[yt]=V,this.callback(this.manager,Re,{pointers:q,changedPointers:[V],pointerType:tt,srcEvent:V}),le&&q.splice(yt,1))}});var zi={touchstart:Te,touchmove:Ae,touchend:De,touchcancel:ze},Vi="touchstart",gr="touchstart touchmove touchend touchcancel";function Qi(){this.evTarget=Vi,this.evWin=gr,this.started=!1,he.apply(this,arguments)}m(Qi,he,{handler:function(V){var q=zi[V.type];if(q===Te&&(this.started=!0),!!this.started){var le=vr.call(this,V,q);q&(De|ze)&&le[0].length-le[1].length==0&&(this.started=!1),this.callback(this.manager,q,{pointers:le[0],changedPointers:le[1],pointerType:$,srcEvent:V})}}});function vr(M,V){var q=C(M.touches),le=C(M.changedTouches);return V&(De|ze)&&(q=A(q.concat(le),"identifier",!0)),[q,le]}var Zr={touchstart:Te,touchmove:Ae,touchend:De,touchcancel:ze},Hi="touchstart touchmove touchend touchcancel";function yi(){this.evTarget=Hi,this.targetIds={},he.apply(this,arguments)}m(yi,he,{handler:function(V){var q=Zr[V.type],le=ei.call(this,V,q);!le||this.callback(this.manager,q,{pointers:le[0],changedPointers:le[1],pointerType:$,srcEvent:V})}});function ei(M,V){var q=C(M.touches),le=this.targetIds;if(V&(Te|Ae)&&q.length===1)return le[q[0].identifier]=!0,[q,q];var be,Re,tt=C(M.changedTouches),lt=[],yt=this.target;if(Re=q.filter(function(mt){return S(mt.target,yt)}),V===Te)for(be=0;be<Re.length;)le[Re[be].identifier]=!0,be++;for(be=0;be<tt.length;)le[tt[be].identifier]&&lt.push(tt[be]),V&(De|ze)&&delete le[tt[be].identifier],be++;if(!!lt.length)return[A(Re.concat(lt),"identifier",!0),lt]}var St=2500,yr=25;function ji(){he.apply(this,arguments);var M=_(this.handler,this);this.touch=new yi(this.manager,M),this.mouse=new Ai(this.manager,M),this.primaryTouch=null,this.lastTouches=[]}m(ji,he,{handler:function(V,q,le){var be=le.pointerType==$,Re=le.pointerType==te;if(!(Re&&le.sourceCapabilities&&le.sourceCapabilities.firesTouchEvents)){if(be)mi.call(this,q,le);else if(Re&&Or.call(this,le))return;this.callback(V,q,le)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function mi(M,V){M&Te?(this.primaryTouch=V.changedPointers[0].identifier,er.call(this,V)):M&(De|ze)&&er.call(this,V)}function er(M){var V=M.changedPointers[0];if(V.identifier===this.primaryTouch){var q={x:V.clientX,y:V.clientY};this.lastTouches.push(q);var le=this.lastTouches,be=function(){var Re=le.indexOf(q);Re>-1&&le.splice(Re,1)};setTimeout(be,St)}}function Or(M){for(var V=M.srcEvent.clientX,q=M.srcEvent.clientY,le=0;le<this.lastTouches.length;le++){var be=this.lastTouches[le],Re=Math.abs(V-be.x),tt=Math.abs(q-be.y);if(Re<=yr&&tt<=yr)return!0}return!1}var tr=b(u.style,"touchAction"),ir=tr!==r,mr="compute",_r="auto",ti="manipulation",Nt="none",_i="pan-x",ii="pan-y",Di=$t();function xi(M,V){this.manager=M,this.set(V)}xi.prototype={set:function(M){M==mr&&(M=this.compute()),ir&&this.manager.element.style&&Di[M]&&(this.manager.element.style[tr]=M),this.actions=M.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var M=[];return s(this.manager.recognizers,function(V){E(V.options.enable,[V])&&(M=M.concat(V.getTouchAction()))}),Gi(M.join(" "))},preventDefaults:function(M){var V=M.srcEvent,q=M.offsetDirection;if(this.manager.session.prevented){V.preventDefault();return}var le=this.actions,be=B(le,Nt)&&!Di[Nt],Re=B(le,ii)&&!Di[ii],tt=B(le,_i)&&!Di[_i];if(be){var lt=M.pointers.length===1,yt=M.distance<2,mt=M.deltaTime<250;if(lt&&yt&&mt)return}if(!(tt&&Re)&&(be||Re&&q&ne||tt&&q&Y))return this.preventSrc(V)},preventSrc:function(M){this.manager.session.prevented=!0,M.preventDefault()}};function Gi(M){if(B(M,Nt))return Nt;var V=B(M,_i),q=B(M,ii);return V&&q?Nt:V||q?V?_i:ii:B(M,ti)?ti:_r}function $t(){if(!ir)return!1;var M={},V=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(q){M[q]=V?a.CSS.supports("touch-action",q):!0}),M}var ri=1,zt=2,Ei=4,dt=8,Vt=dt,bt=16,_t=32;function Ot(M){this.options=f({},this.defaults,M||{}),this.id=W(),this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=ri,this.simultaneous={},this.requireFail=[]}Ot.prototype={defaults:{},set:function(M){return f(this.options,M),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(M){if(e(M,"recognizeWith",this))return this;var V=this.simultaneous;return M=rr(M,this),V[M.id]||(V[M.id]=M,M.recognizeWith(this)),this},dropRecognizeWith:function(M){return e(M,"dropRecognizeWith",this)?this:(M=rr(M,this),delete this.simultaneous[M.id],this)},requireFailure:function(M){if(e(M,"requireFailure",this))return this;var V=this.requireFail;return M=rr(M,this),R(V,M)===-1&&(V.push(M),M.requireFailure(this)),this},dropRequireFailure:function(M){if(e(M,"dropRequireFailure",this))return this;M=rr(M,this);var V=R(this.requireFail,M);return V>-1&&this.requireFail.splice(V,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(M){return!!this.simultaneous[M.id]},emit:function(M){var V=this,q=this.state;function le(be){V.manager.emit(be,M)}q<dt&&le(V.options.event+vt(q)),le(V.options.event),M.additionalEvent&&le(M.additionalEvent),q>=dt&&le(V.options.event+vt(q))},tryEmit:function(M){if(this.canEmit())return this.emit(M);this.state=_t},canEmit:function(){for(var M=0;M<this.requireFail.length;){if(!(this.requireFail[M].state&(_t|ri)))return!1;M++}return!0},recognize:function(M){var V=f({},M);if(!E(this.options.enable,[this,V])){this.reset(),this.state=_t;return}this.state&(Vt|bt|_t)&&(this.state=ri),this.state=this.process(V),this.state&(zt|Ei|dt|bt)&&this.tryEmit(V)},process:function(M){},getTouchAction:function(){},reset:function(){}};function vt(M){return M&bt?"cancel":M&dt?"end":M&Ei?"move":M&zt?"start":""}function xr(M){return M==fe?"down":M==D?"up":M==Oe?"left":M==$e?"right":""}function rr(M,V){var q=V.manager;return q?q.get(M):M}function Lt(){Ot.apply(this,arguments)}m(Lt,Ot,{defaults:{pointers:1},attrTest:function(M){var V=this.options.pointers;return V===0||M.pointers.length===V},process:function(M){var V=this.state,q=M.eventType,le=V&(zt|Ei),be=this.attrTest(M);return le&&(q&ze||!be)?V|bt:le||be?q&De?V|dt:V&zt?V|Ei:zt:_t}});function Ri(){Lt.apply(this,arguments),this.pX=null,this.pY=null}m(Ri,Lt,{defaults:{event:"pan",threshold:10,pointers:1,direction:H},getTouchAction:function(){var M=this.options.direction,V=[];return M&ne&&V.push(ii),M&Y&&V.push(_i),V},directionTest:function(M){var V=this.options,q=!0,le=M.distance,be=M.direction,Re=M.deltaX,tt=M.deltaY;return be&V.direction||(V.direction&ne?(be=Re===0?Ce:Re<0?Oe:$e,q=Re!=this.pX,le=Math.abs(M.deltaX)):(be=tt===0?Ce:tt<0?D:fe,q=tt!=this.pY,le=Math.abs(M.deltaY))),M.direction=be,q&&le>V.threshold&&be&V.direction},attrTest:function(M){return Lt.prototype.attrTest.call(this,M)&&(this.state&zt||!(this.state&zt)&&this.directionTest(M))},emit:function(M){this.pX=M.deltaX,this.pY=M.deltaY;var V=xr(M.direction);V&&(M.additionalEvent=this.options.event+V),this._super.emit.call(this,M)}});function di(){Lt.apply(this,arguments)}m(di,Lt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Nt]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.scale-1)>this.options.threshold||this.state&zt)},emit:function(M){if(M.scale!==1){var V=M.scale<1?"in":"out";M.additionalEvent=this.options.event+V}this._super.emit.call(this,M)}});function Ui(){Ot.apply(this,arguments),this._timer=null,this._input=null}m(Ui,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[_r]},process:function(M){var V=this.options,q=M.pointers.length===V.pointers,le=M.distance<V.threshold,be=M.deltaTime>V.time;if(this._input=M,!le||!q||M.eventType&(De|ze)&&!be)this.reset();else if(M.eventType&Te)this.reset(),this._timer=p(function(){this.state=Vt,this.tryEmit()},V.time,this);else if(M.eventType&De)return Vt;return _t},reset:function(){clearTimeout(this._timer)},emit:function(M){this.state===Vt&&(M&&M.eventType&De?this.manager.emit(this.options.event+"up",M):(this._input.timeStamp=v(),this.manager.emit(this.options.event,this._input)))}});function Li(){Lt.apply(this,arguments)}m(Li,Lt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Nt]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.rotation)>this.options.threshold||this.state&zt)}});function ci(){Lt.apply(this,arguments)}m(ci,Lt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ne|Y,pointers:1},getTouchAction:function(){return Ri.prototype.getTouchAction.call(this)},attrTest:function(M){var V=this.options.direction,q;return V&(ne|Y)?q=M.overallVelocity:V&ne?q=M.overallVelocityX:V&Y&&(q=M.overallVelocityY),this._super.attrTest.call(this,M)&&V&M.offsetDirection&&M.distance>this.options.threshold&&M.maxPointers==this.options.pointers&&g(q)>this.options.velocity&&M.eventType&De},emit:function(M){var V=xr(M.offsetDirection);V&&this.manager.emit(this.options.event+V,M),this.manager.emit(this.options.event,M)}});function $i(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}m($i,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ti]},process:function(M){var V=this.options,q=M.pointers.length===V.pointers,le=M.distance<V.threshold,be=M.deltaTime<V.time;if(this.reset(),M.eventType&Te&&this.count===0)return this.failTimeout();if(le&&be&&q){if(M.eventType!=De)return this.failTimeout();var Re=this.pTime?M.timeStamp-this.pTime<V.interval:!0,tt=!this.pCenter||gt(this.pCenter,M.center)<V.posThreshold;this.pTime=M.timeStamp,this.pCenter=M.center,!tt||!Re?this.count=1:this.count+=1,this._input=M;var lt=this.count%V.taps;if(lt===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=Vt,this.tryEmit()},V.interval,this),zt):Vt}return _t},failTimeout:function(){return this._timer=p(function(){this.state=_t},this.options.interval,this),_t},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Vt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Wt(M,V){return V=V||{},V.recognizers=w(V.recognizers,Wt.defaults.preset),new ni(M,V)}Wt.VERSION="2.0.7",Wt.defaults={domEvents:!1,touchAction:mr,enable:!0,inputTarget:null,inputClass:null,preset:[[Li,{enable:!1}],[di,{enable:!1},["rotate"]],[ci,{direction:ne}],[Ri,{direction:ne},["swipe"]],[$i],[$i,{event:"doubletap",taps:2},["tap"]],[Ui]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Jr=1,nr=2;function ni(M,V){this.options=f({},Wt.defaults,V||{}),this.options.inputTarget=this.options.inputTarget||M,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=M,this.input=ee(this),this.touchAction=new xi(this,this.options.touchAction),Qe(this,!0),s(this.options.recognizers,function(q){var le=this.add(new q[0](q[1]));q[2]&&le.recognizeWith(q[2]),q[3]&&le.requireFailure(q[3])},this)}ni.prototype={set:function(M){return f(this.options,M),M.touchAction&&this.touchAction.update(),M.inputTarget&&(this.input.destroy(),this.input.target=M.inputTarget,this.input.init()),this},stop:function(M){this.session.stopped=M?nr:Jr},recognize:function(M){var V=this.session;if(!V.stopped){this.touchAction.preventDefaults(M);var q,le=this.recognizers,be=V.curRecognizer;(!be||be&&be.state&Vt)&&(be=V.curRecognizer=null);for(var Re=0;Re<le.length;)q=le[Re],V.stopped!==nr&&(!be||q==be||q.canRecognizeWith(be))?q.recognize(M):q.reset(),!be&&q.state&(zt|Ei|dt)&&(be=V.curRecognizer=q),Re++}},get:function(M){if(M instanceof Ot)return M;for(var V=this.recognizers,q=0;q<V.length;q++)if(V[q].options.event==M)return V[q];return null},add:function(M){if(e(M,"add",this))return this;var V=this.get(M.options.event);return V&&this.remove(V),this.recognizers.push(M),M.manager=this,this.touchAction.update(),M},remove:function(M){if(e(M,"remove",this))return this;if(M=this.get(M),M){var V=this.recognizers,q=R(V,M);q!==-1&&(V.splice(q,1),this.touchAction.update())}return this},on:function(M,V){if(M!==r&&V!==r){var q=this.handlers;return s(U(M),function(le){q[le]=q[le]||[],q[le].push(V)}),this}},off:function(M,V){if(M!==r){var q=this.handlers;return s(U(M),function(le){V?q[le]&&q[le].splice(R(q[le],V),1):delete q[le]}),this}},emit:function(M,V){this.options.domEvents&&kt(M,V);var q=this.handlers[M]&&this.handlers[M].slice();if(!(!q||!q.length)){V.type=M,V.preventDefault=function(){V.srcEvent.preventDefault()};for(var le=0;le<q.length;)q[le](V),le++}},destroy:function(){this.element&&Qe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Qe(M,V){var q=M.element;if(!!q.style){var le;s(M.options.cssProps,function(be,Re){le=b(q.style,Re),V?(M.oldCssProps[le]=q.style[le],q.style[le]=be):q.style[le]=M.oldCssProps[le]||""}),V||(M.oldCssProps={})}}function kt(M,V){var q=t.createEvent("Event");q.initEvent(M,!0,!0),q.gesture=V,V.target.dispatchEvent(q)}f(Wt,{INPUT_START:Te,INPUT_MOVE:Ae,INPUT_END:De,INPUT_CANCEL:ze,STATE_POSSIBLE:ri,STATE_BEGAN:zt,STATE_CHANGED:Ei,STATE_ENDED:dt,STATE_RECOGNIZED:Vt,STATE_CANCELLED:bt,STATE_FAILED:_t,DIRECTION_NONE:Ce,DIRECTION_LEFT:Oe,DIRECTION_RIGHT:$e,DIRECTION_UP:D,DIRECTION_DOWN:fe,DIRECTION_HORIZONTAL:ne,DIRECTION_VERTICAL:Y,DIRECTION_ALL:H,Manager:ni,Input:he,TouchAction:xi,TouchInput:yi,MouseInput:Ai,PointerEventInput:Qt,TouchMouseInput:ji,SingleTouchInput:Qi,Recognizer:Ot,AttrRecognizer:Lt,Tap:$i,Pan:Ri,Swipe:ci,Pinch:di,Rotate:Li,Press:Ui,on:k,off:x,each:s,merge:y,extend:c,assign:f,inherit:m,bindFn:_,prefixed:b});var ar=typeof a!="undefined"?a:typeof self!="undefined"?self:{};ar.Hammer=Wt,typeof r=="function"&&r.amd?r(function(){return Wt}):h.exports?h.exports=Wt:a[i]=Wt})(window,document,"Hammer")})(Ki);var to={};(function(h){const a=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=a+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",i="["+a+"]["+t+"]*",r=new RegExp("^"+i+"$"),n=function(o,d){const g=[];let v=d.exec(o);for(;v;){const p=[];p.startIndex=d.lastIndex-v[0].length;const e=v.length;for(let s=0;s<e;s++)p.push(v[s]);g.push(p),v=d.exec(o)}return g},u=function(o){const d=r.exec(o);return!(d===null||typeof d=="undefined")};h.isExist=function(o){return typeof o!="undefined"},h.isEmptyObject=function(o){return Object.keys(o).length===0},h.merge=function(o,d,g){if(d){const v=Object.keys(d),p=v.length;for(let e=0;e<p;e++)g==="strict"?o[v[e]]=[d[v[e]]]:o[v[e]]=d[v[e]]}},h.getValue=function(o){return h.isExist(o)?o:""},h.isName=u,h.getAllMatches=n,h.nameRegexp=i})(to);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const lf=to;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,lf.nameRegexp);Xs("data-v-ec8edf16");const uf={key:0,class:"placeholder"};Ks();var io=qs({props:{modelValue:String,labelKey:{type:String,default:"label"},valueKey:{type:String,default:"key"},columns:{type:Array,required:!0}},emits:["update:modelValue"],setup(h,{emit:a}){const t=h,i=je(!1),r=je(null);oi(()=>t.modelValue,()=>{if(t.modelValue!=null&&t.modelValue!=null){let u=t.columns.find(o=>o[t.valueKey]==t.modelValue);u?r.value=u[t.labelKey]:r.value=t.modelValue}else r.value=null},{immediate:!0});const n=u=>{r.value=u[t.labelKey],a("update:modelValue",u[t.valueKey]),i.value=!1};return(u,o)=>{const d=jt("van-picker"),g=jt("van-popup");return nt(),ct(Yi,null,[Ge("div",{onClick:o[0]||(o[0]=v=>i.value=!0)},[r.value==null?(nt(),ct("div",uf,"\u8BF7\u9009\u62E9")):Ku(u.$slots,"default",{key:1,label:r.value},void 0,!0)]),He(g,{show:i.value,"onUpdate:show":o[2]||(o[2]=v=>i.value=v),round:"",position:"bottom",teleport:"#app"},{default:at(()=>[He(d,{columns:h.columns,"columns-field-names":{text:h.labelKey},onCancel:o[1]||(o[1]=v=>i.value=!1),onConfirm:n},null,8,["columns","columns-field-names"])]),_:1},8,["show"])],64)}}});io.__scopeId="data-v-ec8edf16";class ff{constructor(){this.startGcService()}startGcService(){return oe(this,null,function*(){let a=()=>oe(this,null,function*(){setTimeout(()=>oe(this,null,function*(){let t=yield st.getAllByIndex("fetch_cache","expire_time",IDBKeyRange.upperBound(Date.now()));for(let i=0;i<t.length;i++){const r=t[i];yield st.delRow("fetch_cache",r.id)}t.length>0&&console.log(`FetchCacheGcService \u6E05\u9664\u8FC7\u671F\u7F13\u5B58${t.length}\u4E2A`),a()}),1e4)});a()})}get(a){return oe(this,null,function*(){let t=yield st.getOneByIndex("fetch_cache","markurl",a);return!t||t.expire_time<=Date.now()?null:t})}set(a,t,i,r){return oe(this,null,function*(){let n=Date.now(),u=n+r;yield st.addOrUpdateRow("fetch_cache",{markurl:a,create_time:n,expire_time:u,req:t,res:i},"markurl")})}setBody(a,t,i){return oe(this,null,function*(){yield this.set(a,{url:"",method:"",headers:{},body:""},{status:200,statusText:"",headers:{},body:t},i)})}getBody(a){return oe(this,null,function*(){let t=yield this.get(a);return t?t.res.body:null})}clear(){return oe(this,null,function*(){yield st.clearStore("fetch_cache")})}}var Gt=new ff;const ro=()=>location.href.startsWith("http://vsong.cpomelo")||location.href.startsWith("http://192.168.")||location.href.startsWith("http://127.0.0.1"),df=h=>{let a=0,t=[],i=0,r=v=>{let p=Array.isArray(v)?[]:{};return Object.keys(v).forEach(e=>{let s=v[e];s instanceof ArrayBuffer?(p[e]=`[ArrayBuffer]${a},${s.byteLength}`,t.push(s),a+=s.byteLength,i+=s.byteLength):Array.isArray(s)?p[e]=r(s):s===null?p[e]=s:typeof s=="object"?p[e]=r(s):p[e]=s}),p},n=r(h),u=new TextEncoder().encode(JSON.stringify(n)),o=new Uint8Array(6+u.byteLength+i),d=new DataView(o.buffer);d.setUint16(0,23156),d.setUint32(2,u.byteLength);let g=6;return o.set(u,6),g+=u.byteLength,t.forEach(v=>{o.set(new Uint8Array(v),g),g+=v.byteLength}),o.buffer},cf=h=>{let a=new DataView(h);a.getUint16(0);let t=a.getUint32(2),i=6,r=new TextDecoder().decode(h.slice(i,i+t)),n=JSON.parse(r);i+=t;let u=o=>{Object.keys(o).forEach(d=>{let g=o[d];if(typeof g=="string"&&g.startsWith("[ArrayBuffer]")){let[v,p]=g.slice("[ArrayBuffer]".length).split(",");o[d]=h.slice(i+Number(v),i+Number(v)+Number(p))}else g&&typeof g=="object"&&u(g)})};return u(n),n};class hf{constructor(){ge(this,"peer");ge(this,"channel");ge(this,"localUfrag");ge(this,"localPwd");ge(this,"remoteIp");ge(this,"remotePort");ge(this,"connectCpl");ge(this,"isClosed");ge(this,"channelMsgMap");ge(this,"channelPackBuffers");ge(this,"requestWaitMap");this.isClosed=!0,this.localPwd="cuntoufangyidaduinidejia",this.remoteIp="127.0.0.1",this.remotePort=28443,this.channelMsgMap=new Map,this.channelPackBuffers=[],this.requestWaitMap=new Map}connect(a){return oe(this,null,function*(){if(this.connectCpl!=null)throw new Error("\u5F53\u524D\u5904\u4E8E\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");this.isClosed=!1,(a==null?void 0:a.ip)!==void 0&&(this.remoteIp=a.ip),(a==null?void 0:a.port)!==void 0&&(this.remotePort=a.port),this.connectCpl=new Xi,this.peer=new RTCPeerConnection({iceServers:[]}),this.peer.addEventListener("connectionstatechange",()=>{this.log(`connectionstatechange [${this.peer.connectionState}]`),(this.peer.connectionState=="disconnected"||this.peer.connectionState=="failed")&&this.close()}),this.peer.addEventListener("iceconnectionstatechange",()=>{this.log(`iceconnectionstatechange [${this.peer.iceConnectionState}]`)}),this.channel=this.peer.createDataChannel("HttpOverRtc"),this.channel.binaryType="arraybuffer",this.channel.bufferedAmountLowThreshold=0,this.channel.addEventListener("message",r=>{this.log("channelMessage: ",r),this.handleData(r)}),this.channel.addEventListener("close",()=>{this.log("channelClose"),this.close()}),this.channel.addEventListener("open",()=>{this.log("channelOpen"),this.connectCpl.resolve(!0)}),this.channel.addEventListener("bufferedamountlow",()=>{this.channelPackBuffers.length!=0&&this.channel.send(this.channelPackBuffers.shift())});let t=yield this.peer.createOffer();this.localUfrag=Math.random().toString().slice(2,14),t.sdp=t.sdp.replace(/\r\na=ice-ufrag:.*\r\n/g,`\r
a=ice-ufrag:`+this.localUfrag+`\r
`),t.sdp=t.sdp.replace(/\r\na=ice-pwd:.*\r\n/g,`\r
a=ice-pwd:`+this.localPwd+`\r
`),yield this.peer.setLocalDescription(t);let i={type:"answer",sdp:`v=0\r
o=- 2610138035504400085 1668707003 IN IP4 0.0.0.0\r
s=-\r
t=0 0\r
a=fingerprint:sha-256 F5:14:05:E2:C2:03:16:7C:E8:83:B2:F0:E9:FE:36:47:8E:3C:43:96:17:71:4F:89:2C:E7:DB:2F:E8:70:25:E7\r
a=extmap-allow-mixed\r
a=group:BUNDLE 0\r
m=application 9 UDP/DTLS/SCTP webrtc-datachannel\r
c=IN IP4 0.0.0.0\r
a=setup:active\r
a=mid:0\r
a=sendrecv\r
a=sctp-port:5000\r
a=ice-ufrag:${this.localUfrag}\r
a=ice-pwd:${this.localPwd}\r
a=candidate:2887945528 1 udp 2130706431 ${this.remoteIp} ${this.remotePort} typ host\r
a=end-of-candidates\r
`};return yield this.peer.setRemoteDescription(i),this.connectCpl.toPromise()})}close(){return oe(this,null,function*(){if(!this.isClosed){if(this.isClosed=!0,this.connectCpl==null)throw new Error("\u5F53\u524D\u5904\u4E8E\u672A\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");this.connectCpl.reject(!1),this.channel.close(),this.peer.close(),this.peer=null,this.channel=null,this.localUfrag=null,this.connectCpl=null,this.channelMsgMap.clear(),this.channelPackBuffers=[],this.requestWaitMap.forEach(a=>{a.responseCpl.reject(!1)})}})}handleData(a){let t=a.data,i=this.decodeChannelMsgPack(t),r=this.channelMsgMap.get(i.id);if(r||(r={id:i.id,isEof:!1,bufferLength:0,buffers:[]},this.channelMsgMap.set(i.id,r)),r.bufferLength+=i.bodyBuffer.byteLength,r.buffers.push(i.bodyBuffer),r.isEof=i.isEof,r.isEof){this.channelMsgMap.delete(r.id);let n=new Uint8Array(r.bufferLength),u=0;r.buffers.forEach(d=>{n.set(new Uint8Array(d),u),u+=d.byteLength});let o=cf(n.buffer);if(o.ResId){let d=this.requestWaitMap.get(o.ResId);if(!d)throw new Error(`\u672A\u77E5\u7684ResId\uFF1A${o.ResId}`);if(this.log("response",o),o.Err)d.responseCpl.reject(o.Err),this.requestWaitMap.delete(d.reqId);else if(d.responseCpl.status=="pending"&&d.responseCpl.resolve({Status:o.Res.Status,StatusCode:o.Res.StatusCode,Headers:o.Res.Headers,arrayBuffer:()=>d.responseBodyCpl.toPromise()}),d.responseBodys.push(o.Res.Body),o.Res.BodyEnd){let g=new Uint8Array(d.responseBodys.reduce((p,e)=>p+e.byteLength,0)),v=0;d.responseBodys.forEach(p=>{g.set(new Uint8Array(p),v),v+=p.byteLength}),d.responseBodyCpl.resolve(g.buffer),this.requestWaitMap.delete(d.reqId)}}}}sendData(a){const t=63*1024-10;let i=parseInt(Math.random().toString().slice(2,10))+1,r=!1,n=0;for(;!r;){let u;a.byteLength-n>t?(u=a.slice(n,n+t),n+=t,r=!1):(u=a.slice(n),n=a.byteLength,r=!0);let o=this.encodeChannelMsgPack({type:1,id:i,isEof:r,length:u.byteLength,bodyBuffer:u});this.channel.bufferedAmount==0&&this.channelPackBuffers.length==0?this.channel.send(o):this.channelPackBuffers.push(o)}}decodeChannelMsgPack(a){const t=10;let i=new DataView(a),r=i.getUint8(0),n=i.getUint32(1),u=i.getUint8(5),o=i.getUint32(6),d=a.slice(t);return{type:r,id:n,isEof:!!u,length:o,bodyBuffer:d}}encodeChannelMsgPack(a){const t=10;let i=new ArrayBuffer(t),r=new DataView(i);r.setUint8(0,a.type),r.setUint32(1,a.id),r.setUint8(5,a.isEof?1:0),r.setUint32(6,a.length);let n=new Uint8Array(i.byteLength+a.bodyBuffer.byteLength);return n.set(new Uint8Array(i),0),n.set(new Uint8Array(a.bodyBuffer),i.byteLength),n.buffer}request(a){return oe(this,null,function*(){if(!this.connectCpl)throw new Error("\u5F53\u524D\u5904\u4E8E\u672A\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");yield this.connectCpl.toPromise(),this.log("request",a);let t=Math.random().toString().slice(2,12),i=new Xi;this.requestWaitMap.set(t,{reqId:t,requestOptions:a,responseCpl:i,responseBodys:[],responseBodyCpl:new Xi});let r=a.data;return r&&!(r instanceof ArrayBuffer)&&(r=new TextEncoder().encode(JSON.stringify(r)).buffer),this.sendData(df({ReqId:t,Req:{Method:a.method.toUpperCase(),Url:a.url,Headers:a.headers,Body:r}})),i.toPromise()})}log(...a){this._xbl===!0&&console.log("hrtc:",...a)}}var pf=new hf;class no{constructor(){ge(this,"requestInterceptor",{onFulfilled:null,onRejected:null});ge(this,"responseInterceptor",{onFulfilled:null,onRejected:null})}request(a){return oe(this,null,function*(){a.headers||(a.headers={});try{this.requestInterceptor.onFulfilled&&(a=this.requestInterceptor.onFulfilled(a))}catch(t){return this.requestInterceptor.onRejected?Promise.reject(this.requestInterceptor.onRejected(t)):Promise.reject(t)}try{let t=yield pf.request({url:a.url,method:a.method,data:a.data,headers:a.headers});t.Body=yield t.arrayBuffer();let i={};Object.keys(t.Headers).forEach(n=>{i[n.toLowerCase()]=t.Headers[n][0]});let r;if(a.responseType=="blob")r=new Blob([new Uint8Array(t.Body)]);else if(a.responseType=="arraybuffer")r=t.Body;else{r=new TextDecoder().decode(t.Body);try{r=JSON.parse(r)}catch(n){}}if(t.StatusCode>=200&&t.StatusCode<400)return Promise.resolve({data:r,headers:i,status:t.StatusCode,statusText:t.Status});{let n={config:a,response:{data:r,headers:i,status:t.StatusCode,statusText:t.Status},error:{message:"",stack:""}};return this.responseInterceptor.onRejected&&(n=this.responseInterceptor.onRejected(n)),Promise.reject(n)}}catch(t){return t={message:t.Message,stack:""},this.responseInterceptor.onRejected&&(t=this.responseInterceptor.onRejected(t)),Promise.reject(t)}})}get(i){return oe(this,arguments,function*(a,t={}){return t=wi({},t),t.method="GET",t.url=a,this.request(t)})}post(r,n){return oe(this,arguments,function*(a,t,i={}){return i=wi({},i),i.method="POST",i.url=a,i.data=t,this.request(i)})}setRequestInterceptor(a,t){this.requestInterceptor.onFulfilled=a,this.requestInterceptor.onRejected=t}setResponseInterceptor(a,t){this.responseInterceptor.onFulfilled=a,this.responseInterceptor.onRejected=t}}const Ua="http://service.vsong.cpomelo.com:8077/api/cross";class gf{constructor(){ge(this,"crossToken","");ge(this,"crossType","default");ge(this,"crossUrl",Ua);ge(this,"defaultAxios");ge(this,"bridgeAxios");ge(this,"proxyAxios");ge(this,"hrtcAxios");ge(this,"getAxios",()=>this.crossType=="proxy"?this.proxyAxios:this.crossType=="bridge"?this.bridgeAxios:this.crossType=="hrtc"?this.hrtcAxios:this.defaultAxios);this.defaultAxios=dn.create({timeout:24e4}),this.defaultAxios.interceptors.request.use(a=>(a.headers["cross-token"]=this.crossToken,a)),this.defaultAxios.interceptors.response.use(a=>a,a=>{if(a.config.noErrorToast)return a;if(a.response){const t=a.response.data;Fe.fail(t.msg)}else Fe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${a.message}`);return Promise.reject(a)})}init(a,t){return oe(this,null,function*(){if(a){let i=a.split(";").map(u=>u.trim()),r=[],n=[];i.forEach(u=>{!ro()&&(u.startsWith("http://192.168")||u.startsWith("http://127.0.0.1"))?n.push(u):r.push(u)}),r.forEach(u=>{this.tryProxyAxios(u).then(()=>t("proxy"))}),n.forEach(u=>{this.tryHrtcAxios(u).then(()=>t("hrtc"))})}yield this.tryDefaultAxios(Ua).then(i=>t(i))})}tryDefaultAxios(a){return oe(this,null,function*(){let t=document.createElement("iframe");return t.src=a+"/bridge",t.setAttribute("style","font-size: 0;width: 0;height: 0;border: none;display:block;"),new Promise((i,r)=>{let n=u=>{u.source==t.contentWindow&&(window.removeEventListener("message",n),this.tryBridgeAxios(a).then(()=>{i("default")}).catch(()=>{i("failed")}))};window.addEventListener("message",n),document.body.appendChild(t),setTimeout(()=>{i("failed")},1e3)})})}tryBridgeAxios(a){return oe(this,null,function*(){try{yield this.initBridgeAxios(a);let t=yield this.getCrossToken(this.bridgeAxios,a);if(!t)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.crossType="bridge",this.crossUrl=a,this.crossToken=t,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}tryProxyAxios(a){return oe(this,null,function*(){try{let t=dn.create({}),i=yield this.getCrossToken(t,a);if(!i)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.proxyAxios=t,this.proxyAxios.interceptors.request.use(r=>(r.headers["cross-token"]=this.crossToken,r)),this.proxyAxios.interceptors.response.use(r=>r,r=>{if(r.config.noErrorToast)return r;if(r.response){const n=r.response.data;Fe.fail(n.msg)}else Fe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${r.message}`);return Promise.reject(r)}),this.crossType="proxy",this.crossUrl=a,this.crossToken=i,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}tryHrtcAxios(a){return oe(this,null,function*(){try{let t=new no,i=yield this.getCrossToken(t,a);if(!i)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.hrtcAxios=t,this.hrtcAxios.setRequestInterceptor(r=>(r.headers["cross-token"]=this.crossToken,r)),this.hrtcAxios.setResponseInterceptor(r=>r,r=>{if(r.config.noErrorToast)return r;if(r.response){const n=r.response.data;Fe.fail(n.msg)}else Fe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${r.message}`);return Promise.reject(r)}),this.crossType="hrtc",this.crossUrl=a,this.crossToken=i,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}overrideXgPlayerFetch(){return oe(this,null,function*(){let a;this.crossType!="default"&&(a=(t,i)=>this.getAxios().get(t,{responseType:"arraybuffer"}).then(r=>new Response(r.data))),window.overrideXgFetch=a})}getCrossToken(a,t){return oe(this,null,function*(){let i=localStorage.getItem("vsong_token");return(yield a.get(t+"/token",{headers:{Authorization:"Bearer "+i},timeout:500,noErrorToast:!0})).data.data})}initBridgeAxios(a){return oe(this,null,function*(){const t=document.getElementById("bridgeIframe");this.bridgeAxios=new vf({bridgeIframe:t,bridgeSrc:a+"/bridge"}),this.bridgeAxios.setRequestInterceptor(i=>(!i.url.startsWith("http://")&&!i.url.startsWith("https://")?i.url="http://service.vsong.cpomelo.com:8077/api"+i.url:i.headers["cross-token"]=this.crossToken,i)),this.bridgeAxios.setResponseInterceptor(i=>i.config.url.startsWith(Ua)?i:i.data,i=>{if(i.config.noErrorToast)return i;if(i.response){const r=i.response.data;Fe.fail(r.msg)}else Fe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${i.message}`);return i})})}buildCrossUrl({url:a,referer:t=void 0,cache:i=void 0,withToken:r=void 0}){let n=this.crossUrl+`?agent=pc&url=${encodeURIComponent(a)}`;return t||(t=new URL(a).origin),n+=`&ref=${encodeURIComponent(t)}`,i&&(n+=`&cache=${encodeURIComponent(i)}`),r&&(n+="&token="+this.crossToken),n}buildCustomCrossUrl({url:a,method:t,headers:i,cache:r=void 0,withToken:n=!1}){let u=`${this.crossUrl}/custom?url=${encodeURIComponent(a)}&method=${t}&headers=${encodeURIComponent(JSON.stringify(i))}`;return r!=null&&(u+=`&cache=${encodeURIComponent(r)}`),n===!0&&(u+=`&token=${this.crossToken}`),u}buildCrossM3u8({url:a,method:t,headers:i,cache:r=void 0,withToken:n=!1}){let u=`${this.crossUrl}/m3u8/file?url=${encodeURIComponent(a)}&method=${t}&headers=${encodeURIComponent(JSON.stringify(i))}`;return r!=null&&(u+=`&cache=${encodeURIComponent(r)}`),n===!0&&(u+=`&token=${this.crossToken}`),u}getCrossUrl(){return this.crossUrl}getCrossType(){return this.crossType}getRedirectInfo(a){return oe(this,null,function*(){return(yield this.getAxios().get(this.crossUrl+`/redirect-info?url=${a}`)).data.data.headers.location})}}class vf{constructor({bridgeIframe:a,bridgeSrc:t}){ge(this,"requestPool",{});ge(this,"bridgeIframe");ge(this,"bridgeWindow");ge(this,"bridgeSrc");ge(this,"bridgeOrigin");ge(this,"initCpt",new Xi);ge(this,"requestInterceptor",{onFulfilled:null,onRejected:null});ge(this,"responseInterceptor",{onFulfilled:null,onRejected:null});this.bridgeIframe=a,this.bridgeSrc=t,this.bridgeOrigin=this.bridgeSrc.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:@]*/)[0],this.bridgeIframe.setAttribute("src",this.bridgeSrc),window.addEventListener("message",i=>{if(i.origin!=this.bridgeOrigin)return;let r=i.data;if(r.event==="ready")this.bridgeWindow=this.bridgeIframe.contentWindow,this.initCpt.resolve(!0);else if(r.event==="response"){let n=r.data.resId,u=this.requestPool[n];if(!u)return;if(r.data.success){let o=r.data.response;this.responseInterceptor.onFulfilled&&(o=this.responseInterceptor.onFulfilled(o)),u.cpl.resolve(o)}else{let o=new Error(r.data.error.message);o.stack=r.data.error.stack,o.response=r.data.response,o.config=r.data.config,this.responseInterceptor.onRejected&&(o=this.responseInterceptor.onRejected(o)),u.cpl.reject(o)}delete this.requestPool[n]}})}request(a){return oe(this,null,function*(){yield this.initCpt.toPromise();let t="r"+Math.random().toString().slice(2,10);a.headers||(a.headers={});try{this.requestInterceptor.onFulfilled&&(a=this.requestInterceptor.onFulfilled(a))}catch(r){return this.requestInterceptor.onRejected?Promise.reject(this.requestInterceptor.onRejected(r)):Promise.reject(r)}this.bridgeWindow.postMessage({event:"request",data:{reqId:t,requestConfig:a}},this.bridgeOrigin);let i=new Xi;return this.requestPool[t]={cpl:i},i.toPromise()})}get(i){return oe(this,arguments,function*(a,t={}){return t=wi({},t),t.method="GET",t.url=a,this.request(t)})}post(r,n){return oe(this,arguments,function*(a,t,i={}){return i=wi({},i),i.method="POST",i.url=a,i.data=t,this.request(i)})}setRequestInterceptor(a,t){this.requestInterceptor.onFulfilled=a,this.requestInterceptor.onRejected=t}setResponseInterceptor(a,t){this.responseInterceptor.onFulfilled=a,this.responseInterceptor.onRejected=t}}var wt=new gf;class yf{constructor(){}getUserInfo(t){return oe(this,arguments,function*({sec_uid:a}){let i=yield this.getAwemeList({sec_uid:a},{order:"pubdate",max_cursor:"",count:50,forceRefresh:!1,isPageEnd:!1});return console.log(i),{face:i[0].author_avatar,name:i[0].author}})}getAwemeList(i,r){return oe(this,arguments,function*({sec_uid:a},t){let n=`https://www.douyin.com/aweme/v1/web/aweme/post/?aid=6383&sec_user_id=${a}&max_cursor=${t.max_cursor}&count=${t.count}`,u;if(t.forceRefresh||(u=yield Gt.getBody(n)),!u){let d=yield this.signUrl(n,"max-age=0");u=yield wt.getAxios().get(wt.buildCustomCrossUrl({url:d.url,method:"GET",headers:{accept:"application/json, text/plain, */*","user-agent":d.userAgent,"sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty",referer:"https://www.douyin.com/","accept-language":"zh-CN,zh;q=0.9",cookie:d.cookie},cache:"max-age=0"})),u=u.data,Gt.setBody(n,u,5*Tr)}t.max_cursor=u.max_cursor;let o=u.aweme_list;return o.map((d,g)=>{let v=u.request_item_cursor.toString();return g>=1&&!o[g-1].is_top&&(v=o[g-1].create_time+"000"),{vsongId:`dyAweme_${d.aweme_id}`,vsongType:"dyAweme",author:d.author.nickname,title:d.desc,coverUrl:d.video.cover.url_list[0],originUrl:`https://www.douyin.com/video/${d.aweme_id}`,sec_uid:a,aweme_id:d.aweme_id,videoUrl:d.video.play_addr.url_list[0],min_cursor:v,created:d.create_time,digg_count:d.statistics.digg_count,aweme_type:d.aweme_type,author_avatar:d.author.avatar_thumb.url_list[0]}}).filter(d=>d.aweme_type!=2)})}signUrl(a,t){return oe(this,null,function*(){return(yield wt.getAxios().get(wt.buildCrossUrl({url:`https://www.cpomelo.com/tassa/api/parsedy/sign-url?url=${encodeURIComponent(a)}`,cache:t}))).data.data})}getMediaUrl(r){return oe(this,arguments,function*({sec_uid:a,min_cursor:t,aweme_id:i}){let n=yield this.getAwemeList({sec_uid:a},{max_cursor:t,count:5,forceRefresh:!0}),u=n.find(o=>i==o.aweme_id);return u||(n=yield this.getAwemeList({sec_uid:a},{max_cursor:t,count:50,forceRefresh:!0}),u=n.find(o=>i==o.aweme_id)),{videoUrl:u.videoUrl,coverUrl:u.coverUrl}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCrossUrl({url:a,cache:t,withToken:i,referer:"https://www.douyin.com"})}}var li=new yf,La={exports:{}},ao={},jn={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7},qi={};const pt=jn,Pa=()=>[{type:pt.RANGE,from:48,to:57}],so=()=>[{type:pt.CHAR,value:95},{type:pt.RANGE,from:97,to:122},{type:pt.RANGE,from:65,to:90}].concat(Pa()),oo=()=>[{type:pt.CHAR,value:9},{type:pt.CHAR,value:10},{type:pt.CHAR,value:11},{type:pt.CHAR,value:12},{type:pt.CHAR,value:13},{type:pt.CHAR,value:32},{type:pt.CHAR,value:160},{type:pt.CHAR,value:5760},{type:pt.RANGE,from:8192,to:8202},{type:pt.CHAR,value:8232},{type:pt.CHAR,value:8233},{type:pt.CHAR,value:8239},{type:pt.CHAR,value:8287},{type:pt.CHAR,value:12288},{type:pt.CHAR,value:65279}],mf=()=>[{type:pt.CHAR,value:10},{type:pt.CHAR,value:13},{type:pt.CHAR,value:8232},{type:pt.CHAR,value:8233}];qi.words=()=>({type:pt.SET,set:so(),not:!1});qi.notWords=()=>({type:pt.SET,set:so(),not:!0});qi.ints=()=>({type:pt.SET,set:Pa(),not:!1});qi.notInts=()=>({type:pt.SET,set:Pa(),not:!0});qi.whitespace=()=>({type:pt.SET,set:oo(),not:!1});qi.notWhitespace=()=>({type:pt.SET,set:oo(),not:!0});qi.anyChar=()=>({type:pt.SET,set:mf(),not:!0});(function(h){const a=jn,t=qi,i="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",r={"0":0,t:9,n:10,v:11,f:12,r:13};h.strToChars=function(n){var u=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g;return n=n.replace(u,function(o,d,g,v,p,e,s,l){if(g)return o;var f=d?8:v?parseInt(v,16):p?parseInt(p,16):e?parseInt(e,8):s?i.indexOf(s):r[l],c=String.fromCharCode(f);return/[[\]{}^$.|?*+()]/.test(c)&&(c="\\"+c),c}),n},h.tokenizeClass=(n,u)=>{for(var o=[],d=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?([^])/g,g,v;(g=d.exec(n))!=null;)if(g[1])o.push(t.words());else if(g[2])o.push(t.ints());else if(g[3])o.push(t.whitespace());else if(g[4])o.push(t.notWords());else if(g[5])o.push(t.notInts());else if(g[6])o.push(t.notWhitespace());else if(g[7])o.push({type:a.RANGE,from:(g[8]||g[9]).charCodeAt(0),to:g[10].charCodeAt(0)});else if(v=g[12])o.push({type:a.CHAR,value:v.charCodeAt(0)});else return[o,d.lastIndex];h.error(u,"Unterminated character class")},h.error=(n,u)=>{throw new SyntaxError("Invalid regular expression: /"+n+"/: "+u)}})(ao);var pn={};const Gn=jn;pn.wordBoundary=()=>({type:Gn.POSITION,value:"b"});pn.nonWordBoundary=()=>({type:Gn.POSITION,value:"B"});pn.begin=()=>({type:Gn.POSITION,value:"^"});pn.end=()=>({type:Gn.POSITION,value:"$"});const Vr=ao,hi=jn,Sr=qi,$n=pn;La.exports=h=>{var a=0,t,i,r={type:hi.ROOT,stack:[]},n=r,u=r.stack,o=[],d=y=>{Vr.error(h,`Nothing to repeat at column ${y-1}`)},g=Vr.strToChars(h);for(t=g.length;a<t;)switch(i=g[a++],i){case"\\":switch(i=g[a++],i){case"b":u.push($n.wordBoundary());break;case"B":u.push($n.nonWordBoundary());break;case"w":u.push(Sr.words());break;case"W":u.push(Sr.notWords());break;case"d":u.push(Sr.ints());break;case"D":u.push(Sr.notInts());break;case"s":u.push(Sr.whitespace());break;case"S":u.push(Sr.notWhitespace());break;default:/\d/.test(i)?u.push({type:hi.REFERENCE,value:parseInt(i,10)}):u.push({type:hi.CHAR,value:i.charCodeAt(0)})}break;case"^":u.push($n.begin());break;case"$":u.push($n.end());break;case"[":var v;g[a]==="^"?(v=!0,a++):v=!1;var p=Vr.tokenizeClass(g.slice(a),h);a+=p[1],u.push({type:hi.SET,set:p[0],not:v});break;case".":u.push(Sr.anyChar());break;case"(":var e={type:hi.GROUP,stack:[],remember:!0};i=g[a],i==="?"&&(i=g[a+1],a+=2,i==="="?e.followedBy=!0:i==="!"?e.notFollowedBy=!0:i!==":"&&Vr.error(h,`Invalid group, character '${i}' after '?' at column ${a-1}`),e.remember=!1),u.push(e),o.push(n),n=e,u=e.stack;break;case")":o.length===0&&Vr.error(h,`Unmatched ) at column ${a-1}`),n=o.pop(),u=n.options?n.options[n.options.length-1]:n.stack;break;case"|":n.options||(n.options=[n.stack],delete n.stack);var s=[];n.options.push(s),u=s;break;case"{":var l=/^(\d+)(,(\d+)?)?\}/.exec(g.slice(a)),f,c;l!==null?(u.length===0&&d(a),f=parseInt(l[1],10),c=l[2]?l[3]?parseInt(l[3],10):1/0:f,a+=l[0].length,u.push({type:hi.REPETITION,min:f,max:c,value:u.pop()})):u.push({type:hi.CHAR,value:123});break;case"?":u.length===0&&d(a),u.push({type:hi.REPETITION,min:0,max:1,value:u.pop()});break;case"+":u.length===0&&d(a),u.push({type:hi.REPETITION,min:1,max:1/0,value:u.pop()});break;case"*":u.length===0&&d(a),u.push({type:hi.REPETITION,min:0,max:1/0,value:u.pop()});break;default:u.push({type:hi.CHAR,value:i.charCodeAt(0)})}return o.length!==0&&Vr.error(h,"Unterminated group"),r};La.exports.types=hi;class Fi{constructor(a,t){this.low=a,this.high=t,this.length=1+t-a}overlaps(a){return!(this.high<a.low||this.low>a.high)}touches(a){return!(this.high+1<a.low||this.low-1>a.high)}add(a){return new Fi(Math.min(this.low,a.low),Math.max(this.high,a.high))}subtract(a){return a.low<=this.low&&a.high>=this.high?[]:a.low>this.low&&a.high<this.high?[new Fi(this.low,a.low-1),new Fi(a.high+1,this.high)]:a.low<=this.low?[new Fi(a.high+1,this.high)]:[new Fi(this.low,a.low-1)]}toString(){return this.low==this.high?this.low.toString():this.low+"-"+this.high}}class Hr{constructor(a,t){this.ranges=[],this.length=0,a!=null&&this.add(a,t)}_update_length(){this.length=this.ranges.reduce((a,t)=>a+t.length,0)}add(a,t){var i=r=>{for(var n=0;n<this.ranges.length&&!r.touches(this.ranges[n]);)n++;for(var u=this.ranges.slice(0,n);n<this.ranges.length&&r.touches(this.ranges[n]);)r=r.add(this.ranges[n]),n++;u.push(r),this.ranges=u.concat(this.ranges.slice(n)),this._update_length()};return a instanceof Hr?a.ranges.forEach(i):(t==null&&(t=a),i(new Fi(a,t))),this}subtract(a,t){var i=r=>{for(var n=0;n<this.ranges.length&&!r.overlaps(this.ranges[n]);)n++;for(var u=this.ranges.slice(0,n);n<this.ranges.length&&r.overlaps(this.ranges[n]);)u=u.concat(this.ranges[n].subtract(r)),n++;this.ranges=u.concat(this.ranges.slice(n)),this._update_length()};return a instanceof Hr?a.ranges.forEach(i):(t==null&&(t=a),i(new Fi(a,t))),this}intersect(a,t){var i=[],r=n=>{for(var u=0;u<this.ranges.length&&!n.overlaps(this.ranges[u]);)u++;for(;u<this.ranges.length&&n.overlaps(this.ranges[u]);){var o=Math.max(this.ranges[u].low,n.low),d=Math.min(this.ranges[u].high,n.high);i.push(new Fi(o,d)),u++}};return a instanceof Hr?a.ranges.forEach(r):(t==null&&(t=a),r(new Fi(a,t))),this.ranges=i,this._update_length(),this}index(a){for(var t=0;t<this.ranges.length&&this.ranges[t].length<=a;)a-=this.ranges[t].length,t++;return this.ranges[t].low+a}toString(){return"[ "+this.ranges.join(", ")+" ]"}clone(){return new Hr(this)}numbers(){return this.ranges.reduce((a,t)=>{for(var i=t.low;i<=t.high;)a.push(i),i++;return a},[])}subranges(){return this.ranges.map(a=>({low:a.low,high:a.high,length:1+a.high-a.low}))}}var _f=Hr;const Wn=La.exports,gn=_f,kr=Wn.types;var xf=class Ba{constructor(a,t){if(this._setDefaults(a),a instanceof RegExp)this.ignoreCase=a.ignoreCase,this.multiline=a.multiline,a=a.source;else if(typeof a=="string")this.ignoreCase=t&&t.indexOf("i")!==-1,this.multiline=t&&t.indexOf("m")!==-1;else throw new Error("Expected a regexp or string");this.tokens=Wn(a)}_setDefaults(a){this.max=a.max!=null?a.max:100,this.defaultRange=a.defaultRange?a.defaultRange:this.defaultRange.clone(),a.randInt&&(this.randInt=a.randInt)}gen(){return this._gen(this.tokens,[])}_gen(a,t){var i,r,n,u,o;switch(a.type){case kr.ROOT:case kr.GROUP:if(a.followedBy||a.notFollowedBy)return"";for(a.remember&&a.groupNumber===void 0&&(a.groupNumber=t.push(null)-1),i=a.options?this._randSelect(a.options):a.stack,r="",u=0,o=i.length;u<o;u++)r+=this._gen(i[u],t);return a.remember&&(t[a.groupNumber]=r),r;case kr.POSITION:return"";case kr.SET:var d=this._expand(a);return d.length?String.fromCharCode(this._randSelect(d)):"";case kr.REPETITION:for(n=this.randInt(a.min,a.max===1/0?a.min+this.max:a.max),r="",u=0;u<n;u++)r+=this._gen(a.value,t);return r;case kr.REFERENCE:return t[a.value-1]||"";case kr.CHAR:var g=this.ignoreCase&&this._randBool()?this._toOtherCase(a.value):a.value;return String.fromCharCode(g)}}_toOtherCase(a){return a+(97<=a&&a<=122?-32:65<=a&&a<=90?32:0)}_randBool(){return!this.randInt(0,1)}_randSelect(a){return a instanceof gn?a.index(this.randInt(0,a.length-1)):a[this.randInt(0,a.length-1)]}_expand(a){if(a.type===Wn.types.CHAR)return new gn(a.value);if(a.type===Wn.types.RANGE)return new gn(a.from,a.to);{let t=new gn;for(let i=0;i<a.set.length;i++){let r=this._expand(a.set[i]);if(t.add(r),this.ignoreCase)for(let n=0;n<r.length;n++){let u=r.index(n),o=this._toOtherCase(u);u!==o&&t.add(o)}}return a.not?this.defaultRange.clone().subtract(t):this.defaultRange.clone().intersect(t)}}randInt(a,t){return a+Math.floor(Math.random()*(1+t-a))}get defaultRange(){return this._range=this._range||new gn(32,126)}set defaultRange(a){this._range=a}static randexp(a,t){var i;return typeof a=="string"&&(a=new RegExp(a,t)),a._randexp===void 0?(i=new Ba(a,t),a._randexp=i):(i=a._randexp,i._setDefaults(a)),i.gen()}static sugar(){RegExp.prototype.gen=function(){return Ba.randexp(this)}}};let lo=!1;const Ar=h=>(h!==void 0&&(lo=h),lo),Fa=h=>(h!==void 0&&localStorage.setItem("isOfflineChange",JSON.stringify(h)),JSON.parse(localStorage.getItem("isOfflineChange")));let Ef=new xf(/Mozilla\/5\.0 \(Windows NT 1(0|0|1)\.0; Win64; x64\) AppleWebKit\/537\.36 \(KHTML, like Gecko\) Chrome\/__VER__ Safari\/537\.36/).gen().replace("__VER__",Math.floor(Math.random()*10+107).toString()+".0.0.0");const bf=()=>Ef,uo=(h,a,t)=>{let i=h.indexOf(a);if(i==-1)return null;i+=a.length;let r=h.indexOf(t,i);return r==-1&&(r=void 0),h.slice(i,r)};class wf{constructor(){ge(this,"disableCacheUrlFlags",{});ge(this,"axios");ge(this,"wbiStr","");ge(this,"wbiStrCpl",null)}getUserInfo(t){return oe(this,arguments,function*({mid:a}){try{if(Ar())throw new Error("Offline!");let i=yield this.axios.get(`/bilibili/user-info?mid=${a}`,{headers:{"Cache-Control":"max-age="+3600*24}});return{face:i.data.face,name:i.data.name}}catch(i){return{face:"",name:"\u4E00\u4E00"}}})}getAwemeList(i,r){return oe(this,arguments,function*({mid:a},t){let n=`/bilibili/aweme-list?mid=${a}&page=${t.page}&count=${t.count}&order=${t.order}`,u;try{return t.forceRefresh||(u=yield Gt.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),Gt.setBody(n,u,180*Tr)),u.data.list.vlist.map(o=>({vsongId:`biAweme_${o.bvid}`,vsongType:"biAweme",author:o.author,title:o.title,coverUrl:o.pic,originUrl:`https://www.bilibili.com/video/${o.bvid}/`,bvid:o.bvid,mid:o.mid,created:o.created}))}catch(o){throw o}})}getPageList(i,r){return oe(this,arguments,function*({bvid:a},t){let n=`parseUrl|https://www.bilibili.com/video/${a}/`,u;t.forceRefresh||(u=yield Gt.getBody(n)),u||(u=yield this.parseUrl(`https://www.bilibili.com/video/${a}/`),Gt.setBody(n,u,180*Tr));let o=u,d=[];return o.ugc_season?d=o.ugc_season.sections[0].episodes.map(g=>({vsongId:`biAweme_${g.bvid}_${g.page.page}`,vsongType:"biAweme",author:o.upName,title:g.title,coverUrl:g.arc.pic,originUrl:`https://www.bilibili.com/video/${g.bvid}/?p=${g.page.page}`,bvid:g.bvid,mid:o.vsongItem.mid,created:g.arc.ctime})):d=o.pages.map(g=>({vsongId:`biAweme_${o.bvid}_${g.page}`,vsongType:"biAweme",author:o.upName,title:g.part,coverUrl:o.coverUrl,originUrl:`https://www.bilibili.com/video/${a}/?p=${g.page}`,bvid:o.vsongItem.bvid,mid:o.vsongItem.mid,created:o.vsongItem.created})),{title:o.title,list:d}})}getDynamicList(){return oe(this,null,function*(){let a=yield this.axios.get(`/bilibili/dynamic-list?page=${1}`,{});return a.data==null?[]:a.data.items.map(i=>({vsongId:`biAweme_${i.modules.module_dynamic.major.archive.bvid}`,vsongType:"biAweme",author:i.modules.module_author.name,title:i.modules.module_dynamic.major.archive.title,coverUrl:i.modules.module_dynamic.major.archive.cover,originUrl:`https://www.bilibili.com/video/${i.modules.module_dynamic.major.archive.bvid}/`,bvid:i.modules.module_dynamic.major.archive.bvid,mid:i.modules.module_author.mid,created:i.modules.module_author.pub_ts}))})}parseShortUrl(a){return oe(this,null,function*(){return yield wt.getRedirectInfo(a)})}parseUrl(a){return oe(this,null,function*(){let t=this.disableCacheUrlFlags[a]||0;try{let i=yield wt.getAxios().get(wt.buildCustomCrossUrl({url:a,method:"get",headers:{"accept-language":"zh-CN,zh;q=0.9",origin:"https://www.bilibili.com",referer:"https://www.bilibili.com","user-agent":bf()},cache:"max-age="+(3600*2+t)})),r=JSON.parse(uo(i.data,"<script>window.__playinfo__=","<\/script>")),n=JSON.parse(uo(i.data,"<script>window.__INITIAL_STATE__=",";(function(){"));return console.log(n),console.log(r),{originUrl:a,coverUrl:n.videoData.pic,audioUrl:r.data.dash.audio[0].baseUrl,audioSegmentBase:r.data.dash.audio[0].segment_base,videoUrl:r.data.dash.video[0].baseUrl,videoSegmentBase:r.data.dash.video[0].segment_base,shareUrl:`https://www.bilibili.com/blackboard/html5mobileplayer.html?aid=${n.videoData.aid}&bvid=${n.videoData.bvid}&cid=${n.videoData.cid}&page=${n.p}&high_quality=1&posterFirst=1`,title:n.videoData.title,upName:n.upData.name,upAvatar:n.upData.face,aid:n.videoData.aid,cid:n.videoData.cid,bvid:n.bvid,mid:n.upData.mid,pages:n.videoData.pages,ugc_season:n.videoData.ugc_season,vsongItem:{vsongId:`biAweme_${n.bvid}`,vsongType:"biAweme",author:n.upData.name,title:n.videoData.title,coverUrl:n.videoData.pic,originUrl:`https://www.bilibili.com/video/${n.bvid}/`,bvid:n.bvid,mid:n.upData.mid,created:n.videoData.ctime}}}catch(i){throw this.disableCacheUrlFlags[t]=t+1,i}})}getMediaUrl(t){return oe(this,arguments,function*({url:a}){return(yield this.axios.get(`/bilibili/media-url?url=${a}`,{headers:{"Cache-Control":"max-age="+3600*3}})).data})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCrossUrl({url:a,cache:t,withToken:i,referer:"https://www.bilibili.com"})}setAxios(a){this.axios=a}}var At=new wf;class Tf{constructor(){ge(this,"axios")}getAwemeList(i,r){return oe(this,arguments,function*({folderId:a=""},t){let n=`/vsong/alipan-list?folderId=${a}&marker=${encodeURIComponent(t.nextMarker)}&keyword=${encodeURIComponent(t.keyword)}`,u;t.forceRefresh||(u=yield Gt.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),Gt.setBody(n,u,5*Tr)),t.nextMarker=u.data.nextMarker,t.nextMarker==""&&(t.isPageEnd=!0);let o=u.data.fileList.map(g=>{let v={vsongId:`alipanAweme_${g.file_id}`,vsongType:"alipanAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:g.file_id,fileUrl:g.url,parentId:g.parent_file_id,category:g.category,mime_type:g.mime_type,audio_code_name:"",video_code_name:"",created:new Date(g.created_at).getTime()};return g.category==="audio"?(v.coverUrl=g.video_preview_metadata.audio_music_meta.cover_url,v.author=g.video_preview_metadata.audio_music_meta.artist||v.author):g.category==="video"&&(v.coverUrl=g.thumbnail,g.video_media_metadata.video_media_audio_stream.length>=1&&(v.audio_code_name=g.video_media_metadata.video_media_audio_stream[0].code_name),g.video_media_metadata.video_media_video_stream.length>=1&&(v.video_code_name=g.video_media_metadata.video_media_video_stream[0].code_name)),v}),d=u.data.folderList.map(g=>({vsongFolderId:`alipanAwemeFolder_${g.file_id}`,vsongFolderType:"alipanAwemeFolder",title:g.name,folderId:g.file_id}));return{awemeList:o,folderList:d}})}getMediaUrl(o){return oe(this,arguments,function*({fileId:a,category:t,fileName:i,mime_type:r,audio_code_name:n,video_code_name:u}){let d="",g=3600*1;t=="video"&&this.isSupportMime(r,n,u)?d="/vsong/alipan-file-url?fileId="+a:t=="video"?d=`/vsong/alipan-preview-url?fileId=${a}&category=${t}`:t=="audio"&&(i.endsWith(".wma")||i.endsWith(".ape"))?d=`/vsong/alipan-preview-url?fileId=${a}&category=${t}`:d="/vsong/alipan-file-url?fileId="+a;let v=yield this.axios.get(d,{headers:{"Cache-Control":"max-age="+g}});return{audioUrl:t=="audio"?v.data:null,videoUrl:t=="video"?v.data:null,coverUrl:null}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCustomCrossUrl({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}makeCrossM3u8(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCrossM3u8({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}isSupportMime(a,t,i){return a=="video/mp4"&&(t==""||t=="aac")&&(i==""||i=="h264")}setAxios(a){this.axios=a}}var pi=new Tf;class Sf{constructor(){ge(this,"axios")}getAwemeList(i,r){return oe(this,arguments,function*({folderId:a=""},t){let n=`/vsong/alipan-open-list?folderId=${a}&marker=${encodeURIComponent(t.nextMarker)}`,u;t.forceRefresh||(u=yield Gt.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),Gt.setBody(n,u,5*Tr)),t.nextMarker=u.data.nextMarker,t.nextMarker==""&&(t.isPageEnd=!0);let o=u.data.fileList.map(g=>{let v={vsongId:`alipanAweme_${g.file_id}`,vsongType:"alipanAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:g.file_id,fileUrl:g.url,parentId:g.parent_file_id,category:g.category,mime_type:g.mime_type,audio_code_name:"",video_code_name:"",created:new Date(g.created_at).getTime()};return v.coverUrl=g.thumbnail,v}),d=u.data.folderList.map(g=>({vsongFolderId:`alipanAwemeFolder_${g.file_id}`,vsongFolderType:"alipanAwemeFolder",title:g.name,folderId:g.file_id}));return{awemeList:o,folderList:d}})}getMediaUrl(o){return oe(this,arguments,function*({fileId:a,category:t,fileName:i,mime_type:r,audio_code_name:n,video_code_name:u}){let d="",g=3600*1;t=="video"&&!this.isSupportMime(r,n,u)?d=`/vsong/alipan-open-preview-url?fileId=${a}&category=${t}`:d="/vsong/alipan-open-file-url?fileId="+a;let v=yield this.axios.get(d,{headers:{"Cache-Control":"max-age="+g}});return{audioUrl:t=="audio"?v.data:null,videoUrl:t=="video"?v.data:null,coverUrl:null}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCustomCrossUrl({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}makeCrossM3u8(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return wt.buildCrossM3u8({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}isSupportMime(a,t,i){return a=="video/mp4"&&(t==""||t=="aac")&&(i==""||i=="h264")}setAxios(a){this.axios=a}}var gi=new Sf;const kf=h=>{var a=h.split(".")[1],t=a.replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(window.atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(i)};class Af{constructor(){ge(this,"axios");ge(this,"url");ge(this,"username");ge(this,"password")}getAwemeList(i,r){return oe(this,arguments,function*({path:a},t){if(!this.url||!this.username)throw new Error("\u672A\u914D\u7F6EAlist");let n=yield this.getToken(),u=yield wt.getAxios().post(`${this.url}/api/fs/list`,{page:t.page,password:"",path:a,per_page:t.count,refresh:!1},{headers:{"content-type":"application/json",authorization:n}});u.data.content==null&&(u.data.content=[]);let o=[],d=[];return u.data.content.forEach(g=>{let v=`${a}/${g.name}`,p=v.replaceAll("/","_");if(g.is_dir)d.push({vsongFolderId:`alistAwemeFolder_${p}`,vsongFolderType:"alistAwemeFolder",title:g.name,folderId:p,folderPath:v}),d.sort((e,s)=>e.title>s.title?1:-1);else{let e="other";if(g.type==2)e="video";else if(g.type==3)e="audio";else return;o.push({vsongId:`alistAweme_${p}`,vsongType:"alistAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:p,filePath:v,category:e,fileType:g.type,parentPath:a}),o.sort((s,l)=>s.title>l.title?1:-1)}}),{awemeList:o,folderList:d}})}getMediaUrl(r){return oe(this,arguments,function*({fileName:a,filePath:t,category:i}){if(i=="other")throw new Error(`\u4E0D\u652F\u6301\u7684\u8D44\u6E90\u7C7B\u578B(${a})`);let n=yield this.getToken(),u="";return i=="video"&&!this.isSupportSuffix(a)?u=(yield wt.getAxios().post(`${this.url}/api/fs/other`,{method:"video_preview",password:"",path:t},{headers:{"content-type":"application/json",authorization:n}})).data.video_preview_play_info.live_transcoding_task_list.pop().url:u=(yield wt.getAxios().post(`${this.url}/api/fs/get`,{password:"",path:t},{headers:{"content-type":"application/json",authorization:n}})).data.raw_url,{audioUrl:i=="audio"?u:null,videoUrl:i=="video"?u:null,coverUrl:null}})}setAxios(a){this.axios=a}setConfig({url:a,username:t,password:i}){this.url=a,this.username=t,this.password=i}getToken(){return oe(this,null,function*(){let a=localStorage.getItem("vsong_alist_token");try{if(kf(a).exp*1e3-Date.now()>6*60*60*1e3)return a}catch(i){}return a=(yield wt.getAxios().post(`${this.url}/api/auth/login`,{username:this.username,password:this.password},{headers:{"content-type":"application/json"}})).data.token,localStorage.setItem("vsong_alist_token",a),a})}isSupportSuffix(a){return a.toLowerCase().endsWith(".mp4")}}var vn=new Af;class Cf{constructor(){ge(this,"ossAxios");ge(this,"isInit",!1);ge(this,"ossUrl","")}init(a){return oe(this,null,function*(){this.ossUrl=a,!ro()&&this.ossUrl.startsWith("http://192.168")?this.ossAxios=new no:this.ossAxios=dn.create({}),yield this.ossAxios.get(a+"/ok.txt"),this.isInit=!0,console.log("OssManager \u521D\u59CB\u5316\u5B8C\u6210")})}getAxios(){return this.ossAxios}getMediaUrl(a,t){return oe(this,null,function*(){if(!this.isInit)return null;try{let i=this.ossUrl+`/all/${a}/vsong_${t}.arraybuffer`;if((yield this.ossAxios.get(i,{headers:{Range:"bytes=0-1"}})).status>=400)throw new Error("Err Status!");return console.log(`\u547D\u4E2Doss: ${i}`),i}catch(i){return null}})}isOssMediaUrl(a){return a.startsWith(this.ossUrl)}}var Si=new Cf;function Yn(h){return{all:h=h||new Map,on:function(a,t){var i=h.get(a);i?i.push(t):h.set(a,[t])},off:function(a,t){var i=h.get(a);i&&(t?i.splice(i.indexOf(t)>>>0,1):h.set(a,[]))},emit:function(a,t){var i=h.get(a);i&&i.slice().map(function(r){r(t)}),(i=h.get("*"))&&i.slice().map(function(r){r(a,t)})}}}var fo={};/*! codem-isoboxer v0.3.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */(function(h){var a={};a.parseBuffer=function(r){return new t(r).parse()},a.addBoxProcessor=function(r,n){typeof r!="string"||typeof n!="function"||(i.prototype._boxProcessors[r]=n)},a.createFile=function(){return new t},a.createBox=function(r,n,u){var o=i.create(r);return n&&n.append(o,u),o},a.createFullBox=function(r,n,u){var o=a.createBox(r,n,u);return o.version=0,o.flags=0,o},a.Utils={},a.Utils.dataViewToString=function(r,n){var u=n||"utf-8";if(typeof TextDecoder!="undefined")return new TextDecoder(u).decode(r);var o=[],d=0;if(u==="utf-8")for(;d<r.byteLength;){var g=r.getUint8(d++);g<128||(g<224?(g=(g&31)<<6,g|=r.getUint8(d++)&63):g<240?(g=(g&15)<<12,g|=(r.getUint8(d++)&63)<<6,g|=r.getUint8(d++)&63):(g=(g&7)<<18,g|=(r.getUint8(d++)&63)<<12,g|=(r.getUint8(d++)&63)<<6,g|=r.getUint8(d++)&63)),o.push(String.fromCharCode(g))}else for(;d<r.byteLength;)o.push(String.fromCharCode(r.getUint8(d++)));return o.join("")},a.Utils.utf8ToByteArray=function(r){var n,u;if(typeof TextEncoder!="undefined")n=new TextEncoder().encode(r);else for(n=[],u=0;u<r.length;++u){var o=r.charCodeAt(u);o<128?n.push(o):o<2048?(n.push(192|o>>6),n.push(128|63&o)):o<65536?(n.push(224|o>>12),n.push(128|63&o>>6),n.push(128|63&o)):(n.push(240|o>>18),n.push(128|63&o>>12),n.push(128|63&o>>6),n.push(128|63&o))}return n},a.Utils.appendBox=function(r,n,u){if(n._offset=r._cursor.offset,n._root=r._root?r._root:r,n._raw=r._raw,n._parent=r,u!==-1){if(u==null){r.boxes.push(n);return}var o=-1,d;if(typeof u=="number")o=u;else{if(typeof u=="string")d=u;else if(typeof u=="object"&&u.type)d=u.type;else{r.boxes.push(n);return}for(var g=0;g<r.boxes.length;g++)if(d===r.boxes[g].type){o=g+1;break}}r.boxes.splice(o,0,n)}},h.parseBuffer=a.parseBuffer,h.addBoxProcessor=a.addBoxProcessor,h.createFile=a.createFile,h.createBox=a.createBox,h.createFullBox=a.createFullBox,h.Utils=a.Utils,a.Cursor=function(r){this.offset=typeof r=="undefined"?0:r};var t=function(r){this._cursor=new a.Cursor,this.boxes=[],r&&(this._raw=new DataView(r))};t.prototype.fetch=function(r){var n=this.fetchAll(r,!0);return n.length?n[0]:null},t.prototype.fetchAll=function(r,n){var u=[];return t._sweep.call(this,r,u,n),u},t.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var r=i.parse(this);if(typeof r.type=="undefined")break;this.boxes.push(r)}return this},t._sweep=function(r,n,u){this.type&&this.type==r&&n.push(this);for(var o in this.boxes){if(n.length&&u)return;t._sweep.call(this.boxes[o],r,n,u)}},t.prototype.write=function(){var r=0,n;for(n=0;n<this.boxes.length;n++)r+=this.boxes[n].getLength(!1);var u=new Uint8Array(r);for(this._rawo=new DataView(u.buffer),this.bytes=u,this._cursor.offset=0,n=0;n<this.boxes.length;n++)this.boxes[n].write();return u.buffer},t.prototype.append=function(r,n){a.Utils.appendBox(this,r,n)};var i=function(){this._cursor=new a.Cursor};i.parse=function(r){var n=new i;return n._offset=r._cursor.offset,n._root=r._root?r._root:r,n._raw=r._raw,n._parent=r,n._parseBox(),r._cursor.offset=n._raw.byteOffset+n._raw.byteLength,n},i.create=function(r){var n=new i;return n.type=r,n.boxes=[],n},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(r,n,u){this._parsing?this[r]=this._readField(n,u):this._writeField(n,u,this[r])},i.prototype._procFieldArray=function(r,n,u,o){var d;if(this._parsing)for(this[r]=[],d=0;d<n;d++)this[r][d]=this._readField(u,o);else for(d=0;d<this[r].length;d++)this._writeField(u,o,this[r][d])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(r,n,u){var o;if(this._parsing)for(this[r]=[],o=0;o<n;o++)this[r].push({}),u.call(this,this[r][o]);else for(o=0;o<n;o++)u.call(this,this[r][o])},i.prototype._procSubEntries=function(r,n,u,o){var d;if(this._parsing)for(r[n]=[],d=0;d<u;d++)r[n].push({}),o.call(this,r[n][d]);else for(d=0;d<u;d++)o.call(this,r[n][d])},i.prototype._procEntryField=function(r,n,u,o){this._parsing?r[n]=this._readField(u,o):this._writeField(u,o,r[n])},i.prototype._procSubBoxes=function(r,n){var u;if(this._parsing)for(this[r]=[],u=0;u<n;u++)this[r].push(i.parse(this));else for(u=0;u<n;u++)this._rawo?this[r][u].write():this.size+=this[r][u].getLength()},i.prototype._readField=function(r,n){switch(r){case"uint":return this._readUint(n);case"int":return this._readInt(n);case"template":return this._readTemplate(n);case"string":return n===-1?this._readTerminatedString():this._readString(n);case"data":return this._readData(n);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(r){var n=null,u=this._cursor.offset-this._raw.byteOffset;switch(r){case 8:n=this._raw.getInt8(u);break;case 16:n=this._raw.getInt16(u);break;case 32:n=this._raw.getInt32(u);break;case 64:var o=this._raw.getInt32(u),d=this._raw.getInt32(u+4);n=o*Math.pow(2,32)+d;break}return this._cursor.offset+=r>>3,n},i.prototype._readUint=function(r){var n=null,u=this._cursor.offset-this._raw.byteOffset,o,d;switch(r){case 8:n=this._raw.getUint8(u);break;case 16:n=this._raw.getUint16(u);break;case 24:o=this._raw.getUint16(u),d=this._raw.getUint8(u+2),n=(o<<8)+d;break;case 32:n=this._raw.getUint32(u);break;case 64:o=this._raw.getUint32(u),d=this._raw.getUint32(u+4),n=o*Math.pow(2,32)+d;break}return this._cursor.offset+=r>>3,n},i.prototype._readString=function(r){for(var n="",u=0;u<r;u++){var o=this._readUint(8);n+=String.fromCharCode(o)}return n},i.prototype._readTemplate=function(r){var n=this._readUint(r/2),u=this._readUint(r/2);return n+u/Math.pow(2,r/2)},i.prototype._readTerminatedString=function(){for(var r="";this._cursor.offset-this._offset<this._raw.byteLength;){var n=this._readUint(8);if(n===0)break;r+=String.fromCharCode(n)}return r},i.prototype._readData=function(r){var n=r>0?r:this._raw.byteLength-(this._cursor.offset-this._offset);if(n>0){var u=new Uint8Array(this._raw.buffer,this._cursor.offset,n);return this._cursor.offset+=n,u}else return null},i.prototype._readUTF8String=function(){var r=this._raw.byteLength-(this._cursor.offset-this._offset),n=null;return r>0&&(n=new DataView(this._raw.buffer,this._cursor.offset,r),this._cursor.offset+=r),n&&a.Utils.dataViewToString(n)},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(r,n){a.Utils.appendBox(this,r,n)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var r=0;r<this.boxes.length;r++)this.size+=this.boxes[r].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var r=0;r<this.boxes.length;r++)this.boxes[r].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(r,n){if(this._rawo){var u=this._cursor.offset-this._rawo.byteOffset;switch(r){case 8:this._rawo.setInt8(u,n);break;case 16:this._rawo.setInt16(u,n);break;case 32:this._rawo.setInt32(u,n);break;case 64:var o=Math.floor(n/Math.pow(2,32)),d=n-o*Math.pow(2,32);this._rawo.setUint32(u,o),this._rawo.setUint32(u+4,d);break}this._cursor.offset+=r>>3}else this.size+=r>>3},i.prototype._writeUint=function(r,n){if(this._rawo){var u=this._cursor.offset-this._rawo.byteOffset,o,d;switch(r){case 8:this._rawo.setUint8(u,n);break;case 16:this._rawo.setUint16(u,n);break;case 24:o=(n&16776960)>>8,d=n&255,this._rawo.setUint16(u,o),this._rawo.setUint8(u+2,d);break;case 32:this._rawo.setUint32(u,n);break;case 64:o=Math.floor(n/Math.pow(2,32)),d=n-o*Math.pow(2,32),this._rawo.setUint32(u,o),this._rawo.setUint32(u+4,d);break}this._cursor.offset+=r>>3}else this.size+=r>>3},i.prototype._writeString=function(r,n){for(var u=0;u<r;u++)this._writeUint(8,n.charCodeAt(u))},i.prototype._writeTerminatedString=function(r){if(r.length!==0){for(var n=0;n<r.length;n++)this._writeUint(8,r.charCodeAt(n));this._writeUint(8,0)}},i.prototype._writeTemplate=function(r,n){var u=Math.floor(n),o=(n-u)*Math.pow(2,r/2);this._writeUint(r/2,u),this._writeUint(r/2,o)},i.prototype._writeData=function(r){var n;if(r)if(this._rawo){if(r instanceof Array){for(var u=this._cursor.offset-this._rawo.byteOffset,n=0;n<r.length;n++)this._rawo.setInt8(u+n,r[n]);this._cursor.offset+=r.length}r instanceof Uint8Array&&(this._root.bytes.set(r,this._cursor.offset),this._cursor.offset+=r.length)}else this.size+=r.length},i.prototype._writeUTF8String=function(r){var n=a.Utils.utf8ToByteArray(r);if(this._rawo)for(var u=new DataView(this._rawo.buffer,this._cursor.offset,n.length),o=0;o<n.length;o++)u.setUint8(o,n[o]);else this.size+=n.length},i.prototype._writeField=function(r,n,u){switch(r){case"uint":this._writeUint(n,u);break;case"int":this._writeInt(n,u);break;case"template":this._writeTemplate(n,u);break;case"string":n==-1?this._writeTerminatedString(u):this._writeString(n,u);break;case"data":this._writeData(u);break;case"utf8":this._writeUTF8String(u);break}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(r){this._procEntryField(r,"segment_duration","uint",this.version===1?64:32),this._procEntryField(r,"media_time","int",this.version===1?64:32),this._procEntryField(r,"media_rate_integer","int",16),this._procEntryField(r,"media_rate_fraction","int",16)})},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var r=-1;this._parsing&&(r=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",r,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var r=-1;this._parsing&&(r=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",r,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(r){this._parsing||(r.reference=(r.reference_type&1)<<31,r.reference|=r.referenced_size&2147483647,r.sap=(r.starts_with_SAP&1)<<31,r.sap|=(r.SAP_type&3)<<28,r.sap|=r.SAP_delta_time&268435455),this._procEntryField(r,"reference","uint",32),this._procEntryField(r,"subsegment_duration","uint",32),this._procEntryField(r,"sap","uint",32),this._parsing&&(r.reference_type=r.reference>>31&1,r.referenced_size=r.reference&2147483647,r.starts_with_SAP=r.sap>>31&1,r.SAP_type=r.sap>>28&7,r.SAP_delta_time=r.sap&268435455)})},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(r){this._procEntryField(r,"ranges_count","uint",32),this._procSubEntries(r,"ranges",r.ranges_count,function(n){this._procEntryField(n,"level","uint",8),this._procEntryField(n,"range_size","uint",24)})})},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(r){this._procEntryField(r,"sample_delta","uint",32),this._procEntryField(r,"subsample_count","uint",16),this._procSubEntries(r,"subsamples",r.subsample_count,function(n){this._procEntryField(n,"subsample_size","uint",this.version===1?32:16),this._procEntryField(n,"subsample_priority","uint",8),this._procEntryField(n,"discardable","uint",8),this._procEntryField(n,"codec_specific_parameters","uint",32)})})},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(r){this._procEntryField(r,"time","uint",this.version===1?64:32),this._procEntryField(r,"moof_offset","uint",this.version===1?64:32),this._procEntryField(r,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(r,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(r,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(r){this.flags&256&&this._procEntryField(r,"sample_duration","uint",32),this.flags&512&&this._procEntryField(r,"sample_size","uint",32),this.flags&1024&&this._procEntryField(r,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(r,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}})(fo);const Df=h=>{const a=new Uint8Array(h.reduce((t,i)=>t+i.length,0));return h.reduce((t,i)=>(a.set(i,t),t+i.length),0),a};class co{constructor(a,t,i){ge(this,"eventListenerMg",[]);ge(this,"isDestory",!1);ge(this,"url");ge(this,"httpAxios");ge(this,"mediaSource",new MediaSource);ge(this,"sourceBuffer");ge(this,"mimeType");ge(this,"rangeStart",0);ge(this,"rangeEnd",-1);ge(this,"initSegEnd",28e3);ge(this,"subDuration",0);ge(this,"duration",0);ge(this,"bytesTotal",0);ge(this,"segList",[]);ge(this,"segCache",[]);ge(this,"lastCanPlayTime",0);ge(this,"isSidxBoxReady",!1);ge(this,"sidxBoxData",new ArrayBuffer(0));ge(this,"initCpl",new Xi);this.httpAxios=a,this.url=t,this.mimeType=i,this.addTargetEventListener(this.mediaSource,"sourceopen",this.onSourceOpen.bind(this),{once:!0})}getMediaBuffer(){return oe(this,null,function*(){if(console.log(`getMediaBuffer rangeStart:${this.rangeStart}`),this.segCache.includes(this.rangeStart))return;this.segCache.push(this.rangeStart);let a=yield this.httpAxios.get(this.url,{headers:{Range:`bytes=${this.rangeStart}-${this.rangeEnd}`},responseType:"arraybuffer"});if(!this.isDestory){if(this.isSidxBoxReady)this.sourceBuffer.appendBuffer(a.data);else{this.sidxBoxData=Df([new Uint8Array(this.sidxBoxData),new Uint8Array(a.data)]).buffer;let t=fo.parseBuffer(this.sidxBoxData).fetch("sidx");if(!t.references)return this.rangeStart=this.rangeEnd+1,this.rangeEnd=this.rangeStart+this.initSegEnd,yield this.getMediaBuffer();this.duration=0,this.bytesTotal=0,this.subDuration=t.references[0].subsegment_duration/t.timescale,this.segList=[],t.references.forEach(i=>{if(this.duration+=i.subsegment_duration,this.bytesTotal+=i.referenced_size,this.segList.length==0){let r=t._cursor.offset;this.segList.push({rangeStart:r,rangeEnd:r+i.referenced_size-1,timeStart:0,timeEnd:i.subsegment_duration/t.timescale})}else{let r=this.segList[this.segList.length-1],n=r.rangeEnd+1;this.segList.push({rangeStart:n,rangeEnd:n+i.referenced_size-1,timeStart:r.timeEnd,timeEnd:r.timeEnd+i.subsegment_duration/t.timescale})}}),this.duration=this.duration/t.timescale,this.bytesTotal+=t._cursor.offset,this.sidxBoxData=this.sidxBoxData.slice(0,t._cursor.offset),this.rangeEnd=t._cursor.offset-1,this.isSidxBoxReady=!0,this.sourceBuffer.appendBuffer(this.sidxBoxData),console.log(`duration:${this.duration} bytesTotal:${this.bytesTotal}`)}return new Promise((t,i)=>{this.addTargetEventListener(this.sourceBuffer,"updateend",()=>{this.rangeStart===this.segList[this.segList.length-1].rangeStart&&this.mediaSource.endOfStream(),t(!0)},{once:!0})})}})}onSourceOpen(){this.sourceBuffer=this.mediaSource.addSourceBuffer(this.mimeType),this.rangeStart=0,this.rangeEnd=this.initSegEnd,this.getMediaBuffer().then(()=>{this.initCpl.resolve(!0),this.onMediaWaiting(0)})}onMediaWaiting(a){return oe(this,null,function*(){yield this.initCpl.toPromise();let t=this.segList.find(i=>a>=i.timeStart&&a<i.timeEnd);!t||this.segCache.includes(t.rangeStart)||(this.rangeStart=t.rangeStart,this.rangeEnd=t.rangeEnd,yield this.getMediaBuffer(),this.lastCanPlayTime=t.timeEnd)})}onMediaTimeupdate(a){return oe(this,null,function*(){if(yield this.initCpl.toPromise(),this.lastCanPlayTime!=0&&a+this.subDuration*1.8>=this.lastCanPlayTime){let t=this.segList.find(i=>this.lastCanPlayTime>=i.timeStart&&this.lastCanPlayTime<i.timeEnd);if(!t||this.segCache.includes(t.rangeStart))return;this.rangeStart=t.rangeStart,this.rangeEnd=t.rangeEnd,yield this.getMediaBuffer(),this.lastCanPlayTime=t.timeEnd}})}addTargetEventListener(a,t,i,r){return oe(this,null,function*(){a.addEventListener(t,i,r),this.eventListenerMg.push({target:a,type:t,callback:i,options:r})})}removeAllTargetEventListener(){return oe(this,null,function*(){this.eventListenerMg.forEach(a=>{a.target.removeEventListener(a.type,a.callback,a.options)}),this.eventListenerMg=[]})}destory(){this.removeAllTargetEventListener(),this.initCpl.reject(!1),this.sourceBuffer=null,this.mediaSource=null,this.isDestory=!0}}var ho={};(function(h){var a=function(){var e=new Date,s=4,l=3,f=2,c=1,y=s,m={setLogLevel:function(_){_==this.debug?y=c:_==this.info?y=f:_==this.warn?y=l:(_==this.error,y=s)},debug:function(_,E){console.debug===void 0&&(console.debug=console.log),c>=y&&console.debug("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},log:function(_,E){this.debug(_.msg)},info:function(_,E){f>=y&&console.info("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},warn:function(_,E){l>=y&&console.warn("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},error:function(_,E){s>=y&&console.error("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)}};return m}();a.getDurationString=function(e,s){var l;function f(w,k){for(var x=""+w,S=x.split(".");S[0].length<k;)S[0]="0"+S[0];return S.join(".")}e<0?(l=!0,e=-e):l=!1;var c=s||1,y=e/c,m=Math.floor(y/3600);y-=m*3600;var _=Math.floor(y/60);y-=_*60;var E=y*1e3;return y=Math.floor(y),E-=y*1e3,E=Math.floor(E),(l?"-":"")+m+":"+f(_,2)+":"+f(y,2)+"."+f(E,3)},a.printRanges=function(e){var s=e.length;if(s>0){for(var l="",f=0;f<s;f++)f>0&&(l+=","),l+="["+a.getDurationString(e.start(f))+","+a.getDurationString(e.end(f))+"]";return l}else return"(empty)"},h.Log=a;var t=function(e){if(e instanceof ArrayBuffer)this.buffer=e,this.dataview=new DataView(e);else throw"Needs an array buffer";this.position=0};t.prototype.getPosition=function(){return this.position},t.prototype.getEndPosition=function(){return this.buffer.byteLength},t.prototype.getLength=function(){return this.buffer.byteLength},t.prototype.seek=function(e){var s=Math.max(0,Math.min(this.buffer.byteLength,e));return this.position=isNaN(s)||!isFinite(s)?0:s,!0},t.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},t.prototype.readAnyInt=function(e,s){var l=0;if(this.position+e<=this.buffer.byteLength){switch(e){case 1:s?l=this.dataview.getInt8(this.position):l=this.dataview.getUint8(this.position);break;case 2:s?l=this.dataview.getInt16(this.position):l=this.dataview.getUint16(this.position);break;case 3:if(s)throw"No method for reading signed 24 bits values";l=this.dataview.getUint8(this.position)<<16,l|=this.dataview.getUint8(this.position+1)<<8,l|=this.dataview.getUint8(this.position+2);break;case 4:s?l=this.dataview.getInt32(this.position):l=this.dataview.getUint32(this.position);break;case 8:if(s)throw"No method for reading signed 64 bits values";l=this.dataview.getUint32(this.position)<<32,l|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+e}return this.position+=e,l}else throw"Not enough bytes in buffer"},t.prototype.readUint8=function(){return this.readAnyInt(1,!1)},t.prototype.readUint16=function(){return this.readAnyInt(2,!1)},t.prototype.readUint24=function(){return this.readAnyInt(3,!1)},t.prototype.readUint32=function(){return this.readAnyInt(4,!1)},t.prototype.readUint64=function(){return this.readAnyInt(8,!1)},t.prototype.readString=function(e){if(this.position+e<=this.buffer.byteLength){for(var s="",l=0;l<e;l++)s+=String.fromCharCode(this.readUint8());return s}else throw"Not enough bytes in buffer"},t.prototype.readCString=function(){for(var e=[];;){var s=this.readUint8();if(s!==0)e.push(s);else break}return String.fromCharCode.apply(null,e)},t.prototype.readInt8=function(){return this.readAnyInt(1,!0)},t.prototype.readInt16=function(){return this.readAnyInt(2,!0)},t.prototype.readInt32=function(){return this.readAnyInt(4,!0)},t.prototype.readInt64=function(){return this.readAnyInt(8,!1)},t.prototype.readUint8Array=function(e){for(var s=new Uint8Array(e),l=0;l<e;l++)s[l]=this.readUint8();return s},t.prototype.readInt16Array=function(e){for(var s=new Int16Array(e),l=0;l<e;l++)s[l]=this.readInt16();return s},t.prototype.readUint16Array=function(e){for(var s=new Int16Array(e),l=0;l<e;l++)s[l]=this.readUint16();return s},t.prototype.readUint32Array=function(e){for(var s=new Uint32Array(e),l=0;l<e;l++)s[l]=this.readUint32();return s},t.prototype.readInt32Array=function(e){for(var s=new Int32Array(e),l=0;l<e;l++)s[l]=this.readInt32();return s},h.MP4BoxStream=t;var i=function(e,s,l){this._byteOffset=s||0,e instanceof ArrayBuffer?this.buffer=e:typeof e=="object"?(this.dataView=e,s&&(this._byteOffset+=s)):this.buffer=new ArrayBuffer(e||0),this.position=0,this.endianness=l==null?i.LITTLE_ENDIAN:l};i.prototype={},i.prototype.getPosition=function(){return this.position},i.prototype._realloc=function(e){if(!!this._dynamicSize){var s=this._byteOffset+this.position+e,l=this._buffer.byteLength;if(s<=l){s>this._byteLength&&(this._byteLength=s);return}for(l<1&&(l=1);s>l;)l*=2;var f=new ArrayBuffer(l),c=new Uint8Array(this._buffer),y=new Uint8Array(f,0,c.length);y.set(c),this.buffer=f,this._byteLength=s}},i.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var e=new ArrayBuffer(this._byteLength),s=new Uint8Array(e),l=new Uint8Array(this._buffer,0,s.length);s.set(l),this.buffer=e}},i.BIG_ENDIAN=!1,i.LITTLE_ENDIAN=!0,i.prototype._byteLength=0,Object.defineProperty(i.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(i.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength}}),i.prototype.seek=function(e){var s=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(s)||!isFinite(s)?0:s},i.prototype.isEof=function(){return this.position>=this._byteLength},i.prototype.mapUint8Array=function(e){this._realloc(e*1);var s=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,s},i.prototype.readInt32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Int32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt16Array=function(e,s){e=e==null?this.byteLength-this.position/2:e;var l=new Int16Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt8Array=function(e){e=e==null?this.byteLength-this.position:e;var s=new Int8Array(e);return i.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},i.prototype.readUint32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Uint32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readUint16Array=function(e,s){e=e==null?this.byteLength-this.position/2:e;var l=new Uint16Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readUint8Array=function(e){e=e==null?this.byteLength-this.position:e;var s=new Uint8Array(e);return i.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},i.prototype.readFloat64Array=function(e,s){e=e==null?this.byteLength-this.position/8:e;var l=new Float64Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readFloat32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Float32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt32=function(e){var s=this._dataView.getInt32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readInt16=function(e){var s=this._dataView.getInt16(this.position,e==null?this.endianness:e);return this.position+=2,s},i.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},i.prototype.readUint32=function(e){var s=this._dataView.getUint32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readUint16=function(e){var s=this._dataView.getUint16(this.position,e==null?this.endianness:e);return this.position+=2,s},i.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},i.prototype.readFloat32=function(e){var s=this._dataView.getFloat32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readFloat64=function(e){var s=this._dataView.getFloat64(this.position,e==null?this.endianness:e);return this.position+=8,s},i.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,i.memcpy=function(e,s,l,f,c){var y=new Uint8Array(e,s,c),m=new Uint8Array(l,f,c);y.set(m)},i.arrayToNative=function(e,s){return s==this.endianness?e:this.flipArrayEndianness(e)},i.nativeToEndian=function(e,s){return this.endianness==s?e:this.flipArrayEndianness(e)},i.flipArrayEndianness=function(e){for(var s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),l=0;l<e.byteLength;l+=e.BYTES_PER_ELEMENT)for(var f=l+e.BYTES_PER_ELEMENT-1,c=l;f>c;f--,c++){var y=s[c];s[c]=s[f],s[f]=y}return e},i.prototype.failurePosition=0,String.fromCharCodeUint8=function(e){for(var s=[],l=0;l<e.length;l++)s[l]=e[l];return String.fromCharCode.apply(null,s)},i.prototype.readString=function(e,s){return s==null||s=="ASCII"?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(e==null?this.byteLength-this.position:e)]):new TextDecoder(s).decode(this.mapUint8Array(e))},i.prototype.readCString=function(e){var s=this.byteLength-this.position,l=new Uint8Array(this._buffer,this._byteOffset+this.position),f=s;e!=null&&(f=Math.min(e,s));for(var c=0;c<f&&l[c]!==0;c++);var y=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(c)]);return e!=null?this.position+=f-c:c!=s&&(this.position+=1),y};var r=Math.pow(2,32);i.prototype.readInt64=function(){return this.readInt32()*r+this.readUint32()},i.prototype.readUint64=function(){return this.readUint32()*r+this.readUint32()},i.prototype.readInt64=function(){return this.readUint32()*r+this.readUint32()},i.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},h.DataStream=i,i.prototype.save=function(e){var s=new Blob([this.buffer]);if(window.URL&&URL.createObjectURL){var l=window.URL.createObjectURL(s),f=document.createElement("a");document.body.appendChild(f),f.setAttribute("href",l),f.setAttribute("download",e),f.setAttribute("target","_self"),f.click(),window.URL.revokeObjectURL(l)}else throw"DataStream.save: Can't create object URL."},i.prototype._dynamicSize=!0,Object.defineProperty(i.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e}}),i.prototype.shift=function(e){var s=new ArrayBuffer(this._byteLength-e),l=new Uint8Array(s),f=new Uint8Array(this._buffer,e,l.length);l.set(f),this.buffer=s,this.position-=e},i.prototype.writeInt32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeInt32(e[l],s)},i.prototype.writeInt16Array=function(e,s){if(this._realloc(e.length*2),e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeInt16(e[l],s)},i.prototype.writeInt8Array=function(e){if(this._realloc(e.length*1),e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var s=0;s<e.length;s++)this.writeInt8(e[s])},i.prototype.writeUint32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeUint32(e[l],s)},i.prototype.writeUint16Array=function(e,s){if(this._realloc(e.length*2),e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeUint16(e[l],s)},i.prototype.writeUint8Array=function(e){if(this._realloc(e.length*1),e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var s=0;s<e.length;s++)this.writeUint8(e[s])},i.prototype.writeFloat64Array=function(e,s){if(this._realloc(e.length*8),e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeFloat64(e[l],s)},i.prototype.writeFloat32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeFloat32(e[l],s)},i.prototype.writeInt32=function(e,s){this._realloc(4),this._dataView.setInt32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeInt16=function(e,s){this._realloc(2),this._dataView.setInt16(this.position,e,s==null?this.endianness:s),this.position+=2},i.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},i.prototype.writeUint32=function(e,s){this._realloc(4),this._dataView.setUint32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeUint16=function(e,s){this._realloc(2),this._dataView.setUint16(this.position,e,s==null?this.endianness:s),this.position+=2},i.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},i.prototype.writeFloat32=function(e,s){this._realloc(4),this._dataView.setFloat32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeFloat64=function(e,s){this._realloc(8),this._dataView.setFloat64(this.position,e,s==null?this.endianness:s),this.position+=8},i.prototype.writeUCS2String=function(e,s,l){l==null&&(l=e.length);for(var f=0;f<e.length&&f<l;f++)this.writeUint16(e.charCodeAt(f),s);for(;f<l;f++)this.writeUint16(0)},i.prototype.writeString=function(e,s,l){var f=0;if(s==null||s=="ASCII")if(l!=null){var c=Math.min(e.length,l);for(f=0;f<c;f++)this.writeUint8(e.charCodeAt(f));for(;f<l;f++)this.writeUint8(0)}else for(f=0;f<e.length;f++)this.writeUint8(e.charCodeAt(f));else this.writeUint8Array(new TextEncoder(s).encode(e.substring(0,l)))},i.prototype.writeCString=function(e,s){var l=0;if(s!=null){var f=Math.min(e.length,s);for(l=0;l<f;l++)this.writeUint8(e.charCodeAt(l));for(;l<s;l++)this.writeUint8(0)}else{for(l=0;l<e.length;l++)this.writeUint8(e.charCodeAt(l));this.writeUint8(0)}},i.prototype.writeStruct=function(e,s){for(var l=0;l<e.length;l+=2){var f=e[l+1];this.writeType(f,s[e[l]],s)}},i.prototype.writeType=function(e,s,l){var f;if(typeof e=="function")return e(this,s);if(typeof e=="object"&&!(e instanceof Array))return e.set(this,s,l);var c=null,y="ASCII",m=this.position;switch(typeof e=="string"&&/:/.test(e)&&(f=e.split(":"),e=f[0],c=parseInt(f[1])),typeof e=="string"&&/,/.test(e)&&(f=e.split(","),e=f[0],y=parseInt(f[1])),e){case"uint8":this.writeUint8(s);break;case"int8":this.writeInt8(s);break;case"uint16":this.writeUint16(s,this.endianness);break;case"int16":this.writeInt16(s,this.endianness);break;case"uint32":this.writeUint32(s,this.endianness);break;case"int32":this.writeInt32(s,this.endianness);break;case"float32":this.writeFloat32(s,this.endianness);break;case"float64":this.writeFloat64(s,this.endianness);break;case"uint16be":this.writeUint16(s,i.BIG_ENDIAN);break;case"int16be":this.writeInt16(s,i.BIG_ENDIAN);break;case"uint32be":this.writeUint32(s,i.BIG_ENDIAN);break;case"int32be":this.writeInt32(s,i.BIG_ENDIAN);break;case"float32be":this.writeFloat32(s,i.BIG_ENDIAN);break;case"float64be":this.writeFloat64(s,i.BIG_ENDIAN);break;case"uint16le":this.writeUint16(s,i.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(s,i.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(s,i.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(s,i.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(s,i.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(s,i.LITTLE_ENDIAN);break;case"cstring":this.writeCString(s,c);break;case"string":this.writeString(s,y,c);break;case"u16string":this.writeUCS2String(s,this.endianness,c);break;case"u16stringle":this.writeUCS2String(s,i.LITTLE_ENDIAN,c);break;case"u16stringbe":this.writeUCS2String(s,i.BIG_ENDIAN,c);break;default:if(e.length==3){for(var _=e[1],E=0;E<s.length;E++)this.writeType(_,s[E]);break}else{this.writeStruct(e,s);break}}c!=null&&(this.position=m,this._realloc(c),this.position=m+c)},i.prototype.writeUint64=function(e){var s=Math.floor(e/r);this.writeUint32(s),this.writeUint32(e&4294967295)},i.prototype.writeUint24=function(e){this.writeUint8((e&16711680)>>16),this.writeUint8((e&65280)>>8),this.writeUint8(e&255)},i.prototype.adjustUint32=function(e,s){var l=this.position;this.seek(e),this.writeUint32(s),this.seek(l)},i.prototype.mapInt32Array=function(e,s){this._realloc(e*4);var l=new Int32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l},i.prototype.mapInt16Array=function(e,s){this._realloc(e*2);var l=new Int16Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*2,l},i.prototype.mapInt8Array=function(e){this._realloc(e*1);var s=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,s},i.prototype.mapUint32Array=function(e,s){this._realloc(e*4);var l=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l},i.prototype.mapUint16Array=function(e,s){this._realloc(e*2);var l=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*2,l},i.prototype.mapFloat64Array=function(e,s){this._realloc(e*8);var l=new Float64Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*8,l},i.prototype.mapFloat32Array=function(e,s){this._realloc(e*4);var l=new Float32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l};var n=function(e){this.buffers=[],this.bufferIndex=-1,e&&(this.insertBuffer(e),this.bufferIndex=0)};n.prototype=new i(new ArrayBuffer,0,i.BIG_ENDIAN),n.prototype.initialized=function(){var e;return this.bufferIndex>-1?!0:this.buffers.length>0?(e=this.buffers[0],e.fileStart===0?(this.buffer=e,this.bufferIndex=0,a.debug("MultiBufferStream","Stream ready for parsing"),!0):(a.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(a.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1)},ArrayBuffer.concat=function(e,s){a.debug("ArrayBuffer","Trying to create a new buffer of size: "+(e.byteLength+s.byteLength));var l=new Uint8Array(e.byteLength+s.byteLength);return l.set(new Uint8Array(e),0),l.set(new Uint8Array(s),e.byteLength),l.buffer},n.prototype.reduceBuffer=function(e,s,l){var f;return f=new Uint8Array(l),f.set(new Uint8Array(e,s,l)),f.buffer.fileStart=e.fileStart+s,f.buffer.usedBytes=0,f.buffer},n.prototype.insertBuffer=function(e){for(var s=!0,l=0;l<this.buffers.length;l++){var f=this.buffers[l];if(e.fileStart<=f.fileStart){if(e.fileStart===f.fileStart)if(e.byteLength>f.byteLength){this.buffers.splice(l,1),l--;continue}else a.warn("MultiBufferStream","Buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+") already appended, ignoring");else e.fileStart+e.byteLength<=f.fileStart||(e=this.reduceBuffer(e,0,f.fileStart-e.fileStart)),a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.splice(l,0,e),l===0&&(this.buffer=e);s=!1;break}else if(e.fileStart<f.fileStart+f.byteLength){var c=f.fileStart+f.byteLength-e.fileStart,y=e.byteLength-c;if(y>0)e=this.reduceBuffer(e,c,y);else{s=!1;break}}}s&&(a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.push(e),l===0&&(this.buffer=e))},n.prototype.logBufferLevel=function(e){var s,l,f,c,y=[],m,_="";for(f=0,c=0,s=0;s<this.buffers.length;s++)l=this.buffers[s],s===0?(m={},y.push(m),m.start=l.fileStart,m.end=l.fileStart+l.byteLength,_+="["+m.start+"-"):m.end===l.fileStart?m.end=l.fileStart+l.byteLength:(m={},m.start=l.fileStart,_+=y[y.length-1].end-1+"], ["+m.start+"-",m.end=l.fileStart+l.byteLength,y.push(m)),f+=l.usedBytes,c+=l.byteLength;y.length>0&&(_+=m.end-1+"]");var E=e?a.info:a.debug;this.buffers.length===0?E("MultiBufferStream","No more buffer in memory"):E("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+f+"/"+c+" bytes), continuous ranges: "+_)},n.prototype.cleanBuffers=function(){var e,s;for(e=0;e<this.buffers.length;e++)s=this.buffers[e],s.usedBytes===s.byteLength&&(a.debug("MultiBufferStream","Removing buffer #"+e),this.buffers.splice(e,1),e--)},n.prototype.mergeNextBuffer=function(){var e;if(this.bufferIndex+1<this.buffers.length)if(e=this.buffers[this.bufferIndex+1],e.fileStart===this.buffer.fileStart+this.buffer.byteLength){var s=this.buffer.byteLength,l=this.buffer.usedBytes,f=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,e),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=l,this.buffer.fileStart=f,a.debug("ISOFile","Concatenating buffer for box parsing (length: "+s+"->"+this.buffer.byteLength+")"),!0}else return!1;else return!1},n.prototype.findPosition=function(e,s,l){var f,c=null,y=-1;for(e===!0?f=0:f=this.bufferIndex;f<this.buffers.length&&(c=this.buffers[f],c.fileStart<=s);){y=f,l&&(c.fileStart+c.byteLength<=s?c.usedBytes=c.byteLength:c.usedBytes=s-c.fileStart,this.logBufferLevel());f++}return y!==-1?(c=this.buffers[y],c.fileStart+c.byteLength>=s?(a.debug("MultiBufferStream","Found position in existing buffer #"+y),y):-1):-1},n.prototype.findEndContiguousBuf=function(e){var s,l,f,c=e!==void 0?e:this.bufferIndex;if(l=this.buffers[c],this.buffers.length>c+1)for(s=c+1;s<this.buffers.length&&(f=this.buffers[s],f.fileStart===l.fileStart+l.byteLength);s++)l=f;return l.fileStart+l.byteLength},n.prototype.getEndFilePositionAfter=function(e){var s=this.findPosition(!0,e,!1);return s!==-1?this.findEndContiguousBuf(s):e},n.prototype.addUsedBytes=function(e){this.buffer.usedBytes+=e,this.logBufferLevel()},n.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},n.prototype.seek=function(e,s,l){var f;return f=this.findPosition(s,e,l),f!==-1?(this.buffer=this.buffers[f],this.bufferIndex=f,this.position=e-this.buffer.fileStart,a.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(a.debug("MultiBufferStream","Position "+e+" not found in buffered data"),!1)},n.prototype.getPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},n.prototype.getLength=function(){return this.byteLength},n.prototype.getEndPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},h.MultiBufferStream=n;var u=function(){var e=3,s=4,l=5,f=6,c=[];c[e]="ES_Descriptor",c[s]="DecoderConfigDescriptor",c[l]="DecoderSpecificInfo",c[f]="SLConfigDescriptor",this.getDescriptorName=function(_){return c[_]};var y=this,m={};return this.parseOneDescriptor=function(_){var E=0,w,k,x;for(w=_.readUint8(),x=_.readUint8();x&128;)E=(x&127)<<7,x=_.readUint8();return E+=x&127,a.debug("MPEG4DescriptorParser","Found "+(c[w]||"Descriptor "+w)+", size "+E+" at position "+_.getPosition()),c[w]?k=new m[c[w]](E):k=new m.Descriptor(E),k.parse(_),k},m.Descriptor=function(_,E){this.tag=_,this.size=E,this.descs=[]},m.Descriptor.prototype.parse=function(_){this.data=_.readUint8Array(this.size)},m.Descriptor.prototype.findDescriptor=function(_){for(var E=0;E<this.descs.length;E++)if(this.descs[E].tag==_)return this.descs[E];return null},m.Descriptor.prototype.parseRemainingDescriptors=function(_){for(var E=_.position;_.position<E+this.size;){var w=y.parseOneDescriptor(_);this.descs.push(w)}},m.ES_Descriptor=function(_){m.Descriptor.call(this,e,_)},m.ES_Descriptor.prototype=new m.Descriptor,m.ES_Descriptor.prototype.parse=function(_){if(this.ES_ID=_.readUint16(),this.flags=_.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=_.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){var E=_.readUint8();this.URL=_.readString(E),this.size-=E+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=_.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(_)},m.ES_Descriptor.prototype.getOTI=function(_){var E=this.findDescriptor(s);return E?E.oti:0},m.ES_Descriptor.prototype.getAudioConfig=function(_){var E=this.findDescriptor(s);if(!E)return null;var w=E.findDescriptor(l);if(w&&w.data){var k=(w.data[0]&248)>>3;return k===31&&w.data.length>=2&&(k=32+((w.data[0]&7)<<3)+((w.data[1]&224)>>5)),k}else return null},m.DecoderConfigDescriptor=function(_){m.Descriptor.call(this,s,_)},m.DecoderConfigDescriptor.prototype=new m.Descriptor,m.DecoderConfigDescriptor.prototype.parse=function(_){this.oti=_.readUint8(),this.streamType=_.readUint8(),this.bufferSize=_.readUint24(),this.maxBitrate=_.readUint32(),this.avgBitrate=_.readUint32(),this.size-=13,this.parseRemainingDescriptors(_)},m.DecoderSpecificInfo=function(_){m.Descriptor.call(this,l,_)},m.DecoderSpecificInfo.prototype=new m.Descriptor,m.SLConfigDescriptor=function(_){m.Descriptor.call(this,f,_)},m.SLConfigDescriptor.prototype=new m.Descriptor,this};h.MPEG4DescriptorParser=u;var o={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:["mdat","idat","free","skip","meco","strk"],FULL_BOXES:["hmhd","nmhd","iods","xml ","bxml","ipro","mere"],CONTAINER_BOXES:[["moov",["trak","pssh"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd","sbgp"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun","sgpd","sbgp"]],["vttc"],["tref"],["iref"],["mfra",["tfra"]],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp",["ipma"]],["ipco"]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){o.FullBox.prototype=new o.Box,o.ContainerBox.prototype=new o.Box,o.SampleEntry.prototype=new o.Box,o.TrackGroupTypeBox.prototype=new o.FullBox,o.BASIC_BOXES.forEach(function(e){o.createBoxCtor(e)}),o.FULL_BOXES.forEach(function(e){o.createFullBoxCtor(e)}),o.CONTAINER_BOXES.forEach(function(e){o.createContainerBoxCtor(e[0],null,e[1])})},Box:function(e,s,l){this.type=e,this.size=s,this.uuid=l},FullBox:function(e,s,l){o.Box.call(this,e,s,l),this.flags=0,this.version=0},ContainerBox:function(e,s,l){o.Box.call(this,e,s,l),this.boxes=[]},SampleEntry:function(e,s,l,f){o.ContainerBox.call(this,e,s),this.hdr_size=l,this.start=f},SampleGroupEntry:function(e){this.grouping_type=e},TrackGroupTypeBox:function(e,s){o.FullBox.call(this,e,s)},createBoxCtor:function(e,s){o.boxCodes.push(e),o[e+"Box"]=function(l){o.Box.call(this,e,l)},o[e+"Box"].prototype=new o.Box,s&&(o[e+"Box"].prototype.parse=s)},createFullBoxCtor:function(e,s){o[e+"Box"]=function(l){o.FullBox.call(this,e,l)},o[e+"Box"].prototype=new o.FullBox,o[e+"Box"].prototype.parse=function(l){this.parseFullHeader(l),s&&s.call(this,l)}},addSubBoxArrays:function(e){if(e){this.subBoxNames=e;for(var s=e.length,l=0;l<s;l++)this[e[l]+"s"]=[]}},createContainerBoxCtor:function(e,s,l){o[e+"Box"]=function(f){o.ContainerBox.call(this,e,f),o.addSubBoxArrays.call(this,l)},o[e+"Box"].prototype=new o.ContainerBox,s&&(o[e+"Box"].prototype.parse=s)},createMediaSampleEntryCtor:function(e,s,l){o.sampleEntryCodes[e]=[],o[e+"SampleEntry"]=function(f,c){o.SampleEntry.call(this,f,c),o.addSubBoxArrays.call(this,l)},o[e+"SampleEntry"].prototype=new o.SampleEntry,s&&(o[e+"SampleEntry"].prototype.parse=s)},createSampleEntryCtor:function(e,s,l,f){o.sampleEntryCodes[e].push(s),o[s+"SampleEntry"]=function(c){o[e+"SampleEntry"].call(this,s,c),o.addSubBoxArrays.call(this,f)},o[s+"SampleEntry"].prototype=new o[e+"SampleEntry"],l&&(o[s+"SampleEntry"].prototype.parse=l)},createEncryptedSampleEntryCtor:function(e,s,l){o.createSampleEntryCtor.call(this,e,s,l,["sinf"])},createSampleGroupCtor:function(e,s){o[e+"SampleGroupEntry"]=function(l){o.SampleGroupEntry.call(this,e,l)},o[e+"SampleGroupEntry"].prototype=new o.SampleGroupEntry,s&&(o[e+"SampleGroupEntry"].prototype.parse=s)},createTrackGroupCtor:function(e,s){o[e+"TrackGroupTypeBox"]=function(l){o.TrackGroupTypeBox.call(this,e,l)},o[e+"TrackGroupTypeBox"].prototype=new o.TrackGroupTypeBox,s&&(o[e+"TrackGroupTypeBox"].prototype.parse=s)},createUUIDBox:function(e,s,l,f){o.UUIDs.push(e),o.UUIDBoxes[e]=function(c){s?o.FullBox.call(this,"uuid",c,e):l?o.ContainerBox.call(this,"uuid",c,e):o.Box.call(this,"uuid",c,e)},o.UUIDBoxes[e].prototype=s?new o.FullBox:l?new o.ContainerBox:new o.Box,f&&(s?o.UUIDBoxes[e].prototype.parse=function(c){this.parseFullHeader(c),f&&f.call(this,c)}:o.UUIDBoxes[e].prototype.parse=f)}};o.initialize(),o.TKHD_FLAG_ENABLED=1,o.TKHD_FLAG_IN_MOVIE=2,o.TKHD_FLAG_IN_PREVIEW=4,o.TFHD_FLAG_BASE_DATA_OFFSET=1,o.TFHD_FLAG_SAMPLE_DESC=2,o.TFHD_FLAG_SAMPLE_DUR=8,o.TFHD_FLAG_SAMPLE_SIZE=16,o.TFHD_FLAG_SAMPLE_FLAGS=32,o.TFHD_FLAG_DUR_EMPTY=65536,o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,o.TRUN_FLAGS_DATA_OFFSET=1,o.TRUN_FLAGS_FIRST_FLAG=4,o.TRUN_FLAGS_DURATION=256,o.TRUN_FLAGS_SIZE=512,o.TRUN_FLAGS_FLAGS=1024,o.TRUN_FLAGS_CTS_OFFSET=2048,o.Box.prototype.add=function(e){return this.addBox(new o[e+"Box"])},o.Box.prototype.addBox=function(e){return this.boxes.push(e),this[e.type+"s"]?this[e.type+"s"].push(e):this[e.type]=e,e},o.Box.prototype.set=function(e,s){return this[e]=s,this},o.Box.prototype.addEntry=function(e,s){var l=s||"entries";return this[l]||(this[l]=[]),this[l].push(e),this},h.BoxParser=o,o.parseUUID=function(e){return o.parseHex16(e)},o.parseHex16=function(e){for(var s="",l=0;l<16;l++){var f=e.readUint8().toString(16);s+=f.length===1?"0"+f:f}return s},o.parseOneBox=function(e,s,l){var f,c=e.getPosition(),y=0,m,_;if(e.getEndPosition()-c<8)return a.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:o.ERR_NOT_ENOUGH_DATA};if(l&&l<8)return a.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:o.ERR_NOT_ENOUGH_DATA};var E=e.readUint32(),w=e.readString(4),k=w;if(a.debug("BoxParser","Found box of type '"+w+"' and size "+E+" at position "+c),y=8,w=="uuid"){if(e.getEndPosition()-e.getPosition()<16||l-y<16)return e.seek(c),a.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:o.ERR_NOT_ENOUGH_DATA};_=o.parseUUID(e),y+=16,k=_}if(E==1){if(e.getEndPosition()-e.getPosition()<8||l&&l-y<8)return e.seek(c),a.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+w+'" box'),{code:o.ERR_NOT_ENOUGH_DATA};E=e.readUint64(),y+=8}else if(E===0){if(l)E=l;else if(w!=="mdat")return a.error("BoxParser","Unlimited box size not supported for type: '"+w+"'"),f=new o.Box(w,E),{code:o.OK,box:f,size:f.size}}return E!==0&&E<y?(a.error("BoxParser","Box of type "+w+" has an invalid size "+E+" (too small to be a box)"),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:c}):E!==0&&l&&E>l?(a.error("BoxParser","Box of type '"+w+"' has a size "+E+" greater than its container size "+l),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:c}):E!==0&&c+E>e.getEndPosition()?(e.seek(c),a.info("BoxParser","Not enough data in stream to parse the entire '"+w+"' box"),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:c}):s?{code:o.OK,type:w,size:E,hdr_size:y,start:c}:(o[w+"Box"]?f=new o[w+"Box"](E):w!=="uuid"?(a.warn("BoxParser","Unknown box type: '"+w+"'"),f=new o.Box(w,E),f.has_unparsed_data=!0):o.UUIDBoxes[_]?f=new o.UUIDBoxes[_](E):(a.warn("BoxParser","Unknown uuid type: '"+_+"'"),f=new o.Box(w,E),f.uuid=_,f.has_unparsed_data=!0),f.hdr_size=y,f.start=c,f.write===o.Box.prototype.write&&f.type!=="mdat"&&(a.info("BoxParser","'"+k+"' box writing not yet implemented, keeping unparsed data in memory for later write"),f.parseDataAndRewind(e)),f.parse(e),m=e.getPosition()-(f.start+f.size),m<0?(a.warn("BoxParser","Parsing of box '"+k+"' did not read the entire indicated box data size (missing "+-m+" bytes), seeking forward"),e.seek(f.start+f.size)):m>0&&(a.error("BoxParser","Parsing of box '"+k+"' read "+m+" more bytes than the indicated box data size, seeking backwards"),f.size!==0&&e.seek(f.start+f.size)),{code:o.OK,box:f,size:f.size})},o.Box.prototype.parse=function(e){this.type!="mdat"?this.data=e.readUint8Array(this.size-this.hdr_size):this.size===0?e.seek(e.getEndPosition()):e.seek(this.start+this.size)},o.Box.prototype.parseDataAndRewind=function(e){this.data=e.readUint8Array(this.size-this.hdr_size),e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseDataAndRewind=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseFullHeader=function(e){this.version=e.readUint8(),this.flags=e.readUint24(),this.hdr_size+=4},o.FullBox.prototype.parse=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.ContainerBox.prototype.parse=function(e){for(var s,l;e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)if(l=s.box,this.boxes.push(l),this.subBoxNames&&this.subBoxNames.indexOf(l.type)!=-1)this[this.subBoxNames[this.subBoxNames.indexOf(l.type)]+"s"].push(l);else{var f=l.type!=="uuid"?l.type:l.uuid;this[f]?a.warn("Box of type "+f+" already stored in field of this type"):this[f]=l}else return},o.Box.prototype.parseLanguage=function(e){this.language=e.readUint16();var s=[];s[0]=this.language>>10&31,s[1]=this.language>>5&31,s[2]=this.language&31,this.languageString=String.fromCharCode(s[0]+96,s[1]+96,s[2]+96)},o.SAMPLE_ENTRY_TYPE_VISUAL="Visual",o.SAMPLE_ENTRY_TYPE_AUDIO="Audio",o.SAMPLE_ENTRY_TYPE_HINT="Hint",o.SAMPLE_ENTRY_TYPE_METADATA="Metadata",o.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",o.SAMPLE_ENTRY_TYPE_SYSTEM="System",o.SAMPLE_ENTRY_TYPE_TEXT="Text",o.SampleEntry.prototype.parseHeader=function(e){e.readUint8Array(6),this.data_reference_index=e.readUint16(),this.hdr_size+=8},o.SampleEntry.prototype.parse=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.SampleEntry.prototype.parseDataAndRewind=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,e.position-=this.size-this.hdr_size},o.SampleEntry.prototype.parseFooter=function(e){o.ContainerBox.prototype.parse.call(this,e)},o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_HINT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,function(e){var s;this.parseHeader(e),e.readUint16(),e.readUint16(),e.readUint32Array(3),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16(),s=Math.min(31,e.readUint8()),this.compressorname=e.readString(s),s<31&&e.readString(31-s),this.depth=e.readUint16(),e.readUint16(),this.parseFooter(e)}),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,function(e){this.parseHeader(e),e.readUint32Array(2),this.channel_count=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.samplerate=e.readUint32()/(1<<16),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT,"enct"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"encm"),o.createBoxCtor("a1lx",function(e){var s=e.readUint8()&1,l=((s&1)+1)*16;this.layer_size=[];for(var f=0;f<3;f++)l==16?this.layer_size[f]=e.readUint16():this.layer_size[f]=e.readUint32()}),o.createBoxCtor("a1op",function(e){this.op_index=e.readUint8()}),o.createFullBoxCtor("auxC",function(e){this.aux_type=e.readCString();var s=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=e.readUint8Array(s)}),o.createBoxCtor("av1C",function(e){var s=e.readUint8();if(s>>7&!1){a.error("av1C marker problem");return}if(this.version=s&127,this.version!==1){a.error("av1C version "+this.version+" not supported");return}if(s=e.readUint8(),this.seq_profile=s>>5&7,this.seq_level_idx_0=s&31,s=e.readUint8(),this.seq_tier_0=s>>7&1,this.high_bitdepth=s>>6&1,this.twelve_bit=s>>5&1,this.monochrome=s>>4&1,this.chroma_subsampling_x=s>>3&1,this.chroma_subsampling_y=s>>2&1,this.chroma_sample_position=s&3,s=e.readUint8(),this.reserved_1=s>>5&7,this.reserved_1!==0){a.error("av1C reserved_1 parsing problem");return}if(this.initial_presentation_delay_present=s>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=s&15;else if(this.reserved_2=s&15,this.reserved_2!==0){a.error("av1C reserved_2 parsing problem");return}var l=this.size-this.hdr_size-4;this.configOBUs=e.readUint8Array(l)}),o.createBoxCtor("avcC",function(e){var s,l;for(this.configurationVersion=e.readUint8(),this.AVCProfileIndication=e.readUint8(),this.profile_compatibility=e.readUint8(),this.AVCLevelIndication=e.readUint8(),this.lengthSizeMinusOne=e.readUint8()&3,this.nb_SPS_nalus=e.readUint8()&31,l=this.size-this.hdr_size-6,this.SPS=[],s=0;s<this.nb_SPS_nalus;s++)this.SPS[s]={},this.SPS[s].length=e.readUint16(),this.SPS[s].nalu=e.readUint8Array(this.SPS[s].length),l-=2+this.SPS[s].length;for(this.nb_PPS_nalus=e.readUint8(),l--,this.PPS=[],s=0;s<this.nb_PPS_nalus;s++)this.PPS[s]={},this.PPS[s].length=e.readUint16(),this.PPS[s].nalu=e.readUint8Array(this.PPS[s].length),l-=2+this.PPS[s].length;l>0&&(this.ext=e.readUint8Array(l))}),o.createBoxCtor("btrt",function(e){this.bufferSizeDB=e.readUint32(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32()}),o.createBoxCtor("clap",function(e){this.cleanApertureWidthN=e.readUint32(),this.cleanApertureWidthD=e.readUint32(),this.cleanApertureHeightN=e.readUint32(),this.cleanApertureHeightD=e.readUint32(),this.horizOffN=e.readUint32(),this.horizOffD=e.readUint32(),this.vertOffN=e.readUint32(),this.vertOffD=e.readUint32()}),o.createBoxCtor("clli",function(e){this.max_content_light_level=e.readUint16(),this.max_pic_average_light_level=e.readUint16()}),o.createFullBoxCtor("co64",function(e){var s,l;if(s=e.readUint32(),this.chunk_offsets=[],this.version===0)for(l=0;l<s;l++)this.chunk_offsets.push(e.readUint64())}),o.createFullBoxCtor("CoLL",function(e){this.maxCLL=e.readUint16(),this.maxFALL=e.readUint16()}),o.createBoxCtor("colr",function(e){if(this.colour_type=e.readString(4),this.colour_type==="nclx"){this.colour_primaries=e.readUint16(),this.transfer_characteristics=e.readUint16(),this.matrix_coefficients=e.readUint16();var s=e.readUint8();this.full_range_flag=s>>7}else this.colour_type==="rICC"?this.ICC_profile=e.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=e.readUint8Array(this.size-4))}),o.createFullBoxCtor("cprt",function(e){this.parseLanguage(e),this.notice=e.readCString()}),o.createFullBoxCtor("cslg",function(e){this.version===0&&(this.compositionToDTSShift=e.readInt32(),this.leastDecodeToDisplayDelta=e.readInt32(),this.greatestDecodeToDisplayDelta=e.readInt32(),this.compositionStartTime=e.readInt32(),this.compositionEndTime=e.readInt32())}),o.createFullBoxCtor("ctts",function(e){var s,l;if(s=e.readUint32(),this.sample_counts=[],this.sample_offsets=[],this.version===0)for(l=0;l<s;l++){this.sample_counts.push(e.readUint32());var f=e.readInt32();f<0&&a.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(f)}else if(this.version==1)for(l=0;l<s;l++)this.sample_counts.push(e.readUint32()),this.sample_offsets.push(e.readInt32())}),o.createBoxCtor("dac3",function(e){var s=e.readUint8(),l=e.readUint8(),f=e.readUint8();this.fscod=s>>6,this.bsid=s>>1&31,this.bsmod=(s&1)<<2|l>>6&3,this.acmod=l>>3&7,this.lfeon=l>>2&1,this.bit_rate_code=l&3|f>>5&7}),o.createBoxCtor("dec3",function(e){var s=e.readUint16();this.data_rate=s>>3,this.num_ind_sub=s&7,this.ind_subs=[];for(var l=0;l<this.num_ind_sub+1;l++){var f={};this.ind_subs.push(f);var c=e.readUint8(),y=e.readUint8(),m=e.readUint8();f.fscod=c>>6,f.bsid=c>>1&31,f.bsmod=(c&1)<<4|y>>4&15,f.acmod=y>>1&7,f.lfeon=y&1,f.num_dep_sub=m>>1&15,f.num_dep_sub>0&&(f.chan_loc=(m&1)<<8|e.readUint8())}}),o.createFullBoxCtor("dfLa",function(e){var s=127,l=128,f=[],c=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];this.parseFullHeader(e);do{var y=e.readUint8(),m=Math.min(y&s,c.length-1);if(m?e.readUint8Array(e.readUint24()):(e.readUint8Array(13),this.samplerate=e.readUint32()>>12,e.readUint8Array(20)),f.push(c[m]),y&l)break}while(!0);this.numMetadataBlocks=f.length+" ("+f.join(", ")+")"}),o.createBoxCtor("dimm",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dmax",function(e){this.time=e.readUint32()}),o.createBoxCtor("dmed",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dOps",function(e){if(this.Version=e.readUint8(),this.OutputChannelCount=e.readUint8(),this.PreSkip=e.readUint16(),this.InputSampleRate=e.readUint32(),this.OutputGain=e.readInt16(),this.ChannelMappingFamily=e.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=e.readUint8(),this.CoupledCount=e.readUint8(),this.ChannelMapping=[];for(var s=0;s<this.OutputChannelCount;s++)this.ChannelMapping[s]=e.readUint8()}}),o.createFullBoxCtor("dref",function(e){var s,l;this.entries=[];for(var f=e.readUint32(),c=0;c<f;c++)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)l=s.box,this.entries.push(l);else return}),o.createBoxCtor("drep",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("elng",function(e){this.extended_language=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("elst",function(e){this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.entries.push(f),this.version===1?(f.segment_duration=e.readUint64(),f.media_time=e.readInt64()):(f.segment_duration=e.readUint32(),f.media_time=e.readInt32()),f.media_rate_integer=e.readInt16(),f.media_rate_fraction=e.readInt16()}}),o.createFullBoxCtor("emsg",function(e){this.version==1?(this.timescale=e.readUint32(),this.presentation_time=e.readUint64(),this.event_duration=e.readUint32(),this.id=e.readUint32(),this.scheme_id_uri=e.readCString(),this.value=e.readCString()):(this.scheme_id_uri=e.readCString(),this.value=e.readCString(),this.timescale=e.readUint32(),this.presentation_time_delta=e.readUint32(),this.event_duration=e.readUint32(),this.id=e.readUint32());var s=this.size-this.hdr_size-(4*4+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version==1&&(s-=4),this.message_data=e.readUint8Array(s)}),o.createFullBoxCtor("esds",function(e){var s=e.readUint8Array(this.size-this.hdr_size);if(typeof u!="undefined"){var l=new u;this.esd=l.parseOneDescriptor(new i(s.buffer,0,i.BIG_ENDIAN))}}),o.createBoxCtor("fiel",function(e){this.fieldCount=e.readUint8(),this.fieldOrdering=e.readUint8()}),o.createBoxCtor("frma",function(e){this.data_format=e.readString(4)}),o.createBoxCtor("ftyp",function(e){var s=this.size-this.hdr_size;this.major_brand=e.readString(4),this.minor_version=e.readUint32(),s-=8,this.compatible_brands=[];for(var l=0;s>=4;)this.compatible_brands[l]=e.readString(4),s-=4,l++}),o.createFullBoxCtor("hdlr",function(e){this.version===0&&(e.readUint32(),this.handler=e.readString(4),e.readUint32Array(3),this.name=e.readString(this.size-this.hdr_size-20),this.name[this.name.length-1]==="\0"&&(this.name=this.name.slice(0,-1)))}),o.createBoxCtor("hvcC",function(e){var s,l,f,c;this.configurationVersion=e.readUint8(),c=e.readUint8(),this.general_profile_space=c>>6,this.general_tier_flag=(c&32)>>5,this.general_profile_idc=c&31,this.general_profile_compatibility=e.readUint32(),this.general_constraint_indicator=e.readUint8Array(6),this.general_level_idc=e.readUint8(),this.min_spatial_segmentation_idc=e.readUint16()&4095,this.parallelismType=e.readUint8()&3,this.chroma_format_idc=e.readUint8()&3,this.bit_depth_luma_minus8=e.readUint8()&7,this.bit_depth_chroma_minus8=e.readUint8()&7,this.avgFrameRate=e.readUint16(),c=e.readUint8(),this.constantFrameRate=c>>6,this.numTemporalLayers=(c&13)>>3,this.temporalIdNested=(c&4)>>2,this.lengthSizeMinusOne=c&3,this.nalu_arrays=[];var y=e.readUint8();for(s=0;s<y;s++){var m=[];this.nalu_arrays.push(m),c=e.readUint8(),m.completeness=(c&128)>>7,m.nalu_type=c&63;var _=e.readUint16();for(l=0;l<_;l++){var E={};m.push(E),f=e.readUint16(),E.data=e.readUint8Array(f)}}}),o.createFullBoxCtor("iinf",function(e){var s;this.version===0?this.entry_count=e.readUint16():this.entry_count=e.readUint32(),this.item_infos=[];for(var l=0;l<this.entry_count;l++)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)s.box.type!=="infe"&&a.error("BoxParser","Expected 'infe' box, got "+s.box.type),this.item_infos[l]=s.box;else return}),o.createFullBoxCtor("iloc",function(e){var s;s=e.readUint8(),this.offset_size=s>>4&15,this.length_size=s&15,s=e.readUint8(),this.base_offset_size=s>>4&15,this.version===1||this.version===2?this.index_size=s&15:this.index_size=0,this.items=[];var l=0;if(this.version<2)l=e.readUint16();else if(this.version===2)l=e.readUint32();else throw"version of iloc box not supported";for(var f=0;f<l;f++){var c={};if(this.items.push(c),this.version<2)c.item_ID=e.readUint16();else if(this.version===2)c.item_ID=e.readUint16();else throw"version of iloc box not supported";switch(this.version===1||this.version===2?c.construction_method=e.readUint16()&15:c.construction_method=0,c.data_reference_index=e.readUint16(),this.base_offset_size){case 0:c.base_offset=0;break;case 4:c.base_offset=e.readUint32();break;case 8:c.base_offset=e.readUint64();break;default:throw"Error reading base offset size"}var y=e.readUint16();c.extents=[];for(var m=0;m<y;m++){var _={};if(c.extents.push(_),this.version===1||this.version===2)switch(this.index_size){case 0:_.extent_index=0;break;case 4:_.extent_index=e.readUint32();break;case 8:_.extent_index=e.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:_.extent_offset=0;break;case 4:_.extent_offset=e.readUint32();break;case 8:_.extent_offset=e.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:_.extent_length=0;break;case 4:_.extent_length=e.readUint32();break;case 8:_.extent_length=e.readUint64();break;default:throw"Error reading extent index"}}}}),o.createBoxCtor("imir",function(e){var s=e.readUint8();this.reserved=s>>7,this.axis=s&1}),o.createFullBoxCtor("infe",function(e){if((this.version===0||this.version===1)&&(this.item_ID=e.readUint16(),this.item_protection_index=e.readUint16(),this.item_name=e.readCString(),this.content_type=e.readCString(),this.content_encoding=e.readCString()),this.version===1){this.extension_type=e.readString(4),a.warn("BoxParser","Cannot parse extension type"),e.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=e.readUint16():this.version===3&&(this.item_ID=e.readUint32()),this.item_protection_index=e.readUint16(),this.item_type=e.readString(4),this.item_name=e.readCString(),this.item_type==="mime"?(this.content_type=e.readCString(),this.content_encoding=e.readCString()):this.item_type==="uri "&&(this.item_uri_type=e.readCString()))}),o.createFullBoxCtor("ipma",function(e){var s,l;for(entry_count=e.readUint32(),this.associations=[],s=0;s<entry_count;s++){var f={};this.associations.push(f),this.version<1?f.id=e.readUint16():f.id=e.readUint32();var c=e.readUint8();for(f.props=[],l=0;l<c;l++){var y=e.readUint8(),m={};f.props.push(m),m.essential=(y&128)>>7==1,this.flags&1?m.property_index=(y&127)<<8|e.readUint8():m.property_index=y&127}}}),o.createFullBoxCtor("iref",function(e){var s,l;for(this.references=[];e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),s.code===o.OK)this.version===0?l=new o.SingleItemTypeReferenceBox(s.type,s.size,s.hdr_size,s.start):l=new o.SingleItemTypeReferenceBoxLarge(s.type,s.size,s.hdr_size,s.start),l.write===o.Box.prototype.write&&l.type!=="mdat"&&(a.warn("BoxParser",l.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),l.parseDataAndRewind(e)),l.parse(e),this.references.push(l);else return}),o.createBoxCtor("irot",function(e){this.angle=e.readUint8()&3}),o.createFullBoxCtor("ispe",function(e){this.image_width=e.readUint32(),this.image_height=e.readUint32()}),o.createFullBoxCtor("kind",function(e){this.schemeURI=e.readCString(),this.value=e.readCString()}),o.createFullBoxCtor("leva",function(e){var s=e.readUint8();this.levels=[];for(var l=0;l<s;l++){var f={};this.levels[l]=f,f.track_ID=e.readUint32();var c=e.readUint8();switch(f.padding_flag=c>>7,f.assignment_type=c&127,f.assignment_type){case 0:f.grouping_type=e.readString(4);break;case 1:f.grouping_type=e.readString(4),f.grouping_type_parameter=e.readUint32();break;case 2:break;case 3:break;case 4:f.sub_track_id=e.readUint32();break;default:a.warn("BoxParser","Unknown leva assignement type")}}}),o.createBoxCtor("lsel",function(e){this.layer_id=e.readUint16()}),o.createBoxCtor("maxr",function(e){this.period=e.readUint32(),this.bytes=e.readUint32()}),o.createBoxCtor("mdcv",function(e){this.display_primaries=[],this.display_primaries[0]={},this.display_primaries[0].x=e.readUint16(),this.display_primaries[0].y=e.readUint16(),this.display_primaries[1]={},this.display_primaries[1].x=e.readUint16(),this.display_primaries[1].y=e.readUint16(),this.display_primaries[2]={},this.display_primaries[2].x=e.readUint16(),this.display_primaries[2].y=e.readUint16(),this.white_point={},this.white_point.x=e.readUint16(),this.white_point.y=e.readUint16(),this.max_display_mastering_luminance=e.readUint32(),this.min_display_mastering_luminance=e.readUint32()}),o.createFullBoxCtor("mdhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.parseLanguage(e),e.readUint16()}),o.createFullBoxCtor("mehd",function(e){this.flags&1&&(a.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version==1?this.fragment_duration=e.readUint64():this.fragment_duration=e.readUint32()}),o.createFullBoxCtor("meta",function(e){this.boxes=[],o.ContainerBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("mfhd",function(e){this.sequence_number=e.readUint32()}),o.createFullBoxCtor("mfro",function(e){this._size=e.readUint32()}),o.createFullBoxCtor("mvhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.rate=e.readUint32(),this.volume=e.readUint16()>>8,e.readUint16(),e.readUint32Array(2),this.matrix=e.readUint32Array(9),e.readUint32Array(6),this.next_track_id=e.readUint32()}),o.createBoxCtor("npck",function(e){this.packetssent=e.readUint32()}),o.createBoxCtor("nump",function(e){this.packetssent=e.readUint64()}),o.createFullBoxCtor("padb",function(e){var s=e.readUint32();this.padbits=[];for(var l=0;l<Math.floor((s+1)/2);l++)this.padbits=e.readUint8()}),o.createBoxCtor("pasp",function(e){this.hSpacing=e.readUint32(),this.vSpacing=e.readUint32()}),o.createBoxCtor("payl",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createBoxCtor("payt",function(e){this.payloadID=e.readUint32();var s=e.readUint8();this.rtpmap_string=e.readString(s)}),o.createFullBoxCtor("pdin",function(e){var s=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var l=0;l<s;l++)this.rate[l]=e.readUint32(),this.initial_delay[l]=e.readUint32()}),o.createFullBoxCtor("pitm",function(e){this.version===0?this.item_id=e.readUint16():this.item_id=e.readUint32()}),o.createFullBoxCtor("pixi",function(e){var s;for(this.num_channels=e.readUint8(),this.bits_per_channels=[],s=0;s<this.num_channels;s++)this.bits_per_channels[s]=e.readUint8()}),o.createBoxCtor("pmax",function(e){this.bytes=e.readUint32()}),o.createFullBoxCtor("prft",function(e){this.ref_track_id=e.readUint32(),this.ntp_timestamp=e.readUint64(),this.version===0?this.media_time=e.readUint32():this.media_time=e.readUint64()}),o.createFullBoxCtor("pssh",function(e){if(this.system_id=o.parseHex16(e),this.version>0){var s=e.readUint32();this.kid=[];for(var l=0;l<s;l++)this.kid[l]=o.parseHex16(e)}var f=e.readUint32();f>0&&(this.data=e.readUint8Array(f))}),o.createFullBoxCtor("clef",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("enof",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("prof",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createContainerBoxCtor("tapt",null,["clef","prof","enof"]),o.createBoxCtor("rtp ",function(e){this.descriptionformat=e.readString(4),this.sdptext=e.readString(this.size-this.hdr_size-4)}),o.createFullBoxCtor("saio",function(e){this.flags&1&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32());var s=e.readUint32();this.offset=[];for(var l=0;l<s;l++)this.version===0?this.offset[l]=e.readUint32():this.offset[l]=e.readUint64()}),o.createFullBoxCtor("saiz",function(e){this.flags&1&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32()),this.default_sample_info_size=e.readUint8();var s=e.readUint32();if(this.sample_info_size=[],this.default_sample_info_size===0)for(var l=0;l<s;l++)this.sample_info_size[l]=e.readUint8()}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(e){this.parseHeader(e),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.auxiliary_mime_types=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(e){this.parseHeader(e),this.displayFlags=e.readUint32(),this.horizontal_justification=e.readInt8(),this.vertical_justification=e.readInt8(),this.bg_color_rgba=e.readUint8Array(4),this.box_record=e.readInt16Array(4),this.style_record=e.readUint8Array(12),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(e){this.parseHeader(e),this.parseFooter(e)}),o.createSampleGroupCtor("alst",function(e){var s,l=e.readUint16();for(this.first_output_sample=e.readUint16(),this.sample_offset=[],s=0;s<l;s++)this.sample_offset[s]=e.readUint32();var f=this.description_length-4-4*l;for(this.num_output_samples=[],this.num_total_samples=[],s=0;s<f/4;s++)this.num_output_samples[s]=e.readUint16(),this.num_total_samples[s]=e.readUint16()}),o.createSampleGroupCtor("avll",function(e){this.layerNumber=e.readUint8(),this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()}),o.createSampleGroupCtor("avss",function(e){this.subSequenceIdentifier=e.readUint16(),this.layerNumber=e.readUint8();var s=e.readUint8();this.durationFlag=s>>7,this.avgRateFlag=s>>6&1,this.durationFlag&&(this.duration=e.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()),this.dependency=[];for(var l=e.readUint8(),f=0;f<l;f++){var c={};this.dependency.push(c),c.subSeqDirectionFlag=e.readUint8(),c.layerNumber=e.readUint8(),c.subSequenceIdentifier=e.readUint16()}}),o.createSampleGroupCtor("dtrt",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("mvif",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("prol",function(e){this.roll_distance=e.readInt16()}),o.createSampleGroupCtor("rap ",function(e){var s=e.readUint8();this.num_leading_samples_known=s>>7,this.num_leading_samples=s&127}),o.createSampleGroupCtor("rash",function(e){if(this.operation_point_count=e.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)a.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=e.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=e.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var s=0;s<this.operation_point_count;s++)this.available_bitrate[s]=e.readUint32(),this.target_rate_share[s]=e.readUint16()}this.maximum_bitrate=e.readUint32(),this.minimum_bitrate=e.readUint32(),this.discard_priority=e.readUint8()}}),o.createSampleGroupCtor("roll",function(e){this.roll_distance=e.readInt16()}),o.SampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=e.readUint8Array(this.description_length)},o.createSampleGroupCtor("scif",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("scnm",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("seig",function(e){this.reserved=e.readUint8();var s=e.readUint8();this.crypt_byte_block=s>>4,this.skip_byte_block=s&15,this.isProtected=e.readUint8(),this.Per_Sample_IV_Size=e.readUint8(),this.KID=o.parseHex16(e),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=e.readUint8(),this.constant_IV=e.readUint8Array(this.constant_IV_size))}),o.createSampleGroupCtor("stsa",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("sync",function(e){var s=e.readUint8();this.NAL_unit_type=s&63}),o.createSampleGroupCtor("tele",function(e){var s=e.readUint8();this.level_independently_decodable=s>>7}),o.createSampleGroupCtor("tsas",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("tscl",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("vipr",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createFullBoxCtor("sbgp",function(e){this.grouping_type=e.readString(4),this.version===1?this.grouping_type_parameter=e.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.entries.push(f),f.sample_count=e.readInt32(),f.group_description_index=e.readInt32()}}),o.createFullBoxCtor("schm",function(e){this.scheme_type=e.readString(4),this.scheme_version=e.readUint32(),this.flags&1&&(this.scheme_uri=e.readString(this.size-this.hdr_size-8))}),o.createBoxCtor("sdp ",function(e){this.sdptext=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("sdtp",function(e){var s,l=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var f=0;f<l;f++)s=e.readUint8(),this.is_leading[f]=s>>6,this.sample_depends_on[f]=s>>4&3,this.sample_is_depended_on[f]=s>>2&3,this.sample_has_redundancy[f]=s&3}),o.createFullBoxCtor("senc"),o.createFullBoxCtor("sgpd",function(e){this.grouping_type=e.readString(4),a.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=e.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=e.readUint32()),this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f;o[this.grouping_type+"SampleGroupEntry"]?f=new o[this.grouping_type+"SampleGroupEntry"](this.grouping_type):f=new o.SampleGroupEntry(this.grouping_type),this.entries.push(f),this.version===1?this.default_length===0?f.description_length=e.readUint32():f.description_length=this.default_length:f.description_length=this.default_length,f.write===o.SampleGroupEntry.prototype.write&&(a.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),f.data=e.readUint8Array(f.description_length),e.position-=f.description_length),f.parse(e)}}),o.createFullBoxCtor("sidx",function(e){this.reference_ID=e.readUint32(),this.timescale=e.readUint32(),this.version===0?(this.earliest_presentation_time=e.readUint32(),this.first_offset=e.readUint32()):(this.earliest_presentation_time=e.readUint64(),this.first_offset=e.readUint64()),e.readUint16(),this.references=[];for(var s=e.readUint16(),l=0;l<s;l++){var f={};this.references.push(f);var c=e.readUint32();f.reference_type=c>>31&1,f.referenced_size=c&2147483647,f.subsegment_duration=e.readUint32(),c=e.readUint32(),f.starts_with_SAP=c>>31&1,f.SAP_type=c>>28&7,f.SAP_delta_time=c&268435455}}),o.SingleItemTypeReferenceBox=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.SingleItemTypeReferenceBox.prototype=new o.Box,o.SingleItemTypeReferenceBox.prototype.parse=function(e){this.from_item_ID=e.readUint16();var s=e.readUint16();this.references=[];for(var l=0;l<s;l++)this.references[l]=e.readUint16()},o.SingleItemTypeReferenceBoxLarge=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.SingleItemTypeReferenceBoxLarge.prototype=new o.Box,o.SingleItemTypeReferenceBoxLarge.prototype.parse=function(e){this.from_item_ID=e.readUint32();var s=e.readUint16();this.references=[];for(var l=0;l<s;l++)this.references[l]=e.readUint32()},o.createFullBoxCtor("SmDm",function(e){this.primaryRChromaticity_x=e.readUint16(),this.primaryRChromaticity_y=e.readUint16(),this.primaryGChromaticity_x=e.readUint16(),this.primaryGChromaticity_y=e.readUint16(),this.primaryBChromaticity_x=e.readUint16(),this.primaryBChromaticity_y=e.readUint16(),this.whitePointChromaticity_x=e.readUint16(),this.whitePointChromaticity_y=e.readUint16(),this.luminanceMax=e.readUint32(),this.luminanceMin=e.readUint32()}),o.createFullBoxCtor("smhd",function(e){this.balance=e.readUint16(),e.readUint16()}),o.createFullBoxCtor("ssix",function(e){this.subsegments=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.subsegments.push(f),f.ranges=[];for(var c=e.readUint32(),y=0;y<c;y++){var m={};f.ranges.push(m),m.level=e.readUint8(),m.range_size=e.readUint24()}}}),o.createFullBoxCtor("stco",function(e){var s;if(s=e.readUint32(),this.chunk_offsets=[],this.version===0)for(var l=0;l<s;l++)this.chunk_offsets.push(e.readUint32())}),o.createFullBoxCtor("stdp",function(e){var s=(this.size-this.hdr_size)/2;this.priority=[];for(var l=0;l<s;l++)this.priority[l]=e.readUint16()}),o.createFullBoxCtor("sthd"),o.createFullBoxCtor("stri",function(e){this.switch_group=e.readUint16(),this.alternate_group=e.readUint16(),this.sub_track_id=e.readUint32();var s=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var l=0;l<s;l++)this.attribute_list[l]=e.readUint32()}),o.createFullBoxCtor("stsc",function(e){var s,l;if(s=e.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(l=0;l<s;l++)this.first_chunk.push(e.readUint32()),this.samples_per_chunk.push(e.readUint32()),this.sample_description_index.push(e.readUint32())}),o.createFullBoxCtor("stsd",function(e){var s,l,f,c;for(this.entries=[],f=e.readUint32(),s=1;s<=f;s++)if(l=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),l.code===o.OK)o[l.type+"SampleEntry"]?(c=new o[l.type+"SampleEntry"](l.size),c.hdr_size=l.hdr_size,c.start=l.start):(a.warn("BoxParser","Unknown sample entry type: "+l.type),c=new o.SampleEntry(l.type,l.size,l.hdr_size,l.start)),c.write===o.SampleEntry.prototype.write&&(a.info("BoxParser","SampleEntry "+c.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),c.parseDataAndRewind(e)),c.parse(e),this.entries.push(c);else return}),o.createFullBoxCtor("stsg",function(e){this.grouping_type=e.readUint32();var s=e.readUint16();this.group_description_index=[];for(var l=0;l<s;l++)this.group_description_index[l]=e.readUint32()}),o.createFullBoxCtor("stsh",function(e){var s,l;if(s=e.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(l=0;l<s;l++)this.shadowed_sample_numbers.push(e.readUint32()),this.sync_sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stss",function(e){var s,l;if(l=e.readUint32(),this.version===0)for(this.sample_numbers=[],s=0;s<l;s++)this.sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stsz",function(e){var s;if(this.sample_sizes=[],this.version===0)for(this.sample_size=e.readUint32(),this.sample_count=e.readUint32(),s=0;s<this.sample_count;s++)this.sample_size===0?this.sample_sizes.push(e.readUint32()):this.sample_sizes[s]=this.sample_size}),o.createFullBoxCtor("stts",function(e){var s,l,f;if(s=e.readUint32(),this.sample_counts=[],this.sample_deltas=[],this.version===0)for(l=0;l<s;l++)this.sample_counts.push(e.readUint32()),f=e.readInt32(),f<0&&(a.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),f=1),this.sample_deltas.push(f)}),o.createFullBoxCtor("stvi",function(e){var s=e.readUint32();this.single_view_allowed=s&3,this.stereo_scheme=e.readUint32();var l=e.readUint32();this.stereo_indication_type=e.readString(l);var f,c;for(this.boxes=[];e.getPosition()<this.start+this.size;)if(f=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),f.code===o.OK)c=f.box,this.boxes.push(c),this[c.type]=c;else return}),o.createBoxCtor("styp",function(e){o.ftypBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("stz2",function(e){var s,l;if(this.sample_sizes=[],this.version===0)if(this.reserved=e.readUint24(),this.field_size=e.readUint8(),l=e.readUint32(),this.field_size===4)for(s=0;s<l;s+=2){var f=e.readUint8();this.sample_sizes[s]=f>>4&15,this.sample_sizes[s+1]=f&15}else if(this.field_size===8)for(s=0;s<l;s++)this.sample_sizes[s]=e.readUint8();else if(this.field_size===16)for(s=0;s<l;s++)this.sample_sizes[s]=e.readUint16();else a.error("BoxParser","Error in length field in stz2 box")}),o.createFullBoxCtor("subs",function(e){var s,l,f,c;for(f=e.readUint32(),this.entries=[],s=0;s<f;s++){var y={};if(this.entries[s]=y,y.sample_delta=e.readUint32(),y.subsamples=[],c=e.readUint16(),c>0)for(l=0;l<c;l++){var m={};y.subsamples.push(m),this.version==1?m.size=e.readUint32():m.size=e.readUint16(),m.priority=e.readUint8(),m.discardable=e.readUint8(),m.codec_specific_parameters=e.readUint32()}}}),o.createFullBoxCtor("tenc",function(e){if(e.readUint8(),this.version===0)e.readUint8();else{var s=e.readUint8();this.default_crypt_byte_block=s>>4&15,this.default_skip_byte_block=s&15}this.default_isProtected=e.readUint8(),this.default_Per_Sample_IV_Size=e.readUint8(),this.default_KID=o.parseHex16(e),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=e.readUint8(),this.default_constant_IV=e.readUint8Array(this.default_constant_IV_size))}),o.createFullBoxCtor("tfdt",function(e){this.version==1?this.baseMediaDecodeTime=e.readUint64():this.baseMediaDecodeTime=e.readUint32()}),o.createFullBoxCtor("tfhd",function(e){var s=0;this.track_id=e.readUint32(),this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=e.readUint64(),s+=8):this.base_data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=e.readUint32(),s+=4):this.default_sample_description_index=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=e.readUint32(),s+=4):this.default_sample_duration=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=e.readUint32(),s+=4):this.default_sample_size=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=e.readUint32(),s+=4):this.default_sample_flags=0}),o.createFullBoxCtor("tfra",function(e){this.track_ID=e.readUint32(),e.readUint24();var s=e.readUint8();this.length_size_of_traf_num=s>>4&3,this.length_size_of_trun_num=s>>2&3,this.length_size_of_sample_num=s&3,this.entries=[];for(var l=e.readUint32(),f=0;f<l;f++)this.version===1?(this.time=e.readUint64(),this.moof_offset=e.readUint64()):(this.time=e.readUint32(),this.moof_offset=e.readUint32()),this.traf_number=e["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=e["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=e["readUint"+8*(this.length_size_of_sample_num+1)]()}),o.createFullBoxCtor("tkhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint32()),e.readUint32Array(2),this.layer=e.readInt16(),this.alternate_group=e.readInt16(),this.volume=e.readInt16()>>8,e.readUint16(),this.matrix=e.readInt32Array(9),this.width=e.readUint32(),this.height=e.readUint32()}),o.createBoxCtor("tmax",function(e){this.time=e.readUint32()}),o.createBoxCtor("tmin",function(e){this.time=e.readUint32()}),o.createBoxCtor("totl",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpay",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpyl",function(e){this.bytessent=e.readUint64()}),o.TrackGroupTypeBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_group_id=e.readUint32()},o.createTrackGroupCtor("msrc"),o.TrackReferenceTypeBox=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.TrackReferenceTypeBox.prototype=new o.Box,o.TrackReferenceTypeBox.prototype.parse=function(e){this.track_ids=e.readUint32Array((this.size-this.hdr_size)/4)},o.trefBox.prototype.parse=function(e){for(var s,l;e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),s.code===o.OK)l=new o.TrackReferenceTypeBox(s.type,s.size,s.hdr_size,s.start),l.write===o.Box.prototype.write&&l.type!=="mdat"&&(a.info("BoxParser","TrackReference "+l.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),l.parseDataAndRewind(e)),l.parse(e),this.boxes.push(l);else return},o.createFullBoxCtor("trep",function(e){for(this.track_ID=e.readUint32(),this.boxes=[];e.getPosition()<this.start+this.size;)if(ret=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),ret.code===o.OK)box=ret.box,this.boxes.push(box);else return}),o.createFullBoxCtor("trex",function(e){this.track_id=e.readUint32(),this.default_sample_description_index=e.readUint32(),this.default_sample_duration=e.readUint32(),this.default_sample_size=e.readUint32(),this.default_sample_flags=e.readUint32()}),o.createBoxCtor("trpy",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("trun",function(e){var s=0;if(this.sample_count=e.readUint32(),s+=4,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=e.readInt32(),s+=4):this.data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=e.readUint32(),s+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>s)for(var l=0;l<this.sample_count;l++)this.flags&o.TRUN_FLAGS_DURATION&&(this.sample_duration[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_SIZE&&(this.sample_size[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_FLAGS&&(this.sample_flags[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?this.sample_composition_time_offset[l]=e.readUint32():this.sample_composition_time_offset[l]=e.readInt32())}),o.createFullBoxCtor("tsel",function(e){this.switch_group=e.readUint32();var s=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var l=0;l<s;l++)this.attribute_list[l]=e.readUint32()}),o.createFullBoxCtor("txtC",function(e){this.config=e.readCString()}),o.createFullBoxCtor("url ",function(e){this.flags!==1&&(this.location=e.readCString())}),o.createFullBoxCtor("urn ",function(e){this.name=e.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=e.readCString())}),o.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66",!0,!1,function(e){this.LiveServerManifest=e.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),o.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3",!0,!1,function(e){this.system_id=o.parseHex16(e);var s=e.readUint32();s>0&&(this.data=e.readUint8Array(s))}),o.createUUIDBox("a2394f525a9b4f14a2446c427c648df4",!0,!1),o.createUUIDBox("8974dbce7be74c5184f97148f9882554",!0,!1,function(e){this.default_AlgorithmID=e.readUint24(),this.default_IV_size=e.readUint8(),this.default_KID=o.parseHex16(e)}),o.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f",!0,!1,function(e){this.fragment_count=e.readUint8(),this.entries=[];for(var s=0;s<this.fragment_count;s++){var l={},f=0,c=0;this.version===1?(f=e.readUint64(),c=e.readUint64()):(f=e.readUint32(),c=e.readUint32()),l.absolute_time=f,l.absolute_duration=c,this.entries.push(l)}}),o.createUUIDBox("6d1d9b0542d544e680e2141daff757b2",!0,!1,function(e){this.version===1?(this.absolute_time=e.readUint64(),this.duration=e.readUint64()):(this.absolute_time=e.readUint32(),this.duration=e.readUint32())}),o.createFullBoxCtor("vmhd",function(e){this.graphicsmode=e.readUint16(),this.opcolor=e.readUint16Array(3)}),o.createFullBoxCtor("vpcC",function(e){var s;this.version===1?(this.profile=e.readUint8(),this.level=e.readUint8(),s=e.readUint8(),this.bitDepth=s>>4,this.chromaSubsampling=s>>1&7,this.videoFullRangeFlag=s&1,this.colourPrimaries=e.readUint8(),this.transferCharacteristics=e.readUint8(),this.matrixCoefficients=e.readUint8(),this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize)):(this.profile=e.readUint8(),this.level=e.readUint8(),s=e.readUint8(),this.bitDepth=s>>4&15,this.colorSpace=s&15,s=e.readUint8(),this.chromaSubsampling=s>>4&15,this.transferFunction=s>>1&7,this.videoFullRangeFlag=s&1,this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize))}),o.createBoxCtor("vttC",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("vvcC",function(e){var s,l,f={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(B){this.held_bits=B.readUint8(),this.num_held_bits=1*8},stream_read_2_bytes:function(B){this.held_bits=B.readUint16(),this.num_held_bits=2*8},extract_bits:function(B){var U=this.held_bits>>this.num_held_bits-B&(1<<B)-1;return this.num_held_bits-=B,U}};if(f.stream_read_1_bytes(e),f.extract_bits(5),this.lengthSizeMinusOne=f.extract_bits(2),this.ptl_present_flag=f.extract_bits(1),this.ptl_present_flag){f.stream_read_2_bytes(e),this.ols_idx=f.extract_bits(9),this.num_sublayers=f.extract_bits(3),this.constant_frame_rate=f.extract_bits(2),this.chroma_format_idc=f.extract_bits(2),f.stream_read_1_bytes(e),this.bit_depth_minus8=f.extract_bits(3),f.extract_bits(5);{if(f.stream_read_2_bytes(e),f.extract_bits(2),this.num_bytes_constraint_info=f.extract_bits(6),this.general_profile_idc=f.extract_bits(7),this.general_tier_flag=f.extract_bits(1),this.general_level_idc=e.readUint8(),f.stream_read_1_bytes(e),this.ptl_frame_only_constraint_flag=f.extract_bits(1),this.ptl_multilayer_enabled_flag=f.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(s=0;s<this.num_bytes_constraint_info-1;s++){var c=f.extract_bits(6);f.stream_read_1_bytes(e);var y=f.extract_bits(2);this.general_constraint_info[s]=c<<2|y}this.general_constraint_info[this.num_bytes_constraint_info-1]=f.extract_bits(6)}else f.extract_bits(6);for(f.stream_read_1_bytes(e),this.ptl_sublayer_present_mask=0,l=this.num_sublayers-2;l>=0;--l){var m=f.extract_bits(1);this.ptl_sublayer_present_mask|=m<<l}for(l=this.num_sublayers;l<=8&&this.num_sublayers>1;++l)f.extract_bits(1);for(l=this.num_sublayers-2;l>=0;--l)this.ptl_sublayer_present_mask&1<<l&&(this.sublayer_level_idc[l]=e.readUint8());if(this.ptl_num_sub_profiles=e.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(s=0;s<this.ptl_num_sub_profiles;s++)this.general_sub_profile_idc.push(e.readUint32())}this.max_picture_width=e.readUint16(),this.max_picture_height=e.readUint16(),this.avg_frame_rate=e.readUint16()}var _=12,E=13;this.nalu_arrays=[];var w=e.readUint8();for(s=0;s<w;s++){var k=[];this.nalu_arrays.push(k),f.stream_read_1_bytes(e),k.completeness=f.extract_bits(1),f.extract_bits(2),k.nalu_type=f.extract_bits(5);var x=1;for(k.nalu_type!=E&&k.nalu_type!=_&&(x=e.readUint16()),l=0;l<x;l++){var S=e.readUint16();k.push({data:e.readUint8Array(S),length:S})}}}),o.createFullBoxCtor("vvnC",function(e){var s=strm.readUint8();this.lengthSizeMinusOne=s&3}),o.SampleEntry.prototype.isVideo=function(){return!1},o.SampleEntry.prototype.isAudio=function(){return!1},o.SampleEntry.prototype.isSubtitle=function(){return!1},o.SampleEntry.prototype.isMetadata=function(){return!1},o.SampleEntry.prototype.isHint=function(){return!1},o.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},o.SampleEntry.prototype.getWidth=function(){return""},o.SampleEntry.prototype.getHeight=function(){return""},o.SampleEntry.prototype.getChannelCount=function(){return""},o.SampleEntry.prototype.getSampleRate=function(){return""},o.SampleEntry.prototype.getSampleSize=function(){return""},o.VisualSampleEntry.prototype.isVideo=function(){return!0},o.VisualSampleEntry.prototype.getWidth=function(){return this.width},o.VisualSampleEntry.prototype.getHeight=function(){return this.height},o.AudioSampleEntry.prototype.isAudio=function(){return!0},o.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},o.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},o.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},o.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},o.MetadataSampleEntry.prototype.isMetadata=function(){return!0},o.decimalToHex=function(e,s){var l=Number(e).toString(16);for(s=typeof s=="undefined"||s===null?s=2:s;l.length<s;)l="0"+l;return l},o.avc1SampleEntry.prototype.getCodec=o.avc2SampleEntry.prototype.getCodec=o.avc3SampleEntry.prototype.getCodec=o.avc4SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.avcC?e+"."+o.decimalToHex(this.avcC.AVCProfileIndication)+""+o.decimalToHex(this.avcC.profile_compatibility)+""+o.decimalToHex(this.avcC.AVCLevelIndication):e},o.hev1SampleEntry.prototype.getCodec=o.hvc1SampleEntry.prototype.getCodec=function(){var e,s=o.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(s+=".",this.hvcC.general_profile_space){case 0:s+="";break;case 1:s+="A";break;case 2:s+="B";break;case 3:s+="C";break}s+=this.hvcC.general_profile_idc,s+=".";var l=this.hvcC.general_profile_compatibility,f=0;for(e=0;e<32&&(f|=l&1,e!=31);e++)f<<=1,l>>=1;s+=o.decimalToHex(f,0),s+=".",this.hvcC.general_tier_flag===0?s+="L":s+="H",s+=this.hvcC.general_level_idc;var c=!1,y="";for(e=5;e>=0;e--)(this.hvcC.general_constraint_indicator[e]||c)&&(y="."+o.decimalToHex(this.hvcC.general_constraint_indicator[e],0)+y,c=!0);s+=y}return s},o.vvc1SampleEntry.prototype.getCodec=o.vvi1SampleEntry.prototype.getCodec=function(){var e,s=o.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){s+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?s+=".H":s+=".L",s+=this.vvcC.general_level_idc;var l="";if(this.vvcC.general_constraint_info){var f=[],c=0;c|=this.vvcC.ptl_frame_only_constraint<<7,c|=this.vvcC.ptl_multilayer_enabled<<6;var y;for(e=0;e<this.vvcC.general_constraint_info.length;++e)c|=this.vvcC.general_constraint_info[e]>>2&63,f.push(c),c&&(y=e),c=this.vvcC.general_constraint_info[e]>>2&3;if(y===void 0)l=".CA";else{l=".C";var m="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",_=0,E=0;for(e=0;e<=y;++e)for(_=_<<8|f[e],E+=8;E>=5;){var w=_>>E-5&31;l+=m[w],E-=5,_&=(1<<E)-1}E&&(_<<=5-E,l+=m[_&31])}}s+=l}return s},o.mp4aSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var s=this.esds.esd.getOTI(),l=this.esds.esd.getAudioConfig();return e+"."+o.decimalToHex(s)+(l?"."+l:"")}else return e},o.stxtSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.mime_format?e+"."+this.mime_format:e},o.vp08SampleEntry.prototype.getCodec=o.vp09SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),s=this.vpcC.level;s==0&&(s="00");var l=this.vpcC.bitDepth;return l==8&&(l="08"),e+".0"+this.vpcC.profile+"."+s+"."+l},o.av01SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),s=this.av1C.seq_level_idx_0;s<10&&(s="0"+s);var l;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?l=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(l=this.av1C.high_bitdepth===1?"10":"08"),e+"."+this.av1C.seq_profile+"."+s+(this.av1C.seq_tier_0?"H":"M")+"."+l},o.Box.prototype.writeHeader=function(e,s){this.size+=8,this.size>r&&(this.size+=8),this.type==="uuid"&&(this.size+=16),a.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+e.getPosition()+(s||"")),this.size>r?e.writeUint32(1):(this.sizePosition=e.getPosition(),e.writeUint32(this.size)),e.writeString(this.type,null,4),this.type==="uuid"&&e.writeUint8Array(this.uuid),this.size>r&&e.writeUint64(this.size)},o.FullBox.prototype.writeHeader=function(e){this.size+=4,o.Box.prototype.writeHeader.call(this,e," v="+this.version+" f="+this.flags),e.writeUint8(this.version),e.writeUint24(this.flags)},o.Box.prototype.write=function(e){this.type==="mdat"?this.data&&(this.size=this.data.length,this.writeHeader(e),e.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(e),this.data&&e.writeUint8Array(this.data))},o.ContainerBox.prototype.write=function(e){this.size=0,this.writeHeader(e);for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&(this.boxes[s].write(e),this.size+=this.boxes[s].size);a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.TrackReferenceTypeBox.prototype.write=function(e){this.size=this.track_ids.length*4,this.writeHeader(e),e.writeUint32Array(this.track_ids)},o.avcCBox.prototype.write=function(e){var s;for(this.size=7,s=0;s<this.SPS.length;s++)this.size+=2+this.SPS[s].length;for(s=0;s<this.PPS.length;s++)this.size+=2+this.PPS[s].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(e),e.writeUint8(this.configurationVersion),e.writeUint8(this.AVCProfileIndication),e.writeUint8(this.profile_compatibility),e.writeUint8(this.AVCLevelIndication),e.writeUint8(this.lengthSizeMinusOne+(63<<2)),e.writeUint8(this.SPS.length+(7<<5)),s=0;s<this.SPS.length;s++)e.writeUint16(this.SPS[s].length),e.writeUint8Array(this.SPS[s].nalu);for(e.writeUint8(this.PPS.length),s=0;s<this.PPS.length;s++)e.writeUint16(this.PPS[s].length),e.writeUint8Array(this.PPS[s].nalu);this.ext&&e.writeUint8Array(this.ext)},o.co64Box.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),s=0;s<this.chunk_offsets.length;s++)e.writeUint64(this.chunk_offsets[s])},o.cslgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeInt32(this.compositionToDTSShift),e.writeInt32(this.leastDecodeToDisplayDelta),e.writeInt32(this.greatestDecodeToDisplayDelta),e.writeInt32(this.compositionStartTime),e.writeInt32(this.compositionEndTime)},o.cttsBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)e.writeUint32(this.sample_counts[s]),this.version===1?e.writeInt32(this.sample_offsets[s]):e.writeUint32(this.sample_offsets[s])},o.drefBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++)this.entries[s].write(e),this.size+=this.entries[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.elngBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(e),e.writeString(this.extended_language)},o.elstBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(e),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var l=this.entries[s];e.writeUint32(l.segment_duration),e.writeInt32(l.media_time),e.writeInt16(l.media_rate_integer),e.writeInt16(l.media_rate_fraction)}},o.emsgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(e),e.writeCString(this.scheme_id_uri),e.writeCString(this.value),e.writeUint32(this.timescale),e.writeUint32(this.presentation_time_delta),e.writeUint32(this.event_duration),e.writeUint32(this.id),e.writeUint8Array(this.message_data)},o.ftypBox.prototype.write=function(e){this.size=8+4*this.compatible_brands.length,this.writeHeader(e),e.writeString(this.major_brand,null,4),e.writeUint32(this.minor_version);for(var s=0;s<this.compatible_brands.length;s++)e.writeString(this.compatible_brands[s],null,4)},o.hdlrBox.prototype.write=function(e){this.size=5*4+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(e),e.writeUint32(0),e.writeString(this.handler,null,4),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeCString(this.name)},o.kindBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(e),e.writeCString(this.schemeURI),e.writeCString(this.value)},o.mdhdBox.prototype.write=function(e){this.size=4*4+2*2,this.flags=0,this.version=0,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint16(this.language),e.writeUint16(0)},o.mehdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.fragment_duration)},o.mfhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.sequence_number)},o.mvhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=23*4+2*2,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint32(this.rate),e.writeUint16(this.volume<<8),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32Array(this.matrix),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(this.next_track_id)},o.SampleEntry.prototype.writeHeader=function(e){this.size=8,o.Box.prototype.writeHeader.call(this,e),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint16(this.data_reference_index)},o.SampleEntry.prototype.writeFooter=function(e){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(e),this.size+=this.boxes[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.SampleEntry.prototype.write=function(e){this.writeHeader(e),e.writeUint8Array(this.data),this.size+=this.data.length,a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.VisualSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*7+6*4+32,e.writeUint16(0),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.width),e.writeUint16(this.height),e.writeUint32(this.horizresolution),e.writeUint32(this.vertresolution),e.writeUint32(0),e.writeUint16(this.frame_count),e.writeUint8(Math.min(31,this.compressorname.length)),e.writeString(this.compressorname,null,31),e.writeUint16(this.depth),e.writeInt16(-1),this.writeFooter(e)},o.AudioSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*4+3*4,e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.channel_count),e.writeUint16(this.samplesize),e.writeUint16(0),e.writeUint16(0),e.writeUint32(this.samplerate<<16),this.writeFooter(e)},o.stppSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,e.writeCString(this.namespace),e.writeCString(this.schema_location),e.writeCString(this.auxiliary_mime_types),this.writeFooter(e)},o.SampleGroupEntry.prototype.write=function(e){e.writeUint8Array(this.data)},o.sbgpBox.prototype.write=function(e){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(e),e.writeString(this.grouping_type,null,4),e.writeUint32(this.grouping_type_parameter),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var l=this.entries[s];e.writeInt32(l.sample_count),e.writeInt32(l.group_description_index)}},o.sgpdBox.prototype.write=function(e){var s,l;for(this.flags=0,this.size=12,s=0;s<this.entries.length;s++)l=this.entries[s],this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=l.data.length);for(this.writeHeader(e),e.writeString(this.grouping_type,null,4),this.version===1&&e.writeUint32(this.default_length),this.version>=2&&e.writeUint32(this.default_sample_description_index),e.writeUint32(this.entries.length),s=0;s<this.entries.length;s++)l=this.entries[s],this.version===1&&this.default_length===0&&e.writeUint32(l.description_length),l.write(e)},o.sidxBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+2+2+12*this.references.length,this.writeHeader(e),e.writeUint32(this.reference_ID),e.writeUint32(this.timescale),e.writeUint32(this.earliest_presentation_time),e.writeUint32(this.first_offset),e.writeUint16(0),e.writeUint16(this.references.length);for(var s=0;s<this.references.length;s++){var l=this.references[s];e.writeUint32(l.reference_type<<31|l.referenced_size),e.writeUint32(l.subsegment_duration),e.writeUint32(l.starts_with_SAP<<31|l.SAP_type<<28|l.SAP_delta_time)}},o.smhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=4,this.writeHeader(e),e.writeUint16(this.balance),e.writeUint16(0)},o.stcoBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),e.writeUint32Array(this.chunk_offsets)},o.stscBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(e),e.writeUint32(this.first_chunk.length),s=0;s<this.first_chunk.length;s++)e.writeUint32(this.first_chunk[s]),e.writeUint32(this.samples_per_chunk[s]),e.writeUint32(this.sample_description_index[s])},o.stsdBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(e),e.writeUint32(this.entries.length),this.size+=4,s=0;s<this.entries.length;s++)this.entries[s].write(e),this.size+=this.entries[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.stshBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(e),e.writeUint32(this.shadowed_sample_numbers.length),s=0;s<this.shadowed_sample_numbers.length;s++)e.writeUint32(this.shadowed_sample_numbers[s]),e.writeUint32(this.sync_sample_numbers[s])},o.stssBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(e),e.writeUint32(this.sample_numbers.length),e.writeUint32Array(this.sample_numbers)},o.stszBox.prototype.write=function(e){var s,l=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(s=0;s+1<this.sample_sizes.length;)if(this.sample_sizes[s+1]!==this.sample_sizes[0]){l=!1;break}else s++;else l=!1;this.size=8,l||(this.size+=4*this.sample_sizes.length),this.writeHeader(e),l?e.writeUint32(this.sample_sizes[0]):e.writeUint32(0),e.writeUint32(this.sample_sizes.length),l||e.writeUint32Array(this.sample_sizes)},o.sttsBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)e.writeUint32(this.sample_counts[s]),e.writeUint32(this.sample_deltas[s])},o.tfdtBox.prototype.write=function(e){var s=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>s?1:0,this.flags=0,this.size=4,this.version===1&&(this.size+=4),this.writeHeader(e),this.version===1?e.writeUint64(this.baseMediaDecodeTime):e.writeUint32(this.baseMediaDecodeTime)},o.tfhdBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(e),e.writeUint32(this.track_id),this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&e.writeUint64(this.base_data_offset),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&e.writeUint32(this.default_sample_description_index),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&e.writeUint32(this.default_sample_duration),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&e.writeUint32(this.default_sample_size),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&e.writeUint32(this.default_sample_flags)},o.tkhdBox.prototype.write=function(e){this.version=0,this.size=4*18+2*4,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.track_id),e.writeUint32(0),e.writeUint32(this.duration),e.writeUint32(0),e.writeUint32(0),e.writeInt16(this.layer),e.writeInt16(this.alternate_group),e.writeInt16(this.volume<<8),e.writeUint16(0),e.writeInt32Array(this.matrix),e.writeUint32(this.width),e.writeUint32(this.height)},o.trexBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeUint32(this.track_id),e.writeUint32(this.default_sample_description_index),e.writeUint32(this.default_sample_duration),e.writeUint32(this.default_sample_size),e.writeUint32(this.default_sample_flags)},o.trunBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&o.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&o.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&o.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(e),e.writeUint32(this.sample_count),this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=e.getPosition(),e.writeInt32(this.data_offset)),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&e.writeUint32(this.first_sample_flags);for(var s=0;s<this.sample_count;s++)this.flags&o.TRUN_FLAGS_DURATION&&e.writeUint32(this.sample_duration[s]),this.flags&o.TRUN_FLAGS_SIZE&&e.writeUint32(this.sample_size[s]),this.flags&o.TRUN_FLAGS_FLAGS&&e.writeUint32(this.sample_flags[s]),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?e.writeUint32(this.sample_composition_time_offset[s]):e.writeInt32(this.sample_composition_time_offset[s]))},o["url Box"].prototype.write=function(e){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(e),this.location&&e.writeCString(this.location)},o["urn Box"].prototype.write=function(e){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(e),e.writeCString(this.name),this.location&&e.writeCString(this.location)},o.vmhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=8,this.writeHeader(e),e.writeUint16(this.graphicsmode),e.writeUint16Array(this.opcolor)},o.cttsBox.prototype.unpack=function(e){var s,l,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(l=0;l<this.sample_counts[s];l++)e[f].pts=e[f].dts+this.sample_offsets[s],f++},o.sttsBox.prototype.unpack=function(e){var s,l,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(l=0;l<this.sample_counts[s];l++)f===0?e[f].dts=0:e[f].dts=e[f-1].dts+this.sample_deltas[s],f++},o.stcoBox.prototype.unpack=function(e){var s;for(s=0;s<this.chunk_offsets.length;s++)e[s].offset=this.chunk_offsets[s]},o.stscBox.prototype.unpack=function(e){var s,l,f,c,y;for(c=0,y=0,s=0;s<this.first_chunk.length;s++)for(l=0;l<(s+1<this.first_chunk.length?this.first_chunk[s+1]:1/0);l++)for(y++,f=0;f<this.samples_per_chunk[s];f++){if(e[c])e[c].description_index=this.sample_description_index[s],e[c].chunk_index=y;else return;c++}},o.stszBox.prototype.unpack=function(e){var s;for(s=0;s<this.sample_sizes.length;s++)e[s].size=this.sample_sizes[s]},o.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],o.boxEqualFields=function(e,s){if(e&&!s)return!1;var l;for(l in e)if(!(o.DIFF_BOXES_PROP_NAMES.indexOf(l)>-1)){if(e[l]instanceof o.Box||s[l]instanceof o.Box)continue;if(typeof e[l]=="undefined"||typeof s[l]=="undefined")continue;if(typeof e[l]=="function"||typeof s[l]=="function")continue;if(e.subBoxNames&&e.subBoxNames.indexOf(l.slice(0,4))>-1||s.subBoxNames&&s.subBoxNames.indexOf(l.slice(0,4))>-1)continue;if(l==="data"||l==="start"||l==="size"||l==="creation_time"||l==="modification_time")continue;if(o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(l)>-1)continue;if(e[l]!==s[l])return!1}return!0},o.boxEqual=function(e,s){if(!o.boxEqualFields(e,s))return!1;for(var l=0;l<o.DIFF_BOXES_PROP_NAMES.length;l++){var f=o.DIFF_BOXES_PROP_NAMES[l];if(e[f]&&s[f]&&!o.boxEqual(e[f],s[f]))return!1}return!0};var d=function(){};d.prototype.parseSample=function(e){var s={},l;s.resources=[];var f=new t(e.data.buffer);if(!e.subsamples||e.subsamples.length===0)s.documentString=f.readString(e.data.length);else if(s.documentString=f.readString(e.subsamples[0].size),e.subsamples.length>1)for(l=1;l<e.subsamples.length;l++)s.resources[l]=f.readUint8Array(e.subsamples[l].size);return typeof DOMParser!="undefined"&&(s.document=new DOMParser().parseFromString(s.documentString,"application/xml")),s};var g=function(){};g.prototype.parseSample=function(e){var s,l=new t(e.data.buffer);return s=l.readString(e.data.length),s},g.prototype.parseConfig=function(e){var s,l=new t(e.buffer);return l.readUint32(),s=l.readCString(),s},h.XMLSubtitlein4Parser=d,h.Textin4Parser=g;var v=function(e){this.stream=e||new n,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.onSidx=null,this.sidxSent=!1};v.prototype.setSegmentOptions=function(e,s,l){var f=this.getTrackById(e);if(f){var c={};this.fragmentedTracks.push(c),c.id=e,c.user=s,c.trak=f,f.nextSample=0,c.segmentStream=null,c.nb_samples=1e3,c.rapAlignement=!0,l&&(l.nbSamples&&(c.nb_samples=l.nbSamples),l.rapAlignement&&(c.rapAlignement=l.rapAlignement))}},v.prototype.unsetSegmentOptions=function(e){for(var s=-1,l=0;l<this.fragmentedTracks.length;l++){var f=this.fragmentedTracks[l];f.id==e&&(s=l)}s>-1&&this.fragmentedTracks.splice(s,1)},v.prototype.setExtractionOptions=function(e,s,l){var f=this.getTrackById(e);if(f){var c={};this.extractedTracks.push(c),c.id=e,c.user=s,c.trak=f,f.nextSample=0,c.nb_samples=1e3,c.samples=[],l&&l.nbSamples&&(c.nb_samples=l.nbSamples)}},v.prototype.unsetExtractionOptions=function(e){for(var s=-1,l=0;l<this.extractedTracks.length;l++){var f=this.extractedTracks[l];f.id==e&&(s=l)}s>-1&&this.extractedTracks.splice(s,1)},v.prototype.parse=function(){var e,s,l=!1;if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else if(this.saveParsePosition&&this.saveParsePosition(),e=o.parseOneBox(this.stream,l),e.code===o.ERR_NOT_ENOUGH_DATA)if(this.processIncompleteBox){if(this.processIncompleteBox(e))continue;return}else return;else{var f;switch(s=e.box,f=s.type!=="uuid"?s.type:s.uuid,this.boxes.push(s),f){case"mdat":this.mdats.push(s);break;case"moof":this.moofs.push(s);break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[f]!==void 0&&a.warn("ISOFile","Duplicate Box of type: "+f+", overriding previous occurrence"),this[f]=s;break}this.updateUsedBytes&&this.updateUsedBytes(s,e)}},v.prototype.checkBuffer=function(e){if(e==null)throw"Buffer must be defined and non empty";if(e.fileStart===void 0)throw"Buffer must have a fileStart property";return e.byteLength===0?(a.warn("ISOFile","Ignoring empty buffer (fileStart: "+e.fileStart+")"),this.stream.logBufferLevel(),!1):(a.info("ISOFile","Processing buffer (fileStart: "+e.fileStart+")"),e.usedBytes=0,this.stream.insertBuffer(e),this.stream.logBufferLevel(),this.stream.initialized()?!0:(a.warn("ISOFile","Not ready to start parsing"),!1))},v.prototype.appendBuffer=function(e,s){var l;if(!!this.checkBuffer(e))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(s),this.nextSeekPosition?(l=this.nextSeekPosition,this.nextSeekPosition=void 0):l=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(l=this.stream.getEndFilePositionAfter(l))):this.nextParsePosition?l=this.nextParsePosition:l=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(a.info("ISOFile","Done processing buffer (fileStart: "+e.fileStart+") - next buffer to fetch should have a fileStart position of "+l),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),a.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),l},v.prototype.getInfo=function(){var e,s,l={},f,c,y,m,_=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(l.hasMoov=!0,l.duration=this.moov.mvhd.duration,l.timescale=this.moov.mvhd.timescale,l.isFragmented=this.moov.mvex!=null,l.isFragmented&&this.moov.mvex.mehd&&(l.fragment_duration=this.moov.mvex.mehd.fragment_duration),l.isProgressive=this.isProgressive,l.hasIOD=this.moov.iods!=null,l.brands=[],l.brands.push(this.ftyp.major_brand),l.brands=l.brands.concat(this.ftyp.compatible_brands),l.created=new Date(_+this.moov.mvhd.creation_time*1e3),l.modified=new Date(_+this.moov.mvhd.modification_time*1e3),l.tracks=[],l.audioTracks=[],l.videoTracks=[],l.subtitleTracks=[],l.metadataTracks=[],l.hintTracks=[],l.otherTracks=[],e=0;e<this.moov.traks.length;e++){if(f=this.moov.traks[e],m=f.mdia.minf.stbl.stsd.entries[0],c={},l.tracks.push(c),c.id=f.tkhd.track_id,c.name=f.mdia.hdlr.name,c.references=[],f.tref)for(s=0;s<f.tref.boxes.length;s++)y={},c.references.push(y),y.type=f.tref.boxes[s].type,y.track_ids=f.tref.boxes[s].track_ids;f.edts&&(c.edits=f.edts.elst.entries),c.created=new Date(_+f.tkhd.creation_time*1e3),c.modified=new Date(_+f.tkhd.modification_time*1e3),c.movie_duration=f.tkhd.duration,c.movie_timescale=l.timescale,c.layer=f.tkhd.layer,c.alternate_group=f.tkhd.alternate_group,c.volume=f.tkhd.volume,c.matrix=f.tkhd.matrix,c.track_width=f.tkhd.width/(1<<16),c.track_height=f.tkhd.height/(1<<16),c.timescale=f.mdia.mdhd.timescale,c.cts_shift=f.mdia.minf.stbl.cslg,c.duration=f.mdia.mdhd.duration,c.samples_duration=f.samples_duration,c.codec=m.getCodec(),c.kind=f.udta&&f.udta.kinds.length?f.udta.kinds[0]:{schemeURI:"",value:""},c.language=f.mdia.elng?f.mdia.elng.extended_language:f.mdia.mdhd.languageString,c.nb_samples=f.samples.length,c.size=f.samples_size,c.bitrate=c.size*8*c.timescale/c.samples_duration,m.isAudio()?(c.type="audio",l.audioTracks.push(c),c.audio={},c.audio.sample_rate=m.getSampleRate(),c.audio.channel_count=m.getChannelCount(),c.audio.sample_size=m.getSampleSize()):m.isVideo()?(c.type="video",l.videoTracks.push(c),c.video={},c.video.width=m.getWidth(),c.video.height=m.getHeight()):m.isSubtitle()?(c.type="subtitles",l.subtitleTracks.push(c)):m.isHint()?(c.type="metadata",l.hintTracks.push(c)):m.isMetadata()?(c.type="metadata",l.metadataTracks.push(c)):(c.type="metadata",l.otherTracks.push(c))}else l.hasMoov=!1;if(l.mime="",l.hasMoov&&l.tracks){for(l.videoTracks&&l.videoTracks.length>0?l.mime+='video/mp4; codecs="':l.audioTracks&&l.audioTracks.length>0?l.mime+='audio/mp4; codecs="':l.mime+='application/mp4; codecs="',e=0;e<l.tracks.length;e++)e!==0&&(l.mime+=","),l.mime+=l.tracks[e].codec;l.mime+='"; profiles="',l.mime+=this.ftyp.compatible_brands.join(),l.mime+='"'}return l},v.prototype.processSamples=function(e){var s,l;if(!!this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==null)for(s=0;s<this.fragmentedTracks.length;s++){var f=this.fragmentedTracks[s];for(l=f.trak;l.nextSample<l.samples.length&&this.sampleProcessingStarted;){a.debug("ISOFile","Creating media fragment on track #"+f.id+" for sample "+l.nextSample);var c=this.createFragment(f.id,l.nextSample,f.segmentStream);if(c)f.segmentStream=c,l.nextSample++;else break;if((l.nextSample%f.nb_samples==0||e||l.nextSample>=l.samples.length)&&(a.info("ISOFile","Sending fragmented data on track #"+f.id+" for samples ["+Math.max(0,l.nextSample-f.nb_samples)+","+(l.nextSample-1)+"]"),a.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(f.id,f.user,f.segmentStream.buffer,l.nextSample,e||l.nextSample>=l.samples.length),f.segmentStream=null,f!==this.fragmentedTracks[s]))break}}if(this.onSamples!==null)for(s=0;s<this.extractedTracks.length;s++){var y=this.extractedTracks[s];for(l=y.trak;l.nextSample<l.samples.length&&this.sampleProcessingStarted;){a.debug("ISOFile","Exporting on track #"+y.id+" sample #"+l.nextSample);var m=this.getSample(l,l.nextSample);if(m)l.nextSample++,y.samples.push(m);else break;if((l.nextSample%y.nb_samples==0||l.nextSample>=l.samples.length)&&(a.debug("ISOFile","Sending samples on track #"+y.id+" for sample "+l.nextSample),this.onSamples&&this.onSamples(y.id,y.user,y.samples),y.samples=[],y!==this.extractedTracks[s]))break}}}},v.prototype.getBox=function(e){var s=this.getBoxes(e,!0);return s.length?s[0]:null},v.prototype.getBoxes=function(e,s){var l=[];return v._sweep.call(this,e,l,s),l},v._sweep=function(e,s,l){this.type&&this.type==e&&s.push(this);for(var f in this.boxes){if(s.length&&l)return;v._sweep.call(this.boxes[f],e,s,l)}},v.prototype.getTrackSamplesInfo=function(e){var s=this.getTrackById(e);if(s)return s.samples},v.prototype.getTrackSample=function(e,s){var l=this.getTrackById(e),f=this.getSample(l,s);return f},v.prototype.releaseUsedSamples=function(e,s){var l=0,f=this.getTrackById(e);f.lastValidSample||(f.lastValidSample=0);for(var c=f.lastValidSample;c<s;c++)l+=this.releaseSample(f,c);a.info("ISOFile","Track #"+e+" released samples up to "+s+" (released size: "+l+", remaining: "+this.samplesDataSize+")"),f.lastValidSample=s},v.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},v.prototype.stop=function(){this.sampleProcessingStarted=!1},v.prototype.flush=function(){a.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},v.prototype.seekTrack=function(e,s,l){var f,c,y=1/0,m=0,_=0,E;if(l.samples.length===0)return a.info("ISOFile","No sample in track, cannot seek! Using time "+a.getDurationString(0,1)+" and offset: "+0),{offset:0,time:0};for(f=0;f<l.samples.length;f++){if(c=l.samples[f],f===0)_=0,E=c.timescale;else if(c.cts>e*c.timescale){_=f-1;break}s&&c.is_sync&&(m=f)}for(s&&(_=m),e=l.samples[_].cts,l.nextSample=_;l.samples[_].alreadyRead===l.samples[_].size&&l.samples[_+1];)_++;return y=l.samples[_].offset+l.samples[_].alreadyRead,a.info("ISOFile","Seeking to "+(s?"RAP":"")+" sample #"+l.nextSample+" on track "+l.tkhd.track_id+", time "+a.getDurationString(e,E)+" and offset: "+y),{offset:y,time:e/E}},v.prototype.seek=function(e,s){var l=this.moov,f,c,y,m={offset:1/0,time:1/0};if(this.moov){for(y=0;y<l.traks.length;y++)f=l.traks[y],c=this.seekTrack(e,s,f),c.offset<m.offset&&(m.offset=c.offset),c.time<m.time&&(m.time=c.time);return a.info("ISOFile","Seeking at time "+a.getDurationString(m.time,1)+" needs a buffer with a fileStart position of "+m.offset),m.offset===1/0?m={offset:this.nextParsePosition,time:0}:m.offset=this.stream.getEndFilePositionAfter(m.offset),a.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+m.offset),m}else throw"Cannot seek: moov not received!"},v.prototype.equal=function(e){for(var s=0;s<this.boxes.length&&s<e.boxes.length;){var l=this.boxes[s],f=e.boxes[s];if(!o.boxEqual(l,f))return!1;s++}return!0},h.ISOFile=v,v.prototype.lastBoxStartPosition=0,v.prototype.parsingMdat=null,v.prototype.nextParsePosition=0,v.prototype.discardMdatData=!1,v.prototype.processIncompleteBox=function(e){var s,l,f;return e.type==="mdat"?(s=new o[e.type+"Box"](e.size),this.parsingMdat=s,this.boxes.push(s),this.mdats.push(s),s.start=e.start,s.hdr_size=e.hdr_size,this.stream.addUsedBytes(s.hdr_size),this.lastBoxStartPosition=s.start+s.size,f=this.stream.seek(s.start+s.size,!1,this.discardMdatData),f?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=s.start+s.size,!1)):(e.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),l=this.stream.mergeNextBuffer?this.stream.mergeNextBuffer():!1,l?(this.nextParsePosition=this.stream.getEndPosition(),!0):(e.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+e.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},v.prototype.hasIncompleteMdat=function(){return this.parsingMdat!==null},v.prototype.processIncompleteMdat=function(){var e,s;return e=this.parsingMdat,s=this.stream.seek(e.start+e.size,!1,this.discardMdatData),s?(a.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},v.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},v.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},v.prototype.updateUsedBytes=function(e,s){this.stream.addUsedBytes&&(e.type==="mdat"?(this.stream.addUsedBytes(e.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(e.size-e.hdr_size)):this.stream.addUsedBytes(e.size))},v.prototype.add=o.Box.prototype.add,v.prototype.addBox=o.Box.prototype.addBox,v.prototype.init=function(e){var s=e||{};this.add("ftyp").set("major_brand",s.brands&&s.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",s.brands||["iso4"]);var l=this.add("moov");return l.add("mvhd").set("timescale",s.timescale||600).set("rate",s.rate||1<<16).set("creation_time",0).set("modification_time",0).set("duration",s.duration||0).set("volume",s.width?0:256).set("matrix",[1<<16,0,0,0,1<<16,0,0,0,1073741824]).set("next_track_id",1),l.add("mvex"),this},v.prototype.addTrack=function(e){this.moov||this.init(e);var s=e||{};s.width=s.width||320,s.height=s.height||320,s.id=s.id||this.moov.mvhd.next_track_id,s.type=s.type||"avc1";var l=this.moov.add("trak");this.moov.mvhd.next_track_id=s.id+1,l.add("tkhd").set("flags",o.TKHD_FLAG_ENABLED|o.TKHD_FLAG_IN_MOVIE|o.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",s.id).set("duration",s.duration||0).set("layer",s.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[0,0,0,0,0,0,0,0,0]).set("width",s.width<<16).set("height",s.height<<16);var f=l.add("mdia");f.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",s.timescale||1).set("duration",s.media_duration||0).set("language",s.language||"und"),f.add("hdlr").set("handler",s.hdlr||"vide").set("name",s.name||"Track created with MP4Box.js"),f.add("elng").set("extended_language",s.language||"fr-FR");var c=f.add("minf");if(o[s.type+"SampleEntry"]!==void 0){var y=new o[s.type+"SampleEntry"];y.data_reference_index=1;var m="";for(var _ in o.sampleEntryCodes)for(var E=o.sampleEntryCodes[_],w=0;w<E.length;w++)if(E.indexOf(s.type)>-1){m=_;break}switch(m){case"Visual":if(c.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),y.set("width",s.width).set("height",s.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",s.type+" Compressor").set("depth",24),s.avcDecoderConfigRecord){var k=new o.avcCBox,x=new t(s.avcDecoderConfigRecord);k.parse(x),y.addBox(k)}break;case"Audio":c.add("smhd").set("balance",s.balance||0),y.set("channel_count",s.channel_count||2).set("samplesize",s.samplesize||16).set("samplerate",s.samplerate||1<<16);break;case"Hint":c.add("hmhd");break;case"Subtitle":switch(c.add("sthd"),s.type){case"stpp":y.set("namespace",s.namespace||"nonamespace").set("schema_location",s.schema_location||"").set("auxiliary_mime_types",s.auxiliary_mime_types||"");break}break;case"Metadata":c.add("nmhd");break;case"System":c.add("nmhd");break;default:c.add("nmhd");break}s.description&&y.addBox(s.description),s.description_boxes&&s.description_boxes.forEach(function(B){y.addBox(B)}),c.add("dinf").add("dref").addEntry(new o["url Box"]().set("flags",1));var S=c.add("stbl");return S.add("stsd").addEntry(y),S.add("stts").set("sample_counts",[]).set("sample_deltas",[]),S.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),S.add("stco").set("chunk_offsets",[]),S.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",s.id).set("default_sample_description_index",s.default_sample_description_index||1).set("default_sample_duration",s.default_sample_duration||0).set("default_sample_size",s.default_sample_size||0).set("default_sample_flags",s.default_sample_flags||0),this.buildTrakSampleLists(l),s.id}},o.Box.prototype.computeSize=function(e){var s=e||new i;s.endianness=i.BIG_ENDIAN,this.write(s)},v.prototype.addSample=function(e,s,l){var f=l||{},c={},y=this.getTrackById(e);if(y!==null){c.number=y.samples.length,c.track_id=y.tkhd.track_id,c.timescale=y.mdia.mdhd.timescale,c.description_index=f.sample_description_index?f.sample_description_index-1:0,c.description=y.mdia.minf.stbl.stsd.entries[c.description_index],c.data=s,c.size=s.byteLength,c.alreadyRead=c.size,c.duration=f.duration||1,c.cts=f.cts||0,c.dts=f.dts||0,c.is_sync=f.is_sync||!1,c.is_leading=f.is_leading||0,c.depends_on=f.depends_on||0,c.is_depended_on=f.is_depended_on||0,c.has_redundancy=f.has_redundancy||0,c.degradation_priority=f.degradation_priority||0,c.offset=0,c.subsamples=f.subsamples,y.samples.push(c),y.samples_size+=c.size,y.samples_duration+=c.duration,y.first_dts||(y.first_dts=f.dts),this.processSamples();var m=this.createSingleSampleMoof(c);return this.addBox(m),m.computeSize(),m.trafs[0].truns[0].data_offset=m.size+8,this.add("mdat").data=new Uint8Array(s),c}},v.prototype.createSingleSampleMoof=function(e){var s=0;e.is_sync?s=1<<25:s=1<<16;var l=new o.moofBox;l.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var f=l.add("traf"),c=this.getTrackById(e.track_id);return f.add("tfhd").set("track_id",e.track_id).set("flags",o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),f.add("tfdt").set("baseMediaDecodeTime",e.dts-(c.first_dts||0)),f.add("trun").set("flags",o.TRUN_FLAGS_DATA_OFFSET|o.TRUN_FLAGS_DURATION|o.TRUN_FLAGS_SIZE|o.TRUN_FLAGS_FLAGS|o.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[e.duration]).set("sample_size",[e.size]).set("sample_flags",[s]).set("sample_composition_time_offset",[e.cts-e.dts]),l},v.prototype.lastMoofIndex=0,v.prototype.samplesDataSize=0,v.prototype.resetTables=function(){var e,s,l,f,c,y,m,_;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,e=0;e<this.moov.traks.length;e++){s=this.moov.traks[e],s.tkhd.duration=0,s.mdia.mdhd.duration=0,l=s.mdia.minf.stbl.stco||s.mdia.minf.stbl.co64,l.chunk_offsets=[],f=s.mdia.minf.stbl.stsc,f.first_chunk=[],f.samples_per_chunk=[],f.sample_description_index=[],c=s.mdia.minf.stbl.stsz||s.mdia.minf.stbl.stz2,c.sample_sizes=[],y=s.mdia.minf.stbl.stts,y.sample_counts=[],y.sample_deltas=[],m=s.mdia.minf.stbl.ctts,m&&(m.sample_counts=[],m.sample_offsets=[]),_=s.mdia.minf.stbl.stss;var E=s.mdia.minf.stbl.boxes.indexOf(_);E!=-1&&(s.mdia.minf.stbl.boxes[E]=null)}},v.initSampleGroups=function(e,s,l,f,c){var y,m,_,E;function w(k,x,S){this.grouping_type=k,this.grouping_type_parameter=x,this.sbgp=S,this.last_sample_in_run=-1,this.entry_index=-1}for(s&&(s.sample_groups_info=[]),e.sample_groups_info||(e.sample_groups_info=[]),m=0;m<l.length;m++){for(E=l[m].grouping_type+"/"+l[m].grouping_type_parameter,_=new w(l[m].grouping_type,l[m].grouping_type_parameter,l[m]),s&&(s.sample_groups_info[E]=_),e.sample_groups_info[E]||(e.sample_groups_info[E]=_),y=0;y<f.length;y++)f[y].grouping_type===l[m].grouping_type&&(_.description=f[y],_.description.used=!0);if(c)for(y=0;y<c.length;y++)c[y].grouping_type===l[m].grouping_type&&(_.fragment_description=c[y],_.fragment_description.used=!0,_.is_fragment=!0)}if(s){if(c)for(m=0;m<c.length;m++)!c[m].used&&c[m].version>=2&&(E=c[m].grouping_type+"/0",_=new w(c[m].grouping_type,0),_.is_fragment=!0,s.sample_groups_info[E]||(s.sample_groups_info[E]=_))}else for(m=0;m<f.length;m++)!f[m].used&&f[m].version>=2&&(E=f[m].grouping_type+"/0",_=new w(f[m].grouping_type,0),e.sample_groups_info[E]||(e.sample_groups_info[E]=_))},v.setSampleGroupProperties=function(e,s,l,f){var c,y;s.sample_groups=[];for(c in f)if(s.sample_groups[c]={},s.sample_groups[c].grouping_type=f[c].grouping_type,s.sample_groups[c].grouping_type_parameter=f[c].grouping_type_parameter,l>=f[c].last_sample_in_run&&(f[c].last_sample_in_run<0&&(f[c].last_sample_in_run=0),f[c].entry_index++,f[c].entry_index<=f[c].sbgp.entries.length-1&&(f[c].last_sample_in_run+=f[c].sbgp.entries[f[c].entry_index].sample_count)),f[c].entry_index<=f[c].sbgp.entries.length-1?s.sample_groups[c].group_description_index=f[c].sbgp.entries[f[c].entry_index].group_description_index:s.sample_groups[c].group_description_index=-1,s.sample_groups[c].group_description_index!==0){var m;f[c].fragment_description?m=f[c].fragment_description:m=f[c].description,s.sample_groups[c].group_description_index>0?(s.sample_groups[c].group_description_index>65535?y=(s.sample_groups[c].group_description_index>>16)-1:y=s.sample_groups[c].group_description_index-1,m&&y>=0&&(s.sample_groups[c].description=m.entries[y])):m&&m.version>=2&&m.default_group_description_index>0&&(s.sample_groups[c].description=m.entries[m.default_group_description_index-1])}},v.process_sdtp=function(e,s,l){!s||(e?(s.is_leading=e.is_leading[l],s.depends_on=e.sample_depends_on[l],s.is_depended_on=e.sample_is_depended_on[l],s.has_redundancy=e.sample_has_redundancy[l]):(s.is_leading=0,s.depends_on=0,s.is_depended_on=0,s.has_redundancy=0))},v.prototype.buildSampleLists=function(){var e,s;for(e=0;e<this.moov.traks.length;e++)s=this.moov.traks[e],this.buildTrakSampleLists(s)},v.prototype.buildTrakSampleLists=function(e){var s,l,f,c,y,m,_,E,w,k,x,S,B,U,R,C,A,b,O,W,K,G,F,j;if(e.samples=[],e.samples_duration=0,e.samples_size=0,l=e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64,f=e.mdia.minf.stbl.stsc,c=e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2,y=e.mdia.minf.stbl.stts,m=e.mdia.minf.stbl.ctts,_=e.mdia.minf.stbl.stss,E=e.mdia.minf.stbl.stsd,w=e.mdia.minf.stbl.subs,S=e.mdia.minf.stbl.stdp,k=e.mdia.minf.stbl.sbgps,x=e.mdia.minf.stbl.sgpds,b=-1,O=-1,W=-1,K=-1,G=0,F=0,j=0,v.initSampleGroups(e,null,k,x),typeof c!="undefined"){for(s=0;s<c.sample_sizes.length;s++){var N={};N.number=s,N.track_id=e.tkhd.track_id,N.timescale=e.mdia.mdhd.timescale,N.alreadyRead=0,e.samples[s]=N,N.size=c.sample_sizes[s],e.samples_size+=N.size,s===0?(U=1,B=0,N.chunk_index=U,N.chunk_run_index=B,A=f.samples_per_chunk[B],C=0,B+1<f.first_chunk.length?R=f.first_chunk[B+1]-1:R=1/0):s<A?(N.chunk_index=U,N.chunk_run_index=B):(U++,N.chunk_index=U,C=0,U<=R||(B++,B+1<f.first_chunk.length?R=f.first_chunk[B+1]-1:R=1/0),N.chunk_run_index=B,A+=f.samples_per_chunk[B]),N.description_index=f.sample_description_index[N.chunk_run_index]-1,N.description=E.entries[N.description_index],N.offset=l.chunk_offsets[N.chunk_index-1]+C,C+=N.size,s>b&&(O++,b<0&&(b=0),b+=y.sample_counts[O]),s>0?(e.samples[s-1].duration=y.sample_deltas[O],e.samples_duration+=e.samples[s-1].duration,N.dts=e.samples[s-1].dts+e.samples[s-1].duration):N.dts=0,m?(s>=W&&(K++,W<0&&(W=0),W+=m.sample_counts[K]),N.cts=e.samples[s].dts+m.sample_offsets[K]):N.cts=N.dts,_?(s==_.sample_numbers[G]-1?(N.is_sync=!0,G++):(N.is_sync=!1,N.degradation_priority=0),w&&w.entries[F].sample_delta+j==s+1&&(N.subsamples=w.entries[F].subsamples,j+=w.entries[F].sample_delta,F++)):N.is_sync=!0,v.process_sdtp(e.mdia.minf.stbl.sdtp,N,N.number),S?N.degradation_priority=S.priority[s]:N.degradation_priority=0,w&&w.entries[F].sample_delta+j==s&&(N.subsamples=w.entries[F].subsamples,j+=w.entries[F].sample_delta),(k.length>0||x.length>0)&&v.setSampleGroupProperties(e,N,s,e.sample_groups_info)}s>0&&(e.samples[s-1].duration=Math.max(e.mdia.mdhd.duration-e.samples[s-1].dts,0),e.samples_duration+=e.samples[s-1].duration)}},v.prototype.updateSampleLists=function(){var e,s,l,f,c,y,m,_,E,w,k,x,S,B,U;if(this.moov!==void 0){for(;this.lastMoofIndex<this.moofs.length;)if(E=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,E.type=="moof")for(w=E,e=0;e<w.trafs.length;e++){for(k=w.trafs[e],x=this.getTrackById(k.tfhd.track_id),S=this.getTrexById(k.tfhd.track_id),k.tfhd.flags&o.TFHD_FLAG_SAMPLE_DESC?f=k.tfhd.default_sample_description_index:f=S?S.default_sample_description_index:1,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_DUR?c=k.tfhd.default_sample_duration:c=S?S.default_sample_duration:0,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_SIZE?y=k.tfhd.default_sample_size:y=S?S.default_sample_size:0,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_FLAGS?m=k.tfhd.default_sample_flags:m=S?S.default_sample_flags:0,k.sample_number=0,k.sbgps.length>0&&v.initSampleGroups(x,k,k.sbgps,x.mdia.minf.stbl.sgpds,k.sgpds),s=0;s<k.truns.length;s++){var R=k.truns[s];for(l=0;l<R.sample_count;l++){B={},B.moof_number=this.lastMoofIndex,B.number_in_traf=k.sample_number,k.sample_number++,B.number=x.samples.length,k.first_sample_index=x.samples.length,x.samples.push(B),B.track_id=x.tkhd.track_id,B.timescale=x.mdia.mdhd.timescale,B.description_index=f-1,B.description=x.mdia.minf.stbl.stsd.entries[B.description_index],B.size=y,R.flags&o.TRUN_FLAGS_SIZE&&(B.size=R.sample_size[l]),x.samples_size+=B.size,B.duration=c,R.flags&o.TRUN_FLAGS_DURATION&&(B.duration=R.sample_duration[l]),x.samples_duration+=B.duration,x.first_traf_merged||l>0?B.dts=x.samples[x.samples.length-2].dts+x.samples[x.samples.length-2].duration:(k.tfdt?B.dts=k.tfdt.baseMediaDecodeTime:B.dts=0,x.first_traf_merged=!0),B.cts=B.dts,R.flags&o.TRUN_FLAGS_CTS_OFFSET&&(B.cts=B.dts+R.sample_composition_time_offset[l]),U=m,R.flags&o.TRUN_FLAGS_FLAGS?U=R.sample_flags[l]:l===0&&R.flags&o.TRUN_FLAGS_FIRST_FLAG&&(U=R.first_sample_flags),B.is_sync=!(U>>16&1),B.is_leading=U>>26&3,B.depends_on=U>>24&3,B.is_depended_on=U>>22&3,B.has_redundancy=U>>20&3,B.degradation_priority=U&65535;var C=!!(k.tfhd.flags&o.TFHD_FLAG_BASE_DATA_OFFSET),A=!!(k.tfhd.flags&o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),b=!!(R.flags&o.TRUN_FLAGS_DATA_OFFSET),O=0;C?O=k.tfhd.base_data_offset:A||s===0?O=w.start:O=_,s===0&&l===0?b?B.offset=O+R.data_offset:B.offset=O:B.offset=_,_=B.offset+B.size,(k.sbgps.length>0||k.sgpds.length>0||x.mdia.minf.stbl.sbgps.length>0||x.mdia.minf.stbl.sgpds.length>0)&&v.setSampleGroupProperties(x,B,B.number_in_traf,k.sample_groups_info)}}if(k.subs){x.has_fragment_subsamples=!0;var W=k.first_sample_index;for(s=0;s<k.subs.entries.length;s++)W+=k.subs.entries[s].sample_delta,B=x.samples[W-1],B.subsamples=k.subs.entries[s].subsamples}}}},v.prototype.getSample=function(e,s){var l,f=e.samples[s];if(!this.moov)return null;if(!f.data)f.data=new Uint8Array(f.size),f.alreadyRead=0,this.samplesDataSize+=f.size,a.debug("ISOFile","Allocating sample #"+s+" on track #"+e.tkhd.track_id+" of size "+f.size+" (total: "+this.samplesDataSize+")");else if(f.alreadyRead==f.size)return f;for(;;){var c=this.stream.findPosition(!0,f.offset+f.alreadyRead,!1);if(c>-1){l=this.stream.buffers[c];var y=l.byteLength-(f.offset+f.alreadyRead-l.fileStart);if(f.size-f.alreadyRead<=y)return a.debug("ISOFile","Getting sample #"+s+" data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-l.fileStart)+" read size: "+(f.size-f.alreadyRead)+" full size: "+f.size+")"),i.memcpy(f.data.buffer,f.alreadyRead,l,f.offset+f.alreadyRead-l.fileStart,f.size-f.alreadyRead),l.usedBytes+=f.size-f.alreadyRead,this.stream.logBufferLevel(),f.alreadyRead=f.size,f;if(y===0)return null;a.debug("ISOFile","Getting sample #"+s+" partial data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-l.fileStart)+" read size: "+y+" full size: "+f.size+")"),i.memcpy(f.data.buffer,f.alreadyRead,l,f.offset+f.alreadyRead-l.fileStart,y),f.alreadyRead+=y,l.usedBytes+=y,this.stream.logBufferLevel()}else return null}},v.prototype.releaseSample=function(e,s){var l=e.samples[s];return l.data?(this.samplesDataSize-=l.size,l.data=null,l.alreadyRead=0,l.size):0},v.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},v.prototype.getCodecs=function(){var e,s="";for(e=0;e<this.moov.traks.length;e++){var l=this.moov.traks[e];e>0&&(s+=","),s+=l.mdia.minf.stbl.stsd.entries[0].getCodec()}return s},v.prototype.getTrexById=function(e){var s;if(!this.moov||!this.moov.mvex)return null;for(s=0;s<this.moov.mvex.trexs.length;s++){var l=this.moov.mvex.trexs[s];if(l.track_id==e)return l}return null},v.prototype.getTrackById=function(e){if(this.moov===void 0)return null;for(var s=0;s<this.moov.traks.length;s++){var l=this.moov.traks[s];if(l.tkhd.track_id==e)return l}return null},v.prototype.items=[],v.prototype.itemsDataSize=0,v.prototype.flattenItemInfo=function(){var e=this.items,s,l,f,c=this.meta;if(c!=null&&c.hdlr!==void 0&&c.iinf!==void 0){for(s=0;s<c.iinf.item_infos.length;s++)f={},f.id=c.iinf.item_infos[s].item_ID,e[f.id]=f,f.ref_to=[],f.name=c.iinf.item_infos[s].item_name,c.iinf.item_infos[s].protection_index>0&&(f.protection=c.ipro.protections[c.iinf.item_infos[s].protection_index-1]),c.iinf.item_infos[s].item_type?f.type=c.iinf.item_infos[s].item_type:f.type="mime",f.content_type=c.iinf.item_infos[s].content_type,f.content_encoding=c.iinf.item_infos[s].content_encoding;if(c.iloc)for(s=0;s<c.iloc.items.length;s++){var y=c.iloc.items[s];switch(f=e[y.item_ID],y.data_reference_index!==0&&(a.warn("Item storage with reference to other files: not supported"),f.source=c.dinf.boxes[y.data_reference_index-1]),y.construction_method){case 0:break;case 1:a.warn("Item storage with construction_method : not supported");break;case 2:a.warn("Item storage with construction_method : not supported");break}for(f.extents=[],f.size=0,l=0;l<y.extents.length;l++)f.extents[l]={},f.extents[l].offset=y.extents[l].extent_offset+y.base_offset,f.extents[l].length=y.extents[l].extent_length,f.extents[l].alreadyRead=0,f.size+=f.extents[l].length}if(c.pitm&&(e[c.pitm.item_id].primary=!0),c.iref)for(s=0;s<c.iref.references.length;s++){var m=c.iref.references[s];for(l=0;l<m.references.length;l++)e[m.from_item_ID].ref_to.push({type:m.type,id:m.references[l]})}if(c.iprp)for(var _=0;_<c.iprp.ipmas.length;_++){var E=c.iprp.ipmas[_];for(s=0;s<E.associations.length;s++){var w=E.associations[s];for(f=e[w.id],f.properties===void 0&&(f.properties={},f.properties.boxes=[]),l=0;l<w.props.length;l++){var k=w.props[l];if(k.property_index>0&&k.property_index-1<c.iprp.ipco.boxes.length){var x=c.iprp.ipco.boxes[k.property_index-1];f.properties[x.type]=x,f.properties.boxes.push(x)}}}}}},v.prototype.getItem=function(e){var s,l;if(!this.meta)return null;if(l=this.items[e],!l.data&&l.size)l.data=new Uint8Array(l.size),l.alreadyRead=0,this.itemsDataSize+=l.size,a.debug("ISOFile","Allocating item #"+e+" of size "+l.size+" (total: "+this.itemsDataSize+")");else if(l.alreadyRead===l.size)return l;for(var f=0;f<l.extents.length;f++){var c=l.extents[f];if(c.alreadyRead!==c.length){var y=this.stream.findPosition(!0,c.offset+c.alreadyRead,!1);if(y>-1){s=this.stream.buffers[y];var m=s.byteLength-(c.offset+c.alreadyRead-s.fileStart);if(c.length-c.alreadyRead<=m)a.debug("ISOFile","Getting item #"+e+" extent #"+f+" data (alreadyRead: "+c.alreadyRead+" offset: "+(c.offset+c.alreadyRead-s.fileStart)+" read size: "+(c.length-c.alreadyRead)+" full extent size: "+c.length+" full item size: "+l.size+")"),i.memcpy(l.data.buffer,l.alreadyRead,s,c.offset+c.alreadyRead-s.fileStart,c.length-c.alreadyRead),s.usedBytes+=c.length-c.alreadyRead,this.stream.logBufferLevel(),l.alreadyRead+=c.length-c.alreadyRead,c.alreadyRead=c.length;else return a.debug("ISOFile","Getting item #"+e+" extent #"+f+" partial data (alreadyRead: "+c.alreadyRead+" offset: "+(c.offset+c.alreadyRead-s.fileStart)+" read size: "+m+" full extent size: "+c.length+" full item size: "+l.size+")"),i.memcpy(l.data.buffer,l.alreadyRead,s,c.offset+c.alreadyRead-s.fileStart,m),c.alreadyRead+=m,l.alreadyRead+=m,s.usedBytes+=m,this.stream.logBufferLevel(),null}else return null}}return l.alreadyRead===l.size?l:null},v.prototype.releaseItem=function(e){var s=this.items[e];if(s.data){this.itemsDataSize-=s.size,s.data=null,s.alreadyRead=0;for(var l=0;l<s.extents.length;l++){var f=s.extents[l];f.alreadyRead=0}return s.size}else return 0},v.prototype.processItems=function(e){for(var s in this.items){var l=this.items[s];this.getItem(l.id),e&&!l.sent&&(e(l),l.sent=!0,l.data=null)}},v.prototype.hasItem=function(e){for(var s in this.items){var l=this.items[s];if(l.name===e)return l.id}return-1},v.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},v.prototype.getPrimaryItem=function(){return!this.meta||!this.meta.pitm?null:this.getItem(this.meta.pitm.item_id)},v.prototype.itemToFragmentedTrackFile=function(e){var s=e||{},l=null;if(s.itemId?l=this.getItem(s.itemId):l=this.getPrimaryItem(),l==null)return null;var f=new v;f.discardMdatData=!1;var c={type:l.type,description_boxes:l.properties.boxes};l.properties.ispe&&(c.width=l.properties.ispe.image_width,c.height=l.properties.ispe.image_height);var y=f.addTrack(c);return y?(f.addSample(y,l.data),f):null},v.prototype.write=function(e){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(e)},v.prototype.createFragment=function(e,s,l){var f=this.getTrackById(e),c=this.getSample(f,s);if(c==null)return c=f.samples[s],this.nextSeekPosition?this.nextSeekPosition=Math.min(c.offset+c.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=f.samples[s].offset+c.alreadyRead,null;var y=l||new i;y.endianness=i.BIG_ENDIAN;var m=this.createSingleSampleMoof(c);m.write(y),m.trafs[0].truns[0].data_offset=m.size+8,a.debug("MP4Box","Adjusting data_offset with new value "+m.trafs[0].truns[0].data_offset),y.adjustUint32(m.trafs[0].truns[0].data_offset_position,m.trafs[0].truns[0].data_offset);var _=new o.mdatBox;return _.data=c.data,_.write(y),y},v.writeInitializationSegment=function(e,s,l,f){var c;a.debug("ISOFile","Generating initialization segment");var y=new i;y.endianness=i.BIG_ENDIAN,e.write(y);var m=s.add("mvex");for(l&&m.add("mehd").set("fragment_duration",l),c=0;c<s.traks.length;c++)m.add("trex").set("track_id",s.traks[c].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",f).set("default_sample_size",0).set("default_sample_flags",1<<16);return s.write(y),y.buffer},v.prototype.save=function(e){var s=new i;s.endianness=i.BIG_ENDIAN,this.write(s),s.save(e)},v.prototype.getBuffer=function(){var e=new i;return e.endianness=i.BIG_ENDIAN,this.write(e),e.buffer},v.prototype.initializeSegmentation=function(){var e,s,l,f;for(this.onSegment===null&&a.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),s=[],e=0;e<this.fragmentedTracks.length;e++){var c=new o.moovBox;c.mvhd=this.moov.mvhd,c.boxes.push(c.mvhd),l=this.getTrackById(this.fragmentedTracks[e].id),c.boxes.push(l),c.traks.push(l),f={},f.id=l.tkhd.track_id,f.user=this.fragmentedTracks[e].user,f.buffer=v.writeInitializationSegment(this.ftyp,c,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[e].samples.length>0?this.moov.traks[e].samples[0].duration:0),s.push(f)}return s},o.Box.prototype.printHeader=function(e){this.size+=8,this.size>r&&(this.size+=8),this.type==="uuid"&&(this.size+=16),e.log(e.indent+"size:"+this.size),e.log(e.indent+"type:"+this.type)},o.FullBox.prototype.printHeader=function(e){this.size+=4,o.Box.prototype.printHeader.call(this,e),e.log(e.indent+"version:"+this.version),e.log(e.indent+"flags:"+this.flags)},o.Box.prototype.print=function(e){this.printHeader(e)},o.ContainerBox.prototype.print=function(e){this.printHeader(e);for(var s=0;s<this.boxes.length;s++)if(this.boxes[s]){var l=e.indent;e.indent+=" ",this.boxes[s].print(e),e.indent=l}},v.prototype.print=function(e){e.indent="";for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&this.boxes[s].print(e)},o.mvhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"timescale: "+this.timescale),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"rate: "+this.rate),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"next_track_id: "+this.next_track_id)},o.tkhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"track_id: "+this.track_id),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"layer: "+this.layer),e.log(e.indent+"alternate_group: "+this.alternate_group),e.log(e.indent+"width: "+this.width),e.log(e.indent+"height: "+this.height)};var p={};p.createFile=function(e,s){var l=e!==void 0?e:!0,f=new v(s);return f.discardMdatData=!l,f},h.createFile=p.createFile})(ho);class Rf{constructor(a,t){ge(this,"emitter",Yn());ge(this,"eventListenerMg",[]);ge(this,"isDestory",!1);ge(this,"url");ge(this,"httpAxios");ge(this,"audioMediaSource");ge(this,"videoMediaSource");ge(this,"audioUrl");ge(this,"videoUrl");ge(this,"isKeepGetBuffer",!1);ge(this,"chunkStart",0);ge(this,"chunkSize",3e6);ge(this,"isEnd",!1);ge(this,"totalLength",0);ge(this,"chunkRanges",[]);ge(this,"mp4boxfile");ge(this,"movieInfo");ge(this,"pendingInits",0);ge(this,"isJumpMoov",!1);ge(this,"onMediaSeekingDebounce");ge(this,"initCpl",new Xi);ge(this,"isInit",!1);ge(this,"getMediaBufferLock",new Xi);this.httpAxios=a,this.url=t,this.initCpl.toPromise().then(()=>{this.isInit=!0}),this.getMediaBufferLock.resolve(!0),this.audioMediaSource=new MediaSource,this.videoMediaSource=new MediaSource,this.audioUrl=URL.createObjectURL(this.audioMediaSource),this.videoUrl=URL.createObjectURL(this.videoMediaSource);let i=2;this.addTargetEventListener(this.videoMediaSource,"sourceopen",()=>{i--,i==0&&this.onSourceOpen()},{once:!0}),this.addTargetEventListener(this.audioMediaSource,"sourceopen",()=>{i--,i==0&&this.onSourceOpen()},{once:!0}),this.onMediaSeekingDebounce=Js(r=>{let n=r.currentTime;console.log("onMediaSeeking "+n);let u=!0;for(let o=0;o<r.buffered.length;o++){const d=r.buffered.start(o),g=r.buffered.end(o);if(n>=d&&n<=g){u=!1;break}}if(u){let{offset:o}=this.mp4boxfile.seek(n,!0);this.chunkStart=o}},500,!0)}getMediaBuffer(){return oe(this,null,function*(){yield this.getMediaBufferLock.toPromise();let a=this.chunkStart,t=this.chunkStart+this.chunkSize-1;if(this.totalLength&&a>=this.totalLength)return;this.totalLength&&t>=this.totalLength&&(t=this.totalLength-1),console.log(`getMediaBuffer rangeStart:${this.chunkStart}`),this.getMediaBufferLock=new Xi;let i=yield this.httpAxios.get(this.url,{headers:{Range:`bytes=${a}-${t}`},responseType:"arraybuffer"});if(this.isDestory){this.getMediaBufferLock.reject(!1);return}if(a==0)try{this.totalLength=parseInt(i.headers["content-range"].split("/")[1])}catch(u){}else this.totalLength||i.data.byteLength!==this.chunkSize&&(this.totalLength=a+i.data.byteLength);this.totalLength&&a+this.chunkSize>=this.totalLength&&!this.isJumpMoov&&(this.isEnd=!0);let r=i.data;r.fileStart=a;let n=this.mp4boxfile.appendBuffer(r);this.isJumpMoov&&this.movieInfo?(this.isJumpMoov=!1,this.chunkStart=this.chunkSize):this.chunkStart=n,!this.movieInfo&&a+r.byteLength!=n&&(this.isJumpMoov=!0),this.movieInfo&&this.totalLength,this.isEnd&&this.mp4boxfile.flush(),this.getMediaBufferLock.resolve(!0)})}keepGetMediaBuffer(){return oe(this,null,function*(){if(this.isKeepGetBuffer)return;this.isKeepGetBuffer=!0;let a=()=>oe(this,null,function*(){if(!!this.isKeepGetBuffer){if(this.isEnd||this.isDestory){this.isKeepGetBuffer=!1;return}yield this.getMediaBuffer(),setTimeout(()=>{a()},50)}});a()})}onSourceOpen(){this.initMp4boxfile(),this.chunkStart=0,this.isEnd=!1,this.totalLength=0,this.keepGetMediaBuffer()}onMediaPause(a){return oe(this,null,function*(){!this.isInit||(this.isKeepGetBuffer=!1)})}onMediaSeeking(a){return oe(this,null,function*(){!this.isInit||this.onMediaSeekingDebounce(a)})}onMediaWaiting(a){return oe(this,null,function*(){if(!this.isInit)return;let t=a.currentTime;console.log("onMediaWaiting "+t),this.isKeepGetBuffer||(console.log("keepGetMediaBuffer"),this.keepGetMediaBuffer())})}onMediaTimeupdate(a){return oe(this,null,function*(){if(!this.isInit||a.paused)return;let t=a.currentTime;console.log("onMediaTimeupdate "+t);let i=!0;for(let r=0;r<a.buffered.length;r++){const n=a.buffered.start(r),u=a.buffered.end(r);let o=t+10;if(o>a.duration&&(o=a.duration),t>=n&&o<=u){i=!1;break}}i&&!this.isKeepGetBuffer?(console.log(`needKeep\uFF1A${i}`),this.keepGetMediaBuffer()):!i&&this.isKeepGetBuffer&&(console.log(`needKeep\uFF1A${i}`),this.isKeepGetBuffer=!1)})}initMp4boxfile(){this.mp4boxfile=ho.createFile(),this.mp4boxfile.onMoovStart=()=>{console.log("mp4boxfile:onMoovStart")},this.mp4boxfile.onReady=a=>{console.log("mp4boxfile:onReady ",a),this.movieInfo=a,this.movieInfo.isFragmented?(this.videoMediaSource.duration=this.movieInfo.fragment_duration/this.movieInfo.timescale,this.audioMediaSource.duration=this.movieInfo.fragment_duration/this.movieInfo.timescale):(this.videoMediaSource.duration=this.movieInfo.duration/this.movieInfo.timescale,this.audioMediaSource.duration=this.movieInfo.duration/this.movieInfo.timescale),console.log(this.movieInfo),this.movieInfo.tracks.filter(i=>i.type=="video"||i.type=="audio").forEach(i=>{var r=i.id,n=`video/mp4; codecs="${i.codec}"`;if(!MediaSource.isTypeSupported(n))throw this.emitter.emit("error",new Error(`\u6D4F\u89C8\u5668\u4E0D\u652F\u6301${n}`)),new Error(`MSE MIME type ${n} not supported for creation of a SourceBuffer for track id ${r}`);try{var u=i.type=="video"?this.videoMediaSource:this.audioMediaSource,o={type:i.type,mediaSource:u,id:r,sourceBuffer:u.addSourceBuffer(n),pendingAppends:[],sampleNum:0,is_last:!1};this.mp4boxfile.setSegmentOptions(o.id,o,{nbSamples:Math.floor(100)})}catch(d){console.error(`MSE - SourceBuffer # ${r} Cannot create buffer with type ${n}`,d)}});var t=this.mp4boxfile.initializeSegmentation();t.forEach(i=>{var r=i.user,n=r.sourceBuffer;this.addTargetEventListener(n,"updateend",u=>{r.sampleNum=0,this.addTargetEventListener(n,"updateend",()=>{this.onSourceBufferUpdateend(r,!0)}),this.onSourceBufferUpdateend(r,!0),this.pendingInits--,this.pendingInits===0&&(this.mp4boxfile.seek(0,!0),this.mp4boxfile.start(),this.initCpl.resolve(!0))},{once:!0}),n.appendBuffer(i.buffer),this.pendingInits++})},this.mp4boxfile.onSidx=a=>{console.log("mp4boxfile:onSidx ",a)},this.mp4boxfile.onItem=a=>{console.log("mp4boxfile:onItem ",a)},this.mp4boxfile.onSegment=(a,t,i,r,n)=>{console.log("mp4boxfile:onSegment ",{id:a,user:t,buffer:i,sampleNum:r,is_last:n}),t.pendingAppends.push({id:a,buffer:i,sampleNum:r,is_last:n}),this.onSourceBufferUpdateend(t,!1)},this.mp4boxfile.onSamples=(a,t,i)=>{console.log("mp4boxfile:onSamples ",{id:a,user:t,samples:i})}}onSourceBufferUpdateend(a,t){if(t===!0&&(a.sampleNum&&(this.mp4boxfile.releaseUsedSamples(a.id,a.sampleNum),a.sampleNum=0),a.is_last&&a.mediaSource.endOfStream()),a.mediaSource.readyState==="open"&&a.sourceBuffer.updating===!1&&a.pendingAppends.length>0){var i=a.pendingAppends.shift();a.sampleNum=i.sampleNum,a.is_last=i.is_last,a.sourceBuffer.appendBuffer(i.buffer)}}addChunkRange(a,t){this.chunkRanges.push({start:a,end:t}),this.chunkRanges.sort((i,r)=>i.start-r.start);for(let i=0;i<this.chunkRanges.length-1;i++){const r=this.chunkRanges[i],n=this.chunkRanges[i+1];if(r.end+1==n.start){r.end=n.end,this.chunkRanges.splice(i+1,1),i--;continue}}}isInChunkRanges(a,t){return this.chunkRanges.some(i=>!!(a>=i.start&&a<=i.end||t&&t<=i.end&&t>=i.start))}addTargetEventListener(a,t,i,r){return oe(this,null,function*(){a.addEventListener(t,i,r),this.eventListenerMg.push({target:a,type:t,callback:i,options:r})})}removeAllTargetEventListener(){return oe(this,null,function*(){this.eventListenerMg.forEach(a=>{a.target.removeEventListener(a.type,a.callback,a.options)}),this.eventListenerMg=[]})}destory(){this.removeAllTargetEventListener(),this.emitter.off("*"),this.audioUrl&&URL.revokeObjectURL(this.audioUrl),this.videoUrl&&URL.revokeObjectURL(this.videoUrl),this.isKeepGetBuffer=!1,this.initCpl.reject(!1),this.mp4boxfile=null,this.videoMediaSource=null,this.audioMediaSource=null,this.isDestory=!0}on(a,t){this.emitter.on(a,t)}}class Uf{constructor(){ge(this,"emitter",Yn());ge(this,"bridgeIframe");ge(this,"bridgeWindow");ge(this,"bridgeOrigin");ge(this,"_src","");ge(this,"_currentTime",0);ge(this,"duration",0);ge(this,"paused",!0);ge(this,"buffered",[])}bind(a){this.bridgeIframe=a,this.bridgeOrigin=this.bridgeIframe.src.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:@]*/)[0],this.bridgeWindow=this.bridgeIframe.contentWindow,window.addEventListener("message",t=>{if(t.origin!=this.bridgeOrigin)return;let i=t.data;i.event==="onElementEvent"&&(this._currentTime=i.data.eventData.currentTime,this.duration=i.data.eventData.duration,this.paused=i.data.eventData.paused,this.emitter.emit(i.data.eventName,i.data.eventData))})}get src(){return this._src}set src(a){this._src=a,this.setElementProperty("src",a)}get currentTime(){return this._currentTime}set currentTime(a){this._currentTime=a,this.setElementProperty("currentTime",a)}play(){this.invokeElementMethod("play")}pause(){this.invokeElementMethod("pause")}load(){this.invokeElementMethod("load")}invokeElementMethod(a,t=[]){this.bridgeWindow.postMessage({event:"invokeElementMethod",data:{name:a,args:t}},this.bridgeOrigin)}setElementProperty(a,t){this.bridgeWindow.postMessage({event:"setElementProperty",data:{name:a,value:t}},this.bridgeOrigin)}getElementProperty(a){}addEventListener(a,t,i={once:!1}){if(i.once){let r=n=>{this.emitter.off(a,r),t(n)};this.emitter.on(a,r)}else this.emitter.on(a,t)}removeEventListener(a,t){this.emitter.off(a,t)}isBridgeUrl(a){return this.bridgeOrigin?!!(a.startsWith("http://127.0.0.1")||a.startsWith("http://192.168.")):!1}}class Lf{constructor(){ge(this,"xgplayer");ge(this,"isFirstPlay",!1)}get duration(){return this.xgplayer.duration}get paused(){return this.xgplayer.paused}get buffered(){return this.xgplayer.buffered}bind(a){this.xgplayer=a}get src(){return this.xgplayer.root.style.opacity=="0"?"":this.xgplayer.src}set src(a){if(a==""){this.xgplayer.pause(),this.xgplayer.root.style.opacity="0",this.xgplayer.volume=0;return}this.xgplayer.started?this.xgplayer.src=a:this.xgplayer.start(a),this.xgplayer.once("canplay",()=>{this.xgplayer.root.style.opacity="1",this.xgplayer.volume=1,this.isFirstPlay||(this.isFirstPlay=!0,this.xgplayer.video.removeAttribute("tabindex"))})}get currentTime(){return this.xgplayer.currentTime}set currentTime(a){this.xgplayer.currentTime=a}play(){this.xgplayer.play()}pause(){this.xgplayer.pause()}load(){}addEventListener(a,t,i={once:!1}){i.once?this.xgplayer.once(a,t):this.xgplayer.on(a,t)}removeEventListener(a,t){this.xgplayer.off(a,t)}isXgplayerUrl(a){return a.includes("/m3u8/file")}}class Pf{constructor(){ge(this,"emitter",Yn());ge(this,"naviteAudioEl",new Audio);ge(this,"bridgeAudioEl",new Uf);ge(this,"xgplayerAudioEl",new Lf);ge(this,"activeType","navite")}bindBrigeIframe(a){this.bridgeAudioEl.bind(a)}bindXgplayer(a){this.xgplayerAudioEl.bind(a)}get src(){return this.getActiveAudio().src}set src(a){a&&(this.xgplayerAudioEl.isXgplayerUrl(a)?this.activeType="xgplayer":this.bridgeAudioEl.isBridgeUrl(a)?this.activeType="bridge":this.activeType="navite",this.activeType=="navite"&&this.isPrivateUrl(a)&&location.href.startsWith("https://")&&(a=a.replace("http://","https://"))),this.getActiveAudio().src=a}get currentTime(){return this.getActiveAudio().currentTime}set currentTime(a){this.getActiveAudio().currentTime=a}get duration(){return this.getActiveAudio().duration}get paused(){return this.getActiveAudio().paused}get buffered(){return this.getActiveAudio().buffered}play(){this.getActiveAudio().play()}pause(){this.getActiveAudio().pause()}load(){this.getActiveAudio().load()}addEventListener(a,t,i){let r=()=>{this.activeType==="navite"&&t()},n=()=>{this.activeType==="bridge"&&t()},u=()=>{this.activeType==="xgplayer"&&t()};this.naviteAudioEl.addEventListener(a,r,i),this.bridgeAudioEl.addEventListener(a,n,i),this.xgplayerAudioEl.addEventListener(a,u,i)}removeEventListener(a,t,i){}getActiveAudio(){if(this.activeType=="navite")return this.naviteAudioEl;if(this.activeType=="bridge")return this.bridgeAudioEl;if(this.activeType=="xgplayer")return this.xgplayerAudioEl}isPrivateUrl(a){return!!(a.startsWith("http://127.0.0.1")||a.startsWith("http://192.168.")||a.startsWith("http://pi.lan."))}}var po={exports:{}};(function(h,a){(function(i,r){h.exports=r()})(cn,function(){return function(t){var i={};function r(n){if(i[n])return i[n].exports;var u=i[n]={i:n,l:!1,exports:{}};return t[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=t,r.c=i,r.d=function(n,u,o){r.o(n,u)||Object.defineProperty(n,u,{enumerable:!0,get:o})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,u){if(u&1&&(n=r(n)),u&8||u&4&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),u&2&&typeof n!="string")for(var d in n)r.d(o,d,function(g){return n[g]}.bind(null,d));return o},r.n=function(n){var u=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(u,"a",u),u},r.o=function(n,u){return Object.prototype.hasOwnProperty.call(n,u)},r.p="",r(r.s=79)}([function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.util=i.PresentationMode=void 0,i.createDom=d,i.hasClass=g,i.addClass=v,i.removeClass=p,i.toggleClass=e,i.findDom=s,i.padStart=l,i.format=f,i.event=c,i.typeOf=y,i.deepCopy=m,i.getBgImage=_,i.copyDom=E,i._setInterval=w,i._clearInterval=k,i.createImgBtn=x,i.isWeiXin=S,i.isUc=B,i.computeWatchDur=U,i.offInDestroy=R,i.on=C,i.once=A,i.getBuffered2=b,i.checkIsBrowser=O,i.setStyle=W,i.checkWebkitSetPresentationMode=K;var n=r(7),u=o(n);function o(G){return G&&G.__esModule?G:{default:G}}function d(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",$=document.createElement(G);return $.className=N,$.innerHTML=F,Object.keys(j).forEach(function(Z){var te=Z,ae=j[Z];G==="video"||G==="audio"?ae&&$.setAttribute(te,ae):$.setAttribute(te,ae)}),$}function g(G,F){return G?G.classList?Array.prototype.some.call(G.classList,function(j){return j===F}):G.className?!!G.className.match(new RegExp("(\\s|^)"+F+"(\\s|$)")):!1:!1}function v(G,F){!G||(G.classList?F.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(j){j&&G.classList.add(j)}):g(G,F)||(G.className+=" "+F))}function p(G,F){!G||(G.classList?F.split(/\s+/g).forEach(function(j){G.classList.remove(j)}):g(G,F)&&F.split(/\s+/g).forEach(function(j){var N=new RegExp("(\\s|^)"+j+"(\\s|$)");G.className=G.className.replace(N," ")}))}function e(G,F){!G||F.split(/\s+/g).forEach(function(j){g(G,j)?p(G,j):v(G,j)})}function s(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,F=arguments[1],j=void 0;try{j=G.querySelector(F)}catch(N){F.indexOf("#")===0&&(j=G.getElementById(F.slice(1)))}return j}function l(G,F,j){for(var N=String(j),$=F>>0,Z=Math.ceil($/N.length),te=[],ae=String(G);Z--;)te.push(N);return te.join("").substring(0,$-ae.length)+ae}function f(G){if(window.isNaN(G))return"";var F=l(Math.floor(G/3600),2,0),j=l(Math.floor((G-F*3600)/60),2,0),N=l(Math.floor(G-F*3600-j*60),2,0);return(F==="00"?[j,N]:[F,j,N]).join(":")}function c(G){if(G.touches){var F=G.touches[0]||G.changedTouches[0];G.clientX=F.clientX||0,G.clientY=F.clientY||0,G.offsetX=F.pageX-F.target.offsetLeft,G.offsetY=F.pageY-F.target.offsetTop}G._target=G.target||G.srcElement}function y(G){return Object.prototype.toString.call(G).match(/([^\s.*]+)(?=]$)/g)[0]}function m(G,F){if(y(F)==="Object"&&y(G)==="Object")return Object.keys(F).forEach(function(j){y(F[j])==="Object"&&!(F[j]instanceof Node)?G[j]?m(G[j],F[j]):G[j]=F[j]:y(F[j])==="Array"?G[j]=y(G[j])==="Array"?G[j].concat(F[j]):F[j]:G[j]=F[j]}),G}function _(G){var F=(G.currentStyle||window.getComputedStyle(G,null)).backgroundImage;if(!F||F==="none")return"";var j=document.createElement("a");return j.href=F.replace(/url\("|"\)/g,""),j.href}function E(G){if(G&&G.nodeType===1){var F=document.createElement(G.tagName);return Array.prototype.forEach.call(G.attributes,function(j){F.setAttribute(j.name,j.value)}),G.innerHTML&&(F.innerHTML=G.innerHTML),F}else return""}function w(G,F,j,N){G._interval[F]||(G._interval[F]=setInterval(j.bind(G),N))}function k(G,F){clearInterval(G._interval[F]),G._interval[F]=null}function x(G,F,j,N){var $=d("xg-"+G,"",{},"xgplayer-"+G+"-img");if($.style.backgroundImage='url("'+F+'")',j&&N){var Z=void 0,te=void 0,ae=void 0;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(Ee){return j.indexOf(Ee)>-1&&N.indexOf(Ee)>-1?(Z=Number(j.slice(0,j.indexOf(Ee)).trim()),te=Number(N.slice(0,N.indexOf(Ee)).trim()),ae=Ee,!1):!0}),$.style.width=""+Z+ae,$.style.height=""+te+ae,$.style.backgroundSize=""+Z+ae+" "+te+ae,G==="start"?$.style.margin="-"+te/2+ae+" auto auto -"+Z/2+ae:$.style.margin="auto 5px auto 5px"}return $}function S(){var G=window.navigator.userAgent.toLowerCase();return G.indexOf("micromessenger")>-1}function B(){var G=window.navigator.userAgent.toLowerCase();return G.indexOf("ucbrowser")>-1}function U(){for(var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],F=[],j=0;j<G.length;j++)if(!(!G[j].end||G[j].begin<0||G[j].end<0||G[j].end<G[j].begin))if(F.length<1)F.push({begin:G[j].begin,end:G[j].end});else for(var N=0;N<F.length;N++){var $=G[j].begin,Z=G[j].end;if(Z<F[N].begin){F.splice(N,0,{begin:$,end:Z});break}else if($>F[N].end){if(N>F.length-2){F.push({begin:$,end:Z});break}}else{var te=F[N].begin,ae=F[N].end;F[N].begin=Math.min($,te),F[N].end=Math.max(Z,ae);break}}for(var Ee=0,Te=0;Te<F.length;Te++)Ee+=F[Te].end-F[Te].begin;return Ee}function R(G,F,j,N){function $(){G.off(F,j),G.off(N,$)}G.once(N,$)}function C(G,F,j,N){if(N)G.on(F,j),R(G,F,j,N);else{var $=function Z(te){j(te),G.off(F,Z)};G.on(F,$)}}function A(G,F,j,N){if(N)G.once(F,j),R(G,F,j,N);else{var $=function Z(te){j(te),G.off(F,Z)};G.once(F,$)}}function b(G){for(var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,j=[],N=0;N<G.length;N++)j.push({start:G.start(N)<.5?0:G.start(N),end:G.end(N)});j.sort(function(Ee,Te){var Ae=Ee.start-Te.start;return Ae||Te.end-Ee.end});var $=[];if(F)for(var Z=0;Z<j.length;Z++){var te=$.length;if(te){var ae=$[te-1].end;j[Z].start-ae<F?j[Z].end>ae&&($[te-1].end=j[Z].end):$.push(j[Z])}else $.push(j[Z])}else $=j;return new u.default($)}function O(){return!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined")}function W(G,F,j){var N=G.style;try{N[F]=j}catch($){N.setProperty(F,j)}}i.PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"};function K(G){return typeof G.webkitSetPresentationMode=="function"}i.util={createDom:d,hasClass:g,addClass:v,removeClass:p,toggleClass:e,findDom:s,padStart:l,format:f,event:c,typeOf:y,deepCopy:m,getBgImage:_,copyDom:E,setInterval:w,clearInterval:k,createImgBtn:x,isWeiXin:S,isUc:B,computeWatchDur:U,offInDestroy:R,on:C,once:A,getBuffered2:b,checkIsBrowser:O,setStyle:W}},function(t,i){t.exports=function(u){var o=[];return o.toString=function(){return this.map(function(g){var v=r(g,u);return g[2]?"@media "+g[2]+"{"+v+"}":v}).join("")},o.i=function(d,g){typeof d=="string"&&(d=[[null,d,""]]);for(var v={},p=0;p<this.length;p++){var e=this[p][0];typeof e=="number"&&(v[e]=!0)}for(p=0;p<d.length;p++){var s=d[p];(typeof s[0]!="number"||!v[s[0]])&&(g&&!s[2]?s[2]=g:g&&(s[2]="("+s[2]+") and ("+g+")"),o.push(s))}},o};function r(u,o){var d=u[1]||"",g=u[3];if(!g)return d;if(o&&typeof btoa=="function"){var v=n(g),p=g.sources.map(function(e){return"/*# sourceURL="+g.sourceRoot+e+" */"});return[d].concat(p).concat([v]).join(`
`)}return[d].join(`
`)}function n(u){var o=btoa(unescape(encodeURIComponent(JSON.stringify(u)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,"+o;return"/*# "+d+" */"}},function(t,i,r){var n={},u=function(U){var R;return function(){return typeof R=="undefined"&&(R=U.apply(this,arguments)),R}},o=u(function(){return window&&document&&document.all&&!window.atob}),d=function(U){return document.querySelector(U)},g=function(U){var R={};return function(C){if(typeof C=="function")return C();if(typeof R[C]=="undefined"){var A=d.call(this,C);if(window.HTMLIFrameElement&&A instanceof window.HTMLIFrameElement)try{A=A.contentDocument.head}catch(b){A=null}R[C]=A}return R[C]}}(),v=null,p=0,e=[],s=r(36);t.exports=function(U,R){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");R=R||{},R.attrs=typeof R.attrs=="object"?R.attrs:{},!R.singleton&&typeof R.singleton!="boolean"&&(R.singleton=o()),R.insertInto||(R.insertInto="head"),R.insertAt||(R.insertAt="bottom");var C=f(U,R);return l(C,R),function(b){for(var O=[],W=0;W<C.length;W++){var K=C[W],G=n[K.id];G.refs--,O.push(G)}if(b){var F=f(b,R);l(F,R)}for(var W=0;W<O.length;W++){var G=O[W];if(G.refs===0){for(var j=0;j<G.parts.length;j++)G.parts[j]();delete n[G.id]}}}};function l(U,R){for(var C=0;C<U.length;C++){var A=U[C],b=n[A.id];if(b){b.refs++;for(var O=0;O<b.parts.length;O++)b.parts[O](A.parts[O]);for(;O<A.parts.length;O++)b.parts.push(w(A.parts[O],R))}else{for(var W=[],O=0;O<A.parts.length;O++)W.push(w(A.parts[O],R));n[A.id]={id:A.id,refs:1,parts:W}}}}function f(U,R){for(var C=[],A={},b=0;b<U.length;b++){var O=U[b],W=R.base?O[0]+R.base:O[0],K=O[1],G=O[2],F=O[3],j={css:K,media:G,sourceMap:F};A[W]?A[W].parts.push(j):C.push(A[W]={id:W,parts:[j]})}return C}function c(U,R){var C=g(U.insertInto);if(!C)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var A=e[e.length-1];if(U.insertAt==="top")A?A.nextSibling?C.insertBefore(R,A.nextSibling):C.appendChild(R):C.insertBefore(R,C.firstChild),e.push(R);else if(U.insertAt==="bottom")C.appendChild(R);else if(typeof U.insertAt=="object"&&U.insertAt.before){var b=g(U.insertInto+" "+U.insertAt.before);C.insertBefore(R,b)}else throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`)}function y(U){if(U.parentNode===null)return!1;U.parentNode.removeChild(U);var R=e.indexOf(U);R>=0&&e.splice(R,1)}function m(U){var R=document.createElement("style");return U.attrs.type="text/css",E(R,U.attrs),c(U,R),R}function _(U){var R=document.createElement("link");return U.attrs.type="text/css",U.attrs.rel="stylesheet",E(R,U.attrs),c(U,R),R}function E(U,R){Object.keys(R).forEach(function(C){U.setAttribute(C,R[C])})}function w(U,R){var C,A,b,O;if(R.transform&&U.css)if(O=R.transform(U.css),O)U.css=O;else return function(){};if(R.singleton){var W=p++;C=v||(v=m(R)),A=x.bind(null,C,W,!1),b=x.bind(null,C,W,!0)}else U.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(C=_(R),A=B.bind(null,C,R),b=function(){y(C),C.href&&URL.revokeObjectURL(C.href)}):(C=m(R),A=S.bind(null,C),b=function(){y(C)});return A(U),function(G){if(G){if(G.css===U.css&&G.media===U.media&&G.sourceMap===U.sourceMap)return;A(U=G)}else b()}}var k=function(){var U=[];return function(R,C){return U[R]=C,U.filter(Boolean).join(`
`)}}();function x(U,R,C,A){var b=C?"":A.css;if(U.styleSheet)U.styleSheet.cssText=k(R,b);else{var O=document.createTextNode(b),W=U.childNodes;W[R]&&U.removeChild(W[R]),W.length?U.insertBefore(O,W[R]):U.appendChild(O)}}function S(U,R){var C=R.css,A=R.media;if(A&&U.setAttribute("media",A),U.styleSheet)U.styleSheet.cssText=C;else{for(;U.firstChild;)U.removeChild(U.firstChild);U.appendChild(document.createTextNode(C))}}function B(U,R,C){var A=C.css,b=C.sourceMap,O=R.convertToAbsoluteUrls===void 0&&b;(R.convertToAbsoluteUrls||O)&&(A=s(A)),b&&(A+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(b))))+" */");var W=new Blob([A],{type:"text/css"}),K=U.href;U.href=URL.createObjectURL(W),K&&URL.revokeObjectURL(K)}},function(t,i,r){var n=r(24)();t.exports=function(u){return u!==n&&u!==null}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(8);function u(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}var o={network:{code:1,msg:"\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF",remark:"\u53EA\u8981\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF\u5C31\u4F7F\u7528\u6B64\u7C7B\u578B\uFF0C\u65E0\u8BBA\u662Fvideo\u672C\u8EAB\u7684\u8D85\u65F6\u8FD8\u662Fxhr\u7684\u5206\u6BB5\u8BF7\u6C42\u8D85\u65F6\u6216\u8005\u8D44\u6E90\u4E0D\u5B58\u5728"},mse:{code:2,msg:"\u6D41\u8FFD\u52A0\u9519\u8BEF",remark:"\u8FFD\u52A0\u6D41\u7684\u65F6\u5019\u5982\u679C\u7C7B\u578B\u4E0D\u5BF9\u3001\u65E0\u6CD5\u88AB\u6B63\u786E\u89E3\u7801\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},parse:{code:3,msg:"\u89E3\u6790\u9519\u8BEF",remark:"mp4\u3001hls\u3001flv\u6211\u4EEC\u90FD\u662F\u4F7F\u7528js\u8FDB\u884C\u683C\u5F0F\u89E3\u6790\uFF0C\u5982\u679C\u89E3\u6790\u5931\u8D25\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},format:{code:4,msg:"\u683C\u5F0F\u9519\u8BEF",remark:"\u5982\u679C\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u7684\u683C\u5F0F\u5BFC\u81F4\u64AD\u653E\u9519\u8BEF"},decoder:{code:5,msg:"\u89E3\u7801\u9519\u8BEF",remark:"\u6D4F\u89C8\u5668\u89E3\u7801\u5F02\u5E38\u4F1A\u629B\u51FA\u6B64\u7C7B\u578B\u9519\u8BEF"},runtime:{code:6,msg:"\u8BED\u6CD5\u9519\u8BEF",remark:"\u64AD\u653E\u5668\u8BED\u6CD5\u9519\u8BEF"},timeout:{code:7,msg:"\u64AD\u653E\u8D85\u65F6",remark:"\u64AD\u653E\u8FC7\u7A0B\u4E2D\u65E0\u6CD5\u6B63\u5E38\u8BF7\u6C42\u4E0B\u4E00\u4E2A\u5206\u6BB5\u5BFC\u81F4\u64AD\u653E\u4E2D\u65AD"},other:{code:8,msg:"\u5176\u4ED6\u9519\u8BEF",remark:"\u4E0D\u53EF\u77E5\u7684\u9519\u8BEF\u6216\u88AB\u5FFD\u7565\u7684\u9519\u8BEF\u7C7B\u578B"}},d=function g(v,p,e,s,l,f,c,y){var m=arguments.length>8&&arguments[8]!==void 0?arguments[8]:{line:"",handle:"",msg:"",version:""},_=arguments[9],E=arguments[10];u(this,g);var w={};if(arguments.length>1)w.playerVersion=n.version,w.errorType=v,w.domain=document.domain,w.duration=e,w.currentTime=p,w.networkState=s,w.readyState=l,w.currentSrc=c,w.src=f,w.ended=y,w.errd=m,w.ex=(o[v]||{}).msg,w.errorCode=_,w.mediaError=E;else{var k=arguments[0];Object.keys(k).map(function(x){w[x]=k[x]}),w.ex=(k.type&&o[k.type]||{}).msg}return w};i.default=d,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n={};Object.defineProperty(n,"device",{get:function(){var o=n.os;return o.isPc?"pc":"mobile"}}),Object.defineProperty(n,"browser",{get:function(){var o=navigator.userAgent.toLowerCase(),d={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(d).filter(function(g){return d[g].test(o)}))[0]||""}}),Object.defineProperty(n,"os",{get:function(){var o=navigator.userAgent,d=/(?:Windows Phone)/.test(o),g=/(?:SymbianOS)/.test(o)||d,v=/(?:Android)/.test(o),p=/(?:Firefox)/.test(o),e=/(?:iPad|PlayBook)/.test(o)||v&&!/(?:Mobile)/.test(o)||p&&/(?:Tablet)/.test(o),s=/(?:iPhone)/.test(o)&&!e,l=!s&&!v&&!g&&!e;return{isTablet:e,isPhone:s,isAndroid:v,isPc:l,isSymbian:g,isWindowsPhone:d,isFireFox:p}}}),i.default=n,t.exports=i.default},function(t,i,r){var n=void 0;t.exports=function(u){return u!==n&&u!==null}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function d(g,v){for(var p=0;p<v.length;p++){var e=v[p];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(g,e.key,e)}}return function(g,v,p){return v&&d(g.prototype,v),p&&d(g,p),g}}();function u(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")}var o=function(){function d(g){u(this,d),this.bufferedList=g}return n(d,[{key:"start",value:function(v){return this.bufferedList[v].start}},{key:"end",value:function(v){return this.bufferedList[v].end}},{key:"length",get:function(){return this.bufferedList.length}}]),d}();i.default=o,t.exports=i.default},function(t){t.exports=JSON.parse('{"version":"2.32.2"}')},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function U(R,C){for(var A=0;A<C.length;A++){var b=C[A];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(R,b.key,b)}}return function(R,C,A){return C&&U(R.prototype,C),A&&U(R,A),R}}(),u=function U(R,C,A){R===null&&(R=Function.prototype);var b=Object.getOwnPropertyDescriptor(R,C);if(b===void 0){var O=Object.getPrototypeOf(R);return O===null?void 0:U(O,C,A)}else{if("value"in b)return b.value;var W=b.get;return W===void 0?void 0:W.call(A)}},o=r(11),d=w(o),g=r(0),v=r(5),p=w(v),e=r(7),s=w(e),l=r(4),f=w(l),c=r(31),y=w(c),m=r(10),_=w(m);r(34);var E=r(8);function w(U){return U&&U.__esModule?U:{default:U}}function k(U,R){if(!(U instanceof R))throw new TypeError("Cannot call a class as a function")}function x(U,R){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:U}function S(U,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);U.prototype=Object.create(R&&R.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(U,R):U.__proto__=R)}var B=function(U){S(R,U);function R(C){k(this,R);var A=x(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,C));if(A.config=(0,g.deepCopy)({width:600,height:337.5,ignores:[],whitelist:[],lang:(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),inactive:3e3,volume:.6,controls:!0,controlsList:["nodownload"]},C),A.version=E.version,A.userTimer=null,A.waitTimer=null,A.history=[],A.isProgressMoving=!1,A.root=(0,g.findDom)(document,"#"+A.config.id),A.controls=(0,g.createDom)("xg-controls","",{unselectable:"on",onselectstart:"return false"},"xgplayer-controls"),A.config.isShowControl&&(A.controls.style.display="none"),!A.root){var b=A.config.el;if(b&&b.nodeType===1)A.root=b;else{var O;return A.emit("error",new f.default({type:"use",errd:{line:45,handle:"Constructor",msg:"container id can't be empty"},vid:A.config.vid})),console.error("container id can't be empty"),O=!1,x(A,O)}}if((0,g.addClass)(A.root,"xgplayer xgplayer-"+p.default.device+" xgplayer-nostart xgplayer-pause "+(A.config.controls?"":"xgplayer-no-controls")),A.root.appendChild(A.controls),A.config.fluid?(A.root.style["max-width"]="100%",A.root.style.width="100%",A.root.style.height="0",A.root.style["padding-top"]=A.config.height*100/A.config.width+"%",A.video.style.position="absolute",A.video.style.top="0",A.video.style.left="0"):(A.config.width&&(typeof A.config.width!="number"?A.root.style.width=A.config.width:A.root.style.width=A.config.width+"px"),A.config.height&&(typeof A.config.height!="number"?A.root.style.height=A.config.height:A.root.style.height=A.config.height+"px")),A.config.execBeforePluginsCall&&A.config.execBeforePluginsCall.forEach(function(F){F.call(A,A)}),A.config.closeI18n||R.install(_.default.name,_.default.method),A.config.controlStyle&&(0,g.typeOf)(A.config.controlStyle)==="String"){var W=A;fetch(W.config.controlStyle,{method:"GET",headers:{Accept:"application/json"}}).then(function(F){F.ok&&F.json().then(function(j){for(var N in j)j.hasOwnProperty(N)&&(W.config[N]=j[N]);W.pluginsCall()})}).catch(function(F){console.log("Fetch\u9519\u8BEF:"+F)})}else A.pluginsCall();A.config.controlPlugins&&R.controlsRun(A.config.controlPlugins,A),A.ev.forEach(function(F){var j=Object.keys(F)[0],N=A[F[j]];N&&A.on(j,N)}),["focus","blur"].forEach(function(F){A.on(F,A["on"+F.charAt(0).toUpperCase()+F.slice(1)])});var K=A;A.mousemoveFunc=function(){K.emit("focus"),K.config.closeFocusVideoFocus||K.video.focus()},A.root.addEventListener("mousemove",A.mousemoveFunc),A.playFunc=function(){K.emit("focus"),K.config.closePlayVideoFocus||K.video.focus()},K.once("play",A.playFunc),A.getVideoSize=function(){if(this.video.videoWidth&&this.video.videoHeight){var F=K.root.getBoundingClientRect();K.config.fitVideoSize==="auto"?F.width/F.height>this.video.videoWidth/this.video.videoHeight?K.root.style.height=this.video.videoHeight/this.video.videoWidth*F.width+"px":K.root.style.width=this.video.videoWidth/this.video.videoHeight*F.height+"px":K.config.fitVideoSize==="fixWidth"?K.root.style.height=this.video.videoHeight/this.video.videoWidth*F.width+"px":K.config.fitVideoSize==="fixHeight"&&(K.root.style.width=this.video.videoWidth/this.video.videoHeight*F.height+"px")}},K.once("loadeddata",A.getVideoSize),setTimeout(function(){A.emit("ready"),A.isReady=!0},0),A.config.videoInit&&(0,g.hasClass)(A.root,"xgplayer-nostart")&&A.start(),K.config.rotate&&(K.on("requestFullscreen",A.updateRotateDeg),K.on("exitFullscreen",A.updateRotateDeg));function G(){K.root.removeEventListener("mousemove",K.mousemoveFunc),K.off("destroy",G)}return K.once("destroy",G),A}return n(R,[{key:"attachVideo",value:function(){var A=this;this.video&&this.video.nodeType===1&&this.root.insertBefore(this.video,this.root.firstChild),setTimeout(function(){A.emit("complete"),A.danmu&&typeof A.danmu.resize=="function"&&A.danmu.resize()},1)}},{key:"start",value:function(){var A=this,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;if(!!this.video){var O=this;if(!b||b===""){this.emit("urlNull");return}this.canPlayFunc=function(){O.off("canplay",O.canPlayFunc);var W=O.video.play();W!==void 0&&W&&W.then(function(){O.emit("autoplay started")}).catch(function(){O.emit("autoplay was prevented"),(0,g.addClass)(O.root,"xgplayer-is-autoplay")})},(0,g.typeOf)(b)!=="Array"?(0,g.typeOf)(b)==="String"&&b.indexOf("blob:")>-1&&b===this.video.src||(this.video.src=b):b.forEach(function(W){A.video.appendChild((0,g.createDom)("source","",{src:""+W.src,type:""+(W.type||"")}))}),this.config.autoplay&&(p.default.os.isPhone?this.canPlayFunc():this.on("canplay",this.canPlayFunc)),this.config.disableStartLoad||this.video.load(),this.attachVideo()}}},{key:"reload",value:function(){this.video.load(),this.reloadFunc=function(){var A=this.play();A!==void 0&&A&&A.catch(function(b){})},this.once("loadeddata",this.reloadFunc)}},{key:"destroy",value:function(){var A=this,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,O=this;clearInterval(this.bulletResizeTimer);for(var W in this._interval)clearInterval(this._interval[W]),this._interval[W]=null;this.checkTimer&&clearInterval(this.checkTimer),this.waitTimer&&clearTimeout(this.waitTimer),this.ev.forEach(function(G){var F=Object.keys(G)[0],j=A[G[F]];j&&A.off(F,j)}),this.loadeddataFunc&&this.off("loadeddata",this.loadeddataFunc),this.reloadFunc&&this.off("loadeddata",this.reloadFunc),this.replayFunc&&this.off("play",this.replayFunc),this.playFunc&&this.off("play",this.playFunc),this.getVideoSize&&this.off("loadeddata",this.getVideoSize),["focus","blur"].forEach(function(G){A.off(G,A["on"+G.charAt(0).toUpperCase()+G.slice(1)])}),(!this.config.keyShortcut||this.config.keyShortcut==="on")&&["video","controls"].forEach(function(G){A[G]&&A[G].removeEventListener("keydown",function(F){O.onKeydown(F,O)})});function K(){if(this.emit("destroy"),this.video.removeAttribute("src"),this.video.load(),b){this.root.innerHTML="";var G=this.root.className.split(" ");G.length>0?this.root.className=G.filter(function(j){return j.indexOf("xgplayer")<0}).join(" "):this.root.className=""}for(var F in this)delete this[F];(0,y.default)(this)}K.call(this),u(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"destroy",this).call(this)}},{key:"replay",value:function(){var A=this._replay;if((0,g.removeClass)(this.root,"xgplayer-ended"),p.default.browser.indexOf("ie")>-1&&(this.emit("play"),this.emit("playing")),A&&A instanceof Function)A();else{this.currentTime=0;var b=this.play();b!==void 0&&b&&b.catch(function(O){})}}},{key:"userGestureTrigEvent",value:function(A,b){var O=this,W=function(G,F){O.emit(G,F)};this.config.userGestureEventMiddleware&&typeof this.config.userGestureEventMiddleware[A]=="function"?this.config.userGestureEventMiddleware[A].call(this,this,A,b,W):W.call(this,A,b)}},{key:"pluginsCall",value:function(){var A=this;R.plugins.s_i18n&&R.plugins.s_i18n.call(this,this);var b=this;if(R.plugins){var O=this.config.ignores;Object.keys(R.plugins).forEach(function(W){var K=R.plugins[W];!K||typeof K!="function"?console.warn("plugin name",W,"is invalid"):!O.some(function(G){return W===G||W==="s_"+G})&&W!=="s_i18n"&&(["pc","tablet","mobile"].some(function(G){return G===W})?W===p.default.device&&setTimeout(function(){!b.video||K.call(b,b)},0):K.call(A,A))})}}},{key:"onFocus",value:function(){var A=this;(0,g.hasClass)(this.root,"xgplayer-inactive")&&A.emit("controlShow"),(0,g.removeClass)(this.root,"xgplayer-inactive"),A.userTimer&&clearTimeout(A.userTimer),A.userTimer=setTimeout(function(){A.emit("blur")},A.config.inactive)}},{key:"onBlur",value:function(){(this.config.enablePausedInactive||!this.paused)&&!this.ended&&!this.config.closeInactive&&((0,g.hasClass)(this.root,"xgplayer-inactive")||this.emit("controlHide"),(0,g.addClass)(this.root,"xgplayer-inactive"))}},{key:"onPlay",value:function(){(0,g.addClass)(this.root,"xgplayer-isloading"),(0,g.addClass)(this.root,"xgplayer-playing"),(0,g.removeClass)(this.root,"xgplayer-pause")}},{key:"onPause",value:function(){(0,g.addClass)(this.root,"xgplayer-pause"),this.userTimer&&clearTimeout(this.userTimer),this.emit("focus")}},{key:"onEnded",value:function(){(0,g.addClass)(this.root,"xgplayer-ended"),(0,g.removeClass)(this.root,"xgplayer-playing")}},{key:"onSeeking",value:function(){this.isSeeking=!0,this.onWaiting()}},{key:"onSeeked",value:function(){var A=this;this.once("timeupdate",function(){A.isSeeking=!1}),this.waitTimer&&clearTimeout(this.waitTimer),(0,g.removeClass)(this.root,"xgplayer-isloading")}},{key:"onWaiting",value:function(){var A=this;A.waitTimer&&clearTimeout(A.waitTimer),A.checkTimer&&(clearInterval(A.checkTimer),A.checkTimer=null);var b=A.currentTime;A.waitTimer=setTimeout(function(){(0,g.addClass)(A.root,"xgplayer-isloading"),A.checkTimer=setInterval(function(){A.currentTime!==b&&((0,g.removeClass)(A.root,"xgplayer-isloading"),clearInterval(A.checkTimer),A.checkTimer=null)},1e3)},500)}},{key:"onPlaying",value:function(){this.paused||(this.isSeeking=!1,this.waitTimer&&clearTimeout(this.waitTimer),(0,g.removeClass)(this.root,"xgplayer-isloading xgplayer-nostart xgplayer-pause xgplayer-ended xgplayer-is-error xgplayer-replay"),(0,g.addClass)(this.root,"xgplayer-playing"))}}],[{key:"install",value:function(A,b){!(0,g.checkIsBrowser)()||(R.plugins||(R.plugins={}),R.plugins[A]||(R.plugins[A]=b))}},{key:"installAll",value:function(A){for(var b=0;b<A.length;b++)R.install(A[b].name,A[b].method)}},{key:"use",value:function(A,b){R.plugins||(R.plugins={}),R.plugins[A]=b}},{key:"useAll",value:function(A){for(var b in A)R.use(A[b].name,A[b].method)}},{key:"controlsRun",value:function(A,b){A.forEach(function(O){O.method.call(b)})}}]),R}(d.default);B.util=g.util,B.sniffer=p.default,B.Errors=f.default,B.XgplayerTimeRange=s.default,i.default=B,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g={};g.en={HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"Pip",MINIPLAYER:"Miniplayer",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",MINIPLAYER_DRAG:"Click and hold to drag",AIRPLAY_TIPS:"Airplay"},g["zh-cn"]={HAVE_NOTHING:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u9891/\u89C6\u9891\u7684\u5143\u6570\u636E\u5DF2\u5C31\u7EEA",HAVE_CURRENT_DATA:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC",NETWORK_LOADING:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_DECODE:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u9891/\u89C6\u9891\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7F51\u7EDC\u8FDE\u63A5\u4F3C\u4E4E\u51FA\u73B0\u4E86\u95EE\u9898",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u6682\u505C",PLAYNEXT_TIPS:"\u4E0B\u4E00\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F7D",ROTATE_TIPS:"\u65CB\u8F6C",RELOAD_TIPS:"\u91CD\u65B0\u8F7D\u5165",FULLSCREEN_TIPS:"\u8FDB\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u8FDB\u5165\u6837\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6837\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u753B\u4E2D\u753B",MINIPLAYER:"\u8FF7\u4F60\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u56FE",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u5173\u95ED",MINIPLAYER_DRAG:"\u70B9\u51FB\u6309\u4F4F\u53EF\u62D6\u52A8\u89C6\u9891",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},g["zh-hk"]={HAVE_NOTHING:"\u6C92\u6709\u95DC\u65BC\u97F3\u983B/\u8996\u983B\u662F\u5426\u5C31\u7DD2\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u983B/\u8996\u983B\u7684\u5143\u6578\u64DA\u5DF2\u5C31\u7DD2",HAVE_CURRENT_DATA:"\u95DC\u65BC\u7576\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6C92\u6709\u8DB3\u5920\u7684\u6578\u64DA\u4F86\u64AD\u653E\u4E0B\u58F9\u5E40/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u7576\u524D\u53CA\u81F3\u5C11\u4E0B\u58F9\u5E40\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6578\u64DA\u8DB3\u4EE5\u958B\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u983B/\u8996\u983B\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u983B/\u8996\u983B\u662F\u6D3B\u52D5\u7684\u4E14\u5DF2\u9078\u53D6\u8CC7\u6E90\uFF0C\u4F46\u4E26\u672A\u4F7F\u7528\u7DB2\u7D61",NETWORK_LOADING:"\u700F\u89BD\u5668\u6B63\u5728\u4E0B\u8F09\u6578\u64DA",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u983B/\u8996\u983B\u4F86\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u904E\u7A0B\u88AB\u7528\u6236\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u7576\u4E0B\u8F09\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_DECODE:"\u7576\u89E3\u78BC\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u983B/\u8996\u983B\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7DB2\u7D61\u9023\u63A5\u4F3C\u4E4E\u51FA\u73FE\u4E86\u554F\u984C",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u66AB\u505C",PLAYNEXT_TIPS:"\u4E0B\u58F9\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F09",ROTATE_TIPS:"\u65CB\u8F49",RELOAD_TIPS:"\u91CD\u65B0\u8F09\u5165",FULLSCREEN_TIPS:"\u9032\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u9032\u5165\u6A23\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6A23\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u756B\u4E2D\u756B",MINIPLAYER:"\u8FF7\u59B3\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u5716",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u95DC\u9589",MINIPLAYER_DRAG:"\u9EDE\u64CA\u6309\u4F4F\u53EF\u62D6\u52D5\u8996\u983B",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},g.jp={HAVE_NOTHING:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u6E96\u5099\u3067\u304D\u3066\u3044\u308B\u304B\u60C5\u5831\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_METADATA:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306E\u30E1\u30BF\u30C7\u30FC\u30BF\u306F\u6E96\u5099\u3067\u304D\u3066\u3044\u307E\u3059",HAVE_CURRENT_DATA:"\u73FE\u5728\u306E\u518D\u751F\u4F4D\u7F6E\u306B\u95A2\u3059\u308B\u30C7\u30FC\u30BF\u306F\u5229\u7528\u53EF\u80FD\u3067\u3059\u304C\u3001\u6B21\u306E\u30D5\u30EC\u30FC\u30E0/\u30DF\u30EA\u79D2\u3092\u518D\u751F\u3059\u308B\u306E\u306B\u5341\u5206\u306A\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_FUTURE_DATA:"\u73FE\u5728\u3001\u5C11\u306A\u304F\u3068\u3082\u6B21\u306E\u30D5\u30EC\u30FC\u30E0\u306E\u30C7\u30FC\u30BF\u304C\u5229\u7528\u53EF\u80FD\u3067\u3059",HAVE_ENOUGH_DATA:"\u5229\u7528\u53EF\u80FD\u306A\u30C7\u30FC\u30BF\u306F\u518D\u751F\u3092\u958B\u59CB\u3059\u308B\u306E\u306B\u5341\u5206\u3067\u3059",NETWORK_EMPTY:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u521D\u671F\u5316\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_IDLE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306F\u30A2\u30AF\u30C6\u30A3\u30D6\u3067\u30EA\u30BD\u30FC\u30B9\u304C\u9078\u629E\u3055\u308C\u3066\u3044\u307E\u3059\u304C\u3001\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u304C\u4F7F\u7528\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_LOADING:"\u30D6\u30E9\u30A6\u30B6\u30FC\u306F\u30C7\u30FC\u30BF\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u3057\u3066\u3044\u307E\u3059",NETWORK_NO_SOURCE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u30BD\u30FC\u30B9\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093",MEDIA_ERR_ABORTED:"\u30E6\u30FC\u30B6\u30FC\u306B\u3088\u3063\u3066\u30D5\u30A7\u30C3\u30C1\u30D7\u30ED\u30BB\u30B9\u304C\u4E2D\u6B62\u3055\u308C\u307E\u3057\u305F",MEDIA_ERR_NETWORK:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_DECODE:"\u30C7\u30B3\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u5F62\u5F0F\u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093",REPLAY:"\u30EA\u30D7\u30EC\u30A4",ERROR:"\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u306E\u63A5\u7D9A\u306B\u554F\u984C\u304C\u767A\u751F\u3057\u307E\u3057\u305F",PLAY_TIPS:"\u30D7\u30EC\u30A4",PAUSE_TIPS:"\u4E00\u6642\u505C\u6B62",PLAYNEXT_TIPS:"\u6B21\u3092\u30D7\u30EC\u30A4",DOWNLOAD_TIPS:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",ROTATE_TIPS:"\u56DE\u8EE2",RELOAD_TIPS:"\u518D\u8AAD\u307F\u8FBC\u307F",FULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3",EXITFULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3\u3092\u7D42\u4E86",CSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9",EXITCSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9\u3092\u7D42\u4E86",TEXTTRACK:"\u5B57\u5E55",PIP:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",MINIPLAYER:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",SCREENSHOT:"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8",LIVE:"\u751F\u653E\u9001",OFF:"\u30AA\u30D5",MINIPLAYER_DRAG:"\u30DC\u30BF\u30F3\u3092\u62BC\u3057\u3066\u50CD\u753B\u3092\u30C9\u30E9\u30C3\u30B0\u3059\u308B",AIRPLAY_TIPS:"\u9694\u7A7A\u653E\u9001"},Object.defineProperty(d,"lang",{get:function(){return d.config&&g[d.config.lang]||g.en},set:function(p){(0,n.typeOf)(p)==="Object"&&Object.keys(p).forEach(function(e){g[e]=p[e]})}})};i.default={name:"s_i18n",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function f(c,y){for(var m=0;m<y.length;m++){var _=y[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(c,_.key,_)}}return function(c,y,m){return y&&f(c.prototype,y),m&&f(c,m),c}}(),u=r(12),o=p(u),d=r(0),g=r(4),v=p(g);function p(f){return f&&f.__esModule?f:{default:f}}function e(f,c,y){return c in f?Object.defineProperty(f,c,{value:y,enumerable:!0,configurable:!0,writable:!0}):f[c]=y,f}function s(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")}var l=function(){function f(c){var y=this;s(this,f),this._hasStart=!1,this.videoConfig={controls:!!c.isShowControl,autoplay:c.autoplay,playsinline:c.playsinline,"webkit-playsinline":c.playsinline,"x5-playsinline":c.playsinline,"x5-video-player-type":c["x5-video-player-type"]||c.x5VideoPlayerType,"x5-video-player-fullscreen":c["x5-video-player-fullscreen"]||c.x5VideoPlayerFullscreen,"x5-video-orientation":c["x5-video-orientation"]||c.x5VideoOrientation,airplay:c.airplay,"webkit-airplay":c.airplay,tabindex:2,mediaType:c.mediaType||"video"},c.muted&&(this.videoConfig.muted="muted"),c.loop&&(this.videoConfig.loop="loop");var m="";if(this.textTrackShowDefault=!0,c.nativeTextTrack&&Array.isArray(c.nativeTextTrack)&&(c.nativeTextTrack.length>0&&!c.nativeTextTrack.some(function(b){return b.default})&&(c.nativeTextTrack[0].default=!0,this.textTrackShowDefault=!1),c.nativeTextTrack.some(function(b){if(b.src&&b.label&&b.default)return m+='<track src="'+b.src+'" ',b.kind&&(m+='kind="'+b.kind+'" '),m+='label="'+b.label+'" ',b.srclang&&(m+='srclang="'+b.srclang+'" '),m+=(b.default?"default":"")+">",!0}),this.videoConfig.crossorigin="anonymous"),c.textTrackStyle){var _=document.createElement("style");this.textTrackStyle=_,document.head.appendChild(_);var E="";for(var w in c.textTrackStyle)E+=w+": "+c.textTrackStyle[w]+";";var k=c.id?"#"+c.id:c.el.id?"#"+c.el.id:"."+c.el.className;_.sheet.insertRule?_.sheet.insertRule(k+" video::cue { "+E+" }",0):_.sheet.addRule&&_.sheet.addRule(k+" video::cue",E)}var x=c.el?c.el:(0,d.findDom)(document,"#"+c.id),S=this.constructor.XgVideoProxy;if(S&&this.videoConfig.mediaType===S.mediaType?this.video=new S(x,c):this.video=(0,d.createDom)(this.videoConfig.mediaType,m,this.videoConfig,""),c.videoStyle&&Object.keys(c.videoStyle).forEach(function(b){(0,d.setStyle)(y.video,b,c.videoStyle[b])}),!this.textTrackShowDefault&&m){var B=this.video.getElementsByTagName("Track");B[0].track.mode="hidden"}c.autoplay&&(this.video.autoplay=!0,c.autoplayMuted&&(this.video.muted=!0)),this.ev=["play","playing","pause","ended","error","seeking","seeked","progress","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","ratechange","loadedmetadata","loadeddata","loadstart"].map(function(b){return e({},b,"on"+b.charAt(0).toUpperCase()+b.slice(1))}),(0,o.default)(this),this._interval={};var U="0,0",R=this,C=function(O){!y||(O==="play"?y.hasStart=!0:O==="canplay"?(0,d.removeClass)(y.root,"xgplayer-is-enter"):O==="waiting"?y.inWaitingStart=new Date().getTime():O==="playing"&&((0,d.removeClass)(y.root,"xgplayer-is-enter"),y.inWaitingStart&&(y.inWaitingStart=void 0)),O==="error"?y._onError(O):y.emit(O,y),y.hasOwnProperty("_interval")&&(["ended","error","timeupdate"].indexOf(O)<0?((0,d._clearInterval)(y,"bufferedChange"),(0,d._setInterval)(y,"bufferedChange",function(){if(this.video&&this.video.buffered){for(var W=[],K=0,G=this.video.buffered.length;K<G;K++)W.push([this.video.buffered.start(K),this.video.buffered.end(K)]);W.toString()!==U&&(U=W.toString(),this.emit("bufferedChange",W))}},200)):O!=="timeupdate"&&(0,d._clearInterval)(y,"bufferedChange")))},A=function(O){c.videoEventMiddleware&&typeof c.videoEventMiddleware[O]=="function"?c.videoEventMiddleware[O].call(y,y,O,C):C.call(y,O)};this.ev.forEach(function(b){R.evItem=Object.keys(b)[0];var O=Object.keys(b)[0];R.video.addEventListener(Object.keys(b)[0],A.bind(R,O))})}return n(f,[{key:"_onError",value:function(y){this.video&&this.video.error&&this.emit(y,new v.default("other",this.currentTime,this.duration,this.networkState,this.readyState,this.currentSrc,this.src,this.ended,{line:162,msg:this.error,handle:"Constructor"},this.video.error.code,this.video.error))}},{key:"destroy",value:function(){this.textTrackStyle&&this.textTrackStyle.parentNode.removeChild(this.textTrackStyle)}},{key:"play",value:function(){return this.video.play()}},{key:"pause",value:function(){this.video.pause()}},{key:"canPlayType",value:function(y){return this.video.canPlayType(y)}},{key:"getBufferedRange",value:function(y){var m=[0,0],_=this.video;y||(y=_.buffered);var E=_.currentTime;if(y)for(var w=0,k=y.length;w<k&&(m[0]=y.start(w),m[1]=y.end(w),!(m[0]<=E&&E<=m[1]));w++);return m[0]-E<=0&&E-m[1]<=0?m:[0,0]}},{key:"proxyOn",value:function(y,m){(0,d.on)(this,y,m,"destroy")}},{key:"proxyOnce",value:function(y,m){(0,d.once)(this,y,m,"destroy")}},{key:"hasStart",get:function(){return this._hasStart},set:function(y){typeof y=="boolean"&&y===!0&&!this._hasStart&&(this._hasStart=!0,this.emit("hasstart"))}},{key:"autoplay",set:function(y){this.video&&(this.video.autoplay=y)},get:function(){return this.video?this.video.autoplay:!1}},{key:"buffered",get:function(){if(this.video)return this.video.buffered}},{key:"buffered2",get:function(){return(0,d.getBuffered2)(this.video.buffered)}},{key:"crossOrigin",get:function(){return this.video?this.video.crossOrigin:!1},set:function(y){this.video&&(this.video.crossOrigin=y)}},{key:"currentSrc",get:function(){if(this.video)return this.video.currentSrc}},{key:"currentTime",get:function(){return this.video&&this.video.currentTime||0},set:function(y){var m=this;typeof isFinite=="function"&&!isFinite(y)||((0,d.hasClass)(this.root,"xgplayer-ended")?(this.once("playing",function(){m.video.currentTime=y}),this.replay()):this.video.currentTime=y,this.emit("currentTimeChange",y))}},{key:"defaultMuted",get:function(){return this.video?this.video.defaultMuted:!1},set:function(y){this.video&&(this.video.defaultMuted=y)}},{key:"duration",get:function(){return this.config.duration?this.video?Math.min(this.config.duration,this.video.duration):this.config.duration:this.video?this.video.duration:null}},{key:"ended",get:function(){return this.video?this.video.ended||!1:!0}},{key:"error",get:function(){var y=this.video.error;if(!y)return null;var m=[{en:"MEDIA_ERR_ABORTED",cn:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62"},{en:"MEDIA_ERR_NETWORK",cn:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_DECODE",cn:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_SRC_NOT_SUPPORTED",cn:"\u4E0D\u652F\u6301\u97F3\u9891/\u89C6\u9891"}];return this.lang?this.lang[m[y.code-1].en]:m[y.code-1].en}},{key:"loop",get:function(){return this.video?this.video.loop:!1},set:function(y){this.video&&(this.video.loop=y)}},{key:"muted",get:function(){return this.video?this.video.muted:!1},set:function(y){this.video&&(this.video.muted=y)}},{key:"networkState",get:function(){var y=[{en:"NETWORK_EMPTY",cn:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316"},{en:"NETWORK_IDLE",cn:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC"},{en:"NETWORK_LOADING",cn:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E"},{en:"NETWORK_NO_SOURCE",cn:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90"}];return this.lang?this.lang[y[this.video.networkState].en]:y[this.video.networkState].en}},{key:"paused",get:function(){return(0,d.hasClass)(this.root,"xgplayer-pause")}},{key:"playbackRate",get:function(){return this.video?this.video.playbackRate:1},set:function(y){this.video&&(this.video.playbackRate=y)}},{key:"played",get:function(){if(this.video)return this.video.played}},{key:"preload",get:function(){return this.video?this.video.preload:!1},set:function(y){this.video&&(this.video.preload=y)}},{key:"readyState",get:function(){var y=[{en:"HAVE_NOTHING",cn:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F"},{en:"HAVE_METADATA",cn:"\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u5C31\u7EEA\u7684\u5143\u6570\u636E"},{en:"HAVE_CURRENT_DATA",cn:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2"},{en:"HAVE_FUTURE_DATA",cn:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684"},{en:"HAVE_ENOUGH_DATA",cn:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E"}];return this.lang?this.lang[y[this.video.readyState].en]:y[this.video.readyState]}},{key:"seekable",get:function(){return this.video?this.video.seekable:!1}},{key:"seeking",get:function(){return this.video?this.video.seeking:!1}},{key:"src",get:function(){if(this.video)return this.video.src},set:function(y){(0,d.hasClass)(this.root,"xgplayer-ended")||this.emit("urlchange",this.video.src),(0,d.removeClass)(this.root,"xgplayer-ended xgplayer-is-replay xgplayer-is-error"),this.video.pause(),this.emit("pause"),this.video.src=y,this.emit("srcChange")}},{key:"poster",set:function(y){var m=(0,d.findDom)(this.root,".xgplayer-poster");m&&(m.style.backgroundImage="url("+y+")")}},{key:"volume",get:function(){return this.video?this.video.volume:1},set:function(y){this.video&&(this.video.volume=y)}},{key:"fullscreen",get:function(){return(0,d.hasClass)(this.root,"xgplayer-is-fullscreen")||(0,d.hasClass)(this.root,"xgplayer-fullscreen-active")}},{key:"bullet",get:function(){return(0,d.findDom)(this.root,"xg-danmu")?(0,d.hasClass)((0,d.findDom)(this.root,"xg-danmu"),"xgplayer-has-danmu"):!1}},{key:"textTrack",get:function(){return(0,d.hasClass)(this.root,"xgplayer-is-textTrack")}},{key:"pip",get:function(){return(0,d.hasClass)(this.root,"xgplayer-pip-active")}},{key:"isMiniPlayer",get:function(){return(0,d.hasClass)(this.root,"xgplayer-miniplayer-active")}}]),f}();i.default=l,t.exports=i.default},function(t,i,r){var n=r(13),u=r(30),o=Function.prototype.apply,d=Function.prototype.call,g=Object.create,v=Object.defineProperty,p=Object.defineProperties,e=Object.prototype.hasOwnProperty,s={configurable:!0,enumerable:!1,writable:!0},l,f,c,y,m,_,E;l=function(w,k){var x;return u(k),e.call(this,"__ee__")?x=this.__ee__:(x=s.value=g(null),v(this,"__ee__",s),s.value=null),x[w]?typeof x[w]=="object"?x[w].push(k):x[w]=[x[w],k]:x[w]=k,this},f=function(w,k){var x,S;return u(k),S=this,l.call(this,w,x=function(){c.call(S,w,x),o.call(k,this,arguments)}),x.__eeOnceListener__=k,this},c=function(w,k){var x,S,B,U;if(u(k),!e.call(this,"__ee__"))return this;if(x=this.__ee__,!x[w])return this;if(S=x[w],typeof S=="object")for(U=0;B=S[U];++U)(B===k||B.__eeOnceListener__===k)&&(S.length===2?x[w]=S[U?0:1]:S.splice(U,1));else(S===k||S.__eeOnceListener__===k)&&delete x[w];return this},y=function(w){var k,x,S,B,U;if(!!e.call(this,"__ee__")&&(B=this.__ee__[w],!!B))if(typeof B=="object"){for(x=arguments.length,U=new Array(x-1),k=1;k<x;++k)U[k-1]=arguments[k];for(B=B.slice(),k=0;S=B[k];++k)o.call(S,this,U)}else switch(arguments.length){case 1:d.call(B,this);break;case 2:d.call(B,this,arguments[1]);break;case 3:d.call(B,this,arguments[1],arguments[2]);break;default:for(x=arguments.length,U=new Array(x-1),k=1;k<x;++k)U[k-1]=arguments[k];o.call(B,this,U)}},m={on:l,once:f,off:c,emit:y},_={on:n(l),once:n(f),off:n(c),emit:n(y)},E=p({},_),t.exports=i=function(w){return w==null?g(E):p(Object(w),_)},i.methods=m},function(t,i,r){var n=r(6),u=r(14),o=r(18),d=r(26),g=r(27),v=t.exports=function(p,e){var s,l,f,c,y;return arguments.length<2||typeof p!="string"?(c=e,e=p,p=null):c=arguments[2],n(p)?(s=g.call(p,"c"),l=g.call(p,"e"),f=g.call(p,"w")):(s=f=!0,l=!1),y={value:e,configurable:s,enumerable:l,writable:f},c?o(d(c),y):y};v.gs=function(p,e,s){var l,f,c,y;return typeof p!="string"?(c=s,s=e,e=p,p=null):c=arguments[3],n(e)?u(e)?n(s)?u(s)||(c=s,s=void 0):s=void 0:(c=e,e=s=void 0):e=void 0,n(p)?(l=g.call(p,"c"),f=g.call(p,"e")):(l=!0,f=!1),y={get:e,set:s,configurable:l,enumerable:f},c?o(d(c),y):y}},function(t,i,r){var n=r(15),u=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(d){return!(!n(d)||u.test(o.call(d)))}},function(t,i,r){var n=r(16);t.exports=function(u){if(typeof u!="function"||!hasOwnProperty.call(u,"length"))return!1;try{if(typeof u.length!="number"||typeof u.call!="function"||typeof u.apply!="function")return!1}catch(o){return!1}return!n(u)}},function(t,i,r){var n=r(17);t.exports=function(u){if(!n(u))return!1;try{return u.constructor?u.constructor.prototype===u:!1}catch(o){return!1}}},function(t,i,r){var n=r(6),u={object:!0,function:!0,undefined:!0};t.exports=function(o){return n(o)?hasOwnProperty.call(u,typeof o):!1}},function(t,i,r){t.exports=r(19)()?Object.assign:r(20)},function(t,i,r){t.exports=function(){var n=Object.assign,u;return typeof n!="function"?!1:(u={foo:"raz"},n(u,{bar:"dwa"},{trzy:"trzy"}),u.foo+u.bar+u.trzy==="razdwatrzy")}},function(t,i,r){var n=r(21),u=r(25),o=Math.max;t.exports=function(d,g){var v,p,e=o(arguments.length,2),s;for(d=Object(u(d)),s=function(l){try{d[l]=g[l]}catch(f){v||(v=f)}},p=1;p<e;++p)g=arguments[p],n(g).forEach(s);if(v!==void 0)throw v;return d}},function(t,i,r){t.exports=r(22)()?Object.keys:r(23)},function(t,i,r){t.exports=function(){try{return Object.keys("primitive"),!0}catch(n){return!1}}},function(t,i,r){var n=r(3),u=Object.keys;t.exports=function(o){return u(n(o)?Object(o):o)}},function(t,i,r){t.exports=function(){}},function(t,i,r){var n=r(3);t.exports=function(u){if(!n(u))throw new TypeError("Cannot use null or undefined");return u}},function(t,i,r){var n=r(3),u=Array.prototype.forEach,o=Object.create,d=function(g,v){var p;for(p in g)v[p]=g[p]};t.exports=function(g){var v=o(null);return u.call(arguments,function(p){!n(p)||d(Object(p),v)}),v}},function(t,i,r){t.exports=r(28)()?String.prototype.contains:r(29)},function(t,i,r){var n="razdwatrzy";t.exports=function(){return typeof n.contains!="function"?!1:n.contains("dwa")===!0&&n.contains("foo")===!1}},function(t,i,r){var n=String.prototype.indexOf;t.exports=function(u){return n.call(this,u,arguments[1])>-1}},function(t,i,r){t.exports=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}},function(t,i,r){var n=r(32),u=Object.prototype.hasOwnProperty;t.exports=function(o){var d=arguments[1],g;if(n(o),d!==void 0){if(g=u.call(o,"__ee__")&&o.__ee__,!g)return;g[d]&&delete g[d];return}u.call(o,"__ee__")&&delete o.__ee__}},function(t,i,r){var n=r(33);t.exports=function(u){if(!n(u))throw new TypeError(u+" is not an Object");return u}},function(t,i,r){var n=r(3),u={function:!0,object:!0};t.exports=function(o){return n(o)&&u[typeof o]||!1}},function(t,i,r){var n=r(35);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default{background:#000;width:100%;height:100%;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.xgplayer-skin-default *{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}.xgplayer-skin-default.xgplayer-rotate-fullscreen{position:absolute;top:0;left:100%;bottom:0;right:0;height:100vw!important;width:100vh!important;-webkit-transform-origin:top left;-ms-transform-origin:top left;transform-origin:top left;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.xgplayer-skin-default.xgplayer-is-fullscreen{width:100%!important;height:100%!important;padding-top:0!important;z-index:9999}.xgplayer-skin-default.xgplayer-is-fullscreen.xgplayer-inactive{cursor:none}.xgplayer-skin-default video{width:100%;height:100%;outline:none}.xgplayer-skin-default .xgplayer-none{display:none}@-webkit-keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}@keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}.xgplayer-skin-default .xgplayer-controls{display:-webkit-flex;display:-moz-box;display:flex;position:absolute;bottom:0;left:0;right:0;height:40px;background-image:linear-gradient(180deg,transparent,rgba(0,0,0,.37),rgba(0,0,0,.75),rgba(0,0,0,.75));z-index:10}.xgplayer-skin-default.xgplayer-inactive .xgplayer-controls,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-progress,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-time,.xgplayer-skin-default.xgplayer-no-controls .xgplayer-controls,.xgplayer-skin-default.xgplayer-nostart .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-live{display:block}.xgplayer-skin-default .xgplayer-live{display:block;font-size:12px;color:#fff;line-height:40px;-webkit-order:1;-moz-box-ordinal-group:2;order:1}.xgplayer-skin-default .xgplayer-icon{display:block;width:40px;height:40px;overflow:hidden;fill:#fff}.xgplayer-skin-default .xgplayer-icon svg{position:absolute}.xgplayer-skin-default .xgplayer-tips{background:rgba(0,0,0,.54);border-radius:1px;display:none;position:absolute;font-family:PingFangSC-Regular;font-size:11px;color:#fff;padding:2px 4px;text-align:center;top:-30px;left:50%;margin-left:-16px;width:auto;white-space:nowrap}.xgplayer-skin-default.xgplayer-mobile .xgplayer-tips{display:none!important}.xgplayer-skin-default .xgplayer-screen-container{display:block;width:100%}",""])},function(t,i){t.exports=function(r){var n=typeof window!="undefined"&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!r||typeof r!="string")return r;var u=n.protocol+"//"+n.host,o=u+n.pathname.replace(/\/[^\/]*$/,"/"),d=r.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(g,v){var p=v.trim().replace(/^"(.*)"$/,function(s,l){return l}).replace(/^'(.*)'$/,function(s,l){return l});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(p))return g;var e;return p.indexOf("//")===0?e=p:p.indexOf("/")===0?e=u+p:e=o+p.replace(/^\.\//,""),"url("+JSON.stringify(e)+")"});return d}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root,v=0,p=void 0,e={first:"",second:""};d.onElementTouchend=function(f,c){this.config.closeVideoPreventDefault||f.preventDefault(),this.config.closeVideoStopPropagation||f.stopPropagation();var y=this;if((0,n.hasClass)(g,"xgplayer-inactive")?y.emit("focus"):y.emit("blur"),!y.config.closeVideoTouch&&!y.isTouchMove){var m=function(){p=setTimeout(function(){if((0,n.hasClass)(y.root,"xgplayer-nostart"))return!1;if(!y.ended)if(y.paused){var E=y.play();E!==void 0&&E&&E.catch(function(w){})}else y.pause();v=0},200)};y.config.closeVideoClick||(v++,p&&clearTimeout(p),v===1?y.config.enableVideoDbltouch?e.first=new Date:m():v===2&&y.config.enableVideoDbltouch?(e.second=new Date,Math.abs(e.first-e.second)<400?m():(e.first=new Date,v=1)):v=0)}};function s(f){d.video.addEventListener("touchend",function(c){d.onElementTouchend(c,d.video)}),d.video.addEventListener("touchstart",function(){d.isTouchMove=!1}),d.video.addEventListener("touchmove",function(){d.isTouchMove=!0}),d.config.autoplay&&d.start()}d.once("ready",s);function l(){d.off("ready",s),d.off("destroy",l)}d.once("destroy",l)};i.default={name:"mobile",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this;if(!d.controls||!d.video)return;var g=d.controls,v=d.root,p=0,e=void 0;d.onElementClick=function(E,w){this.config.closeVideoPreventDefault||E.preventDefault(),this.config.closeVideoStopPropagation||E.stopPropagation();var k=this;k.config.closeVideoClick||(p++,e&&clearTimeout(e),p===1?e=setTimeout(function(){if((0,n.hasClass)(k.root,"xgplayer-nostart"))return!1;if(!k.ended)if(k.paused){var x=k.play();x!==void 0&&x&&x.catch(function(S){})}else k.pause();p=0},200):p=0)},d.video.addEventListener("click",function(E){d.onElementClick(E,d.video)},!1),d.onElementDblclick=function(E,w){this.config.closeVideoPreventDefault||E.preventDefault(),this.config.closeVideoStopPropagation||E.stopPropagation();var k=this;if(!k.config.closeVideoDblclick){var x=g.querySelector(".xgplayer-fullscreen");if(x){var S=void 0;document.createEvent?(S=document.createEvent("Event"),S.initEvent("click",!0,!0)):S=new Event("click"),x.dispatchEvent(S)}}},d.video.addEventListener("dblclick",function(E){d.onElementDblclick(E,d.video)},!1);function s(){clearTimeout(d.leavePlayerTimer),d.emit("focus",d)}v.addEventListener("mouseenter",s);function l(){d.config.closePlayerBlur||(d.leavePlayerTimer=setTimeout(function(){d.emit("blur",d)},d.config.leavePlayerTime||0))}v.addEventListener("mouseleave",l);function f(E){d.userTimer&&clearTimeout(d.userTimer)}g.addEventListener("mouseenter",f);function c(E){d.config.closeControlsBlur||d.emit("focus",d)}g.addEventListener("mouseleave",c);function y(E){E.preventDefault(),E.stopPropagation()}g.addEventListener("click",y);function m(E){d.config.autoplay&&d.start()}d.once("ready",m);function _(){v.removeEventListener("mouseenter",s),v.removeEventListener("mouseleave",l),d.off("ready",m),d.off("destroy",_)}d.once("destroy",_)};i.default={name:"pc",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root;function v(){d.off("canplay",v);var s=d.play();s!==void 0&&s&&s.catch(function(l){})}function p(){(0,n.hasClass)(g,"xgplayer-nostart")?((0,n.removeClass)(g,"xgplayer-nostart"),(0,n.addClass)(g,"xgplayer-is-enter"),typeof g.contains=="function"?d.video&&d.video.nodeType===1&&!g.contains(d.video)||d.video&&d.video.nodeType!==1&&d.video.mediaSource===void 0?(d.once("canplay",v),d.start()):v():d.video&&d.video.nodeType===1&&!g.querySelector(this.videoConfig.mediaType)||d.video&&d.video.nodeType!==1&&d.video.mediaSource===void 0?(d.once("canplay",v),d.start()):v()):d.paused&&((0,n.removeClass)(g,"xgplayer-nostart xgplayer-isloading"),setTimeout(function(){var s=d.play();s!==void 0&&s&&s.catch(function(l){})},10))}d.on("startBtnClick",p);function e(){d.off("startBtnClick",p),d.off("canplay",v),d.off("destroy",e)}d.once("destroy",e)};i.default={name:"start",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(41),o=v(u),d=r(42),g=v(d);r(43);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.root,f=(0,n.createDom)("xg-start",'<div class="xgplayer-icon-play">'+o.default+`</div>
                                      <div class="xgplayer-icon-pause">`+g.default+"</div>",{},"xgplayer-start");function c(y){(0,n.addClass)(y.root,"xgplayer-skin-default"),y.config&&(y.config.autoplay&&!(0,n.isWeiXin)()&&!(0,n.isUc)()&&(0,n.addClass)(y.root,"xgplayer-is-enter"),y.config.lang&&y.config.lang==="en"?(0,n.addClass)(y.root,"xgplayer-lang-is-en"):y.config.lang==="jp"&&(0,n.addClass)(y.root,"xgplayer-lang-is-jp"),y.config.enableContextmenu||y.video.addEventListener("contextmenu",function(m){m.preventDefault(),m.stopPropagation()}))}s.config&&s.config.hideStartBtn&&(0,n.addClass)(l,"xgplayer-start-hide"),s.isReady?(l.appendChild(f),c(s)):s.once("ready",function(){l.appendChild(f),c(s)}),s.once("autoplay was prevented",function(){(0,n.removeClass)(s.root,"xgplayer-is-enter"),(0,n.addClass)(s.root,"xgplayer-nostart")}),s.once("canplay",function(){(0,n.removeClass)(s.root,"xgplayer-is-enter")}),f.onclick=function(y){y.preventDefault(),y.stopPropagation(),s.userGestureTrigEvent("startBtnClick")}};i.default={name:"s_start",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04,0.04)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04 0.04)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(t,i,r){var n=r(44);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-start{border-radius:50%;display:inline-block;width:70px;height:70px;background:rgba(0,0,0,.38);overflow:hidden;text-align:center;line-height:70px;vertical-align:middle;position:absolute;left:50%;top:50%;z-index:115;margin:-35px auto auto -35px;cursor:pointer}.xgplayer-skin-default .xgplayer-start div{position:absolute}.xgplayer-skin-default .xgplayer-start div svg{fill:hsla(0,0%,100%,.7)}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-start:hover{opacity:.85}.xgplayer-skin-default.xgplayer-pause.xgplayer-start-hide .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-start-hide .xgplayer-start{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start{display:inline-block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start,.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-pause{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root;function v(){d.config.rotateFullscreen?(0,n.hasClass)(g,"xgplayer-rotate-fullscreen")?d.exitRotateFullscreen():d.getRotateFullscreen():(0,n.hasClass)(g,"xgplayer-is-fullscreen")?d.exitFullscreen(g):d.getFullscreen(g)}d.on("fullscreenBtnClick",v);function p(){var l=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;l&&l===g?((0,n.addClass)(g,"xgplayer-is-fullscreen"),d.emit("requestFullscreen")):(0,n.hasClass)(g,"xgplayer-is-fullscreen")&&((0,n.removeClass)(g,"xgplayer-is-fullscreen"),d.emit("exitFullscreen")),d.danmu&&typeof d.danmu.resize=="function"&&d.danmu.resize()}["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(l){document.addEventListener(l,p)}),d.video.addEventListener("webkitbeginfullscreen",function(){(0,n.addClass)(g,"xgplayer-is-fullscreen"),d.emit("requestFullscreen")}),d.video.addEventListener("webkitendfullscreen",function(){(0,n.removeClass)(g,"xgplayer-is-fullscreen"),d.emit("exitFullscreen")});function e(l){var f=d.video.webkitPresentationMode;f!==n.PresentationMode.FULLSCREEN&&((0,n.removeClass)(g,"xgplayer-is-fullscreen"),d.emit("exitFullscreen"))}(0,n.checkWebkitSetPresentationMode)(d.video)&&d.video.addEventListener("webkitpresentationmodechanged",e);function s(){d.off("fullscreenBtnClick",v),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(l){document.removeEventListener(l,p)}),(0,n.checkWebkitSetPresentationMode)(d.video)&&d.video.removeEventListener("webkitpresentationmodechanged",e),d.off("destroy",s)}d.once("destroy",s),d.getFullscreen=function(l){var f=this;if(l.requestFullscreen){var c=l.requestFullscreen();c&&c.catch(function(){f.emit("fullscreen error")})}else l.mozRequestFullScreen?l.mozRequestFullScreen():l.webkitRequestFullscreen?l.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):f.video.webkitSupportsFullscreen?f.video.webkitEnterFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():(0,n.addClass)(l,"xgplayer-is-cssfullscreen")},d.exitFullscreen=function(l){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),(0,n.removeClass)(l,"xgplayer-is-cssfullscreen")},d.getRotateFullscreen=function(){var l=this;document.documentElement.style.width="100%",document.documentElement.style.height="100%",l.config.fluid&&(l.root.style["padding-top"]="",l.root.style["max-width"]="unset"),l.root&&!(0,n.hasClass)(l.root,"xgplayer-rotate-fullscreen")&&(0,n.addClass)(l.root,"xgplayer-rotate-fullscreen"),l.emit("getRotateFullscreen")},d.exitRotateFullscreen=function(){var l=this;document.documentElement.style.width="unset",document.documentElement.style.height="unset",l.config.fluid&&(l.root.style.width="100%",l.root.style.height="0",l.root.style["padding-top"]=l.config.height*100/l.config.width+"%",l.root.style["max-width"]="100%"),l.root&&(0,n.hasClass)(l.root,"xgplayer-rotate-fullscreen")&&(0,n.removeClass)(l.root,"xgplayer-rotate-fullscreen"),l.emit("exitRotateFullscreen")}};i.default={name:"fullscreen",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this;function g(){if(!(!d.config.allowPlayAfterEnded&&d.ended))if((0,n.hasClass)(d.root,"xgplayer-nostart")&&d.start(),d.paused){var p=d.play();p!==void 0&&p&&p.catch(function(e){})}else d.pause()}d.on("playBtnClick",g);function v(){d.off("playBtnClick",g),d.off("destroy",v)}d.once("destroy",v)};i.default={name:"play",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root;function v(){(0,n.removeClass)(g,"xgplayer-is-replay"),d.replay()}d.on("replayBtnClick",v);function p(){d.config.loop||(0,n.addClass)(g,"xgplayer-is-replay")}d.on("ended",p);function e(){d.off("replayBtnClick",v),d.off("destroy",e)}d.once("destroy",e)};i.default={name:"replay",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(49),o=v(u),d=r(50),g=v(d);r(51);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.config.playBtn?s.config.playBtn:{},f=void 0;l.type==="img"?f=(0,n.createImgBtn)("play",l.url.play,l.width,l.height):f=(0,n.createDom)("xg-play",`<xg-icon class="xgplayer-icon">
                                      <div class="xgplayer-icon-play">`+o.default+`</div>
                                      <div class="xgplayer-icon-pause">`+g.default+`</div>
                                     </xg-icon>`,{},"xgplayer-play");var c={};c.play=s.lang.PLAY_TIPS,c.pause=s.lang.PAUSE_TIPS;var y=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-play">'+c.play+`</span>
                                        <span class="xgplayer-tip-pause">`+c.pause+"</span>",{},"xgplayer-tips");f.appendChild(y),s.once("ready",function(){s.controls&&s.controls.appendChild(f)}),["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),s.userGestureTrigEvent("playBtnClick")})})};i.default={name:"s_play",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(t,i,r){var n=r(52);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-play,.xgplayer-skin-default .xgplayer-play-img{width:40px;position:relative;-webkit-order:0;-moz-box-ordinal-group:1;order:0;display:block;cursor:pointer;margin-left:3px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-play .xgplayer-icon{margin-top:3px;width:32px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-play .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}.xgplayer-skin-default .xgplayer-play-img:hover,.xgplayer-skin-default .xgplayer-play:hover{opacity:.85}.xgplayer-skin-default .xgplayer-play-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-play:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(54);var u=function(){var d=this,g=d.root;if(!!d.config.poster){var v=(0,n.createDom)("xg-poster","",{},"xgplayer-poster");v.style.backgroundImage="url("+d.config.poster+")",g.appendChild(v)}};i.default={name:"s_poster",method:u},t.exports=i.default},function(t,i,r){var n=r(55);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-poster{display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:100;background-size:cover;background-position:50%}.xgplayer-skin-default.xgplayer-nostart .xgplayer-poster{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(57);var u=function(){var d=this,g=(0,n.createDom)("xg-placeholder","",{},"xgplayer-placeholder");d.controls.appendChild(g)};i.default={name:"s_flex",method:u},t.exports=i.default},function(t,i,r){var n=r(58);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-placeholder{-webkit-flex:1;-moz-box-flex:1;flex:1;-webkit-order:3;-moz-box-ordinal-group:4;order:3;display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(60),o=v(u),d=r(61),g=v(d);r(62);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.config.fullscreenBtn?s.config.fullscreenBtn:{},f=void 0;l.type==="img"?f=(0,n.createImgBtn)("fullscreen",l.url.request,l.width,l.height):f=(0,n.createDom)("xg-fullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+o.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+g.default+`</div>
                                           </xg-icon>`,{},"xgplayer-fullscreen");var c={};c.requestfull=s.lang.FULLSCREEN_TIPS,c.exitfull=s.lang.EXITFULLSCREEN_TIPS;var y=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+c.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+c.exitfull+"</span>",{},"xgplayer-tips");f.appendChild(y),s.once("ready",function(){s.controls&&s.controls.appendChild(f)}),["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),s.userGestureTrigEvent("fullscreenBtnClick")})})};i.default={name:"s_fullscreen",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`},function(t,i,r){var n=r(63);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-fullscreen,.xgplayer-skin-default .xgplayer-fullscreen-img{position:relative;-webkit-order:13;-moz-box-ordinal-group:14;order:13;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img:hover,.xgplayer-skin-default .xgplayer-fullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-fullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(65),o=d(u);r(66);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=(0,n.createDom)("xg-loading",""+o.default,{},"xgplayer-loading");p.once("ready",function(){e.appendChild(s)})};i.default={name:"s_loading",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100">
  <path d="M100,50A50,50,0,1,1,50,0"></path>
</svg>
`},function(t,i,r){var n=r(67);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-loading{display:none;width:100px;height:100px;overflow:hidden;-webkit-transform:scale(.7);-ms-transform:scale(.7);transform:scale(.7);position:absolute;left:50%;top:50%;margin:-50px auto auto -50px}.xgplayer-skin-default .xgplayer-loading svg{border-radius:50%;-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-animation:loadingRotate 1s linear infinite;animation:loadingRotate 1s linear infinite}.xgplayer-skin-default .xgplayer-loading svg path{stroke:#ddd;stroke-dasharray:236;-webkit-animation:loadingDashOffset 2s linear infinite;animation:loadingDashOffset 2s linear infinite;animation-direction:alternate-reverse;fill:none;stroke-width:12px}.xgplayer-skin-default.xgplayer-nostart .xgplayer-loading{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-loading{display:none!important}.xgplayer-skin-default.xgplayer-isloading .xgplayer-loading{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=d(u);r(69);function d(p){return p&&p.__esModule?p:{default:p}}var g=function(e){return(0,n.hasClass)(e.root,"xgplayer-rotate-fullscreen")},v=function(){var e=this,s=(0,n.createDom)("xg-progress",`<xg-outer class="xgplayer-progress-outer">
                                                   <xg-cache class="xgplayer-progress-cache"></xg-cache>
                                                   <xg-played class="xgplayer-progress-played">
                                                     <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
                                                     <xg-point class="xgplayer-progress-point xgplayer-tips"></xg-point>
                                                     <xg-thumbnail class="xgplayer-progress-thumbnail xgplayer-tips"></xg-thumbnail>
                                                   </xg-played>
                                                 </xg-outer>`,{tabindex:1},"xgplayer-progress"),l=void 0;e.controls.appendChild(s);var f=s.querySelector(".xgplayer-progress-played"),c=s.querySelector(".xgplayer-progress-outer"),y=s.querySelector(".xgplayer-progress-cache"),m=s.querySelector(".xgplayer-progress-point"),_=s.querySelector(".xgplayer-progress-thumbnail");e.dotArr={};function E(Z,te){Z.addEventListener("mouseenter",function(ae){te&&((0,n.addClass)(Z,"xgplayer-progress-dot-show"),(0,n.addClass)(s,"xgplayer-progress-dot-active"))}),Z.addEventListener("mouseleave",function(ae){te&&((0,n.removeClass)(Z,"xgplayer-progress-dot-show"),(0,n.removeClass)(s,"xgplayer-progress-dot-active"))}),Z.addEventListener("touchend",function(ae){ae.stopPropagation(),te&&((0,n.hasClass)(Z,"xgplayer-progress-dot-show")||Object.keys(e.dotArr).forEach(function(Ee){e.dotArr[Ee]&&(0,n.removeClass)(e.dotArr[Ee],"xgplayer-progress-dot-show")}),(0,n.toggleClass)(Z,"xgplayer-progress-dot-show"),(0,n.toggleClass)(s,"xgplayer-progress-dot-active"))})}function w(){e.config.progressDot&&(0,n.typeOf)(e.config.progressDot)==="Array"&&e.config.progressDot.forEach(function(Z){if(Z.time>=0&&Z.time<=e.duration){var te=(0,n.createDom)("xg-progress-dot",Z.text?'<span class="xgplayer-progress-tip">'+Z.text+"</span>":"",{},"xgplayer-progress-dot");if(te.style.left=Z.time/e.duration*100+"%",Z.duration>=0&&(te.style.width=Math.min(Z.duration,e.duration-Z.time)/e.duration*100+"%"),Z.style)for(var ae in Z.style)te.style[ae]=Z.style[ae];c.appendChild(te),e.dotArr[Z.time]=te,E(te,Z.text)}})}e.once("canplay",w),e.addProgressDot=function(Z,te,ae,Ee){if(!e.dotArr[Z]&&Z>=0&&Z<=e.duration){var Te=(0,n.createDom)("xg-progress-dot",te?'<span class="xgplayer-progress-tip">'+te+"</span>":"",{},"xgplayer-progress-dot");if(Te.style.left=Z/e.duration*100+"%",ae>=0&&(Te.style.width=Math.min(ae,e.duration-Z)/e.duration*100+"%"),Ee)for(var Ae in Ee)Te.style[Ae]=Ee[Ae];c.appendChild(Te),e.dotArr[Z]=Te,E(Te,te)}},e.removeProgressDot=function(Z){if(Z>=0&&Z<=e.duration&&e.dotArr[Z]){var te=e.dotArr[Z];te.parentNode.removeChild(te),te=null,e.dotArr[Z]=null}},e.removeAllProgressDot=function(){Object.keys(e.dotArr).forEach(function(Z){if(e.dotArr[Z]){var te=e.dotArr[Z];te.parentNode.removeChild(te),te=null,e.dotArr[Z]=null}})};var k=0,x=0,S=0,B=0,U=0,R=0,C=[],A=void 0,b=void 0,O=function(){e.config.thumbnail&&(e.config.thumbnail.isShowCoverPreview&&!A&&(f.removeChild(_),A=(0,n.createDom)("xg-coverpreview",`<xg-outer class="xgplayer-coverpreview-outer">
            <xg-thumbnail class="xgplayer-coverpreview-thumbnail"></xg-thumbnail>
            <xg-point class="xgplayer-coverpreview-point"></xg-point>
          </xg-outer>`,{tabindex:1},"xgplayer-coverpreview"),A.querySelector(".xgplayer-coverpreview-outer"),b=A.querySelector(".xgplayer-coverpreview-point"),_=A.querySelector(".xgplayer-coverpreview-thumbnail"),e.root.appendChild(A)),k=e.config.thumbnail.pic_num,x=e.config.thumbnail.width,S=e.config.thumbnail.height,B=e.config.thumbnail.col,U=e.config.thumbnail.row,C=e.config.thumbnail.urls,_.style.width=x+"px",_.style.height=S+"px")};e.on("loadedmetadata",O),typeof e.config.disableSwipeHandler=="function"&&typeof e.config.enableSwipeHandler=="function"&&(e.root.addEventListener("touchmove",function(Z){Z.preventDefault(),e.disableSwipe||(e.disableSwipe=!0,e.config.disableSwipeHandler.call(e))}),e.root.addEventListener("touchstart",function(Z){e.disableSwipe=!0,e.config.disableSwipeHandler.call(e)}),e.root.addEventListener("touchend",function(Z){e.disableSwipe=!1,e.config.enableSwipeHandler.call(e)}));var W=["touchstart","mousedown"];o.default.device==="mobile"&&W.pop(),W.forEach(function(Z){s.addEventListener(Z,function(te){if(!e.config.disableProgress){if(te.stopPropagation(),(0,n.event)(te),te._target===m||!e.config.allowSeekAfterEnded&&e.ended)return!0;s.focus();var ae=f.getBoundingClientRect(),Ee=ae.left,Te=g(e);Te?(Ee=f.getBoundingClientRect().top,l=s.getBoundingClientRect().height):(l=s.getBoundingClientRect().width,Ee=f.getBoundingClientRect().left);var Ae=function(Ce){Ce.stopPropagation(),(0,n.event)(Ce),e.isProgressMoving=!0;var Oe=(Te?Ce.clientY:Ce.clientX)-Ee;Oe>l&&(Oe=l);var $e=Oe/l*e.duration;if($e<0&&($e=0),!(e.config.allowSeekPlayed&&Number($e).toFixed(1)>e.maxPlayedTime))if(f.style.width=Oe*100/l+"%",e.videoConfig.mediaType==="video"&&!e.dash&&!e.config.closeMoveSeek)console.log("trigger touchmove"),e.currentTime=Number($e).toFixed(1);else{var D=(0,n.findDom)(e.controls,".xgplayer-time");D&&(D.innerHTML='<span class="xgplayer-time-current">'+(0,n.format)($e||0)+"</span><span>"+(0,n.format)(e.duration)+"</span>")}if(e.config.thumbnail&&e.config.thumbnail.isShowCoverPreview){b.innerHTML="<span>"+(0,n.format)($e)+"</span> / "+(0,n.format)(e.duration||0),R=e.duration/k;var fe=Math.floor($e/R);_.style.backgroundImage="url("+C[Math.ceil((fe+1)/(B*U))-1]+")";var ne=fe+1-B*U*(Math.ceil((fe+1)/(B*U))-1),Y=Math.ceil(ne/U)-1,H=ne-Y*U-1;_.style["background-position"]="-"+H*x+"px -"+Y*S+"px",A.style.display="block"}e.emit("focus")},De=function ze(Ce){if(console.log("up event",Ce),Ce.stopPropagation(),(0,n.event)(Ce),window.removeEventListener("mousemove",Ae),window.removeEventListener("touchmove",Ae,{passive:!1}),window.removeEventListener("mouseup",ze),window.removeEventListener("touchend",ze),o.default.browser.indexOf("ie")<0&&s.blur(),!e.isProgressMoving||e.videoConfig&&e.videoConfig.mediaType==="audio"||e.dash||e.config.closeMoveSeek){var Oe=(Te?Ce.clientY:Ce.clientX)-Ee;Oe>l&&(Oe=l);var $e=Oe/l*e.duration;$e<0&&($e=0),e.config.allowSeekPlayed&&Number($e).toFixed(1)>e.maxPlayedTime||(f.style.width=Oe*100/l+"%",console.warn("trigger touchup"),e.currentTime=Number($e).toFixed(1))}e.config.thumbnail&&e.config.thumbnail.isShowCoverPreview&&(A.style.display="none"),e.emit("focus"),e.isProgressMoving=!1};return window.addEventListener("touchmove",Ae,{passive:!1}),window.addEventListener("touchend",De),window.addEventListener("mousemove",Ae),window.addEventListener("mouseup",De),!0}})}),s.addEventListener("mouseenter",function(Z){if(!e.config.allowSeekAfterEnded&&e.ended)return!0;var te=g(e),ae=te?s.getBoundingClientRect().top:s.getBoundingClientRect().left,Ee=te?s.getBoundingClientRect().height:s.getBoundingClientRect().width,Te=function(Ce){var Oe=((te?Ce.clientY:Ce.clientX)-ae)/Ee*e.duration;Oe=Oe<0?0:Oe,m.textContent=(0,n.format)(Oe);var $e=m.getBoundingClientRect().width;if(e.config.thumbnail&&!e.config.thumbnail.isShowCoverPreview){R=e.duration/k;var D=Math.floor(Oe/R);_.style.backgroundImage="url("+C[Math.ceil((D+1)/(B*U))-1]+")";var fe=D+1-B*U*(Math.ceil((D+1)/(B*U))-1),ne=Math.ceil(fe/U)-1,Y=fe-ne*U-1;_.style["background-position"]="-"+Y*x+"px -"+ne*S+"px";var H=(te?Ce.clientY:Ce.clientX)-ae-x/2;H=H>0?H:0,H=H<Ee-x?H:Ee-x,_.style.left=H+"px",_.style.top=-10-S+"px",_.style.display="block",m.style.left=H+x/2-$e/2+"px"}else{var J=Ce.clientX-ae-$e/2;J=J>0?J:0,J=J>Ee-$e?Ee-$e:J,m.style.left=J+"px"}(0,n.hasClass)(s,"xgplayer-progress-dot-active")?m.style.display="none":m.style.display="block"},Ae=function(Ce){Te(Ce)},De=function ze(Ce){s.removeEventListener("mousemove",Ae,!1),s.removeEventListener("mouseleave",ze,!1),Te(Ce),m.style.display="none",e.config.thumbnail&&!e.config.thumbnail.isShowCoverPreview&&(_.style.display="none")};s.addEventListener("mousemove",Ae,!1),s.addEventListener("mouseleave",De,!1),Te(Z)},!1);var K=function(){if(e.maxPlayedTime===void 0&&(e.maxPlayedTime=0),e.maxPlayedTime<e.currentTime&&(e.maxPlayedTime=e.currentTime),!l&&s&&(l=s.getBoundingClientRect().width),!e.isProgressMoving&&!e.isSeeking&&!e.seeking){var te=e.currentTime/e.duration,ae=Number(f.style.width.replace("%","")||"0")/Number(s.style.width||"100");Math.abs(te-ae)<=1&&(f.style.width=e.currentTime*100/e.duration+"%")}};e.on("timeupdate",K);var G=function(te){f.style.width=te*100/e.duration+"%"};e.on("currentTimeChange",G);var F=function(){f.style.width="0%"};e.on("srcChange",F);var j=function(){var te=e.buffered;if(te&&te.length>0){for(var ae=te.end(te.length-1),Ee=0,Te=te.length;Ee<Te;Ee++)if(e.currentTime>=te.start(Ee)&&e.currentTime<=te.end(Ee)){ae=te.end(Ee);for(var Ae=Ee+1;Ae<te.length;Ae++)if(te.start(Ae)-te.end(Ae-1)>=2){ae=te.end(Ae-1);break}break}y.style.width=ae/e.duration*100+"%"}},N=["bufferedChange","cacheupdate","ended","timeupdate"];N.forEach(function(Z){e.on(Z,j)});function $(){e.removeAllProgressDot(),e.off("canplay",w),e.off("timeupdate",K),e.off("currentTimeChange",G),e.off("srcChange",F),e.off("loadedmetadata",O),N.forEach(function(Z){e.off(Z,j)}),e.off("destroy",$)}e.once("destroy",$)};i.default={name:"s_progress",method:v},t.exports=i.default},function(t,i,r){var n=r(70);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-progress{display:block;position:absolute;height:20px;line-height:20px;left:12px;right:12px;outline:none;top:-15px;z-index:35}.xgplayer-skin-default .xgplayer-progress-outer{background:hsla(0,0%,100%,.3);display:block;height:3px;line-height:3px;margin-top:8.5px;width:100%;position:relative;cursor:pointer}.xgplayer-skin-default .xgplayer-progress-cache,.xgplayer-skin-default .xgplayer-progress-played{display:block;height:100%;line-height:1;position:absolute;left:0;top:0}.xgplayer-skin-default .xgplayer-progress-cache{width:0;background:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-progress-played{display:block;width:0;background-image:linear-gradient(-90deg,#fa1f41,#e31106);border-radius:0 1.5px 1.5px 0}.xgplayer-skin-default .xgplayer-progress-btn{display:none;position:absolute;left:0;top:-5px;width:13px;height:13px;border-radius:30px;background:#fff;box-shadow:0 0 2px 0 rgba(0,0,0,.26);left:100%;-webkit-transform:translate(-50%);-ms-transform:translate(-50%);transform:translate(-50%);z-index:36}.xgplayer-skin-default .xgplayer-progress-point{position:absolute}.xgplayer-skin-default .xgplayer-progress-point.xgplayer-tips{margin-left:0;top:-25px;display:none;z-index:100}.xgplayer-skin-default .xgplayer-progress-dot{display:inline-block;position:absolute;height:3px;width:5px;top:0;background:#fff;border-radius:6px;z-index:16}.xgplayer-skin-default .xgplayer-progress-dot .xgplayer-progress-tip{position:absolute;bottom:200%;right:50%;-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);height:auto;line-height:30px;width:auto;background:rgba(0,0,0,.3);border-radius:6px;border:1px solid rgba(0,0,0,.8);cursor:default;white-space:nowrap;display:none}.xgplayer-skin-default .xgplayer-progress-dot-show .xgplayer-progress-tip{display:block}.xgplayer-skin-default .xgplayer-progress-thumbnail{position:absolute;-moz-box-sizing:border-box;box-sizing:border-box}.xgplayer-skin-default .xgplayer-progress-thumbnail.xgplayer-tips{margin-left:0;display:none;z-index:99}.xgplayer-skin-default .xgplayer-coverpreview{position:absolute;width:100%;height:100%;top:0;left:0;display:none}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer{position:absolute;display:block;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-thumbnail{display:block}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point{display:block;text-align:center;font-family:PingFangSC-Regular;font-size:11px;color:#ccc;padding:2px 4px}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point span{color:#fff}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-outer{height:6px;margin-top:7px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-dot,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-dot{height:6px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-btn{display:block;top:-3px}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-volume-active .xgplayer-progress{z-index:15}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress-btn{display:block!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-outer{height:3px!important;margin-top:8.5px!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-btn{display:block!important;top:-5px!important}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(72);var u=function(){var d=this,g=(0,n.createDom)("xg-time",'<span class="xgplayer-time-current">'+(d.currentTime||(0,n.format)(0))+`</span>
                                           <span>`+(d.duration||(0,n.format)(0))+"</span>",{},"xgplayer-time");d.once("ready",function(){d.controls&&d.controls.appendChild(g)});var v=function(){(d.videoConfig.mediaType!=="audio"||!d.isProgressMoving||!d.dash)&&(g.innerHTML='<span class="xgplayer-time-current">'+(0,n.format)(d.currentTime||0)+"</span>"+("<span>"+(0,n.format)(d.duration)+"</span>"))};d.on("durationchange",v),d.on("timeupdate",v);function p(){d.off("durationchange",v),d.off("timeupdate",v),d.off("destroy",p)}d.once("destroy",p)};i.default={name:"s_time",method:u},t.exports=i.default},function(t,i,r){var n=r(73);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,'.xgplayer-skin-default .xgplayer-time{-webkit-order:2;-moz-box-ordinal-group:3;order:2;font-family:ArialMT;font-size:13px;color:#fff;line-height:40px;height:40px;text-align:center;display:inline-block;margin:auto 8px}.xgplayer-skin-default .xgplayer-time span{color:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current{color:#fff}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current:after{content:"/";display:inline-block;padding:0 3px}',""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(75),o=d(u);r(76);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=p.lang.REPLAY,l=(0,n.createDom)("xg-replay",o.default+`
                                         <xg-replay-txt class="xgplayer-replay-txt">`+s+`</xg-replay-txt>
                                        `,{},"xgplayer-replay");p.once("ready",function(){e.appendChild(l)});function f(){var _=l.querySelector("path");if(_){var E=window.getComputedStyle(_).getPropertyValue("transform");if(typeof E=="string"&&E.indexOf("none")>-1)return;_.setAttribute("transform",E)}}p.on("ended",f);function c(_){_.preventDefault(),_.stopPropagation()}l.addEventListener("click",c);var y=l.querySelector("svg");["click","touchend"].forEach(function(_){y.addEventListener(_,function(E){E.preventDefault(),E.stopPropagation(),p.userGestureTrigEvent("replayBtnClick")})});function m(){p.off("ended",f),p.off("destroy",m)}p.once("destroy",m)};i.default={name:"s_replay",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" width="78" height="78" viewbox="0 0 78 78">
  <path d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`},function(t,i,r){var n=r(77);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-replay{position:absolute;left:0;top:0;width:100%;height:100%;z-index:105;display:none;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center;background:rgba(0,0,0,.54);-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;flex-direction:column}.xgplayer-skin-default .xgplayer-replay svg{background:rgba(0,0,0,.58);border-radius:100%;cursor:pointer}.xgplayer-skin-default .xgplayer-replay svg path{-webkit-transform:translate(20px,21px);-ms-transform:translate(20px,21px);transform:translate(20px,21px);fill:#ddd}.xgplayer-skin-default .xgplayer-replay svg:hover{background:rgba(0,0,0,.38)}.xgplayer-skin-default .xgplayer-replay svg:hover path{fill:#fff}.xgplayer-skin-default .xgplayer-replay .xgplayer-replay-txt{display:inline-block;font-family:PingFangSC-Regular;font-size:14px;color:#fff;line-height:34px}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-replay{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(t,i,r){var n=r(161);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){t.exports=r(80)},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(9),u=J(n),o=r(81),d=J(o),g=r(82),v=J(g),p=r(83),e=J(p),s=r(84),l=J(s),f=r(85),c=J(f),y=r(88),m=J(y),_=r(45),E=J(_),w=r(89),k=J(w),x=r(90),S=J(x),B=r(91),U=J(B),R=r(92),C=J(R),A=r(37),b=J(A),O=r(38),W=J(O),K=r(98),G=J(K),F=r(46),j=J(F),N=r(99),$=J(N),Z=r(100),te=J(Z),ae=r(47),Ee=J(ae),Te=r(101),Ae=J(Te),De=r(102),ze=J(De),Ce=r(103),Oe=J(Ce),$e=r(39),D=J($e),fe=r(104),ne=J(fe),Y=r(105),H=J(Y);r(107);function J(ce){return ce&&ce.__esModule?ce:{default:ce}}u.default.installAll([d.default,v.default,e.default,l.default,c.default,m.default,E.default,k.default,S.default,U.default,C.default,b.default,W.default,G.default,j.default,$.default,te.default,Ee.default,Ae.default,ze.default,Oe.default,D.default,ne.default,H.default]),i.default=u.default,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;if(!o.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)return;function d(){o.video.webkitShowPlaybackTargetPicker()}o.on("airplayBtnClick",d);function g(){o.off("airplayBtnClick",d),o.off("destroy",g)}o.once("destroy",g)};i.default={name:"airplay",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root;function v(){(0,n.hasClass)(g,"xgplayer-is-cssfullscreen")?d.exitCssFullscreen():d.getCssFullscreen()}d.on("cssFullscreenBtnClick",v),d.on("exitFullscreen",function(){(0,n.removeClass)(g,"xgplayer-is-cssfullscreen")});function p(){d.off("cssFullscreenBtnClick",v),d.off("destroy",p)}d.once("destroy",p),d.getCssFullscreen=function(){var e=this;e.config.fluid&&(e.root.style["padding-top"]=""),(0,n.addClass)(e.root,"xgplayer-is-cssfullscreen"),e.emit("requestCssFullscreen")},d.exitCssFullscreen=function(){var e=this;e.config.fluid&&(e.root.style.width="100%",e.root.style.height="0",e.root.style["padding-top"]=e.config.height*100/e.config.width+"%"),(0,n.removeClass)(e.root,"xgplayer-is-cssfullscreen"),e.emit("exitCssFullscreen")}};i.default={name:"cssFullscreen",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this;function g(v){var p=d.root.querySelector("xg-danmu");if((0,n.addClass)(p,"xgplayer-has-danmu"),!d.config.danmu.closeDefaultBtn){var e=function(){v.start()},s=function(){(0,n.hasClass)(d.danmuBtn,"danmu-switch-active")&&v.pause()},l=function(){(0,n.hasClass)(d.danmuBtn,"danmu-switch-active")&&v.play()},f=function(){(0,n.hasClass)(d.danmuBtn,"danmu-switch-active")&&(v.stop(),v.start())},c=function y(){d.off("timeupdate",e),d.off("pause",s),d.off("play",l),d.off("seeked",f),d.off("destroy",y)};d.danmuBtn=(0,n.copyDom)(v.bulletBtn.createSwitch(!0)),d.controls.appendChild(d.danmuBtn),["click","touchend"].forEach(function(y){d.danmuBtn.addEventListener(y,function(m){m.preventDefault(),m.stopPropagation(),(0,n.toggleClass)(d.danmuBtn,"danmu-switch-active"),(0,n.hasClass)(d.danmuBtn,"danmu-switch-active")?(d.emit("danmuBtnOn"),(0,n.addClass)(p,"xgplayer-has-danmu"),d.once("timeupdate",e)):(d.emit("danmuBtnOff"),(0,n.removeClass)(p,"xgplayer-has-danmu"),v.stop())})}),d.onElementClick&&p.addEventListener("click",function(y){d.onElementClick(y,p)},!1),d.onElementDblclick&&p.addEventListener("dblclick",function(y){d.onElementDblclick(y,p)},!1),d.on("pause",s),d.on("play",l),d.on("seeked",f),d.once("destroy",c)}}d.on("initDefaultDanmu",g)};i.default={name:"danmu",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;function d(){o.off("destroy",d)}o.once("destroy",d)};i.default={name:"definition",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(86),u=d(n),o=r(87);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;function e(){p.download()}p.on("downloadBtnClick",e);function s(){p.off("downloadBtnClick",e),p.off("destroy",s)}p.once("destroy",s),p.download=function(){var l=(0,o.getAbsoluteURL)(this.config.url);(0,u.default)(l)}};i.default={name:"download",method:g},t.exports=i.default},function(t,i,r){var n,u,o;(function(d,g){u=[],n=g,o=typeof n=="function"?n.apply(i,u):n,o!==void 0&&(t.exports=o)})(this,function(){return function d(g,v,p){var e=window,s="application/octet-stream",l=p||s,f=g,c=!v&&!p&&f,y=document.createElement("a"),m=function(A){return String(A)},_=e.Blob||e.MozBlob||e.WebKitBlob||m,E=v||"download",w,k;if(_=_.call?_.bind(e):Blob,String(this)==="true"&&(f=[f,l],l=f[0],f=f[1]),c&&c.length<2048&&(E=c.split("/").pop().split("?")[0],y.href=c,y.href.indexOf(c)!==-1)){var x=new XMLHttpRequest;return x.open("GET",c,!0),x.responseType="blob",x.onload=function(A){d(A.target.response,E,s)},setTimeout(function(){x.send()},0),x}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(f))if(f.length>1024*1024*1.999&&_!==m)f=R(f),l=f.type||s;else return navigator.msSaveBlob?navigator.msSaveBlob(R(f),E):C(f);else if(/([\x80-\xff])/.test(f)){var S=0,B=new Uint8Array(f.length),U=B.length;for(S;S<U;++S)B[S]=f.charCodeAt(S);f=new _([B],{type:l})}w=f instanceof _?f:new _([f],{type:l});function R(A){var b=A.split(/[:;,]/),O=b[1],W=b[2]=="base64"?atob:decodeURIComponent,K=W(b.pop()),G=K.length,F=0,j=new Uint8Array(G);for(F;F<G;++F)j[F]=K.charCodeAt(F);return new _([j],{type:O})}function C(A,b){if("download"in y)return y.href=A,y.setAttribute("download",E),y.className="download-js-link",y.innerHTML="downloading...",y.style.display="none",document.body.appendChild(y),setTimeout(function(){y.click(),document.body.removeChild(y),b===!0&&setTimeout(function(){e.URL.revokeObjectURL(y.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,s)),window.open(A)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=A),!0;var O=document.createElement("iframe");document.body.appendChild(O),!b&&/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,s)),O.src=A,setTimeout(function(){document.body.removeChild(O)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(w,E);if(e.URL)C(e.URL.createObjectURL(w),!0);else{if(typeof w=="string"||w.constructor===m)try{return C("data:"+l+";base64,"+e.btoa(w))}catch(A){return C("data:"+l+","+encodeURIComponent(w))}k=new FileReader,k.onload=function(A){C(this.result)},k.readAsDataURL(w)}return!0}})},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getAbsoluteURL=function(u){if(!u.match(/^https?:\/\//)){var o=document.createElement("div");o.innerHTML='<a href="'+u+'">x</a>',u=o.firstChild.href}return u}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(4),u=o(n);function o(v){return v&&v.__esModule?v:{default:v}}var d={maxCount:3,backupUrl:"",isFetch:!0,fetchTimeout:100};function g(){var v=this,p=this;if(!p.config.errorConfig||p.src.indexOf("blob:")>-1)return;var e={},s=p.config.errorConfig;for(var l in d)s[l]===void 0?e[l]=d[l]:e[l]=s[l];p.retryData={count:0,errfTimer:null,isFetchReturn:!1,currentTime:0};function f(m,_,E){var w=function(x,S){m.retryData.isFetchReturn||(m.retryData.isFetchReturn=!0,x(S))};return new Promise(function(k,x){try{var S=new window.XMLHttpRequest;S.open("get",_),S.onload=function(){w(k,{status:S.status,statusText:S.statusText,xhr:S})},S.onerror=function(){w(k,{status:S.status,statusText:S.statusText||"The network environment is disconnected or the address is invalid",xhr:S})},S.onabort=function(){},m.retryData.errfTimer=window.setTimeout(function(){var B=m.retryData.errfTimer;window.clearTimeout(B),m.retryData.errfTimer=null,w(k,{status:-1,statusText:"request timeout"})},E),S.send()}catch(B){m.retryData.isFetchReturn=!0,w(k,{status:-2,statusText:"request error"})}})}function c(){this.currentTime=this.retryData.currentTime,this.play(),this.retryData.retryCode=0,this.retryData.isFetchReturn=!1,this.retryData.currentTime=0}var y=p._onError;p._onError=function(m){var _=v.retryData.count;if(_>e.maxCount){e.isFetch?f(v,v.currentSrc,e.fetchTimeout).then(function(w){v.emit("error",new u.default({type:"network",currentTime:v.currentTime,duration:v.duration||0,networkState:v.networkState,readyState:v.readyState,currentSrc:v.currentSrc,src:v.src,ended:v.ended,httpCode:w.status,httpMsg:w.statusText,errd:{line:101,msg:v.error,handle:"plugin errorRetry"},errorCode:v.video&&v.video.error.code,mediaError:v.video&&v.video.error})),y.call(v,w)}):y.call(v,m);return}_===0&&(v.retryData.currentTime=v.currentTime,v.once("canplay",c.bind(v)));var E="";e.count<2?E=e.backupUrl?e.backupUrl:p.currentSrc:E=e.backupUrl&&_>1?e.backupUrl:p.currentSrc,v.retryData.count++,v.src=E}}i.default={name:"errorretry",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function v(p,e){for(var s=0;s<e.length;s++){var l=e[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(p,l.key,l)}}return function(p,e,s){return e&&v(p.prototype,e),s&&v(p,s),p}}(),u=r(0);function o(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}var d=function(){function v(p){o(this,v),this.player=p,this.state={playbackRate:0,isRepeat:!1,keyCode:0,repeat:0,isBody:!1},this.timer=null,this.initEvents()}return n(v,[{key:"initEvents",value:function(){var e=this,s=this.player,l=s.root,f=s.config;if(this.player.onBodyKeydown=this.onBodyKeydown.bind(this),this.player.onKeydown=this.onKeydown.bind(this),this.player.onKeyup=this.onKeyup.bind(this),!f.keyShortcut||f.keyShortcut==="on"){document.addEventListener("keydown",this.player.onBodyKeydown),l.addEventListener("keydown",this.player.onKeydown);var c=function(){document.removeEventListener("keydown",e.player.onBodyKeydown),l.removeEventListener("keydown",e.player.onKeydown),clearTimeout(e.timer),e.timer=null};(0,u.on)(this.player,"destroy",c)}}},{key:"checkTarget",value:function(e){var s=this.player;return e.target===s.root||e.target===s.video||e.target===s.controls}},{key:"onBodyKeydown",value:function(e){var s=e||window.event,l=s.keyCode;if(s.target===document.body&&(l===37||l===39||l===32))return s.preventDefault(),s.cancelBubble=!0,s.returnValue=!1,s.repeat||document.addEventListener("keyup",this.player.onKeyup),this.handler(s),!1}},{key:"onKeydown",value:function(e){var s=e||window.event,l=s.keyCode;if(this.checkTarget(s)&&(l===37||l===38||l===39||l===40||l===32||l===27))return s.preventDefault(),s.cancelBubble=!0,s.returnValue=!1,this.player.emit("focus"),s.repeat||this.player.root.addEventListener("keyup",this.player.onKeyup),this.handler(s),!1}},{key:"onKeyup",value:function(){var e=this.state,s=this.player;document.removeEventListener("keyup",this.player.onKeyup),s.root.removeEventListener("keyup",this.player.onKeyup),!!e.keyCode&&(e.playbackRate!==0&&(s.playbackRate=e.playbackRate),e.isRepeat||this.handlerKeyCode(e.keyCode,!1),e.playbackRate=0,e.isRepeat=!1,e.keyCode=0,e.repeat=0,this.changeVolumeSlide())}},{key:"handler",value:function(e){var s=this.state,l=this.player;s.keyCode=e.keyCode,s.isRepeat=e.repeat,e.repeat&&(l.config.disableLongPress?this.handlerKeyCode(s.keyCode,!1):s.repeat%2==0&&this.handlerKeyCode(s.keyCode,!0),s.repeat++)}},{key:"handlerKeyCode",value:function(e,s){var l=this.player,f=this.state;switch(e){case 39:s?f.repeat===0&&this.changeRate():this.seek(!1,s);break;case 37:this.seek(!0,s);break;case 38:this.changeVolume(!0);break;case 40:this.changeVolume(!1);break;case 32:s||(l.paused?l.play():l.pause());break;case 27:(0,u.hasClass)(l.root,"xgplayer-is-cssfullscreen")&&l.exitCssFullscreen();break}}},{key:"seek",value:function(e,s){var l=this.player,f=l.config.keyShortcutStep||{},c=f.currentTime||10;l.isLoading||l.isSeeking||s&&this.state.repeat%8>0||(e?l.currentTime-c>=0?l.currentTime-=c:l.currentTime=0:l.maxPlayedTime&&l.config.allowSeekPlayed&&l.currentTime+c>l.maxPlayedTime?l.currentTime=l.maxPlayedTime:l.currentTime+c<=l.duration?l.currentTime+=c:l.currentTime=l.duration+1)}},{key:"changeRate",value:function(){this.state.playbackRate=this.player.playbackRate,this.player.playbackRate=this.player.config.keyboardRate||5}},{key:"changeVolumeSlide",value:function(e){var s=this.player;!s.controls||(e?(s.emit("focus"),(0,u.hasClass)(s.root,"xgplayer-volume-active")||(0,u.addClass)(s.root,"xgplayer-volume-active")):(clearTimeout(this.timer),this.timer=setTimeout(function(){(0,u.removeClass)(s.root,"xgplayer-volume-active")},1e3)))}},{key:"changeVolume",value:function(e){var s=this.player,l=s.config.keyShortcutStep||{},f=l.volume||.1;this.changeVolumeSlide(!0);var c=s.volume;e&&c+f<=1?s.volume=c+f:!e&&c-f>=0&&(s.volume=c-f)}}]),v}(),g=function(){var p=this;p.keyboard=new d(p)};i.default={name:"keyboard",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.root;function v(e){d.uploadFile=e.files[0];var s=URL.createObjectURL(d.uploadFile);if((0,n.hasClass)(g,"xgplayer-nostart"))d.config.url=s,d.start();else{d.src=s;var l=d.play();l!==void 0&&l&&l.catch(function(f){})}}d.on("upload",v);function p(){d.off("upload",v),d.off("destroy",p)}d.once("destroy",p)};i.default={name:"localPreview",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;o.on("memoryPlayStart",function(d){setTimeout(function(){console.log("memoryPlayStart",d,o.readyState,11),o.currentTime=d})})};i.default={name:"memoryPlay",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(93),o=d(u);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root;function s(){(0,n.hasClass)(e,"xgplayer-miniplayer-active")?p.exitMiniplayer():p.getMiniplayer()}p.on("miniplayerBtnClick",s);function l(){p.off("miniplayerBtnClick",s),p.off("destroy",l)}p.once("destroy",l),p.getMiniplayer=function(){(0,n.hasClass)(e,"xgplayer-is-fullscreen")&&this.exitFullscreen(e),(0,n.hasClass)(e,"xgplayer-is-cssfullscreen")&&this.exitCssFullscreen(),(0,n.hasClass)(e,"xgplayer-rotate-fullscreen")&&this.exitRotateFullscreen();var f=(0,n.createDom)("xg-miniplayer-lay","<div></div>",{},"xgplayer-miniplayer-lay");this.root.appendChild(f);var c=(0,n.createDom)("xg-miniplayer-drag",'<div class="drag-handle"><span>'+this.lang.MINIPLAYER_DRAG+"</span></div>",{tabindex:9},"xgplayer-miniplayer-drag");this.root.appendChild(c),new o.default(".xgplayer",{handle:".drag-handle"}),(0,n.addClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right=0,this.root.style.bottom="200px",this.root.style.top="",this.root.style.left="",this.root.style.width="320px",this.root.style.height="180px",this.config.miniplayerConfig&&(this.config.miniplayerConfig.top!==void 0&&(this.root.style.top=this.config.miniplayerConfig.top+"px",this.root.style.bottom=""),this.config.miniplayerConfig.bottom!==void 0&&(this.root.style.bottom=this.config.miniplayerConfig.bottom+"px"),this.config.miniplayerConfig.left!==void 0&&(this.root.style.left=this.config.miniplayerConfig.left+"px",this.root.style.right=""),this.config.miniplayerConfig.right!==void 0&&(this.root.style.right=this.config.miniplayerConfig.right+"px"),this.config.miniplayerConfig.width!==void 0&&(this.root.style.width=this.config.miniplayerConfig.width+"px"),this.config.miniplayerConfig.height!==void 0&&(this.root.style.height=this.config.miniplayerConfig.height+"px")),this.config.fluid&&(this.root.style["padding-top"]="");var y=this;["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),y.exitMiniplayer()})})},p.exitMiniplayer=function(){(0,n.removeClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right="",this.root.style.bottom="",this.root.style.top="",this.root.style.left="",this.config.fluid?(this.root.style.width="100%",this.root.style.height="0",this.root.style["padding-top"]=this.config.height*100/this.config.width+"%"):(this.config.width&&(typeof this.config.width!="number"?this.root.style.width=this.config.width:this.root.style.width=this.config.width+"px"),this.config.height&&(typeof this.config.height!="number"?this.root.style.height=this.config.height:this.root.style.height=this.config.height+"px"));var f=(0,n.findDom)(this.root,".xgplayer-miniplayer-lay");f&&f.parentNode&&f.parentNode.removeChild(f);var c=(0,n.findDom)(this.root,".xgplayer-miniplayer-drag");c&&c.parentNode&&c.parentNode.removeChild(c)}};i.default={name:"miniplayer",method:g},t.exports=i.default},function(t,i,r){var n,u;/*!
* Draggabilly v2.4.1
* Make that shiz draggable
* https://draggabilly.desandro.com
* MIT license
*/(function(o,d){n=[r(94),r(95)],u=function(g,v){return d(o,g,v)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(d,g,v){function p(m,_){for(var E in _)m[E]=_[E];return m}function e(){}var s=d.jQuery;function l(m,_){this.element=typeof m=="string"?document.querySelector(m):m,s&&(this.$element=s(this.element)),this.options=p({},this.constructor.defaults),this.option(_),this._create()}var f=l.prototype=Object.create(v.prototype);l.defaults={},f.option=function(m){p(this.options,m)};var c={relative:!0,absolute:!0,fixed:!0};f._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=p({},this.position);var m=getComputedStyle(this.element);c[m.position]||(this.element.style.position="relative"),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},f.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},f.dispatchEvent=function(m,_,E){var w=[_].concat(E);this.emitEvent(m,w),this.dispatchJQueryEvent(m,_,E)},f.dispatchJQueryEvent=function(m,_,E){var w=d.jQuery;if(!(!w||!this.$element)){var k=w.Event(_);k.type=m,this.$element.trigger(k,E)}},f._getPosition=function(){var m=getComputedStyle(this.element),_=this._getPositionCoord(m.left,"width"),E=this._getPositionCoord(m.top,"height");this.position.x=isNaN(_)?0:_,this.position.y=isNaN(E)?0:E,this._addTransformPosition(m)},f._getPositionCoord=function(m,_){if(m.indexOf("%")!=-1){var E=g(this.element.parentNode);return E?parseFloat(m)/100*E[_]:0}return parseInt(m,10)},f._addTransformPosition=function(m){var _=m.transform;if(_.indexOf("matrix")===0){var E=_.split(","),w=_.indexOf("matrix3d")===0?12:4,k=parseInt(E[w],10),x=parseInt(E[w+1],10);this.position.x+=k,this.position.y+=x}},f.onPointerDown=function(m,_){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",m,[_])},f.pointerDown=function(m,_){var E=this.okayPointerDown(m);if(!E||!this.isEnabled){this._pointerReset();return}this.pointerDownPointer={pageX:_.pageX,pageY:_.pageY},m.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(m),this.element.classList.add("is-pointer-down"),this.dispatchEvent("pointerDown",m,[_])},f.dragStart=function(m,_){!this.isEnabled||(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",m,[_]),this.animate())},f.measureContainment=function(){var m=this.getContainer();if(!!m){var _=g(this.element),E=g(m),w=this.element.getBoundingClientRect(),k=m.getBoundingClientRect(),x=E.borderLeftWidth+E.borderRightWidth,S=E.borderTopWidth+E.borderBottomWidth,B=this.relativeStartPosition={x:w.left-(k.left+E.borderLeftWidth),y:w.top-(k.top+E.borderTopWidth)};this.containSize={width:E.width-x-B.x-_.width,height:E.height-S-B.y-_.height}}},f.getContainer=function(){var m=this.options.containment;if(!!m){var _=m instanceof HTMLElement;return _?m:typeof m=="string"?document.querySelector(m):this.element.parentNode}},f.onPointerMove=function(m,_,E){this.dispatchJQueryEvent("pointerMove",m,[_,E])},f.dragMove=function(m,_,E){if(!!this.isEnabled){var w=E.x,k=E.y,x=this.options.grid,S=x&&x[0],B=x&&x[1];w=y(w,S),k=y(k,B),w=this.containDrag("x",w,S),k=this.containDrag("y",k,B),w=this.options.axis=="y"?0:w,k=this.options.axis=="x"?0:k,this.position.x=this.startPosition.x+w,this.position.y=this.startPosition.y+k,this.dragPoint.x=w,this.dragPoint.y=k,this.dispatchEvent("dragMove",m,[_,E])}};function y(m,_,E){return E=E||"round",_?Math[E](m/_)*_:m}return f.containDrag=function(m,_,E){if(!this.options.containment)return _;var w=m=="x"?"width":"height",k=this.relativeStartPosition[m],x=y(-k,E,"ceil"),S=this.containSize[w];return S=y(S,E,"floor"),Math.max(x,Math.min(S,_))},f.onPointerUp=function(m,_){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",m,[_])},f.dragEnd=function(m,_){!this.isEnabled||(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",m,[_]))},f.animate=function(){if(!!this.isDragging){this.positionDrag();var m=this;requestAnimationFrame(function(){m.animate()})}},f.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},f.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},f.staticClick=function(m,_){this.dispatchEvent("staticClick",m,[_])},f.setPosition=function(m,_){this.position.x=m,this.position.y=_,this.setLeftTop()},f.enable=function(){this.isEnabled=!0},f.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},f.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},f._init=e,s&&s.bridget&&s.bridget("draggabilly",l),l})},function(t,i,r){var n,u;/*!
* getSize v2.0.3
* measure size of elements
* MIT license
*/(function(o,d){n=d,u=typeof n=="function"?n.call(i,r,i,t):n,u!==void 0&&(t.exports=u)})(window,function(){function d(_){var E=parseFloat(_),w=_.indexOf("%")==-1&&!isNaN(E);return w&&E}function g(){}var v=typeof console=="undefined"?g:function(_){console.error(_)},p=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],e=p.length;function s(){for(var _={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},E=0;E<e;E++){var w=p[E];_[w]=0}return _}function l(_){var E=getComputedStyle(_);return E||v("Style returned "+E+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),E}var f=!1,c;function y(){if(!f){f=!0;var _=document.createElement("div");_.style.width="200px",_.style.padding="1px 2px 3px 4px",_.style.borderStyle="solid",_.style.borderWidth="1px 2px 3px 4px",_.style.boxSizing="border-box";var E=document.body||document.documentElement;E.appendChild(_);var w=l(_);c=Math.round(d(w.width))==200,m.isBoxSizeOuter=c,E.removeChild(_)}}function m(_){if(y(),typeof _=="string"&&(_=document.querySelector(_)),!(!_||typeof _!="object"||!_.nodeType)){var E=l(_);if(E.display=="none")return s();var w={};w.width=_.offsetWidth,w.height=_.offsetHeight;for(var k=w.isBorderBox=E.boxSizing=="border-box",x=0;x<e;x++){var S=p[x],B=E[S],U=parseFloat(B);w[S]=isNaN(U)?0:U}var R=w.paddingLeft+w.paddingRight,C=w.paddingTop+w.paddingBottom,A=w.marginLeft+w.marginRight,b=w.marginTop+w.marginBottom,O=w.borderLeftWidth+w.borderRightWidth,W=w.borderTopWidth+w.borderBottomWidth,K=k&&c,G=d(E.width);G!==!1&&(w.width=G+(K?0:R+O));var F=d(E.height);return F!==!1&&(w.height=F+(K?0:C+W)),w.innerWidth=w.width-(R+O),w.innerHeight=w.height-(C+W),w.outerWidth=w.width+A,w.outerHeight=w.height+b,w}}return m})},function(t,i,r){var n,u;/*!
* Unidragger v2.4.0
* Draggable base class
* MIT license
*/(function(o,d){n=[r(96)],u=function(g){return d(o,g)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(d,g){function v(){}var p=v.prototype=Object.create(g.prototype);p.bindHandles=function(){this._bindHandles(!0)},p.unbindHandles=function(){this._bindHandles(!1)},p._bindHandles=function(l){l=l===void 0?!0:l;for(var f=l?"addEventListener":"removeEventListener",c=l?this._touchActionValue:"",y=0;y<this.handles.length;y++){var m=this.handles[y];this._bindStartEvent(m,l),m[f]("click",this),d.PointerEvent&&(m.style.touchAction=c)}},p._touchActionValue="none",p.pointerDown=function(l,f){var c=this.okayPointerDown(l);!c||(this.pointerDownPointer={pageX:f.pageX,pageY:f.pageY},l.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(l),this.emitEvent("pointerDown",[l,f]))};var e={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return p.okayPointerDown=function(l){var f=e[l.target.nodeName],c=s[l.target.type],y=!f||c;return y||this._pointerReset(),y},p.pointerDownBlur=function(){var l=document.activeElement,f=l&&l.blur&&l!=document.body;f&&l.blur()},p.pointerMove=function(l,f){var c=this._dragPointerMove(l,f);this.emitEvent("pointerMove",[l,f,c]),this._dragMove(l,f,c)},p._dragPointerMove=function(l,f){var c={x:f.pageX-this.pointerDownPointer.pageX,y:f.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(c)&&this._dragStart(l,f),c},p.hasDragStarted=function(l){return Math.abs(l.x)>3||Math.abs(l.y)>3},p.pointerUp=function(l,f){this.emitEvent("pointerUp",[l,f]),this._dragPointerUp(l,f)},p._dragPointerUp=function(l,f){this.isDragging?this._dragEnd(l,f):this._staticClick(l,f)},p._dragStart=function(l,f){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(l,f)},p.dragStart=function(l,f){this.emitEvent("dragStart",[l,f])},p._dragMove=function(l,f,c){!this.isDragging||this.dragMove(l,f,c)},p.dragMove=function(l,f,c){l.preventDefault(),this.emitEvent("dragMove",[l,f,c])},p._dragEnd=function(l,f){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(l,f)},p.dragEnd=function(l,f){this.emitEvent("dragEnd",[l,f])},p.onclick=function(l){this.isPreventingClicks&&l.preventDefault()},p._staticClick=function(l,f){this.isIgnoringMouseUp&&l.type=="mouseup"||(this.staticClick(l,f),l.type!="mouseup"&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},p.staticClick=function(l,f){this.emitEvent("staticClick",[l,f])},v.getPointerPoint=g.getPointerPoint,v})},function(t,i,r){var n,u;/*!
* Unipointer v2.4.0
* base class for doing one thing with pointer event
* MIT license
*/(function(o,d){n=[r(97)],u=function(g){return d(o,g)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(d,g){function v(){}function p(){}var e=p.prototype=Object.create(g.prototype);e.bindStartEvent=function(l){this._bindStartEvent(l,!0)},e.unbindStartEvent=function(l){this._bindStartEvent(l,!1)},e._bindStartEvent=function(l,f){f=f===void 0?!0:f;var c=f?"addEventListener":"removeEventListener",y="mousedown";"ontouchstart"in d?y="touchstart":d.PointerEvent&&(y="pointerdown"),l[c](y,this)},e.handleEvent=function(l){var f="on"+l.type;this[f]&&this[f](l)},e.getTouch=function(l){for(var f=0;f<l.length;f++){var c=l[f];if(c.identifier==this.pointerIdentifier)return c}},e.onmousedown=function(l){var f=l.button;f&&f!==0&&f!==1||this._pointerDown(l,l)},e.ontouchstart=function(l){this._pointerDown(l,l.changedTouches[0])},e.onpointerdown=function(l){this._pointerDown(l,l)},e._pointerDown=function(l,f){l.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=f.pointerId!==void 0?f.pointerId:f.identifier,this.pointerDown(l,f))},e.pointerDown=function(l,f){this._bindPostStartEvents(l),this.emitEvent("pointerDown",[l,f])};var s={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return e._bindPostStartEvents=function(l){if(!!l){var f=s[l.type];f.forEach(function(c){d.addEventListener(c,this)},this),this._boundPointerEvents=f}},e._unbindPostStartEvents=function(){!this._boundPointerEvents||(this._boundPointerEvents.forEach(function(l){d.removeEventListener(l,this)},this),delete this._boundPointerEvents)},e.onmousemove=function(l){this._pointerMove(l,l)},e.onpointermove=function(l){l.pointerId==this.pointerIdentifier&&this._pointerMove(l,l)},e.ontouchmove=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerMove(l,f)},e._pointerMove=function(l,f){this.pointerMove(l,f)},e.pointerMove=function(l,f){this.emitEvent("pointerMove",[l,f])},e.onmouseup=function(l){this._pointerUp(l,l)},e.onpointerup=function(l){l.pointerId==this.pointerIdentifier&&this._pointerUp(l,l)},e.ontouchend=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerUp(l,f)},e._pointerUp=function(l,f){this._pointerDone(),this.pointerUp(l,f)},e.pointerUp=function(l,f){this.emitEvent("pointerUp",[l,f])},e._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},e._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},e.pointerDone=v,e.onpointercancel=function(l){l.pointerId==this.pointerIdentifier&&this._pointerCancel(l,l)},e.ontouchcancel=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerCancel(l,f)},e._pointerCancel=function(l,f){this._pointerDone(),this.pointerCancel(l,f)},e.pointerCancel=function(l,f){this.emitEvent("pointerCancel",[l,f])},p.getPointerPoint=function(l){return{x:l.pageX,y:l.pageY}},p})},function(t,i,r){var n,u;(function(o,d){n=d,u=typeof n=="function"?n.call(i,r,i,t):n,u!==void 0&&(t.exports=u)})(typeof window!="undefined"?window:this,function(){function o(){}var d=o.prototype;return d.on=function(g,v){if(!(!g||!v)){var p=this._events=this._events||{},e=p[g]=p[g]||[];return e.indexOf(v)==-1&&e.push(v),this}},d.once=function(g,v){if(!(!g||!v)){this.on(g,v);var p=this._onceEvents=this._onceEvents||{},e=p[g]=p[g]||{};return e[v]=!0,this}},d.off=function(g,v){var p=this._events&&this._events[g];if(!(!p||!p.length)){var e=p.indexOf(v);return e!=-1&&p.splice(e,1),this}},d.emitEvent=function(g,v){var p=this._events&&this._events[g];if(!(!p||!p.length)){p=p.slice(0),v=v||[];for(var e=this._onceEvents&&this._onceEvents[g],s=0;s<p.length;s++){var l=p[s],f=e&&e[l];f&&(this.off(g,l),delete e[l]),l.apply(this,v)}return this}},d.allOff=function(){delete this._events,delete this._onceEvents},o})},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=this;function v(){g.video!==document.pictureInPictureElement?g.video.requestPictureInPicture():document.exitPictureInPicture()}g.on("pipBtnClick",v);var p=function(l){var f=g.video.webkitPresentationMode;d.pMode=f,f===n.PresentationMode.PIP?g.emit("requestPictureInPicture",l.pictureInPictureWindow):f===n.PresentationMode.INLINE&&g.emit("exitPictureInPicture")};g.video.addEventListener("enterpictureinpicture",function(s){(0,n.addClass)(g.root,"xgplayer-pip-active"),g.emit("requestPictureInPicture",s)}),g.video.addEventListener("leavepictureinpicture",function(){(0,n.removeClass)(g.root,"xgplayer-pip-active"),g.emit("exitPictureInPicture")}),(0,n.checkWebkitSetPresentationMode)(g.video)&&g.video.addEventListener("webkitpresentationmodechanged",p);function e(){g.off("pipBtnClick",v),g.off("destroy",e),(0,n.checkWebkitSetPresentationMode)(g.video)&&g.video.removeEventListener("webkitpresentationmodechanged",p)}g.once("destroy",e)};i.default={name:"pip",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,d=o.config.playNext;o.currentVideoIndex=-1;function g(){o.currentVideoIndex+1<d.urlList.length&&(o.currentVideoIndex++,o.video.autoplay=!0,o.src=d.urlList[o.currentVideoIndex],o.emit("playerNext",o.currentVideoIndex+1),o.currentVideoIndex+1===d.urlList.length&&o.emit("urlListEnd"))}o.on("playNextBtnClick",g);function v(){o.off("playNextBtnClick",g),o.off("destroy",v)}o.once("destroy",v)};i.default={name:"playNext",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this,g=d.config.reload;if(!g)return;function v(){(0,n.removeClass)(d.root,"xgplayer-is-error"),d.src=d.config.url}d.on("reloadBtnClick",v);function p(){d.off("reloadBtnClick",v),d.off("destroy",p)}d.once("destroy",p)};i.default={name:"reload",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,d=o.config.rotate;if(!d)return;function g(){o.rotate(d.clockwise,d.innerRotate)}o.on("rotateBtnClick",g);function v(){o.off("rotateBtnClick",g),o.off("destroy",v)}o.once("destroy",v),o.updateRotateDeg=function(){var p=this;p.rotateDeg||(p.rotateDeg=0);var e=p.root.offsetWidth,s=p.root.offsetHeight,l=p.video.videoWidth,f=p.video.videoHeight;!p.config.rotate.innerRotate&&p.config.rotate.controlsFix&&(p.root.style.width=s+"px",p.root.style.height=e+"px");var c=void 0;if(p.rotateDeg===.25||p.rotateDeg===.75){if(p.config.rotate.innerRotate)if(l/f>s/e){var y=0;f/l>s/e?y=s*l/f:y=e,c=s/y}else{var m=0;f/l>s/e?m=s:m=e*f/l,c=e/m}else e>=s?c=e/s:c=s/e;c=Number(c.toFixed(5))}else c=1;p.config.rotate.innerRotate||p.config.rotate.controlsFix?(p.video.style.transformOrigin="center center",p.video.style.transform="rotate("+p.rotateDeg+"turn) scale("+c+")",p.video.style.webKitTransform="rotate("+p.rotateDeg+"turn) scale("+c+")"):(p.root.style.transformOrigin="center center",p.root.style.transform="rotate("+p.rotateDeg+"turn) scale("+1+")",p.root.style.webKitTransform="rotate("+p.rotateDeg+"turn) scale("+1+")")},o.rotate=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=this;s.rotateDeg||(s.rotateDeg=0);var l=p?1:-1;s.rotateDeg=(s.rotateDeg+1+l*.25*e)%1,this.updateRotateDeg(),s.emit("rotate",s.rotateDeg*360)}};i.default={name:"rotate",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,d=o.config.screenShot,g=null;if(!d)return;o.video.setAttribute("crossOrigin","anonymous");var v=.92;(d.quality||d.quality===0)&&(v=d.quality);var p=d.type===void 0?"image/png":d.type,e=d.format===void 0?".png":d.format,s=document.createElement("canvas"),l=s.getContext("2d"),f=new Image;s.width=this.config.width||600,s.height=this.config.height||337.5;var c=function(_,E){var w=document.createElement("a");w.href=_,w.download=E;var k=document.createEvent("MouseEvents");k.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),w.dispatchEvent(k)};o.screenShot=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;m=d.saveImg===void 0?m:d.saveImg,s.width=o.video.videoWidth||600,s.height=o.video.videoHeight||337.5,g=d.callBack,f.onload=function(){l.drawImage(o.video,0,0,s.width,s.height),f.src=s.toDataURL(p,v).replace(p,"image/octet-stream");var _=f.src.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),E=d.fileName||o.lang.SCREENSHOT;o.emit("screenShot",_),m&&g?g(_,E,e):m&&c(_,E+e)}()},o.on("screenShotBtnClick",o.screenShot);function y(){o.off("screenShotBtnClick",o.screenShot),o.off("destroy",y)}o.once("destroy",y)};i.default={name:"screenShot",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(4),u=o(n);function o(g){return g&&g.__esModule?g:{default:g}}function d(){var g=this;if(!!g.config.enableStallCheck){var v=0,p=void 0,e=void 0;g.once("complete",function(){setInterval(function(){g.currentTime-(v||0)>.1||g.paused?(p===1||p===2)&&(p=0,clearTimeout(e),e=null):p||(p=1,e=setTimeout(function(){p===1&&(p=2,g.emit("error",new u.default("STALL"))),e=null},2e4)),v=g.currentTime},1e3)})}}i.default={name:"stallCheck",method:d},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=d(u);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=void 0,l=void 0,f=void 0,c=void 0;function y(){!p.controls||(p.volume=p.config.volume,s=p.controls.querySelector(".xgplayer-volume"),!!s&&(l=s.querySelector(".xgplayer-slider"),f=s.querySelector(".xgplayer-bar"),c=s.querySelector(".xgplayer-drag"),o.default.device==="mobile"&&(p.volume===0&&(p.video.muted=!0),x())))}p.once("canplay",y);function m(B){if(!!l){p.video.muted=!1,l.focus(),(0,n.event)(B);var U=f.getBoundingClientRect(),R={x:B.clientX,y:B.clientY},C=c.getBoundingClientRect().height,A=!1,b=function(K){K.preventDefault(),K.stopPropagation(),(0,n.event)(K),A=!0;var G=C-K.clientY+R.y,F=G/U.height;c.style.height=G+"px",p.volume=Math.max(Math.min(F,1),0)},O=function W(K){if(K.preventDefault(),K.stopPropagation(),(0,n.event)(K),window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",b),window.removeEventListener("mouseup",W),window.removeEventListener("touchend",W),!A){var G=U.height-(K.clientY-U.top),F=G/U.height;c.style.height=G+"px",F<=0&&(p.volume>0?c.volume=p.video.volume:F=c.volume),p.volume=Math.max(Math.min(F,1),0)}l.volume=p.volume,A=!1};return window.addEventListener("mousemove",b),window.addEventListener("touchmove",b),window.addEventListener("mouseup",O),window.addEventListener("touchend",O),!1}}p.on("volumeBarClick",m);function _(){if(o.default.device==="mobile")p.video.muted?(p.video.muted=!1,p.emit("unmute"),p.volume=1):(p.video.muted=!0,p.emit("mute"),p.volume=0);else{if(!l)return;p.video.muted=!1,p.volume<.1?(l.volume<.1?p.volume=.6:p.volume=l.volume,p.emit("unmute")):(p.volume=0,p.emit("mute"))}}p.on("volumeIconClick",_);function E(){(0,n.addClass)(e,"xgplayer-volume-active"),s&&s.focus()}p.on("volumeIconEnter",E);function w(){(0,n.removeClass)(e,"xgplayer-volume-active")}p.on("volumeIconLeave",w);var k=null;function x(){k&&clearTimeout(k),k=setTimeout(function(){if(o.default.device==="mobile")(0,n.removeClass)(e,"xgplayer-volume-muted"),(0,n.removeClass)(e,"xgplayer-volume-large"),p.video.muted||p.video.defaultMuted?(p.video.muted||(p.video.muted=!0),p.video.defaultMuted=!1,(0,n.addClass)(e,"xgplayer-volume-muted")):(0,n.addClass)(e,"xgplayer-volume-large");else{if((0,n.removeClass)(e,"xgplayer-volume-muted"),(0,n.removeClass)(e,"xgplayer-volume-small"),(0,n.removeClass)(e,"xgplayer-volume-large"),p.volume===0||p.muted?(0,n.addClass)(e,"xgplayer-volume-muted"):p.volume<.5?(0,n.addClass)(e,"xgplayer-volume-small"):(0,n.addClass)(e,"xgplayer-volume-large"),!f)return;var B=f.getBoundingClientRect().height||76;c.style.height=p.volume*B+"px"}},50)}p.on("volumechange",x);function S(){p.off("canplay",y),p.off("volumeBarClick",m),p.off("volumeIconClick",_),p.off("volumeIconEnter",E),p.off("volumeIconLeave",w),p.off("volumechange",x),p.off("destroy",S),k&&(clearTimeout(k),k=null)}p.once("destroy",S)};i.default={name:"volume",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function s(l,f){for(var c=0;c<f.length;c++){var y=f[c];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,y.key,y)}}return function(l,f,c){return f&&s(l.prototype,f),c&&s(l,c),l}}(),u=r(106),o=d(u);function d(s){return s&&s.__esModule?s:{default:s}}function g(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")}var v={follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},p=function(){function s(l,f,c){var y=this;g(this,s);var m=this.create(f,c,l.textTrackShowDefault);m.attachPlayer(l),this.subtitle=m,this.player=l,this.positionData={vBottom:0,marginBottom:0},this.isActive=!1,this.followBottom=c.followBottom,["onSubtitleResize","onFocus","onBlur"].map(function(_){y[_]=y[_].bind(y)}),l.controls&&c.follow&&(this.subtitle.on("resize",this.onSubtitleResize),l.on("focus",this.onFocus),l.on("blur",this.onBlur))}return n(s,[{key:"create",value:function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,m={subTitles:f,defaultOpen:y};return Object.keys(c).map(function(_){m[_]=c[_]}),new o.default(m)}},{key:"switch",value:function(f){return this.subtitle.switch(f)}},{key:"switchOff",value:function(){return this.subtitle.switchOff()}},{key:"setSubTitles",value:function(f,c,y){return this.subtitle.setSubTitles(f,c,y)}},{key:"onFocus",value:function(){var f=this.positionData,c=f.marginBottom,y=f.vBottom;if(!(this.isActive||!c)){this.isActive=!0;var m=c+y;this.followBottom>m&&(m=this.followBottom),this.subtitle&&(this.subtitle.root.style.bottom=m+"px")}}},{key:"onBlur",value:function(){this.isActive=!1;var f=this.positionData.vBottom+this.positionData.marginBottom;this.subtitle&&(this.subtitle.root.style.bottom=f+"px")}},{key:"onSubtitleResize",value:function(f){this.positionData.vBottom=f.vBottom,this.positionData.marginBottom=f.marginBottom}},{key:"destroy",value:function(){this.subtitle.off("resize",this.onSubtitleResize),this.player.off("focus",this.onFocus),this.player.off("blur",this.onBlur),this.subtitle.destroy(),this.subtitle=null}}]),s}(),e=function(){var l=this,f=this,c=f.config.textTrack;if(!c)return;var y=f.config.textTrackStyle||{};Object.keys(v).map(function(_){y[_]===void 0&&(y[_]=v[_])}),f.textTrackShowDefault=!1,f.config.textTrack.map(function(_,E){!_.id&&!_.language&&(_.id=E),!_.url&&(_.url=_.src),!_.language&&(_.language=_.srclang),_.isDefault===void 0&&(_.isDefault=_.default),!f.textTrackShowDefault&&(f.textTrackShowDefault=_.isDefault||_.default)}),this.subTitles=new p(f,f.config.textTrack,y),f.setSubTitles=function(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=!1;_.map(function(k,x){!k.id&&!k.language&&(k.id=x),!k.url&&(k.url=k.src),!k.language&&(k.language=k.srclang),k.isDefault===void 0&&(k.isDefault=k.default),k.isDefault&&(w=!0)}),f.textTrackShowDefault=w,l.subTitles.setSubTitles(_,w,E),f.emit("subtitle_change",{off:!1,isListUpdate:!0,list:_})},f.switchSubTitle=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};l.subTitles.switch(_).then(function(E){E.code===0&&(_.off=!1,_.isListUpdate=!1,_.list=[],f.emit("subtitle_change",_))})},f.switchOffSubtile=function(){l.subTitles.switchOff(),f.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]})};function m(){this.subTitles.destroy(),this.subTitles=null}f.once("destroy",m)};i.default={name:"textTrack",method:e},t.exports=i.default},function(t,i,r){(function(n,u){t.exports=u()})(this,function(){function n(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}function u(T,L){return L={exports:{}},T(L,L.exports),L.exports}function o(T){var L,P;this.promise=new T(function(I,X){if(L!==void 0||P!==void 0)throw TypeError("Bad Promise constructor");L=I,P=X}),this.resolve=Ee(L),this.reject=Ee(P)}function d(T){var L=T.length;return L===3?(60*(60*Number(T[0])+Number(T[1]))*1e3+1e3*Number(T[2]))/1e3:L===2?(60*Number(T[0])*1e3+1e3*Number(T[1]))/1e3:Number(T[0])}function g(T){return/^(\-|\+)?\d+(\.\d+)?$/.test(T)}function v(T){return T}function p(T,L){return T>=0&&T<L.length?L[T]:""}function e(T,L){if(!T)return!1;if(T.classList)return Array.prototype.some.call(T.classList,function(I){return I===L});var P=T.className&&rn(T.className)==="object"?T.getAttribute("class"):T.className;return P&&!!P.match(new RegExp("(\\s|^)"+L+"(\\s|$)"))}function s(T,L){T&&(T.classList?L.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(P){P&&T.classList.add(P)}):e(T,L)||(T.className&&rn(T.className)==="object"?T.setAttribute("class",T.getAttribute("class")+" "+L):T.className+=" "+L))}function l(T,L){T&&(T.classList?L.split(/\s+/g).forEach(function(P){T.classList.remove(P)}):e(T,L)&&L.split(/\s+/g).forEach(function(P){var I=new RegExp("(\\s|^)"+P+"(\\s|$)");T.className&&rn(T.className)==="object"?T.setAttribute("class",T.getAttribute("class").replace(I," ")):T.className=T.className.replace(I," ")}))}function f(T,L,P){var I=L.length;if(I<1)return-1;if(P=P<0?0:P>=I?I-1:P,L[P].start<=T&&T<L[P].end)return P;for(var X=L[P].end<=T?P+1:0;X<I;X++){if(L[X].start<=T&&T<L[X].end)return X;if(T>L[X].end&&X+1<I&&T<L[X+1].start||T>L[X].end&&X+1>=I)return-1}return-1}function c(T,L,P){var I=L.length;if(I<1)return[];var X=[];if((P=P<0?0:P>=I?I-1:P)<I)for(var Q=L[P].end<=T?P:0;Q<I&&(L[Q].start<=T&&T<L[Q].end&&X.push(Q),!(T<L[Q].start));Q++);return X}function y(T){return Object.prototype.toString.call(T).match(/([^\s.*]+)(?=]$)/g)[0]}function m(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",X=document.createElement(T);return X.className=I,X.innerHTML=L,un(P).forEach(function(Q){var se=Q,de=P[Q];T==="video"||T==="audio"||T==="live-video"?de&&X.setAttribute(se,de):X.setAttribute(se,de)}),X}function _(){var T=navigator.userAgent,L=/(?:Windows Phone)/.test(T),P=/(?:SymbianOS)/.test(T)||L,I=/(?:Android)/.test(T),X=/(?:Firefox)/.test(T),Q=/(?:iPad|PlayBook)/.test(T)||I&&!/(?:Mobile)/.test(T)||X&&/(?:Tablet)/.test(T);return/(?:iPhone)/.test(T)&&!Q||I||P||Q}function E(T){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",P="";T.map(function(de){P+=" "+L+" "+de.key+" {"+de.style+"}"});var I=document.createElement("style"),X=document.head||document.getElementsByTagName("head")[0];if(I.type="text/css",I.id="ssss",I.styleSheet){var Q=function(){try{I.styleSheet.cssText=P}catch(de){}};I.styleSheet.disabled?setTimeout(Q,10):Q()}else{var se=document.createTextNode(P);I.appendChild(se)}X.appendChild(I)}function w(T,L){fn||(fn=new Hu),fn.addObserver(T,L)}function k(T,L){fn&&fn.unObserver(T,L)}function x(T){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P={code:Gs[T].code,msg:Gs[T].msg};return un(L).map(function(I){P[I]=L[I]}),P}function S(T,L,P,I,X){X?P(x(2,X),{format:I.format}):I.format?(T.list=I.list,T.format=I.format,T.styles=I.styles,L(T)):P(x(3))}function B(T){return new Ta(function(L,P){if(T.list)return void L(T);if(T.json){var I=ka.parseJson(T.json);return T.list=I,T.format="json",void L(T)}if(T.stringContent&&!T.url)ka.parse(T.stringContent,function(Q,se){S(T,L,P,Q,se)});else if(T.url)new Mu({url:T.url,type:"text"}).then(function(Q){ka.parse(Q.res.response,function(se,de){S(T,L,P,se,de)})}).catch(function(Q){var se=x(1,{statusText:Q.statusText,status:Q.status,type:Q.type,message:"http load error",url:T.url});P(se)});else{var X=x(8);P(X)}})}function U(T,L){return!!(T.id&&T.id===L.id||T.language&&T.language===L.language)}var R=function(T){if(T==null)throw TypeError("Can't call method on  "+T);return T},C=function(T){return Object(R(T))},A={}.hasOwnProperty,b=function(T,L){return A.call(T,L)},O=u(function(T){var L=T.exports={version:"2.6.12"};typeof __e=="number"&&(__e=L)}),W=(O.version,u(function(T){var L=T.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=L)})),K=u(function(T){var L=W["__core-js_shared__"]||(W["__core-js_shared__"]={});(T.exports=function(P,I){return L[P]||(L[P]=I!==void 0?I:{})})("versions",[]).push({version:O.version,mode:"pure",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})}),G=0,F=Math.random(),j=function(T){return"Symbol(".concat(T===void 0?"":T,")_",(++G+F).toString(36))},N=K("keys"),$=function(T){return N[T]||(N[T]=j(T))},Z=$("IE_PROTO"),te=Object.prototype,ae=Object.getPrototypeOf||function(T){return T=C(T),b(T,Z)?T[Z]:typeof T.constructor=="function"&&T instanceof T.constructor?T.constructor.prototype:T instanceof Object?te:null},Ee=function(T){if(typeof T!="function")throw TypeError(T+" is not a function!");return T},Te=function(T,L,P){if(Ee(T),L===void 0)return T;switch(P){case 1:return function(I){return T.call(L,I)};case 2:return function(I,X){return T.call(L,I,X)};case 3:return function(I,X,Q){return T.call(L,I,X,Q)}}return function(){return T.apply(L,arguments)}},Ae=function(T){return typeof T=="object"?T!==null:typeof T=="function"},De=function(T){if(!Ae(T))throw TypeError(T+" is not an object!");return T},ze=function(T){try{return!!T()}catch(L){return!0}},Ce=!ze(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),Oe=W.document,$e=Ae(Oe)&&Ae(Oe.createElement),D=function(T){return $e?Oe.createElement(T):{}},fe=!Ce&&!ze(function(){return Object.defineProperty(D("div"),"a",{get:function(){return 7}}).a!=7}),ne=function(T,L){if(!Ae(T))return T;var P,I;if(L&&typeof(P=T.toString)=="function"&&!Ae(I=P.call(T))||typeof(P=T.valueOf)=="function"&&!Ae(I=P.call(T))||!L&&typeof(P=T.toString)=="function"&&!Ae(I=P.call(T)))return I;throw TypeError("Can't convert object to primitive value")},Y=Object.defineProperty,H={f:Ce?Object.defineProperty:function(T,L,P){if(De(T),L=ne(L,!0),De(P),fe)try{return Y(T,L,P)}catch(I){}if("get"in P||"set"in P)throw TypeError("Accessors not supported!");return"value"in P&&(T[L]=P.value),T}},J=function(T,L){return{enumerable:!(1&T),configurable:!(2&T),writable:!(4&T),value:L}},ce=Ce?function(T,L,P){return H.f(T,L,J(1,P))}:function(T,L,P){return T[L]=P,T},he=function(T,L,P){var I,X,Q,se=T&he.F,de=T&he.G,me=T&he.S,Ue=T&he.P,Pe=T&he.B,Me=T&he.W,Ve=de?O:O[L]||(O[L]={}),Xe=Ve.prototype,Be=de?W:me?W[L]:(W[L]||{}).prototype;de&&(P=L);for(I in P)(X=!se&&Be&&Be[I]!==void 0)&&b(Ve,I)||(Q=X?Be[I]:P[I],Ve[I]=de&&typeof Be[I]!="function"?P[I]:Pe&&X?Te(Q,W):Me&&Be[I]==Q?function(Ke){var Je=function(rt,Tt,Rt){if(this instanceof Ke){switch(arguments.length){case 0:return new Ke;case 1:return new Ke(rt);case 2:return new Ke(rt,Tt)}return new Ke(rt,Tt,Rt)}return Ke.apply(this,arguments)};return Je.prototype=Ke.prototype,Je}(Q):Ue&&typeof Q=="function"?Te(Function.call,Q):Q,Ue&&((Ve.virtual||(Ve.virtual={}))[I]=Q,T&he.R&&Xe&&!Xe[I]&&ce(Xe,I,Q)))};he.F=1,he.G=2,he.S=4,he.P=8,he.B=16,he.W=32,he.U=64,he.R=128;var ee=he,Se=function(T,L){var P=(O.Object||{})[T]||Object[T],I={};I[T]=L(P),ee(ee.S+ee.F*ze(function(){P(1)}),"Object",I)};Se("getPrototypeOf",function(){return function(T){return ae(C(T))}});var Le=O.Object.getPrototypeOf,ke=n(u(function(T){T.exports={default:Le,__esModule:!0}})),Ne=n(u(function(T,L){L.__esModule=!0,L.default=function(P,I){if(!(P instanceof I))throw new TypeError("Cannot call a class as a function")}})),Ye=Math.ceil,et=Math.floor,qe=function(T){return isNaN(T=+T)?0:(T>0?et:Ye)(T)},Et=ce,gt={},Zt={}.toString,ft=function(T){return Zt.call(T).slice(8,-1)},ki=Object("z").propertyIsEnumerable(0)?Object:function(T){return ft(T)=="String"?T.split(""):Object(T)},Ut=function(T){return ki(R(T))},Ft=Math.min,Mi=function(T){return T>0?Ft(qe(T),9007199254740991):0},Ai=Math.max,Fr=Math.min,Ni=function(T,L){return T=qe(T),T<0?Ai(T+L,0):Fr(T,L)},Ci=function(T){return function(L,P,I){var X,Q=Ut(L),se=Mi(Q.length),de=Ni(I,se);if(T&&P!=P){for(;se>de;)if((X=Q[de++])!=X)return!0}else for(;se>de;de++)if((T||de in Q)&&Q[de]===P)return T||de||0;return!T&&-1}}(!1),Jt=$("IE_PROTO"),Qt=function(T,L){var P,I=Ut(T),X=0,Q=[];for(P in I)P!=Jt&&b(I,P)&&Q.push(P);for(;L.length>X;)b(I,P=L[X++])&&(~Ci(Q,P)||Q.push(P));return Q},zi="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Vi=Object.keys||function(T){return Qt(T,zi)},gr=Ce?Object.defineProperties:function(T,L){De(T);for(var P,I=Vi(L),X=I.length,Q=0;X>Q;)H.f(T,P=I[Q++],L[P]);return T},Qi=W.document,vr=Qi&&Qi.documentElement,Zr=$("IE_PROTO"),Hi=function(){},yi=function(){var T,L=D("iframe"),P=zi.length;for(L.style.display="none",vr.appendChild(L),L.src="javascript:",(T=L.contentWindow.document).open(),T.write("<script>document.F=Object<\/script>"),T.close(),yi=T.F;P--;)delete yi.prototype[zi[P]];return yi()},ei=Object.create||function(T,L){var P;return T!==null?(Hi.prototype=De(T),P=new Hi,Hi.prototype=null,P[Zr]=T):P=yi(),L===void 0?P:gr(P,L)},St=u(function(T){var L=K("wks"),P=W.Symbol,I=typeof P=="function";(T.exports=function(X){return L[X]||(L[X]=I&&P[X]||(I?P:j)("Symbol."+X))}).store=L}),yr=H.f,ji=St("toStringTag"),mi=function(T,L,P){T&&!b(T=P?T:T.prototype,ji)&&yr(T,ji,{configurable:!0,value:L})},er={};ce(er,St("iterator"),function(){return this});var Or=function(T,L,P){T.prototype=ei(er,{next:J(1,P)}),mi(T,L+" Iterator")},tr=St("iterator"),ir=!([].keys&&"next"in[].keys()),mr=function(){return this},_r=function(T,L,P,I,X,Q,se){Or(P,L,I);var de,me,Ue,Pe=function(Rt){if(!ir&&Rt in Be)return Be[Rt];switch(Rt){case"keys":case"values":return function(){return new P(this,Rt)}}return function(){return new P(this,Rt)}},Me=L+" Iterator",Ve=X=="values",Xe=!1,Be=T.prototype,Ke=Be[tr]||Be["@@iterator"]||X&&Be[X],Je=Ke||Pe(X),rt=X?Ve?Pe("entries"):Je:void 0,Tt=L=="Array"&&Be.entries||Ke;if(Tt&&(Ue=ae(Tt.call(new T)))!==Object.prototype&&Ue.next&&mi(Ue,Me,!0),Ve&&Ke&&Ke.name!=="values"&&(Xe=!0,Je=function(){return Ke.call(this)}),se&&(ir||Xe||!Be[tr])&&ce(Be,tr,Je),gt[L]=Je,gt[Me]=mr,X)if(de={values:Ve?Je:Pe("values"),keys:Q?Je:Pe("keys"),entries:rt},se)for(me in de)me in Be||Et(Be,me,de[me]);else ee(ee.P+ee.F*(ir||Xe),L,de);return de},ti=function(T){return function(L,P){var I,X,Q=String(R(L)),se=qe(P),de=Q.length;return se<0||se>=de?T?"":void 0:(I=Q.charCodeAt(se),I<55296||I>56319||se+1===de||(X=Q.charCodeAt(se+1))<56320||X>57343?T?Q.charAt(se):I:T?Q.slice(se,se+2):X-56320+(I-55296<<10)+65536)}}(!0);_r(String,"String",function(T){this._t=String(T),this._i=0},function(){var T,L=this._t,P=this._i;return P>=L.length?{value:void 0,done:!0}:(T=ti(L,P),this._i+=T.length,{value:T,done:!1})});var Nt=function(T,L){return{value:L,done:!!T}};_r(Array,"Array",function(T,L){this._t=Ut(T),this._i=0,this._k=L},function(){var T=this._t,L=this._k,P=this._i++;return!T||P>=T.length?(this._t=void 0,Nt(1)):L=="keys"?Nt(0,P):L=="values"?Nt(0,T[P]):Nt(0,[P,T[P]])},"values"),gt.Arguments=gt.Array;for(var _i=St("toStringTag"),ii="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Di=0;Di<ii.length;Di++){var xi=ii[Di],Gi=W[xi],$t=Gi&&Gi.prototype;$t&&!$t[_i]&&ce($t,_i,xi),gt[xi]=gt.Array}var ri={f:St},zt=ri.f("iterator"),Ei=u(function(T){T.exports={default:zt,__esModule:!0}});n(Ei);var dt=u(function(T){var L=j("meta"),P=H.f,I=0,X=Object.isExtensible||function(){return!0},Q=!ze(function(){return X(Object.preventExtensions({}))}),se=function(Me){P(Me,L,{value:{i:"O"+ ++I,w:{}}})},de=function(Me,Ve){if(!Ae(Me))return typeof Me=="symbol"?Me:(typeof Me=="string"?"S":"P")+Me;if(!b(Me,L)){if(!X(Me))return"F";if(!Ve)return"E";se(Me)}return Me[L].i},me=function(Me,Ve){if(!b(Me,L)){if(!X(Me))return!0;if(!Ve)return!1;se(Me)}return Me[L].w},Ue=function(Me){return Q&&Pe.NEED&&X(Me)&&!b(Me,L)&&se(Me),Me},Pe=T.exports={KEY:L,NEED:!1,fastKey:de,getWeak:me,onFreeze:Ue}}),Vt=(dt.KEY,dt.NEED,dt.fastKey,dt.getWeak,dt.onFreeze,H.f),bt=function(T){var L=O.Symbol||(O.Symbol={});T.charAt(0)=="_"||T in L||Vt(L,T,{value:ri.f(T)})},_t={f:Object.getOwnPropertySymbols},Ot={f:{}.propertyIsEnumerable},vt=function(T){var L=Vi(T),P=_t.f;if(P)for(var I,X=P(T),Q=Ot.f,se=0;X.length>se;)Q.call(T,I=X[se++])&&L.push(I);return L},xr=Array.isArray||function(T){return ft(T)=="Array"},rr=zi.concat("length","prototype"),Lt={f:Object.getOwnPropertyNames||function(T){return Qt(T,rr)}},Ri=Lt.f,di={}.toString,Ui=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Li=function(T){try{return Ri(T)}catch(L){return Ui.slice()}},ci={f:function(T){return Ui&&di.call(T)=="[object Window]"?Li(T):Ri(Ut(T))}},$i=Object.getOwnPropertyDescriptor,Wt={f:Ce?$i:function(T,L){if(T=Ut(T),L=ne(L,!0),fe)try{return $i(T,L)}catch(P){}if(b(T,L))return J(!Ot.f.call(T,L),T[L])}},Jr=dt.KEY,nr=Wt.f,ni=H.f,Qe=ci.f,kt=W.Symbol,ar=W.JSON,M=ar&&ar.stringify,V=St("_hidden"),q=St("toPrimitive"),le={}.propertyIsEnumerable,be=K("symbol-registry"),Re=K("symbols"),tt=K("op-symbols"),lt=Object.prototype,yt=typeof kt=="function"&&!!_t.f,mt=W.QObject,Ht=!mt||!mt.prototype||!mt.prototype.findChild,Qr=Ce&&ze(function(){return ei(ni({},"a",{get:function(){return ni(this,"a",{value:7}).a}})).a!=7})?function(T,L,P){var I=nr(lt,L);I&&delete lt[L],ni(T,L,P),I&&T!==lt&&ni(lt,L,I)}:ni,bi=function(T){var L=Re[T]=ei(kt.prototype);return L._k=T,L},Ir=yt&&typeof kt.iterator=="symbol"?function(T){return typeof T=="symbol"}:function(T){return T instanceof kt},Er=function(T,L,P){return T===lt&&Er(tt,L,P),De(T),L=ne(L,!0),De(P),b(Re,L)?(P.enumerable?(b(T,V)&&T[V][L]&&(T[V][L]=!1),P=ei(P,{enumerable:J(0,!1)})):(b(T,V)||ni(T,V,J(1,{})),T[V][L]=!0),Qr(T,L,P)):ni(T,L,P)},Wi=function(T,L){De(T);for(var P,I=vt(L=Ut(L)),X=0,Q=I.length;Q>X;)Er(T,P=I[X++],L[P]);return T},la=function(T,L){return L===void 0?ei(T):Wi(ei(T),L)},ua=function(T){var L=le.call(this,T=ne(T,!0));return!(this===lt&&b(Re,T)&&!b(tt,T))&&(!(L||!b(this,T)||!b(Re,T)||b(this,V)&&this[V][T])||L)},kn=function(T,L){if(T=Ut(T),L=ne(L,!0),T!==lt||!b(Re,L)||b(tt,L)){var P=nr(T,L);return!P||!b(Re,L)||b(T,V)&&T[V][L]||(P.enumerable=!0),P}},An=function(T){for(var L,P=Qe(Ut(T)),I=[],X=0;P.length>X;)b(Re,L=P[X++])||L==V||L==Jr||I.push(L);return I},Cn=function(T){for(var L,P=T===lt,I=Qe(P?tt:Ut(T)),X=[],Q=0;I.length>Q;)!b(Re,L=I[Q++])||P&&!b(lt,L)||X.push(Re[L]);return X};yt||(Et((kt=function(){if(this instanceof kt)throw TypeError("Symbol is not a constructor!");var T=j(arguments.length>0?arguments[0]:void 0),L=function(P){this===lt&&L.call(tt,P),b(this,V)&&b(this[V],T)&&(this[V][T]=!1),Qr(this,T,J(1,P))};return Ce&&Ht&&Qr(lt,T,{configurable:!0,set:L}),bi(T)}).prototype,"toString",function(){return this._k}),Wt.f=kn,H.f=Er,Lt.f=ci.f=An,Ot.f=ua,_t.f=Cn,ri.f=function(T){return bi(St(T))}),ee(ee.G+ee.W+ee.F*!yt,{Symbol:kt});for(var Dn="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Rn=0;Dn.length>Rn;)St(Dn[Rn++]);for(var ai=Vi(St.store),Un=0;ai.length>Un;)bt(ai[Un++]);ee(ee.S+ee.F*!yt,"Symbol",{for:function(T){return b(be,T+="")?be[T]:be[T]=kt(T)},keyFor:function(T){if(!Ir(T))throw TypeError(T+" is not a symbol!");for(var L in be)if(be[L]===T)return L},useSetter:function(){Ht=!0},useSimple:function(){Ht=!1}}),ee(ee.S+ee.F*!yt,"Object",{create:la,defineProperty:Er,defineProperties:Wi,getOwnPropertyDescriptor:kn,getOwnPropertyNames:An,getOwnPropertySymbols:Cn});var en=ze(function(){_t.f(1)});ee(ee.S+ee.F*en,"Object",{getOwnPropertySymbols:function(T){return _t.f(C(T))}}),ar&&ee(ee.S+ee.F*(!yt||ze(function(){var T=kt();return M([T])!="[null]"||M({a:T})!="{}"||M(Object(T))!="{}"})),"JSON",{stringify:function(T){for(var L,P,I=[T],X=1;arguments.length>X;)I.push(arguments[X++]);if(P=L=I[1],(Ae(L)||T!==void 0)&&!Ir(T))return xr(L)||(L=function(Q,se){if(typeof P=="function"&&(se=P.call(this,Q,se)),!Ir(se))return se}),I[1]=L,M.apply(ar,I)}}),kt.prototype[q]||ce(kt.prototype,q,kt.prototype.valueOf),mi(kt,"Symbol"),mi(Math,"Math",!0),mi(W.JSON,"JSON",!0),bt("asyncIterator"),bt("observable");var Ln=O.Symbol,Pn=u(function(T){T.exports={default:Ln,__esModule:!0}});n(Pn);var tn=u(function(T,L){function P(se){return se&&se.__esModule?se:{default:se}}L.__esModule=!0;var I=P(Ei),X=P(Pn),Q=typeof X.default=="function"&&typeof I.default=="symbol"?function(se){return typeof se}:function(se){return se&&typeof X.default=="function"&&se.constructor===X.default&&se!==X.default.prototype?"symbol":typeof se};L.default=typeof X.default=="function"&&Q(I.default)==="symbol"?function(se){return se===void 0?"undefined":Q(se)}:function(se){return se&&typeof X.default=="function"&&se.constructor===X.default&&se!==X.default.prototype?"symbol":se===void 0?"undefined":Q(se)}}),rn=n(tn),nn=n(u(function(T,L){L.__esModule=!0;var P=function(I){return I&&I.__esModule?I:{default:I}}(tn);L.default=function(I,X){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!X||(X===void 0?"undefined":(0,P.default)(X))!=="object"&&typeof X!="function"?I:X}}));ee(ee.S+ee.F*!Ce,"Object",{defineProperty:H.f});var fa=O.Object,z=function(T,L,P){return fa.defineProperty(T,L,P)},ie=u(function(T){T.exports={default:z,__esModule:!0}});n(ie);var re=n(u(function(T,L){L.__esModule=!0;var P=function(I){return I&&I.__esModule?I:{default:I}}(ie);L.default=function(){function I(X,Q){for(var se=0;se<Q.length;se++){var de=Q[se];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),(0,P.default)(X,de.key,de)}}return function(X,Q,se){return Q&&I(X.prototype,Q),se&&I(X,se),X}}()})),ue=function(T,L){if(De(T),!Ae(L)&&L!==null)throw TypeError(L+": can't set as prototype!")},_e={set:Object.setPrototypeOf||("__proto__"in{}?function(T,L,P){try{(P=Te(Function.call,Wt.f(Object.prototype,"__proto__").set,2))(T,[]),L=!(T instanceof Array)}catch(I){L=!0}return function(I,X){return ue(I,X),L?I.__proto__=X:P(I,X),I}}({},!1):void 0),check:ue};ee(ee.S,"Object",{setPrototypeOf:_e.set});var ve=O.Object.setPrototypeOf,pe=u(function(T){T.exports={default:ve,__esModule:!0}});n(pe),ee(ee.S,"Object",{create:ei});var xe=O.Object,Ie=function(T,L){return xe.create(T,L)},we=u(function(T){T.exports={default:Ie,__esModule:!0}});n(we);var ot,it,Ze,si=n(u(function(T,L){function P(se){return se&&se.__esModule?se:{default:se}}L.__esModule=!0;var I=P(pe),X=P(we),Q=P(tn);L.default=function(se,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function, not "+(de===void 0?"undefined":(0,Q.default)(de)));se.prototype=(0,X.default)(de&&de.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),de&&(I.default?(0,I.default)(se,de):se.__proto__=de)}})),br=St("toStringTag"),da=ft(function(){return arguments}())=="Arguments",ye=function(T,L){try{return T[L]}catch(P){}},ht=function(T){var L,P,I;return T===void 0?"Undefined":T===null?"Null":typeof(P=ye(L=Object(T),br))=="string"?P:da?ft(L):(I=ft(L))=="Object"&&typeof L.callee=="function"?"Arguments":I},Yt=function(T,L,P,I){if(!(T instanceof L)||I!==void 0&&I in T)throw TypeError(P+": incorrect invocation!");return T},bu=function(T,L,P,I){try{return I?L(De(P)[0],P[1]):L(P)}catch(Q){var X=T.return;throw X!==void 0&&De(X.call(T)),Q}},wu=St("iterator"),Tu=Array.prototype,Su=function(T){return T!==void 0&&(gt.Array===T||Tu[wu]===T)},ku=St("iterator"),Au=O.getIteratorMethod=function(T){if(T!=null)return T[ku]||T["@@iterator"]||gt[ht(T)]},_s=u(function(T){var L={},P={},I=T.exports=function(X,Q,se,de,me){var Ue,Pe,Me,Ve,Xe=me?function(){return X}:Au(X),Be=Te(se,de,Q?2:1),Ke=0;if(typeof Xe!="function")throw TypeError(X+" is not iterable!");if(Su(Xe)){for(Ue=Mi(X.length);Ue>Ke;Ke++)if((Ve=Q?Be(De(Pe=X[Ke])[0],Pe[1]):Be(X[Ke]))===L||Ve===P)return Ve}else for(Me=Xe.call(X);!(Pe=Me.next()).done;)if((Ve=bu(Me,Be,Pe.value,Q))===L||Ve===P)return Ve};I.BREAK=L,I.RETURN=P}),Cu=St("species"),xs=function(T,L){var P,I=De(T).constructor;return I===void 0||(P=De(I)[Cu])==null?L:Ee(P)},Du=function(T,L,P){var I=P===void 0;switch(L.length){case 0:return I?T():T.call(P);case 1:return I?T(L[0]):T.call(P,L[0]);case 2:return I?T(L[0],L[1]):T.call(P,L[0],L[1]);case 3:return I?T(L[0],L[1],L[2]):T.call(P,L[0],L[1],L[2]);case 4:return I?T(L[0],L[1],L[2],L[3]):T.call(P,L[0],L[1],L[2],L[3])}return T.apply(P,L)},Es=W.process,ca=W.setImmediate,ha=W.clearImmediate,bs=W.MessageChannel,pa=W.Dispatch,ga=0,an={},sn=function(){var T=+this;if(an.hasOwnProperty(T)){var L=an[T];delete an[T],L()}},ws=function(T){sn.call(T.data)};ca&&ha||(ca=function(T){for(var L=[],P=1;arguments.length>P;)L.push(arguments[P++]);return an[++ga]=function(){Du(typeof T=="function"?T:Function(T),L)},ot(ga),ga},ha=function(T){delete an[T]},ft(Es)=="process"?ot=function(T){Es.nextTick(Te(sn,T,1))}:pa&&pa.now?ot=function(T){pa.now(Te(sn,T,1))}:bs?(Ze=(it=new bs).port2,it.port1.onmessage=ws,ot=Te(Ze.postMessage,Ze,1)):W.addEventListener&&typeof postMessage=="function"&&!W.importScripts?(ot=function(T){W.postMessage(T+"","*")},W.addEventListener("message",ws,!1)):ot="onreadystatechange"in D("script")?function(T){vr.appendChild(D("script")).onreadystatechange=function(){vr.removeChild(this),sn.call(T)}}:function(T){setTimeout(Te(sn,T,1),0)});var Ts={set:ca,clear:ha},Ru=Ts.set,Ss=W.MutationObserver||W.WebKitMutationObserver,va=W.process,ya=W.Promise,ks=ft(va)=="process",Bn={f:function(T){return new o(T)}},Fn=function(T){try{return{e:!1,v:T()}}catch(L){return{e:!0,v:L}}},As=W.navigator,Uu=As&&As.userAgent||"",ma=function(T,L){if(De(T),Ae(L)&&L.constructor===T)return L;var P=Bn.f(T);return(0,P.resolve)(L),P.promise},Cs=St("species"),_a=St("iterator"),Ds=!1;try{var Rs=[7][_a]();Rs.return=function(){Ds=!0},Array.from(Rs,function(){throw 2})}catch(T){}var xa,Us,Ls,Ea,Ps=Ts.set,Bs=function(){var T,L,P,I=function(){var de,me;for(ks&&(de=va.domain)&&de.exit();T;){me=T.fn,T=T.next;try{me()}catch(Ue){throw T?P():L=void 0,Ue}}L=void 0,de&&de.enter()};if(ks)P=function(){va.nextTick(I)};else if(!Ss||W.navigator&&W.navigator.standalone)if(ya&&ya.resolve){var X=ya.resolve(void 0);P=function(){X.then(I)}}else P=function(){Ru.call(W,I)};else{var Q=!0,se=document.createTextNode("");new Ss(I).observe(se,{characterData:!0}),P=function(){se.data=Q=!Q}}return function(de){var me={fn:de,next:void 0};L&&(L.next=me),T||(T=me,P()),L=me}}(),Fs=W.TypeError,Mr=W.process,Os=Mr&&Mr.versions,Lu=Os&&Os.v8||"",Pi=W.Promise,on=ht(Mr)=="process",On=function(){},ln=Us=Bn.f,In=!!function(){try{var T=Pi.resolve(1),L=(T.constructor={})[St("species")]=function(P){P(On,On)};return(on||typeof PromiseRejectionEvent=="function")&&T.then(On)instanceof L&&Lu.indexOf("6.6")!==0&&Uu.indexOf("Chrome/66")===-1}catch(P){}}(),Is=function(T){var L;return!(!Ae(T)||typeof(L=T.then)!="function")&&L},ba=function(T,L){if(!T._n){T._n=!0;var P=T._c;Bs(function(){for(var I=T._v,X=T._s==1,Q=0;P.length>Q;)(function(se){var de,me,Ue,Pe=X?se.ok:se.fail,Me=se.resolve,Ve=se.reject,Xe=se.domain;try{Pe?(X||(T._h==2&&Bu(T),T._h=1),Pe===!0?de=I:(Xe&&Xe.enter(),de=Pe(I),Xe&&(Xe.exit(),Ue=!0)),de===se.promise?Ve(Fs("Promise-chain cycle")):(me=Is(de))?me.call(de,Me,Ve):Me(de)):Ve(I)}catch(Be){Xe&&!Ue&&Xe.exit(),Ve(Be)}})(P[Q++]);T._c=[],T._n=!1,L&&!T._h&&Pu(T)})}},Pu=function(T){Ps.call(W,function(){var L,P,I,X=T._v,Q=Ms(T);if(Q&&(L=Fn(function(){on?Mr.emit("unhandledRejection",X,T):(P=W.onunhandledrejection)?P({promise:T,reason:X}):(I=W.console)&&I.error&&I.error("Unhandled promise rejection",X)}),T._h=on||Ms(T)?2:1),T._a=void 0,Q&&L.e)throw L.v})},Ms=function(T){return T._h!==1&&(T._a||T._c).length===0},Bu=function(T){Ps.call(W,function(){var L;on?Mr.emit("rejectionHandled",T):(L=W.onrejectionhandled)&&L({promise:T,reason:T._v})})},Nr=function(T){var L=this;L._d||(L._d=!0,(L=L._w||L)._v=T,L._s=2,L._a||(L._a=L._c.slice()),ba(L,!0))},wa=function(T){var L,P=this;if(!P._d){P._d=!0,P=P._w||P;try{if(P===T)throw Fs("Promise can't be resolved itself");(L=Is(T))?Bs(function(){var I={_w:P,_d:!1};try{L.call(T,Te(wa,I,1),Te(Nr,I,1))}catch(X){Nr.call(I,X)}}):(P._v=T,P._s=1,ba(P,!1))}catch(I){Nr.call({_w:P,_d:!1},I)}}};In||(Pi=function(T){Yt(this,Pi,"Promise","_h"),Ee(T),xa.call(this);try{T(Te(wa,this,1),Te(Nr,this,1))}catch(L){Nr.call(this,L)}},(xa=function(T){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(T,L,P){for(var I in L)P&&T[I]?T[I]=L[I]:ce(T,I,L[I]);return T}(Pi.prototype,{then:function(T,L){var P=ln(xs(this,Pi));return P.ok=typeof T!="function"||T,P.fail=typeof L=="function"&&L,P.domain=on?Mr.domain:void 0,this._c.push(P),this._a&&this._a.push(P),this._s&&ba(this,!1),P.promise},catch:function(T){return this.then(void 0,T)}}),Ls=function(){var T=new xa;this.promise=T,this.resolve=Te(wa,T,1),this.reject=Te(Nr,T,1)},Bn.f=ln=function(T){return T===Pi||T===Ea?new Ls(T):Us(T)}),ee(ee.G+ee.W+ee.F*!In,{Promise:Pi}),mi(Pi,"Promise"),function(T){var L=typeof O[T]=="function"?O[T]:W[T];Ce&&L&&!L[Cs]&&H.f(L,Cs,{configurable:!0,get:function(){return this}})}("Promise"),Ea=O.Promise,ee(ee.S+ee.F*!In,"Promise",{reject:function(T){var L=ln(this);return(0,L.reject)(T),L.promise}}),ee(ee.S+!0*ee.F,"Promise",{resolve:function(T){return ma(this===Ea?Pi:this,T)}}),ee(ee.S+ee.F*!(In&&function(T,L){if(!L&&!Ds)return!1;var P=!1;try{var I=[7],X=I[_a]();X.next=function(){return{done:P=!0}},I[_a]=function(){return X},T(I)}catch(Q){}return P}(function(T){Pi.all(T).catch(On)})),"Promise",{all:function(T){var L=this,P=ln(L),I=P.resolve,X=P.reject,Q=Fn(function(){var se=[],de=0,me=1;_s(T,!1,function(Ue){var Pe=de++,Me=!1;se.push(void 0),me++,L.resolve(Ue).then(function(Ve){Me||(Me=!0,se[Pe]=Ve,--me||I(se))},X)}),--me||I(se)});return Q.e&&X(Q.v),P.promise},race:function(T){var L=this,P=ln(L),I=P.reject,X=Fn(function(){_s(T,!1,function(Q){L.resolve(Q).then(P.resolve,I)})});return X.e&&I(X.v),P.promise}}),ee(ee.P+ee.R,"Promise",{finally:function(T){var L=xs(this,O.Promise||W.Promise),P=typeof T=="function";return this.then(P?function(I){return ma(L,T()).then(function(){return I})}:T,P?function(I){return ma(L,T()).then(function(){throw I})}:T)}}),ee(ee.S,"Promise",{try:function(T){var L=Bn.f(this),P=Fn(T);return(P.e?L.reject:L.resolve)(P.v),L.promise}});var Fu=O.Promise,Ta=n(u(function(T){T.exports={default:Fu,__esModule:!0}}));Se("keys",function(){return function(T){return Vi(C(T))}});var Ou=O.Object.keys,un=n(u(function(T){T.exports={default:Ou,__esModule:!0}})),Iu=u(function(T){function L(){}function P(me,Ue,Pe){this.fn=me,this.context=Ue,this.once=Pe||!1}function I(me,Ue,Pe,Me,Ve){if(typeof Pe!="function")throw new TypeError("The listener must be a function");var Xe=new P(Pe,Me||me,Ve),Be=de?de+Ue:Ue;return me._events[Be]?me._events[Be].fn?me._events[Be]=[me._events[Be],Xe]:me._events[Be].push(Xe):(me._events[Be]=Xe,me._eventsCount++),me}function X(me,Ue){--me._eventsCount==0?me._events=new L:delete me._events[Ue]}function Q(){this._events=new L,this._eventsCount=0}var se=Object.prototype.hasOwnProperty,de="~";Object.create&&(L.prototype=Object.create(null),new L().__proto__||(de=!1)),Q.prototype.eventNames=function(){var me,Ue,Pe=[];if(this._eventsCount===0)return Pe;for(Ue in me=this._events)se.call(me,Ue)&&Pe.push(de?Ue.slice(1):Ue);return Object.getOwnPropertySymbols?Pe.concat(Object.getOwnPropertySymbols(me)):Pe},Q.prototype.listeners=function(me){var Ue=de?de+me:me,Pe=this._events[Ue];if(!Pe)return[];if(Pe.fn)return[Pe.fn];for(var Me=0,Ve=Pe.length,Xe=new Array(Ve);Me<Ve;Me++)Xe[Me]=Pe[Me].fn;return Xe},Q.prototype.listenerCount=function(me){var Ue=de?de+me:me,Pe=this._events[Ue];return Pe?Pe.fn?1:Pe.length:0},Q.prototype.emit=function(me,Ue,Pe,Me,Ve,Xe){var Be=de?de+me:me;if(!this._events[Be])return!1;var Ke,Je,rt=this._events[Be],Tt=arguments.length;if(rt.fn){switch(rt.once&&this.removeListener(me,rt.fn,void 0,!0),Tt){case 1:return rt.fn.call(rt.context),!0;case 2:return rt.fn.call(rt.context,Ue),!0;case 3:return rt.fn.call(rt.context,Ue,Pe),!0;case 4:return rt.fn.call(rt.context,Ue,Pe,Me),!0;case 5:return rt.fn.call(rt.context,Ue,Pe,Me,Ve),!0;case 6:return rt.fn.call(rt.context,Ue,Pe,Me,Ve,Xe),!0}for(Je=1,Ke=new Array(Tt-1);Je<Tt;Je++)Ke[Je-1]=arguments[Je];rt.fn.apply(rt.context,Ke)}else{var Rt,sr=rt.length;for(Je=0;Je<sr;Je++)switch(rt[Je].once&&this.removeListener(me,rt[Je].fn,void 0,!0),Tt){case 1:rt[Je].fn.call(rt[Je].context);break;case 2:rt[Je].fn.call(rt[Je].context,Ue);break;case 3:rt[Je].fn.call(rt[Je].context,Ue,Pe);break;case 4:rt[Je].fn.call(rt[Je].context,Ue,Pe,Me);break;default:if(!Ke)for(Rt=1,Ke=new Array(Tt-1);Rt<Tt;Rt++)Ke[Rt-1]=arguments[Rt];rt[Je].fn.apply(rt[Je].context,Ke)}}return!0},Q.prototype.on=function(me,Ue,Pe){return I(this,me,Ue,Pe,!1)},Q.prototype.once=function(me,Ue,Pe){return I(this,me,Ue,Pe,!0)},Q.prototype.removeListener=function(me,Ue,Pe,Me){var Ve=de?de+me:me;if(!this._events[Ve])return this;if(!Ue)return X(this,Ve),this;var Xe=this._events[Ve];if(Xe.fn)Xe.fn!==Ue||Me&&!Xe.once||Pe&&Xe.context!==Pe||X(this,Ve);else{for(var Be=0,Ke=[],Je=Xe.length;Be<Je;Be++)(Xe[Be].fn!==Ue||Me&&!Xe[Be].once||Pe&&Xe[Be].context!==Pe)&&Ke.push(Xe[Be]);Ke.length?this._events[Ve]=Ke.length===1?Ke[0]:Ke:X(this,Ve)}return this},Q.prototype.removeAllListeners=function(me){var Ue;return me?(Ue=de?de+me:me,this._events[Ue]&&X(this,Ue)):(this._events=new L,this._eventsCount=0),this},Q.prototype.off=Q.prototype.removeListener,Q.prototype.addListener=Q.prototype.on,Q.prefixed=de,Q.EventEmitter=Q,T.exports=Q}),Mu=function T(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P=L.url,I=L.method,X=I===void 0?"GET":I,Q=L.type,se=Q===void 0?"arraybuffer":Q,de=L.timeout,me=de===void 0?1e4:de,Ue=L.data,Pe=Ue===void 0?{}:Ue,Me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ne(this,T),new Ta(function(Ve,Xe){var Be=new window.XMLHttpRequest,Ke=X.toUpperCase(),Je=[];se&&(Be.responseType=se),me&&(Be.timeout=me);for(var rt in Pe)Je.push("k="+Pe[rt]);if(Be.onload=function(){Be.status===200||Be.status===206?Ve({context:Me,res:Be}):Xe(new Error({context:Me,res:Be,type:"error"}))},Be.onerror=function(Tt){Xe(new Error({context:Me,res:Be,type:"error"}))},Be.ontimeout=function(Tt){Xe(new Error({context:Me,res:Be,type:"error"}))},Be.onabort=function(){Xe(new Error({context:Me,res:Be,type:"error"}))},Ke==="GET")Be.open(Ke,""+P),Be.send();else{if(Ke!=="post")throw new Error("xhr "+Ke+" is not supported");Be.open(Ke,P),Be.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Be.send(Je.join("&"))}})},Sa=/^WEBVTT/,Nu=/^STYLE+$/,zu=/^\:\:cue/,Vu=/^}+$/,Ns=/^\[Script Info\].*/,zs=[/[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}\.[0-9]{1,3}-->[0-9]{1,2}\.[0-9]{1,3}/],Vs=/^Format:\s/,Hs=/^Style:\s/,js=/^Dialogue:\s/,ka=function(){function T(){Ne(this,T)}return re(T,null,[{key:"parseJson",value:function(L){for(var P=[],I=0,X=0;X<L.length;X++){if(I>=50&&(I=0),I===0){var Q={start:L[X].start,list:[L[X]],end:L[X].end};P.push(Q)}else P[P.length-1].list.push(L[X]),P[P.length-1].end=L[X].end;I++}return P}},{key:"parse",value:function(L,P){var I=T.checkFormat(L);I||P({format:I});try{var X=[];I==="ass"?X=T.parseASS(L):I==="vtt"&&(X=T.parseVTT(L)),P({format:I,list:X.list,styles:X.styles})}catch(Q){console.error(Q),P({format:I},Q)}}},{key:"parseASSItem",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],I=L.split(","),X={},Q="";try{var se=I.length-P.length;return Q=se>0?I.splice(P.length-1,se+1).join(",")+"":I[I.length-1]+"",Q=Q.replace(/\\n+/g,""),Q=v(Q),I[P.length-1]=Q,P.map(function(de,me){de==="end"||de==="start"?X[de]=d(I[me].split(":")):de==="text"?X[de]=[I[me]]:de==="layer"?(X[de]=[I[me]],X.textTag=[I[me]]):X[de]=de==="style"?[I[me]]:Number(I[me])?Number(I[me]):I[me]}),X}catch(de){return console.error(de),{}}}},{key:"parseASS",value:function(L){for(var P=L.split(`
`),I=[],X=0,Q=0,se=[],de=[],me=null;X<P.length;){if(Vs.test(P[X]))de=(de=P[X].replace(Vs,"").replace(/\s+/g,"").split(",")).map(function(Ke){return Ke.toLocaleLowerCase()});else if(Hs.test(P[X]))se.push(P[X].replace(Hs,"").replace(/\s+/g,""));else if(js.test(P[X])){var Ue=T.parseASSItem(P[X].replace(js,""),de);if(me&&Ue.start===me.start&&Ue.end===me.end)try{var Pe=me,Me=Pe.text,Ve=Pe.textTag,Xe=Pe.style;Me.push(Ue.text[0]),Ve.push(Ue.textTag[0]),Xe.push(Ue.style[0])}catch(Ke){console.error(Ke)}else{me=Ue;var Be=null;Q%50==0?((Be={start:me.start,end:me.end,list:[]}).list.push(me),I.push(Be)):((Be=I[I.length-1]).end=me.end,Be.list.push(me)),Q++}}X++}return{list:I,style:{}}}},{key:"parseVTTStyle",value:function(L,P){var I=L.split(":");if(I.length>1){var X=I[0].trim().split("-"),Q="";X.length>1?X.map(function(se,de){Q+=de===0?se:se.charAt(0).toUpperCase()+se.slice(1)}):Q=X[0],P[Q]=I[1].trim().replace(/;$/,"")}return P}},{key:"parseVTT",value:function(L){for(var P=(L=L.replace(Sa,"")).split(`
`),I=[],X=0,Q=0,se=null,de=!1,me=!1,Ue=null,Pe=null,Me=[];X<P.length;){var Ve=p(X,P).trim();if(!Ve||de&&g(Ve))de=!Ve;else if(zu.test(Ve)&&Nu.test(p(X-1,P).trim())){me=!0;var Xe=/\((.+?)\)/g.exec(Ve);Pe=Xe?Xe[1]:"",Ue=""}else if(me)Vu.test(Ve)?(Me.push({key:Pe,style:Ue}),Ue=null,Pe=null,me=!1):Ue+=Ve;else if(Ve){de=!1;var Be=this.checkIsTime(P[X]);if(Be){var Ke=this.parseVttTime(Be);if(!se||Ke.start!==se.start||Ke.end!==se.end){(se=Ke).text=[],se.textTag=[];var Je=null;Q%50==0?((Je={start:se.start,end:se.end,list:[]}).list.push(se),I.push(Je)):((Je=I[I.length-1]).end=se.end,Je.list.push(se)),Q++}}else if(se){var rt=se,Tt=rt.text,Rt=rt.textTag,sr=this.parseVttText(P[X]);Tt.push(sr.text),Rt.push(sr.tag)}de=!1}X++}return{list:I,styles:Me}}},{key:"checkIsTime",value:function(L){L=L.replace(/\s+/g,"");for(var P=0,I=null;P<zs.length&&!(I=zs[P].exec(L));)P++;return I?I[0]:null}},{key:"parseVttText",value:function(L){var P=/^(<?.+?>)/g.exec(L),I="",X="default";if(P){X=P[0].replace(/\<|\>|\&/g,"");var Q=RegExp("^<"+X+">(([\\s\\S])*?)</"+X+">$").exec(L);Q?I=Q[1]:(I=L,X="")}else I=L;for(var se=/<(\w+).(\w+)>/g,de=se.exec(I);de&&de.length>2;)I=I.replace(de[0],"<"+de[1]+' class="'+de[2]+'">'),de=se.exec(I);return{tag:X,text:v(I.replace(/\\n+/g,"<br/>"))}}},{key:"parseVttTime",value:function(L){var P=L.split("-->"),I=void 0,X=0;if(P.length===2){var Q=P[0].split(":"),se=P[1].split(":");I=d(Q),X=d(se)}return{start:I,end:X,time:L}}},{key:"isVTT",value:function(L){return Sa.test(L)}},{key:"isASS",value:function(L){return Ns.test(L)}},{key:"checkFormat",value:function(L){return L?Sa.test(L)?"vtt":Ns.test(L)?"ass":null:null}}]),T}(),Hu=function(){function T(){var L=this;Ne(this,T),this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver(function(P){L.__trigger(P)}))}return re(T,[{key:"addObserver",value:function(L,P){if(this.observer){this.observer&&this.observer.observe(L);for(var I=this.__handlers,X=-1,Q=0;Q<I.length;Q++)I[Q]&&L===I[Q].target&&(X=Q);X>-1?this.__handlers[X].handler.push(P):this.__handlers.push({target:L,handler:[P]})}}},{key:"unObserver",value:function(L){var P=-1;this.__handlers.map(function(I,X){L===I.target&&(P=X)}),this.observer&&this.observer.unobserve(L),P>-1&&this.__handlers.splice(P,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(L,P){for(var I=this.__handlers,X=0;X<I.length;X++)if(I[X]&&L===I[X].target){I[X].handler&&I[X].handler.map(function(Q){try{Q(L,P)}catch(se){console.error(se)}});break}}},{key:"__trigger",value:function(L){var P=this;L.map(function(I){var X=I.contentRect;P.__runHandler(I.target,X)})}}]),T}(),fn=null;(function(T,L){L===void 0&&(L={});var P=L.insertAt;if(T&&typeof document!="undefined"){var I=document.head||document.getElementsByTagName("head")[0],X=document.createElement("style");X.type="text/css",P==="top"&&I.firstChild?I.insertBefore(X,I.firstChild):I.appendChild(X),X.styleSheet?X.styleSheet.cssText=T:X.appendChild(document.createTextNode(T))}})(`xg-text-track.xg-text-track {
  font-family: "PingFang SC","SF Pro SC","SF Pro Text","SF Pro Icons","Helvetica Neue","Helvetica","Arial",sans-serif;
  -webkit-font-smoothing: antialiased;
  position: absolute;
  bottom: 0;
  color: #fff;
  left: 0;
  right: 0;
  pointer-events: none;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center; }
  xg-text-track.xg-text-track.text-track-no-fitvideo {
    margin-bottom: 2%; }
  xg-text-track.xg-text-track.text-track-hide {
    opacity: 0;
    visibility: hidden; }
  xg-text-track.xg-text-track.text-track-show {
    opacity: 1;
    visibility: visible; }
  xg-text-track.xg-text-track xg-text-track-inner {
    display: block;
    max-width: 92%; }
  xg-text-track.xg-text-track xg-text-track-span {
    display: -webkit-box;
    text-align: center;
    text-overflow: ellipsis;
    -webkit-box-orient: vertical;
    overflow: hidden;
    padding: 1px 4px;
    -webkit-line-clamp: 1;
    line-height: 120%;
    word-break: break-word; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-deputy {
      font-size: 75%; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-single {
      -webkit-line-clamp: 1; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-double {
      -webkit-line-clamp: 2; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-three {
      -webkit-line-clamp: 3; }
  xg-text-track.xg-text-track.text-track-bg xg-text-track-inner {
    background-color: rgba(0, 0, 0, .54);
    border-radius: 2px; }
  xg-text-track.xg-text-track.text-track-stroke xg-text-track-inner {
    background-color: none;
    border-radius: 0;
    text-shadow: -1px 1px 0 rgba(0, 0, 0, .7), 1px 1px 0 rgba(0, 0, 0, .7), 1px -1px 0 rgba(0, 0, 0, .7), -1px -1px 0 rgba(0, 0, 0, .7); }
`);var Gs=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR"},{code:6,msg:"ABORT"},{code:7,msg:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null"}],ju={RESIZE:"resize"},$s=!1;return function(T){function L(P){Ne(this,L);var I=nn(this,(L.__proto__||ke(L)).call(this));return $s=_(),I.currentText=null,I.textTrack=[],I._cid=-1,I._gid=-1,I._cids=[],I._iId=null,I._iC=0,I.player=null,I.root=null,I.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff"},I._ctime=0,I._loadingTrack={},un(I.config).map(function(X){P[X]!==void 0&&P[X]!==null&&(I.config[X]=P[X])}),I._isOpen=!1,I._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},P.subTitles&&y(P.subTitles)==="Array"?(P.player&&I.attachPlayer(P.player),I.setSubTitles(P.subTitles,I.config.defaultOpen),I):nn(I)}return si(L,T),re(L,[{key:"version",get:function(){return"1.0.12"}}]),re(L,[{key:"setSubTitles",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],I=this,X=arguments.length>1&&arguments[1]!==void 0&&arguments[1],Q=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],se=this._isOpen||X;Q&&this.innerRoot&&this.switchOff(),this.currentText=null,this.textTrack=[],P.map(function(de){var me={};un(de).map(function(Ue){me[Ue]=de[Ue]}),me.isDefault&&(I.currentText=me),I.textTrack.push(me)}),this.currentText&&B(this.currentText).then(function(de){I.addStyles(de),se&&I.switch()})}},{key:"addStyles",value:function(P){var I=P.styles,X=P.format;I&&X==="vtt"&&(I.map(function(Q){Q.key||(Q.key="xg-text-track-span")}),E(I,"xg-text-track"))}},{key:"attachPlayer",value:function(P){var I=this;if(P){this.player&&this.detachPlayer();var X=this.config,Q=X.fontColor,se=X.mode,de=X.fitVideo;this.player=P,this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&s(this.root,"text-track-hide"),!de&&s(this.root,"text-track-no-fitvideo"),se&&s(this.root,"text-track-"+se),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),Q&&(this.root.style.color=Q),this.currentText&&["language","id","label"].map(function(me){I.root.setAttribute("data-"+me,I.currentText[me]||"")}),this.player.root.appendChild(this.root),["destroy","__onTimeupdate","_onResize"].map(function(me){I[me]=I[me].bind(I)}),this.player.on("destroy",this.destroy),this.player.on("timeupdate",this.__onTimeupdate),this._isOpen&&this.switch(),w(P.root,this._onResize)}}},{key:"detachPlayer",value:function(){var P=this.player;P&&(P.off("destroy",this.destroy),P.off("timeupdate",this.__onTimeupdate),P.root&&(k(P.root,this._onResize),P.root.removeChild(this.root)),this.innerRoot=null,this.root=null,this.player=null)}},{key:"switch",value:function(){var P=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};return this._loadingTrack=I,new Ta(function(X,Q){if(!I.id&&!I.language){if(P.currentText){P._loadingTrack={},P._updateCurrent(P.currentText),P._isOpen=!0,P.show();var se=x(0,{message:"switch default subtitle success"});return void X(se)}var de=x(5,{message:"no default subtitle"});return void Q(de)}if(P.currentText&&U(I,P.currentText))P._loadingTrack={},P._updateCurrent(P.currentText),P._isOpen=!0,P.show(),X(x(0));else{for(var me=null,Ue=0;Ue<P.textTrack.length;Ue++)if(U(I,P.textTrack[Ue])){me=P.textTrack[Ue];break}if(me)me.list?(P._loadingTrack={},P._updateCurrent(me),P._isOpen=!0,P.show(),X(x(0))):B(me).then(function(Me){if(P.addStyles(Me),P._loadingTrack.id===me.id||P._loadingTrack.language===Me.language)P._loadingTrack={},P._updateCurrent(Me),P._isOpen=!0,P.show(),X(x(0));else{var Ve=x(6,{message:"check _loadingTrack fail id: "+P._loadingTrack.id+"  nextSubtitle:"+Me.id});console.trace(Ve),Q(Ve)}}).catch(function(Me){Q(Me)});else{var Pe=x(4,new Error("The is no subtitle with id:[{"+I.id+"}] or language:["+I.language+"]"));console.trace(Pe),Q(Pe)}}})}},{key:"switchOff",value:function(){this._isOpen=!1,this.hide()}},{key:"_updateCurrent",value:function(P){var I=this;if(this.root){this.currentText=P,["language","id","label"].map(function(Q){I.root.setAttribute("data-"+Q,I.currentText[Q]||"")}),this.__remove(this._cids);var X=this.player.currentTime;this._cids=[],this._gid=-1,this._cid=-1,this._update(X)}}},{key:"__loadAll",value:function(){this.textTrack.map(function(P){B(P)})}},{key:"getDelCid",value:function(P,I){for(var X=[],Q=0;Q<P.length;Q++)I.includes(P[Q])||X.push(P[Q]);return X}},{key:"getNewCid",value:function(P,I){for(var X=[],Q=0;Q<I.length;Q++)P.includes(I[Q])||X.push(I[Q]);return X}},{key:"_update",value:function(P){var I=this,X=f(P,this.currentText.list,this._gid),Q=[];if(X>-1&&(Q=c(P,this.currentText.list[X].list,this._cid)),Q.length<1)return this._cids.length>0&&this.__remove(this._cids),void(this._cids=[]);if(this._cids!==Q||X!==this._gid){this._gid=X,this._cid=Q[0];var se=this.getDelCid(this._cids,Q),de=this.getNewCid(this._cids,Q);this._cids=Q,this.__remove(se);var me=[];de.map(function(Ue){var Pe=I.currentText.list[X].list[Ue];Pe.index=Ue,me.push(Pe)}),this.__render(me,P)}}},{key:"__onTimeupdate",value:function(){if(this._isOpen){var P=this.player.video,I=P.videoWidth,X=P.videoHeight;!this._videoMeta.scale&&I&&X&&this._onResize(this.player.root);var Q=this.player.currentTime;Math.round(Math.abs(1e3*Q-this._ctime))<200||(this._ctime=1e3*Q,this.currentText&&this.currentText.list&&this._update(Q))}}},{key:"_onResize",value:function(P){var I=this._videoMeta;if(P&&P instanceof window.Element||(P=this.player.root),this._iId&&(clearTimeout(this._iId),this._iId=null),!I.scale){if(!this.player.video)return;var X=this.player.video,Q=X.videoWidth,se=X.videoHeight;if(!Q||!se)return;I.videoWidth=Q,I.videoHeight=se,I.scale=parseInt(se/Q*100,10)}this.__startResize(P)}},{key:"resize",value:function(P,I){var X=this,Q=this.config,se=Q.baseSizeX,de=Q.baseSizeY,me=Q.minMobileSize,Ue=Q.minSize,Pe=Q.fitVideo,Me=Q.offsetBottom,Ve=this._videoMeta.scale;this._videoMeta.lwidth=P,this._videoMeta.lheight=I;var Xe=void 0,Be=0;I/P*100>=Ve?(Be=parseInt(Ve*P,10)/100,Xe=P):(Be=I,Xe=parseInt(I/Ve*100,10)),this._videoMeta.vWidth=Xe,this._videoMeta.vHeight=Be;var Ke=0,Je=0;Ve>120?(Ke=de,Je=parseInt(Ke*Be/1080,10)):(Ke=se,Je=parseInt(Ke*Xe/1920,10));var rt=$s?me:Ue,Tt={fontSize:Je=Je<rt?rt:Je>Ke?Ke:Je},Rt=parseInt((I-Be)/2,10),sr=parseInt((P-Xe)/2,10),Aa=parseInt(Be*Me,10)/100;this._videoMeta.vBottom=Rt,this._videoMeta.vLeft=sr,this._videoMeta.marginBottom=Aa,Pe&&(Tt.bottom=Rt+Aa,Tt.left=Tt.right=sr),un(Tt).map(function(Ws){X.root.style[Ws]=Tt[Ws]+"px"}),this.emit(ju.RESIZE,{vLeft:sr,vBottom:Rt,marginBottom:Aa,vWidth:Xe,vHeight:Be,fontSize:Je,scale:Ve})}},{key:"__startResize",value:function(P){var I=this,X=P.getBoundingClientRect(),Q=this._videoMeta,se=X.width,de=X.height;if(this._iId&&(clearTimeout(this._iId),this._iId=null),se>0&&de>0&&(se!==Q.lwidth||de!==Q.lheight))this._iC=0,this.resize(se,de);else{if(this._iC>=5)return void(this._iC=0);this._iC++,this._iId=setTimeout(function(){I.__startResize(P)},50)}}},{key:"__remove",value:function(P){var I=this;if(P&&!(P.length<1)){for(var X=this.innerRoot.children,Q=[],se=0;se<X.length;se++){var de=Number(X[se].getAttribute("data-index"));P.includes(de)&&Q.push(X[se])}Q.map(function(me){I.innerRoot.removeChild(me)})}}},{key:"__render",value:function(){var P=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];I.length>0&&I.map(function(X){var Q="text-track-"+P.config.line;X.text.map(function(se,de){de>0&&(Q+=" text-track-deputy");var me={"data-start":X.start,"data-end":X.end,"data-index":X.index};P.innerRoot.appendChild(m("xg-text-track-span",se,me,Q))})})}},{key:"show",value:function(){l(this.root,"text-track-hide")}},{key:"hide",value:function(){s(this.root,"text-track-hide"),this.innerRoot.innerHTML=""}},{key:"destroy",value:function(){this.detachPlayer(),this.removeAllListeners(),this.player=null,this.textTrack=null}},{key:"marginBottom",get:function(){var P=this._videoMeta,I=P.bottom,X=P.marginBottom;return this.config.fitVideo?I+X:X}}]),L}(Iu)})},function(t,i,r){var n=r(9),u=qe(n),o=r(10),d=qe(o),g=r(108),v=qe(g),p=r(48),e=qe(p),s=r(40),l=qe(s),f=r(53),c=qe(f),y=r(56),m=qe(y),_=r(59),E=qe(_),w=r(111),k=qe(w),x=r(116),S=qe(x),B=r(122),U=qe(B),R=r(64),C=qe(R),A=r(68),b=qe(A),O=r(71),W=qe(O),K=r(74),G=qe(K),F=r(125),j=qe(F),N=r(128),$=qe(N),Z=r(129),te=qe(Z),ae=r(133),Ee=qe(ae),Te=r(139),Ae=qe(Te),De=r(142),ze=qe(De),Ce=r(145),Oe=qe(Ce),$e=r(149),D=qe($e),fe=r(153),ne=qe(fe),Y=r(157),H=qe(Y),J=r(160),ce=qe(J),he=r(162),ee=qe(he),Se=r(163),Le=qe(Se),ke=r(166),Ne=qe(ke),Ye=r(169),et=qe(Ye);function qe(Et){return Et&&Et.__esModule?Et:{default:Et}}u.default.installAll([d.default,v.default,e.default,l.default,c.default,m.default,E.default,k.default,S.default,U.default,C.default,b.default,W.default,G.default,j.default,$.default,te.default,Ee.default,Ae.default,ze.default,Oe.default,D.default,ne.default,H.default,ce.default,ee.default,Le.default,Ne.default,et.default])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(109);var u=function(){for(var d=this,g=d.root,v="",p=1;p<=12;p++)v+='<div class="xgplayer-enter-bar'+p+'"></div>';var e=(0,n.createDom)("xg-enter",`<div class="xgplayer-enter-spinner">
                                                  `+v+`
                                                </div>`,{},"xgplayer-enter");g.appendChild(e)};i.default={name:"s_enter",method:u},t.exports=i.default},function(t,i,r){var n=r(110);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-enter{display:none;position:absolute;left:0;top:0;width:100%;height:100%;background:#000;z-index:120}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner{display:block;position:absolute;left:50%;top:50%;height:100px;width:100px;position:relative;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div{width:12%;height:26%;background-color:hsla(0,0%,100%,.7);position:absolute;left:44%;top:37%;opacity:0;border-radius:30px;-webkit-animation:fade 1s linear infinite;animation:fade 1s linear infinite}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar1{-webkit-transform:rotate(0deg) translateY(-142%);-ms-transform:rotate(0deg) translateY(-142%);transform:rotate(0deg) translateY(-142%);-webkit-animation-delay:0s;animation-delay:0s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar2{-webkit-transform:rotate(30deg) translateY(-142%);-ms-transform:rotate(30deg) translateY(-142%);transform:rotate(30deg) translateY(-142%);-webkit-animation-delay:-.9163s;animation-delay:-.9163s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar3{-webkit-transform:rotate(60deg) translateY(-142%);-ms-transform:rotate(60deg) translateY(-142%);transform:rotate(60deg) translateY(-142%);-webkit-animation-delay:-.833s;animation-delay:-.833s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar4{-webkit-transform:rotate(90deg) translateY(-142%);-ms-transform:rotate(90deg) translateY(-142%);transform:rotate(90deg) translateY(-142%);-webkit-animation-delay:-.7497s;animation-delay:-.7497s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar5{-webkit-transform:rotate(120deg) translateY(-142%);-ms-transform:rotate(120deg) translateY(-142%);transform:rotate(120deg) translateY(-142%);-webkit-animation-delay:-.6664s;animation-delay:-.6664s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar6{-webkit-transform:rotate(150deg) translateY(-142%);-ms-transform:rotate(150deg) translateY(-142%);transform:rotate(150deg) translateY(-142%);-webkit-animation-delay:-.5831s;animation-delay:-.5831s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar7{-webkit-transform:rotate(180deg) translateY(-142%);-ms-transform:rotate(180deg) translateY(-142%);transform:rotate(180deg) translateY(-142%);-webkit-animation-delay:-.4998s;animation-delay:-.4998s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar8{-webkit-transform:rotate(210deg) translateY(-142%);-ms-transform:rotate(210deg) translateY(-142%);transform:rotate(210deg) translateY(-142%);-webkit-animation-delay:-.4165s;animation-delay:-.4165s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar9{-webkit-transform:rotate(240deg) translateY(-142%);-ms-transform:rotate(240deg) translateY(-142%);transform:rotate(240deg) translateY(-142%);-webkit-animation-delay:-.3332s;animation-delay:-.3332s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar10{-webkit-transform:rotate(270deg) translateY(-142%);-ms-transform:rotate(270deg) translateY(-142%);transform:rotate(270deg) translateY(-142%);-webkit-animation-delay:-.2499s;animation-delay:-.2499s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar11{-webkit-transform:rotate(300deg) translateY(-142%);-ms-transform:rotate(300deg) translateY(-142%);transform:rotate(300deg) translateY(-142%);-webkit-animation-delay:-.1666s;animation-delay:-.1666s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar12{-webkit-transform:rotate(330deg) translateY(-142%);-ms-transform:rotate(330deg) translateY(-142%);transform:rotate(330deg) translateY(-142%);-webkit-animation-delay:-.0833s;animation-delay:-.0833s}@-webkit-keyframes fade{0%{opacity:1}to{opacity:.25}}@keyframes fade{0%{opacity:1}to{opacity:.25}}.xgplayer-skin-default.xgplayer-is-enter .xgplayer-enter{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(112),o=v(u),d=r(113),g=v(d);r(114);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this;if(!!s.config.cssFullscreen){var l=(0,n.createDom)("xg-cssfullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+o.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+g.default+`</div>
                                           </xg-icon>`,{},"xgplayer-cssfullscreen"),f={};f.requestfull=s.lang.CSSFULLSCREEN_TIPS,f.exitfull=s.lang.EXITCSSFULLSCREEN_TIPS;var c=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+f.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+f.exitfull+"</span>",{},"xgplayer-tips");l.appendChild(c),s.once("ready",function(){s.controls.appendChild(l)}),["click","touchend"].forEach(function(y){l.addEventListener(y,function(m){m.preventDefault(),m.stopPropagation(),s.userGestureTrigEvent("cssFullscreenBtnClick")})})}};i.default={name:"s_cssFullscreen",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M843.617212 67.898413 175.411567 67.898413c-61.502749 0-111.367437 49.856501-111.367437 111.367437l0 668.205645c0 61.510936 49.864688 111.367437 111.367437 111.367437L843.617212 958.838931c61.510936 0 111.367437-49.856501 111.367437-111.367437L954.984648 179.26585C954.984648 117.754914 905.12917 67.898413 843.617212 67.898413zM398.146441 736.104057c15.380292 0 27.842115 12.461823 27.842115 27.842115 0 15.379269-12.461823 27.841092-27.842115 27.841092L259.725858 791.787264c-7.785314 0-14.781658-3.217275-19.838837-8.365528-5.383614-4.577249-8.791224-11.228739-8.791224-19.475564L231.095797 624.736621c0-15.371082 12.471033-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115l-0.61603 71.426773 133.036969-133.037992 39.378869 39.378869L324.962651 736.113267 398.146441 736.104057zM419.199942 463.611943 286.162974 330.565764l0.61603 71.435982c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.371082 0-27.842115-12.461823-27.842115-27.842115L231.094774 262.791172c0-8.256034 3.40761-14.908548 8.791224-19.476587 5.057179-5.148253 12.053524-8.374738 19.838837-8.374738l138.420583 0.00921c15.380292 0 27.842115 12.461823 27.842115 27.842115s-12.461823 27.842115-27.842115 27.842115l-73.175603-0.00921 133.607974 133.607974L419.199942 463.611943zM787.932981 763.946172c0 8.247848-3.40761 14.899338-8.791224 19.475564-5.057179 5.148253-12.053524 8.365528-19.839861 8.365528L620.881314 791.787264c-15.379269 0-27.841092-12.461823-27.841092-27.841092 0-15.380292 12.461823-27.842115 27.841092-27.842115l73.185836 0.00921L560.449967 602.50427l39.378869-39.378869L732.875015 696.163393l-0.62524-71.426773c0-15.371082 12.462846-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115L787.934005 763.946172zM787.932981 402.000724c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.379269 0-27.842115-12.461823-27.842115-27.842115l0.62524-71.435982L599.828836 463.611943l-39.378869-39.378869 133.617184-133.607974-73.185836 0.00921c-15.379269 0-27.841092-12.461823-27.841092-27.842115s12.461823-27.842115 27.841092-27.842115l138.421606-0.00921c7.785314 0 14.781658 3.226484 19.839861 8.374738 5.383614 4.568039 8.791224 11.219529 8.791224 19.476587L787.934005 402.000724z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M834.56 81.92H189.44c-59.392 0-107.52 48.128-107.52 107.52v645.12c0 59.392 48.128 107.52 107.52 107.52h645.12c59.392 0 107.52-48.128 107.52-107.52V189.44c0-59.392-48.128-107.52-107.52-107.52zM458.24 727.04c0 14.848-12.288 26.624-26.624 26.624S404.48 741.888 404.48 727.04v-69.632L289.28 773.12c-10.752 10.24-27.648 10.24-37.888 0-10.24-10.752-10.24-27.648 0-37.888L366.592 619.52H296.96c-14.848 0-26.624-12.288-26.624-26.624s12.288-26.624 26.624-26.624h134.144c14.848 0 26.624 12.288 26.624 26.624V727.04z m0-295.936c0 14.848-12.288 26.624-26.624 26.624H296.96c-14.848 0-26.624-12.288-26.624-26.624S282.112 404.48 296.96 404.48h69.632L251.392 289.28c-10.24-10.752-10.24-27.648 0-37.888 5.12-5.12 12.288-7.68 18.944-7.68 6.656 0 13.824 2.56 18.944 7.68L404.48 366.592V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v134.144zM773.12 773.12c-10.752 10.24-27.648 10.24-37.888 0L619.52 657.408V727.04c0 14.848-12.288 26.624-26.624 26.624s-26.624-11.776-26.624-26.624v-134.144c0-14.848 12.288-26.624 26.624-26.624H727.04c14.848 0 26.624 12.288 26.624 26.624s-12.288 26.624-26.624 26.624h-69.632l115.2 115.2c10.752 10.752 10.752 27.648 0.512 38.4z m0-483.84L657.408 404.48H727.04c14.848 0 26.624 12.288 26.624 26.624 0 14.848-12.288 26.624-26.624 26.624h-134.144c-14.848 0-26.624-12.288-26.624-26.624V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v69.632L734.72 250.88c5.12-5.12 12.288-7.68 18.944-7.68s13.824 2.56 18.944 7.68c10.752 10.752 10.752 27.648 0.512 38.4z"></path>
</svg>
`},function(t,i,r){var n=r(115);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-cssfullscreen,.xgplayer-skin-default .xgplayer-cssfullscreen-img{position:relative;-webkit-order:12;-moz-box-ordinal-group:13;order:12;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon{width:32px;margin-top:5px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-40px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover,.xgplayer-skin-default .xgplayer-cssfullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-47px}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen-img{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen{position:fixed!important;left:0!important;top:0!important;width:100%!important;height:100%!important;z-index:99999!important}.xgplayer-lang-is-en .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en .xgplayer-cssfullscreen .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-46px}.lang-is-jp .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-120px}.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-60px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(117),o=e(u),d=r(118),g=e(d),v=r(119),p=e(v);r(120);function e(l){return l&&l.__esModule?l:{default:l}}var s=function(){var f=this,c=(0,n.createDom)("xg-volume",`<xg-icon class="xgplayer-icon">
                                         <div class="xgplayer-icon-large">`+p.default+`</div>
                                         <div class="xgplayer-icon-small">`+g.default+`</div>
                                         <div class="xgplayer-icon-muted">`+o.default+`</div>
                                       </xg-icon>
                                       <xg-slider class="xgplayer-slider" tabindex="2">
                                         <xg-bar class="xgplayer-bar">
                                           <xg-drag class="xgplayer-drag"></xg-drag>
                                         </xg-bar>
                                       </xg-slider>`,{},"xgplayer-volume");f.once("ready",function(){f.controls&&f.controls.appendChild(c)});var y=c.querySelector(".xgplayer-slider"),m=c.querySelector(".xgplayer-bar"),_=c.querySelector(".xgplayer-drag"),E=c.querySelector(".xgplayer-icon");_.style.height=f.config.volume*100+"%",y.volume=f.config.volume,m.addEventListener("mousedown",function(w){w.preventDefault(),w.stopPropagation(),f.userGestureTrigEvent("volumeBarClick",w)}),["click","touchend"].forEach(function(w){E.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation(),f.userGestureTrigEvent("volumeIconClick")})}),E.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),f.userGestureTrigEvent("volumeIconEnter")}),["blur","mouseleave"].forEach(function(w){c.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation(),f.userGestureTrigEvent("volumeIconLeave")})})};i.default={name:"s_volume",method:s},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(t,i,r){var n=r(121);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,'.xgplayer-skin-default .xgplayer-volume{outline:none;-webkit-order:4;-moz-box-ordinal-group:5;order:4;width:40px;height:40px;display:block;position:relative;z-index:18}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon{margin-top:8px;cursor:pointer;position:absolute;bottom:-9px}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:none}.xgplayer-skin-default .xgplayer-slider{display:none;position:absolute;width:28px;height:92px;background:rgba(0,0,0,.54);border-radius:1px;bottom:42px;outline:none}.xgplayer-skin-default .xgplayer-slider:after{content:" ";display:block;height:15px;width:28px;position:absolute;bottom:-15px;left:0;z-index:20}.xgplayer-skin-default .xgplayer-bar,.xgplayer-skin-default .xgplayer-drag{display:block;position:absolute;bottom:6px;left:12px;background:hsla(0,0%,100%,.3);border-radius:100px;width:4px;height:76px;outline:none;cursor:pointer}.xgplayer-skin-default .xgplayer-drag{bottom:0;left:0;background:#fa1f41;max-height:76px}.xgplayer-skin-default .xgplayer-drag:after{content:" ";display:inline-block;width:8px;height:8px;background:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.26);position:absolute;border-radius:50%;left:-2px;top:-6px}.xgplayer-skin-default.xgplayer-volume-active .xgplayer-slider,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:none}.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:block}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-large,.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:none}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:block}.xgplayer-skin-default.xgplayer-mobile .xgplayer-volume .xgplayer-slider{display:none}',""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=d(u);r(123);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=void 0,l=(0,n.createDom)("xg-definition","",{tabindex:3},"xgplayer-definition");o.default.device==="mobile"&&(p.config.definitionActive="click");function f(){var w=p.definitionList,k=["<ul>"],x=p.config.url,S=document.createElement("a");p.switchURL?["mp4","hls","__flv__","dash"].every(function(A){return p[A]?(p[A].url&&(S.href=p[A].url),A==="__flv__"&&(p[A]._options?S.href=p[A]._options.url:S.href=p[A]._mediaDataSource.url),A==="hls"&&(S.href=p[A].originUrl||p[A].url,x=S.href),x=S.href,!1):!0}):x=p.currentSrc||p.src,w.forEach(function(A){S.href=A.url,p.dash?k.push("<li url='"+A.url+"' cname='"+A.name+"' class='"+(A.selected?"selected":"")+"'>"+A.name+"</li>"):k.push("<li url='"+A.url+"' cname='"+A.name+"' class='"+(S.href===x?"selected":"")+"'>"+A.name+"</li>")});var B=w.filter(function(A){return S.href=A.url,p.dash?A.selected===!0:S.href===x});console.warn("cursrc:",B,"src:",x,"list:",w),k.push("</ul><p class='name'>"+(B[0]||{name:""}).name+"</p>");var U=e.querySelector(".xgplayer-definition");if(U){U.innerHTML=k.join("");var R=U.querySelector(".name");(!p.config.definitionActive||p.config.definitionActive==="hover")&&R.addEventListener("mouseenter",function(A){A.preventDefault(),A.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-definition-active"),U.focus()})}else{l.innerHTML=k.join("");var C=l.querySelector(".name");(!p.config.definitionActive||p.config.definitionActive==="hover")&&C.addEventListener("mouseenter",function(A){A.preventDefault(),A.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-definition-active"),l.focus()}),p.controls.appendChild(l)}}function c(w){p.definitionList=w,w&&w instanceof Array&&w.length>0&&((0,n.addClass)(e,"xgplayer-is-definition"),p.once("canplay",f))}p.on("resourceReady",c);function y(){if(p.currentTime=p.curTime,s)p.pause();else{var w=p.play();w!==void 0&&w&&w.catch(function(k){})}}function m(){p.once("timeupdate",y)}["touchend","click"].forEach(function(w){l.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation();var x=p.definitionList,S=k.target||k.srcElement,B=document.createElement("a");if(S&&S.tagName.toLocaleLowerCase()==="li"){var U=void 0,R=void 0;if(Array.prototype.forEach.call(S.parentNode.childNodes,function(A){(0,n.hasClass)(A,"selected")&&(U=A.getAttribute("cname"),(0,n.removeClass)(A,"selected"),p.emit("beforeDefinitionChange",A.getAttribute("url")))}),p.dash&&x.forEach(function(A){A.selected=!1,A.name===S.innerHTML&&(A.selected=!0)}),(0,n.addClass)(S,"selected"),R=S.getAttribute("cname"),S.parentNode.nextSibling.innerHTML=""+S.getAttribute("cname"),B.href=S.getAttribute("url"),s=p.paused,p.switchURL){var C=document.createElement("a");["mp4","hls","__flv__","dash"].every(function(A){return p[A]?(p[A].url&&(C.href=p[A].url),A==="__flv__"&&(p[A]._options?C.href=p[A]._options.url:C.href=p[A]._mediaDataSource.url),A==="hls"&&(C.href=p[A].originUrl||p[A].url),!1):!0}),C.href!==B.href&&!p.ended&&p.switchURL(B.href)}else p.hls&&(document.createElement("a"),p.hls.url),B.href!==p.currentSrc&&(p.curTime=p.currentTime,p.ended||(p.src=B.href));navigator.userAgent.toLowerCase().indexOf("android")>-1?p.once("timeupdate",m):p.once("loadedmetadata",y),p.emit("definitionChange",{from:U,to:R}),o.default.device==="mobile"&&(0,n.removeClass)(p.root,"xgplayer-definition-active")}else p.config.definitionActive==="click"&&S&&(S.tagName.toLocaleLowerCase()==="p"||S.tagName.toLocaleLowerCase()==="em")&&(o.default.device==="mobile"?(0,n.toggleClass)(p.root,"xgplayer-definition-active"):(0,n.addClass)(p.root,"xgplayer-definition-active"),l.focus());p.emit("focus")},!1)}),l.addEventListener("mouseleave",function(w){w.preventDefault(),w.stopPropagation(),(0,n.removeClass)(e,"xgplayer-definition-active")});function _(){(0,n.removeClass)(e,"xgplayer-definition-active")}p.on("blur",_);function E(){p.off("resourceReady",c),p.off("canplay",f),navigator.userAgent.toLowerCase().indexOf("android")>-1?(p.off("timeupdate",m),p.off("timeupdate",y)):p.off("loadedmetadata",y),p.off("blur",_),p.off("destroy",E)}p.once("destroy",E),p.getCurrentDefinition=function(){for(var w=p.controls.querySelectorAll(".xgplayer-definition ul li"),k=0;k<w.length;k++)if(w[k].className&&w[k].className.indexOf("selected")>-1)return{name:w[k].getAttribute("cname"),url:w[k].getAttribute("url")};return{name:w[0].getAttribute("cname"),url:w[0].getAttribute("url")}},p.switchDefinition=function(){for(var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=p.controls.querySelectorAll(".xgplayer-definition ul li"),x=0;x<k.length;x++)(k[x].getAttribute("cname")===w.name||k[x].getAttribute("url")===w.url||x===w.index)&&k[x].click()}};i.default={name:"s_definition",method:g},t.exports=i.default},function(t,i,r){var n=r(124);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-definition{-webkit-order:5;-moz-box-ordinal-group:6;order:5;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-left:10px;margin-top:-119px}.xgplayer-skin-default .xgplayer-definition ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:0;text-align:center;white-space:nowrap;margin-left:-10px;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-definition ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);padding:6px 13px}.xgplayer-skin-default .xgplayer-definition ul li.selected,.xgplayer-skin-default .xgplayer-definition ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-definition .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-definition ul,.xgplayer-skin-default.xgplayer-is-definition .xgplayer-definition{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=d(u);r(126);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=[];if(p.config.playbackRate)e=[].concat(p.config.playbackRate),e.sort(function(x,S){return S-x});else return!1;var s=p.config.playbackRateUnit!==void 0?p.config.playbackRateUnit:"x",l=(0,n.createDom)("xg-playbackrate"," ",{},"xgplayer-playbackrate");o.default.device==="mobile"&&(p.config.playbackRateActive="click");var f=[];e.forEach(function(x){f.push({name:""+x,rate:""+x+s,selected:!1})});var c=1,y=["<ul>"];f.forEach(function(x){p.config.defaultPlaybackRate&&p.config.defaultPlaybackRate.toString()===x.name?(x.selected=!0,c=p.config.defaultPlaybackRate,p.once("playing",function(){p.video.playbackRate=p.config.defaultPlaybackRate})):(x.name==="1.0"||x.name==="1")&&(!p.config.defaultPlaybackRate||p.config.defaultPlaybackRate===1)&&(x.selected=!0),y.push("<li cname='"+x.name+"' class='"+(x.selected?"selected":"")+"'>"+x.rate+"</li>")}),y.push("</ul><p class='name'>"+c+s+"</p>");var m=p.root.querySelector(".xgplayer-playbackrate");if(m){m.innerHTML=y.join("");var _=m.querySelector(".name");(!p.config.playbackRateActive||p.config.playbackRateActive==="hover")&&_.addEventListener("mouseenter",function(x){x.preventDefault(),x.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),m.focus()})}else{l.innerHTML=y.join("");var E=l.querySelector(".name");(!p.config.playbackRateActive||p.config.playbackRateActive==="hover")&&E.addEventListener("mouseenter",function(x){x.preventDefault(),x.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),l.focus()}),p.once("ready",function(){p.controls.appendChild(l)})}var w=["touchend","click"];w.forEach(function(x){l.addEventListener(x,function(S){S.stopPropagation(),S.preventDefault();var B=S.target;if(B&&B.tagName.toLocaleLowerCase()==="li"){var U=void 0,R=void 0;f.forEach(function(C){C.selected=!1,B.textContent.replace(/\s+/g,"")===C.rate&&(Array.prototype.forEach.call(B.parentNode.childNodes,function(A){(0,n.hasClass)(A,"selected")&&(U=Number(A.getAttribute("cname")),(0,n.removeClass)(A,"selected"))}),C.selected=!0,p.video.playbackRate=C.name*1,c=C.name*1)}),(0,n.addClass)(B,"selected"),R=Number(B.getAttribute("cname")),B.parentNode.nextSibling.innerHTML=""+B.getAttribute("cname")+s,p.emit("playbackrateChange",{from:U,to:R}),o.default.device==="mobile"&&(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")}else p.config.playbackRateActive==="click"&&B&&(B.tagName.toLocaleLowerCase()==="p"||B.tagName.toLocaleLowerCase()==="span")&&(o.default.device==="mobile"?(0,n.toggleClass)(p.root,"xgplayer-playbackrate-active"):(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),l.focus());p.emit("focus")},!1)}),l.addEventListener("mouseleave",function(x){x.preventDefault(),x.stopPropagation(),(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")});function k(){(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")}p.on("blur",k),p.on("play",function(){p.video.playbackRate.toFixed(1)!==c.toFixed(1)&&(p.video.playbackRate=c)}),p.switchPlaybackRate=function(){for(var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=p.controls.querySelectorAll(".xgplayer-playbackrate ul li"),B=0;B<S.length;B++)!(0,n.hasClass)(S[B],"selected")&&(S[B].getAttribute("cname")===""+x.playbackRate||B===x.index)&&S[B].click()},p.on("ratechange",function(){p.switchPlaybackRate({playbackRate:p.playbackRate})})};i.default={name:"s_playbackRate",method:g},t.exports=i.default},function(t,i,r){var n=r(127);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-playbackrate{-webkit-order:8;-moz-box-ordinal-group:9;order:8;width:60px;height:150px;z-index:18;position:relative;display:inline-block;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-playbackrate ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);text-align:left;white-space:nowrap;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-playbackrate ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);position:relative;padding:4px 0;text-align:center}.xgplayer-skin-default .xgplayer-playbackrate ul li.selected,.xgplayer-skin-default .xgplayer-playbackrate ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-playbackrate ul li:first-child{position:relative;margin-top:12px}.xgplayer-skin-default .xgplayer-playbackrate ul li:last-child{position:relative;margin-bottom:12px}.xgplayer-skin-default .xgplayer-playbackrate .name{width:60px;height:20px;position:absolute;bottom:0;text-align:center;font-family:PingFangSC-Regular;font-size:13px;background:rgba(0,0,0,.38);color:hsla(0,0%,100%,.8);border-radius:10px;line-height:20px}.xgplayer-skin-default .xgplayer-playbackrate span{position:relative;top:19px;font-weight:700;text-shadow:0 0 4px rgba(0,0,0,.6)}.xgplayer-skin-default .xgplayer-playbackrate:hover{opacity:1}.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-playbackrate ul{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var d=this;if(d.config.preview&&d.config.preview.uploadEl){var g=(0,n.createDom)("xg-preview",'<input type="file">',{},"xgplayer-preview"),v=g.querySelector("input");d.config.preview.uploadEl.appendChild(g),v.onchange=function(){d.emit("upload",v)}}};i.default={name:"s_localPreview",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(130),o=d(u);r(131);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.download){var e=(0,n.createDom)("xg-download",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-download"),s=p.lang.DOWNLOAD_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-download">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(c){c.preventDefault(),c.stopPropagation(),p.userGestureTrigEvent("downloadBtnClick")})})}};i.default={name:"s_download",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`},function(t,i,r){var n=r(132);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-download{position:relative;-webkit-order:9;-moz-box-ordinal-group:10;order:9;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-download .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-download .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-download .xgplayer-icon svg{position:relative;top:5px;left:5px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips{margin-left:-20px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips .xgplayer-tip-download{display:block}.xgplayer-skin-default .xgplayer-download:hover{opacity:.85}.xgplayer-skin-default .xgplayer-download:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-download .xgplayer-tips{margin-left:-32px}.xgplayer-lang-is-jp .xgplayer-download .xgplayer-tips{margin-left:-40px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(134),o=v(u),d=r(136),g=v(d);r(137);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.root;if(!!s.config.danmu){var f=(0,n.createDom)("xg-danmu","",{},"xgplayer-danmu");s.once("ready",function(){l.appendChild(f)});var c=(0,n.deepCopy)({container:f,player:s.video,comments:[],area:{start:0,end:1}},s.config.danmu),y=void 0;s.config.danmu.panel&&(y=(0,n.createDom)("xg-panel",`<xg-panel-icon class="xgplayer-panel-icon">
                                                `+g.default+`
                                              </xg-panel-icon>
                                              <xg-panel-slider class="xgplayer-panel-slider">
                                                <xg-hidemode class="xgplayer-hidemode">
                                                  <p class="xgplayer-hidemode-font">\u5C4F\u853D\u7C7B\u578B</p>
                                                  <ul class="xgplayer-hidemode-radio">
                                                    <li class="xgplayer-hidemode-scroll" id="false">\u6EDA\u52A8</li><li class="xgplayer-hidemode-top" id="false">\u9876\u90E8</li><li class="xgplayer-hidemode-bottom" id="false">\u5E95\u90E8</li><li class="xgplayer-hidemode-color" id="false">\u8272\u5F69</li>
                                                  </ul>
                                                </xg-hidemode>
                                                <xg-transparency class="xgplayer-transparency">
                                                  <span>\u4E0D\u900F\u660E\u5EA6</span>
                                                  <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>
                                                </xg-transparency>
                                                <xg-showarea class="xgplayer-showarea">
                                                  <div class="xgplayer-showarea-name">\u663E\u793A\u533A\u57DF</div>
                                                  <div class="xgplayer-showarea-control">
                                                    <div class="xgplayer-showarea-control-up">
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>
                                                    </div>
                                                    <div class="xgplayer-showarea-control-down">
                                                      <div class="xgplayer-showarea-control-down-dots">
                                                        <span class="xgplayer-showarea-onequarters-dot"></span>
                                                        <span class="xgplayer-showarea-twoquarters-dot"></span>
                                                        <span class="xgplayer-showarea-threequarters-dot"></span>
                                                        <span class="xgplayer-showarea-full-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">
                                                    </div>
                                                  </div>
                                                </xg-showarea>
                                                <xg-danmuspeed class="xgplayer-danmuspeed">
                                                  <div class="xgplayer-danmuspeed-name">\u5F39\u5E55\u901F\u5EA6</div>
                                                  <div class="xgplayer-danmuspeed-control">
                                                    <div class="xgplayer-danmuspeed-control-up">
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small">\u6162</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color">\u4E2D</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large">\u5FEB</span>
                                                    </div>
                                                    <div class="xgplayer-danmuspeed-control-down">
                                                      <div class="xgplayer-danmuspeed-control-down-dots">
                                                        <span class="xgplayer-danmuspeed-small-dot"></span>
                                                        <span class="xgplayer-danmuspeed-middle-dot"></span>
                                                        <span class="xgplayer-danmuspeed-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">
                                                    </div>
                                                  </div>
                                                </xg-danmuspeed>
                                                <xg-danmufont class="xgplayer-danmufont">
                                                  <div class="xgplayer-danmufont-name">\u5B57\u4F53\u5927\u5C0F</div>
                                                  <div class="xgplayer-danmufont-control">
                                                    <div class="xgplayer-danmufont-control-up">
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small">\u5C0F</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle">\u4E2D</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color">\u5927</span>
                                                    </div>
                                                    <div class="xgplayer-danmufont-control-down">
                                                      <div class="xgplayer-danmufont-control-down-dots">
                                                        <span class="xgplayer-danmufont-small-dot"></span>
                                                        <span class="xgplayer-danmufont-middle-dot"></span>
                                                        <span class="xgplayer-danmufont-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">
                                                    </div>
                                                  </div>
                                                </xg-danmufont>
                                              </xg-panel-slider>`,{tabindex:7},"xgplayer-panel"),s.once("ready",function(){s.controls.appendChild(y)})),s.once("complete",function(){var m=new o.default(c);if(s.emit("initDefaultDanmu",m),s.danmu=m,!!s.config.danmu.panel){var _=y.querySelector(".xgplayer-panel-slider"),E=void 0,w=["mouseenter","touchend","click"];w.forEach(function(N){y.addEventListener(N,function($){$.preventDefault(),$.stopPropagation(),(0,n.addClass)(_,"xgplayer-panel-active"),y.focus(),E=!0})}),y.addEventListener("mouseleave",function(N){N.preventDefault(),N.stopPropagation(),(0,n.removeClass)(_,"xgplayer-panel-active"),E=!1}),_.addEventListener("mouseleave",function(N){N.preventDefault(),N.stopPropagation(),E===!1&&(0,n.removeClass)(_,"xgplayer-panel-active")});var k=s.config.danmu,x=y.querySelector(".xgplayer-hidemode-scroll"),S=y.querySelector(".xgplayer-hidemode-top"),B=y.querySelector(".xgplayer-hidemode-bottom"),U=y.querySelector(".xgplayer-hidemode-color"),R={scroll:x,top:S,bottom:B,color:U},C=function($){var Z=$,te=["touchend","click"];te.forEach(function(ae){R[Z].addEventListener(ae,function(Ee){R[Z].getAttribute("id")!=="true"?(R[Z].style.color="#f85959",R[Z].setAttribute("id","true"),s.danmu.hide(Z)):(R[Z].style.color="#aaa",R[Z].setAttribute("id","false"),s.danmu.show(Z))})})};for(var A in R)C(A);var b=y.querySelector(".xgplayer-transparency-line"),O=y.querySelector(".xgplayer-transparency-gradient"),W=50;O.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+W+"%, #aaa "+W+"%, #aaa)",b.addEventListener("input",function(N){N.preventDefault(),N.stopPropagation(),W=N.target.value,O.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+W+"%, #aaa "+W+"%, #aaa)",k.comments.forEach(function($){$.style.opacity=W/100})});var K=y.querySelector(".xgplayer-showarea-line");K.addEventListener("input",function(N){N.preventDefault(),N.stopPropagation();var $=N.target.value;s.danmu.config.area.end=$/100,s.config.danmu.area.end=$/100,s.danmu.bulletBtn.main.channel.resize()});var G=y.querySelector(".xgplayer-danmuspeed-line");G.addEventListener("input",function(N){N.preventDefault(),N.stopPropagation();var $=N.target.value;k.comments.forEach(function(Z){Z.duration=(200-$)*100})});var F=y.querySelector(".xgplayer-danmufont-line");if(F.addEventListener("input",function(N){N.preventDefault(),N.stopPropagation();var $=N.target.value;k.comments.forEach(function(Z){Z.style.fontSize=$+"px"})}),navigator.userAgent.indexOf("Firefox")>-1)for(var j=0;j<_.querySelectorAll("input").length;j++)_.querySelectorAll("input")[j].style.marginTop="10px"}})}};i.default={name:"s_danmu",method:p},t.exports=i.default},function(t,i,r){(function(n){var u,o,d,g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v};/*! Built @Mon, 17 Oct 2022 06:40:43 GMT */(function(v,p){g(i)=="object"&&g(n)=="object"?n.exports=p():(o=[],u=p,d=typeof u=="function"?u.apply(i,o):u,d!==void 0&&(n.exports=d))})(window,function(){return function(v){var p={};function e(s){if(p[s])return p[s].exports;var l=p[s]={i:s,l:!1,exports:{}};return v[s].call(l.exports,l,l.exports,e),l.l=!0,l.exports}return e.m=v,e.c=p,e.d=function(s,l,f){e.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:f})},e.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},e.t=function(s,l){if(1&l&&(s=e(s)),8&l||4&l&&(typeof s=="undefined"?"undefined":g(s))=="object"&&s&&s.__esModule)return s;var f=Object.create(null);if(e.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:s}),2&l&&typeof s!="string")for(var c in s)e.d(f,c,function(y){return s[y]}.bind(null,c));return f},e.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return e.d(l,"a",l),l},e.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},e.p="",e(e.s=4)}([function(v,p,e){function s(y,m){return y.classList?Array.prototype.some.call(y.classList,function(_){return _===m}):!!y.className.match(new RegExp("(\\s|^)"+m+"(\\s|$)"))}function l(y,m){y.classList?m.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(_){_&&y.classList.add(_)}):s(y,m)||(y.className+=" "+m)}function f(y,m){y.classList?m.split(/\s+/g).forEach(function(_){y.classList.remove(_)}):s(y,m)&&m.split(/\s+/g).forEach(function(_){var E=new RegExp("(\\s|^)"+_+"(\\s|$)");y.className=y.className.replace(E," ")})}function c(y){return Object.prototype.toString.call(y).match(/([^\s.*]+)(?=]$)/g)[0]}Object.defineProperty(p,"__esModule",{value:!0}),p.createDom=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",w=document.createElement(y);return w.className=E,w.innerHTML=m,Object.keys(_).forEach(function(k){var x=k,S=_[k];y==="video"||y==="audio"?S&&w.setAttribute(x,S):w.setAttribute(x,S)}),w},p.hasClass=s,p.addClass=l,p.removeClass=f,p.toggleClass=function(y,m){m.split(/\s+/g).forEach(function(_){s(y,_)?f(y,_):l(y,_)})},p.findDom=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,m=arguments[1],_=void 0;try{_=y.querySelector(m)}catch(E){m.startsWith("#")&&(_=y.getElementById(m.slice(1)))}return _},p.deepCopy=function y(m,_){if(c(_)==="Object"&&c(m)==="Object")return Object.keys(_).forEach(function(E){c(_[E])!=="Object"||_[E]instanceof Node?c(_[E])==="Array"?m[E]=c(m[E])==="Array"?m[E].concat(_[E]):_[E]:m[E]=_[E]:m[E]?y(m[E],_[E]):m[E]=_[E]}),m},p.typeOf=c,p.copyDom=function(y){if(y&&y.nodeType===1){var m=document.createElement(y.tagName);return Array.prototype.forEach.call(y.attributes,function(_){m.setAttribute(_.name,_.value)}),y.innerHTML&&(m.innerHTML=y.innerHTML),m}return""},p.attachEventListener=function(y,m,_,E){E?(y.on(m,_),function(w,k,x,S){w.once(S,function B(){w.off(k,x),w.off(S,B)})}(y,m,_,E)):y.on(m,function w(k){_(k),y.off(m,w)})},p.styleUtil=function(y,m,_){var E=y.style;try{E[m]=_}catch(w){E.setProperty(m,_)}},p.isNumber=function(y){return typeof y=="number"&&!Number.isNaN(y)},p.throttle=function(y,m){var _=this,E=0;return function(){for(var w=arguments.length,k=Array(w),x=0;x<w;x++)k[x]=arguments[x];clearTimeout(E),E=setTimeout(function(){return y.apply(_,k)},m)}},p.hasOwnProperty=Object.prototype.hasOwnProperty},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=function(){function m(_,E){for(var w=0;w<E.length;w++){var k=E[w];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(_,k.key,k)}}return function(_,E,w){return E&&m(_.prototype,E),w&&m(_,w),_}}(),f=e(26),c=(s=f)&&s.__esModule?s:{default:s},y=function(){function m(){(function(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")})(this,m)}return l(m,[{key:"setLogger",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.logger=new c.default(E+".js")}}]),m}();p.default=y,v.exports=p.default},function(v,p,e){var s=e(18)();v.exports=function(l){return l!==s&&l!==null}},function(v,p,e){v.exports=function(s){return s!=null}},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=e(5),f=(s=l)&&s.__esModule?s:{default:s};e(34),p.default=f.default,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.DanmuJs=void 0;var s=function(){function S(B,U){for(var R=0;R<U.length;R++){var C=U[R];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(B,C.key,C)}}return function(B,U,R){return U&&S(B.prototype,U),R&&S(B,R),B}}(),l=w(e(6)),f=e(25),c=w(e(1)),y=w(e(27)),m=w(e(32)),_=e(33),E=e(0);function w(S){return S&&S.__esModule?S:{default:S}}function k(S,B){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!B||(typeof B=="undefined"?"undefined":g(B))!="object"&&typeof B!="function"?S:B}var x=p.DanmuJs=function(S){function B(U){(function(O,W){if(!(O instanceof W))throw new TypeError("Cannot call a class as a function")})(this,B);var R=k(this,(B.__proto__||Object.getPrototypeOf(B)).call(this)),C=R;C.setLogger("danmu"),C.logger&&C.logger.info("danmu.js version: "+f.version);var A=C.config={overlap:!1,area:{start:0,end:1,lines:void 0},live:!1,comments:[],direction:"r2l",needResizeObserver:!1,dropStaleComments:!1,channelSize:void 0,maxCommentsLength:void 0,bulletOffset:void 0,interval:2e3};if((0,E.deepCopy)(A,U),(0,l.default)(C),C.hideArr=[],C.domObj=new m.default,C.freezeId=null,A.comments.forEach(function(O){O.duration=O.duration?O.duration:5e3,O.mode||(O.mode="scroll")}),C.container=A.container&&A.container.nodeType===1?A.container:null,!C.container)return C.emit("error","container id can't be empty"),k(R,!1);if(A.containerStyle){var b=A.containerStyle;Object.keys(b).forEach(function(O){C.container.style[O]=b[O]})}return C.live=A.live,C.player=A.player,C.direction=A.direction,(0,E.addClass)(C.container,"danmu"),C.bulletBtn=new y.default(C),C.main=C.bulletBtn.main,C.isReady=!0,C.emit("ready"),R.logger&&R.logger.info("ready"),R.addResizeObserver(),R}return function(U,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof R=="undefined"?"undefined":g(R)));U.prototype=Object.create(R&&R.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(U,R):U.__proto__=R)}(B,S),s(B,[{key:"addResizeObserver",value:function(){var R=this;this.config.needResizeObserver&&(0,_.addObserver)(this.container,function(){R.logger&&R.logger.info("needResizeObserver"),R.resize()})}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.main.clear()}},{key:"destroy",value:function(){for(var R in(0,_.unObserver)(this.container),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn.destroy(),this.domObj.destroy(),this)delete this[R];this.emit("destroy")}},{key:"sendComment",value:function(R){this.logger&&this.logger.info("sendComment: "+(R.txt||"[DOM Element]")),R.duration||(R.duration=15e3),R&&R.id&&R.duration&&(R.el||R.txt)&&(R.duration=R.duration?R.duration:5e3,R.style||(R.style={opacity:void 0,fontSize:void 0}),R.style&&(this.opacity&&this.opacity!==R.style.opacity&&(R.style.opacity=this.opacity),this.fontSize&&this.fontSize!==R.style.fontSize&&(R.style.fontSize=this.fontSize)),R.prior||R.realTime?(this.main.data.unshift(R),R.realTime&&(this.main.readData(),this.main.dataHandle())):this.main.data.push(R))}},{key:"setCommentID",value:function(R,C){var A=this;this.logger&&this.logger.info("setCommentID: oldID "+R+" newID "+C),R&&C&&(this.main.data.some(function(b){return b.id===R&&(b.id=C,!0)}),this.main.queue.some(function(b){return b.id===R&&(b.id=C,b.pauseMove(),A.main.status!=="paused"&&b.startMove(),!0)}))}},{key:"setCommentDuration",value:function(R,C){var A=this;this.logger&&this.logger.info("setCommentDuration: id "+R+" duration "+C),R&&C&&(C=C||5e3,this.main.data.some(function(b){return b.id===R&&(b.duration=C,!0)}),this.main.queue.some(function(b){return b.id===R&&(b.duration=C,b.pauseMove(),A.main.status!=="paused"&&b.startMove(),!0)}))}},{key:"setCommentLike",value:function(R,C){this.logger&&this.logger.info("setCommentLike: id "+R+" like "+C),R&&C&&(this.main.data.some(function(A){return A.id===R&&(A.like=C,!0)}),this.main.queue.some(function(A){return A.id===R&&(A.pauseMove(),A.setLikeDom(C.el,C.style),A.danmu.main.status!=="paused"&&A.startMove(),!0)}))}},{key:"restartComment",value:function(R){if(this.logger&&this.logger.info("restartComment: id "+R),R){var C=this.main;if(this._releaseCtrl(R),C.status==="closed")return;C.queue.some(function(A){return A.id===R&&(C.status!=="paused"?A.startMove(!0):A.status="paused",!0)})}}},{key:"_releaseCtrl",value:function(R){this.freezeId&&R===this.freezeId&&(this.mouseControl=!1,this.freezeId=null)}},{key:"_freezeCtrl",value:function(R){this.mouseControl=!0,this.freezeId=R}},{key:"freezeComment",value:function(R){this.logger&&this.logger.info("freezeComment: id "+R),R&&(this._freezeCtrl(R),this.main.queue.some(function(C){return C.id===R&&(C.status="forcedPause",C.pauseMove(),C.el&&C.el.style&&(0,E.styleUtil)(C.el,"zIndex",10),!0)}))}},{key:"removeComment",value:function(R){this.logger&&this.logger.info("removeComment: id "+R),R&&(this._releaseCtrl(R),this.main.queue.some(function(C){return C.id===R&&(C.remove(),!0)}),this.main.data=this.main.data.filter(function(C){return C.id!==R}))}},{key:"updateComments",value:function(R){var C=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],A=this.config,b=this.main,O=this.player,W=[],K=0;if(this.logger&&this.logger.info("updateComments: "+R.length+", isClear "+C),typeof C=="boolean"&&C&&(b.data=[]),b.data=b.data.concat(R),b.sortData(),typeof A.maxCommentsLength=="number"&&b.data.length>A.maxCommentsLength){K=b.data.length-A.maxCommentsLength;for(var G,F=0;F<K;F++)(G=b.data[F]).prior&&!G.attached_&&W.push(b.data[F])}else if(A.dropStaleComments&&O&&O.currentTime){var j=Math.floor(1e3*O.currentTime),N=j-A.interval;if(N>0){for(var $,Z=0;Z<b.data.length;Z++)if(($=b.data[Z]).prior&&!$.attached_&&W.push(b.data[Z]),$.start>N){K=Z;break}}K>0&&(b.data.splice(0,K),b.data=W.concat(b.data))}}},{key:"willChange",value:function(){var R=this.container,C=this.main;R.style.willChange="opacity",C.willChanges.push("contents"),C.queue.forEach(function(A){A.willChange()})}},{key:"stopWillChange",value:function(){this.container.style.willChange="",this.main.willChanges.splice(0),this.main.queue.forEach(function(R){R.willChange()})}},{key:"setAllDuration",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",C=this,A=arguments[1],b=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];this.logger&&this.logger.info("setAllDuration: mode "+R+" duration "+A+" force "+b),A&&(A=A||5e3,b&&(this.main.forceDuration=A),this.main.data.forEach(function(O){R===O.mode&&(O.duration=A)}),this.main.queue.forEach(function(O){R===O.mode&&(O.duration=A,O.pauseMove(),C.main.status!=="paused"&&O.startMove())}))}},{key:"setPlayRate",value:function(){var R=this,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",A=arguments[1];this.logger&&this.logger.info("setPlayRate: "+A),(0,E.isNumber)(A)&&A>0&&(this.main.playRate=A,this.main.queue.forEach(function(b){C===b.mode&&(b.pauseMove(),R.main.status!=="paused"&&b.startMove())}))}},{key:"setOpacity",value:function(R){this.logger&&this.logger.info("setOpacity: opacity "+R),this.container.style.opacity=R}},{key:"setFontSize",value:function(R,C){var A=this,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{reflow:!0};this.logger&&this.logger.info("setFontSize: size "+R+" channelSize "+C),this.fontSize=R+"px",R&&(this.main.data.forEach(function(O){O.style&&(O.style.fontSize=A.fontSize)}),this.main.queue.forEach(function(O){O.options.style||(O.options.style={}),O.options.style.fontSize=A.fontSize,O.setFontSize(A.fontSize),C&&(O.top=O.channel_id[0]*C,O.topInit())})),C&&(this.config.channelSize=C,b.reflow&&this.main.channel.resizeSync())}},{key:"setArea",value:function(R){this.logger&&this.logger.info("setArea: area "+R),this.config.area=R,R.reflow!==!1&&this.main.channel.resizeSync()}},{key:"hide",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode "+R),this.hideArr.indexOf(R)<0&&this.hideArr.push(R);var C=this.main.queue.filter(function(A){return R===A.mode||R==="color"&&A.color});C.forEach(function(A){return A.remove()})}},{key:"show",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode "+R);var C=this.hideArr.indexOf(R);C>-1&&this.hideArr.splice(C,1)}},{key:"setDirection",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction "+R),this.emit("changeDirection",R)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}},{key:"status",get:function(){return this.main.status}},{key:"state",get:function(){var R=this.main;return{status:R.status,comments:R.data,bullets:R.queue}}},{key:"containerPos",get:function(){return this.main.channel.containerPos}}]),B}(c.default);p.default=x},function(v,p,e){var s,l,f,c,y,m,_,E=e(7),w=e(24),k=Function.prototype.apply,x=Function.prototype.call,S=Object.create,B=Object.defineProperty,U=Object.defineProperties,R=Object.prototype.hasOwnProperty,C={configurable:!0,enumerable:!1,writable:!0};l=function(b,O){var W,K;return w(O),K=this,s.call(this,b,W=function(){f.call(K,b,W),k.call(O,this,arguments)}),W.__eeOnceListener__=O,this},y={on:s=function(b,O){var W;return w(O),R.call(this,"__ee__")?W=this.__ee__:(W=C.value=S(null),B(this,"__ee__",C),C.value=null),W[b]?g(W[b])=="object"?W[b].push(O):W[b]=[W[b],O]:W[b]=O,this},once:l,off:f=function(b,O){var W,K,G,F;if(w(O),!R.call(this,"__ee__"))return this;if(!(W=this.__ee__)[b])return this;if(g(K=W[b])=="object")for(F=0;G=K[F];++F)G!==O&&G.__eeOnceListener__!==O||(K.length===2?W[b]=K[F?0:1]:K.splice(F,1));else K!==O&&K.__eeOnceListener__!==O||delete W[b];return this},emit:c=function(b){var O,W,K,G,F;if(R.call(this,"__ee__")&&(G=this.__ee__[b]))if((typeof G=="undefined"?"undefined":g(G))=="object"){for(W=arguments.length,F=new Array(W-1),O=1;O<W;++O)F[O-1]=arguments[O];for(G=G.slice(),O=0;K=G[O];++O)k.call(K,this,F)}else switch(arguments.length){case 1:x.call(G,this);break;case 2:x.call(G,this,arguments[1]);break;case 3:x.call(G,this,arguments[1],arguments[2]);break;default:for(W=arguments.length,F=new Array(W-1),O=1;O<W;++O)F[O-1]=arguments[O];k.call(G,this,F)}}},m={on:E(s),once:E(l),off:E(f),emit:E(c)},_=U({},m),v.exports=p=function(b){return b==null?S(_):U(Object(b),m)},p.methods=y},function(v,p,e){var s=e(3),l=e(8),f=e(12),c=e(20),y=e(21);(v.exports=function(m,_){var E,w,k,x,S;return arguments.length<2||typeof m!="string"?(x=_,_=m,m=null):x=arguments[2],s(m)?(E=y.call(m,"c"),w=y.call(m,"e"),k=y.call(m,"w")):(E=k=!0,w=!1),S={value:_,configurable:E,enumerable:w,writable:k},x?f(c(x),S):S}).gs=function(m,_,E){var w,k,x,S;return typeof m!="string"?(x=E,E=_,_=m,m=null):x=arguments[3],s(_)?l(_)?s(E)?l(E)||(x=E,E=void 0):E=void 0:(x=_,_=E=void 0):_=void 0,s(m)?(w=y.call(m,"c"),k=y.call(m,"e")):(w=!0,k=!1),S={get:_,set:E,configurable:w,enumerable:k},x?f(c(x),S):S}},function(v,p,e){var s=e(9),l=/^\s*class[\s{/}]/,f=Function.prototype.toString;v.exports=function(c){return!!s(c)&&!l.test(f.call(c))}},function(v,p,e){var s=e(10);v.exports=function(l){if(typeof l!="function"||!hasOwnProperty.call(l,"length"))return!1;try{if(typeof l.length!="number"||typeof l.call!="function"||typeof l.apply!="function")return!1}catch(f){return!1}return!s(l)}},function(v,p,e){var s=e(11);v.exports=function(l){if(!s(l))return!1;try{return!!l.constructor&&l.constructor.prototype===l}catch(f){return!1}}},function(v,p,e){var s=e(3),l={object:!0,function:!0,undefined:!0};v.exports=function(f){return!!s(f)&&hasOwnProperty.call(l,typeof f=="undefined"?"undefined":g(f))}},function(v,p,e){v.exports=e(13)()?Object.assign:e(14)},function(v,p,e){v.exports=function(){var s,l=Object.assign;return typeof l=="function"&&(l(s={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),s.foo+s.bar+s.trzy==="razdwatrzy")}},function(v,p,e){var s=e(15),l=e(19),f=Math.max;v.exports=function(c,y){var m,_,E,w=f(arguments.length,2);for(c=Object(l(c)),E=function(x){try{c[x]=y[x]}catch(S){m||(m=S)}},_=1;_<w;++_)s(y=arguments[_]).forEach(E);if(m!==void 0)throw m;return c}},function(v,p,e){v.exports=e(16)()?Object.keys:e(17)},function(v,p,e){v.exports=function(){try{return Object.keys("primitive"),!0}catch(s){return!1}}},function(v,p,e){var s=e(2),l=Object.keys;v.exports=function(f){return l(s(f)?Object(f):f)}},function(v,p,e){v.exports=function(){}},function(v,p,e){var s=e(2);v.exports=function(l){if(!s(l))throw new TypeError("Cannot use null or undefined");return l}},function(v,p,e){var s=e(2),l=Array.prototype.forEach,f=Object.create,c=function(m,_){var E;for(E in m)_[E]=m[E]};v.exports=function(y){var m=f(null);return l.call(arguments,function(_){s(_)&&c(Object(_),m)}),m}},function(v,p,e){v.exports=e(22)()?String.prototype.contains:e(23)},function(v,p,e){var s="razdwatrzy";v.exports=function(){return typeof s.contains=="function"&&s.contains("dwa")===!0&&s.contains("foo")===!1}},function(v,p,e){var s=String.prototype.indexOf;v.exports=function(l){return s.call(this,l,arguments[1])>-1}},function(v,p,e){v.exports=function(s){if(typeof s!="function")throw new TypeError(s+" is not a function");return s}},function(v){v.exports=JSON.parse('{"version":"1.1.2"}')},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function c(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&c(y.prototype,m),_&&c(y,_),y}}(),l=typeof window!="undefined"&&window.location.href.indexOf("danmu-debug")>-1,f=function(){function c(y){(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")})(this,c),this.constructorName=y||""}return s(c,[{key:"info",value:function(m){for(var _,E=arguments.length,w=Array(E>1?E-1:0),k=1;k<E;k++)w[k-1]=arguments[k];l&&(_=console).log.apply(_,["[Danmu Log]["+this.constructorName+"]",m].concat(w))}}]),c}();p.default=f,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function _(E,w){for(var k=0;k<w.length;k++){var x=w[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,x.key,x)}}return function(E,w,k){return w&&_(E.prototype,w),k&&_(E,k),E}}(),l=y(e(1)),f=y(e(28)),c=e(0);function y(_){return _&&_.__esModule?_:{default:_}}var m=function(_){function E(w){(function(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")})(this,E);var k=function(x,S){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!S||(typeof S=="undefined"?"undefined":g(S))!="object"&&typeof S!="function"?x:S}(this,(E.__proto__||Object.getPrototypeOf(E)).call(this));return k.setLogger("control"),k.danmu=w,k.main=new f.default(w),w.config.defaultOff||k.main.start(),k}return function(w,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof k=="undefined"?"undefined":g(k)));w.prototype=Object.create(k&&k.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(w,k):w.__proto__=k)}(E,_),s(E,[{key:"createSwitch",value:function(){var k=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=(0,c.createDom)("dk-switch",'<span class="txt">\u5F39</span>',{},"danmu-switch "+(k?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var k in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)c.hasOwnProperty.call(this,k)&&delete this[k]}}]),E}(l.default);p.default=m,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),l=m(e(1)),f=m(e(29)),c=m(e(30)),y=e(0);function m(E){return E&&E.__esModule?E:{default:E}}var _=function(E){function w(k){(function(S,B){if(!(S instanceof B))throw new TypeError("Cannot call a class as a function")})(this,w);var x=function(S,B){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!B||(typeof B=="undefined"?"undefined":g(B))!="object"&&typeof B!="function"?S:B}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return x.setLogger("main"),x.danmu=k,x.container=k.container,x.channel=new c.default(k),x.data=[].concat(k.config.comments),x.playedData=[],x.queue=[],x.timer=null,x.playRate=1,x.retryStatus="normal",x.interval=k.config.interval,x.willChanges=[],x._status="idle",(0,y.attachEventListener)(k,"bullet_remove",x.updateQueue.bind(x),"destroy"),(0,y.attachEventListener)(k,"changeDirection",function(S){x.danmu.direction=S},"destroy"),x}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),s(w,[{key:"_cancelDataHandleTimer",value:function(){this.handleId&&(clearTimeout(this.handleId),this.handleId=null),this.handleTimer&&(clearTimeout(this.handleTimer),this.handleTimer=null)}},{key:"destroy",value:function(){for(var x in this.logger&&this.logger.info("destroy"),this._cancelDataHandleTimer(),this.channel.destroy(),this.data=[],this)delete this[x]}},{key:"updateQueue",value:function(x){this.logger&&this.logger.info("updateQueue");var S=this;S.queue.some(function(B,U){return B.id===x.bullet.id&&(S.queue.splice(U,1),!0)}),S.data.some(function(B){return B.id===x.bullet.id&&(B.attached_=!1,!0)})}},{key:"init",value:function(){var x=this;x.logger&&x.logger.info("init"),x.retryStatus="normal",x.sortData(),function S(){x._status!=="closed"||x.retryStatus!=="stop"?(x._status==="playing"&&(x.readData(),x.dataHandle()),x.retryStatus==="stop"&&x._status!=="paused"||(x.handleTimer=setTimeout(function(){x.handleId=requestAnimationFrame(function(){S()})},250))):x._cancelDataHandleTimer()}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this._status="playing",this.queue=[],this.container.innerHTML="",this.channel.reset(),this.init()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this._status="closed",this.retryStatus="stop",this.queue=[],this.container.innerHTML="",this.channel.reset()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel.reset(),this.data=[],this.queue=[],this.container.innerHTML=""}},{key:"play",value:function(){var x=this;if(this._status!=="closed"){this.logger&&this.logger.info("play"),this._status="playing";var S=this.channel.channels;S&&S.length>0&&["scroll","top","bottom"].forEach(function(B){x.queue.forEach(function(R){R.startMove(),R.resized=!0});for(var U=0;U<S.length;U++)S[U].queue[B].forEach(function(R){R.resized=!1})})}else this.logger&&this.logger.info("play ignored")}},{key:"pause",value:function(){if(this._status!=="closed"){this.logger&&this.logger.info("pause"),this._status="paused";var x=this.channel.channels;x&&x.length>0&&this.queue.forEach(function(S){S.pauseMove()})}else this.logger&&this.logger.info("pause ignored")}},{key:"dataHandle",value:function(){this._status!=="paused"&&this._status!=="closed"&&this.queue.length&&this.queue.forEach(function(x){x.status==="waiting"&&x.startMove()})}},{key:"readData",value:function(){if(this.danmu.isReady){var x=this,S=this.danmu,B=S.player,U=x.interval,R=x.channel,C=void 0,A=void 0;if(B){var b=B.currentTime?Math.floor(1e3*B.currentTime):0;A=x.data.filter(function(F){return!F.start&&x.danmu.hideArr.indexOf(F.mode)<0&&(!F.color||x.danmu.hideArr.indexOf("color")<0)&&(F.start=b),!F.attached_&&x.danmu.hideArr.indexOf(F.mode)<0&&(!F.color||x.danmu.hideArr.indexOf("color")<0)&&F.start-U<=b&&b<=F.start+U}),S.live&&(x.data=[])}else(A=x.data.splice(0,1)).length===0&&(A=x.playedData.splice(0,1));if(A.length>0){R.updatePos();var O=2;e:for(var W,K=0;K<A.length;K++)if(W=A[K],x.forceDuration&&x.forceDuration!==W.duration&&(W.duration=x.forceDuration),(C=new f.default(S,W))&&!C.bulletCreateFail)if(C.attach(),W.attached_=!0,R.addBullet(C).result)x.queue.push(C),C.topInit(),O=2;else{for(var G in C.detach(),C)y.hasOwnProperty.call(C,G)&&delete C[G];if(C=null,W.attached_=!1,W.noDiscard&&(W.prior?x.data.unshift(W):x.data.push(W)),O===0)break e;O--}else{if(O===0)break e;O--}}}}},{key:"sortData",value:function(){this.data.sort(function(x,S){return(x.start||-1)-(S.start||-1)})}},{key:"status",get:function(){return this._status}}]),w}(l.default);p.default=_,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.Bullet=void 0;var s,l=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),f=e(1),c=(s=f)&&s.__esModule?s:{default:s},y=e(0);function m(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!w||(typeof w=="undefined"?"undefined":g(w))!="object"&&typeof w!="function"?E:w}var _=p.Bullet=function(E){function w(k,x){(function(W,K){if(!(W instanceof K))throw new TypeError("Cannot call a class as a function")})(this,w);var S=m(this,(w.__proto__||Object.getPrototypeOf(w)).call(this)),B=S,U=void 0;if(S.setLogger("bullet"),S.danmu=k,S.options=x,S.duration=x.duration,S.id=x.id,S.container=k.container,S.start=x.start,S.prior=x.prior,S.realTime=x.realTime,S.color=x.color,S.bookChannelId=x.bookChannelId,S.direction=k.direction,S.reuseDOM=!0,S.willChanges=[],S.domObj=k.domObj,x.el&&x.el.nodeType===1){if(x.el.parentNode)return m(S,{bulletCreateFail:!0});if(k.config.disableCopyDOM)U=x.el,S.reuseDOM=!1;else{U=S.domObj.use();var R=(0,y.copyDom)(x.el);x.eventListeners&&x.eventListeners.length>0&&x.eventListeners.forEach(function(W){R.addEventListener(W.event,W.listener,W.useCapture||!1)}),U.appendChild(R)}}else(U=S.domObj.use()).textContent=x.txt;if(S.onChangeDirection=function(W){B.direction=W},S.danmu.on("changeDirection",S.onChangeDirection),x.style){var C=x.style;Object.keys(C).forEach(function(W){(0,y.styleUtil)(U,W,C[W])})}x.mode==="top"||x.mode==="bottom"?S.mode=x.mode:S.mode="scroll",S.el=U,x.like&&x.like.el&&S.setLikeDom(x.like.el,x.like.style),S.status="waiting";var A=void 0;if((0,y.isNumber)(k.config.bulletOffset)&&k.config.bulletOffset>=0)A=k.config.bulletOffset;else{var b=k.containerPos;A=b.width/10>100?100:b.width/10}var O=x.realTime?0:Math.floor(Math.random()*A);return S.updateOffset(O),S}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),l(w,[{key:"updateOffset",value:function(x){this.random=x,(0,y.styleUtil)(this.el,"left",this.danmu.containerPos.width+x+"px")}},{key:"attach",value:function(){var x=this.el;this.container.appendChild(x),this.elPos=x.getBoundingClientRect(),this.direction==="b2t"?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV&&(this.duration=(this.danmu.containerPos.width+this.random+this.width)/this.moveV*1e3),this.danmu.config&&(this.danmu.config.mouseControl&&(this.mouseoverFunWrapper=this.mouseoverFun.bind(this),x.addEventListener("mouseover",this.mouseoverFunWrapper,!1)),this.danmu.config.mouseEnterControl&&(this.mouseEnterFunWrapper=this.mouseoverFun.bind(this),x.addEventListener("mouseenter",this.mouseEnterFunWrapper,!1))),x.addEventListener("transitionend",this._onTransitionEnd,!1)}},{key:"detach",value:function(){var x=this.el;if(x){var S=this.danmu.config;S&&(S.mouseControl&&x.removeEventListener("mouseover",this.mouseoverFunWrapper,!1),S.mouseEnterControl&&x.removeEventListener("mouseenter",this.mouseEnterFunWrapper,!1)),x.removeEventListener("transitionend",this._onTransitionEnd,!1),x.parentNode&&x.parentNode.removeChild(x),this.reuseDOM&&this.domObj.unused(x),this.el=null}this.elPos=void 0,this.danmu.off("changeDirection",this.onChangeDirection)}},{key:"willChange",value:function(){var x=this.danmu.main.willChanges.concat(this.willChanges).join();(0,y.styleUtil)(this.el,"willChange",x)}},{key:"mouseoverFun",value:function(x){this.danmu&&this.danmu.mouseControl&&this.danmu.config.mouseControlPause||this.status==="waiting"||this.status==="end"||this.danmu&&this.danmu.emit("bullet_hover",{bullet:this,event:x})}},{key:"_onTransitionEnd",value:function(){this.status="end",this.remove()}},{key:"topInit",value:function(){this.logger&&this.logger.info("topInit #"+(this.options.txt||"[DOM Element]")+"#"),this.direction==="b2t"?((0,y.styleUtil)(this.el,"transformOrigin","left top"),(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+this.danmu.containerPos.height+"px) translateZ(0px) rotate(90deg)"),(0,y.styleUtil)(this.el,"transition","transform 0s linear 0s")):(0,y.styleUtil)(this.el,"top",this.top+"px")}},{key:"pauseMove",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0],S=this;if(S.status!=="paused"&&(S.status!=="forcedPause"&&(this.status="paused"),S._moveV=void 0,this.el))if(this.willChange(),this.mode==="scroll"){var B=S.danmu.containerPos;if(x){var U=(new Date().getTime()-S.moveTime)/1e3,R=U*this.moveV,C=0;C=S.moveMoreS-R>=0?this.direction==="b2t"?(S.moveMoreS-R)/S.moveContainerHeight*B.height:(S.moveMoreS-R)/S.moveContainerWidth*B.width:S.moveMoreS-R,this.direction==="b2t"?(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+C+"px) translateZ(0px) rotate(90deg)"):(0,y.styleUtil)(this.el,"left",C+"px")}else this.direction==="b2t"?(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+(this.el.getBoundingClientRect().top-B.top)+"px) translateZ(0px) rotate(90deg)"):(0,y.styleUtil)(this.el,"left",this.el.getBoundingClientRect().left-B.left+"px");this.direction==="b2t"||(0,y.styleUtil)(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),(0,y.styleUtil)(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+new Date().getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(x){if(this.hasMove||(this.danmu.emit("bullet_start",this),this.hasMove=!0),(this.status!=="forcedPause"||x)&&this.el&&this.status!=="start")if(this.status="start",this.willChanges=["transform","transition"],this.willChange(),(0,y.styleUtil)(this.el,"backface-visibility","hidden"),(0,y.styleUtil)(this.el,"perspective","500em"),this.mode==="scroll"){var S=this.danmu.containerPos;if(this.direction==="b2t"){var B=(this.el.getBoundingClientRect().bottom-S.top)/this.moveV;(0,y.styleUtil)(this.el,"transition","transform "+B+"s linear 0s"),(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY(-"+this.height+"px) translateZ(0px) rotate(90deg)"),this.moveTime=new Date().getTime(),this.moveMoreS=this.el.getBoundingClientRect().top-S.top,this.moveContainerHeight=S.height}else{if(!this.el)return;var U=this.el.getBoundingClientRect(),R=U.right-S.left,C=R/this.moveV;U.right>S.left?((0,y.styleUtil)(this.el,"transition","transform "+C+"s linear 0s"),(0,y.styleUtil)(this.el,"transform","translateX(-"+R+"px) translateY(0px) translateZ(0px)"),this.moveTime=new Date().getTime(),this.moveMoreS=U.left-S.left,this.moveContainerWidth=S.width):(this.status="end",this.remove())}}else{var A=new Date().getTime(),b=(this.startTime&&A-this.startTime>this.duration?A-this.startTime:this.duration)/1e3;(0,y.styleUtil)(this.el,"left","50%"),(0,y.styleUtil)(this.el,"margin","0 0 0 -"+this.width/2+"px"),(0,y.styleUtil)(this.el,"visibility","hidden"),(0,y.styleUtil)(this.el,"transition","visibility "+b+"s 0s"),this.pastDuration||(this.pastDuration=1),this.startTime=A}}},{key:"remove",value:function(){this.logger&&this.logger.info("remove #"+(this.options.txt||"[DOM Element]")+"#"),this.pauseMove(),this.el&&this.el.parentNode&&(this.willChanges=[],this.willChange(),this.detach(),this.options.el&&this.options.el.nodeType===1&&this.danmu.config.disableCopyDOM&&(0,y.styleUtil)(this.options.el,"transform","none"),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(x){this.el&&(this.el.style.fontSize=x)}},{key:"setLikeDom",value:function(x,S){if(x&&(Object.keys(S).forEach(function(U){x.style[U]=S[U]}),x.className="danmu-like",this.el)){var B=this.el.querySelector(".danmu-like");B&&this.el.removeChild(B),this.el.innerHTML=""+this.el.innerHTML+x.outerHTML}return x}},{key:"moveV",get:function(){var x=this._moveV;if(!x){if(this.options.moveV)x=this.options.moveV;else if(this.elPos){var S=this.danmu.containerPos;x=(this.direction==="b2t"?S.height+this.height:S.width+this.width)/this.duration*1e3}x&&(x*=this.danmu.main.playRate,this._moveV=x)}return x}}]),w}(c.default);p.default=_},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),f=e(1),c=(s=f)&&s.__esModule?s:{default:s},y=e(0),m=e(31),_=function(E){function w(k){(function(B,U){if(!(B instanceof U))throw new TypeError("Cannot call a class as a function")})(this,w);var x=function(B,U){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!U||(typeof U=="undefined"?"undefined":g(U))!="object"&&typeof U!="function"?B:U}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this)),S=x;return S.setLogger("channel"),S.danmu=k,S.reset(!0),S.direction=k.direction,S.channels=[],S.updatePos(),(0,y.attachEventListener)(x.danmu,"bullet_remove",function(B){S.removeBullet(B.bullet)},"destroy"),(0,y.attachEventListener)(x.danmu,"changeDirection",function(B){S.direction=B},"destroy"),(0,y.attachEventListener)(x.danmu,"channel_resize",function(){S.resize()},"destroy"),x}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),l(w,[{key:"updatePos",value:function(){var x=this.container.getBoundingClientRect();this.containerPos=x,this.containerWidth=x.width,this.containerHeight=x.height,this.containerTop=x.top,this.containerBottom=x.bottom,this.containerLeft=x.left,this.containerRight=x.right}},{key:"destroy",value:function(){for(var x in this.logger&&this.logger.info("destroy"),this.channels.splice(0,this.channels.length),this._cancelResizeTimer(),this)y.hasOwnProperty.call(this,x)&&delete this[x]}},{key:"addBullet",value:function(x){var S=this,B=this.danmu,U=this.channels,R=void 0,C=void 0,A=void 0;if(S.direction==="b2t"?(C=this.channelWidth,A=Math.ceil(x.width/C)):(R=this.channelHeight,A=Math.ceil(x.height/R)),A>U.length)return{result:!1,message:"exceed channels.length, occupy="+A+",channelsSize="+U.length};for(var b=!0,O=void 0,W=-1,K=0,G=U.length;K<G;K++)if(U[K].queue[x.mode].some(function(Ye){return Ye.id===x.id}))return{result:!1,message:"exited, channelOrder="+K+",danmu_id="+x.id};if(x.mode==="scroll")for(var F=0,j=U.length-A;F<=j;F++){b=!0;for(var N=F;N<F+A;N++){if((O=U[N]).operating.scroll){b=!1;break}if(O.bookId.scroll&&O.bookId.scroll!==x.id){b=!1;break}O.operating.scroll=!0;var $=O.queue.scroll[0];if($){var Z=$.el.getBoundingClientRect();if(S.direction==="b2t"){if(Z.bottom>=S.containerPos.bottom){b=!1,O.operating.scroll=!1;break}}else if(Z.right>=S.containerPos.right){b=!1,O.operating.scroll=!1;break}var te=void 0,ae=$.moveV,Ee=void 0,Te=x.moveV,Ae=void 0;if(S.direction==="b2t"?(Ee=(te=Z.bottom-S.containerTop)/ae,Ae=S.containerHeight+x.random-te):(Ee=(te=Z.right-S.containerLeft)/ae,Ae=S.containerWidth+x.random-te),Te>ae){var De=Ae/(Te-ae);if(B.config.bOffset||(B.config.bOffset=0),Ee+B.config.bOffset>=De){var ze=Ee*Te-S.containerPos.width;ze>0&&x.updateOffset(ze+(1+Math.ceil(5*Math.random())))}}}O.operating.scroll=!1}if(b){W=F;break}}else if(x.mode==="top")for(var Ce=0,Oe=U.length-A;Ce<=Oe;Ce++){b=!0;for(var $e=Ce;$e<Ce+A;$e++){if($e>Math.floor(U.length/2)){b=!1;break}if((O=U[$e]).operating[x.mode]){b=!1;break}if((O.bookId[x.mode]||x.prior)&&O.bookId[x.mode]!==x.id){b=!1;break}if(O.operating[x.mode]=!0,O.queue[x.mode].length>0){b=!1,O.operating[x.mode]=!1;break}O.operating[x.mode]=!1}if(b){W=Ce;break}}else if(x.mode==="bottom")for(var D=U.length-A;D>=0;D--){b=!0;for(var fe=D;fe<D+A;fe++){if(fe<=Math.floor(U.length/2)){b=!1;break}if((O=U[fe]).operating[x.mode]){b=!1;break}if((O.bookId[x.mode]||x.prior)&&O.bookId[x.mode]!==x.id){b=!1;break}if(O.operating[x.mode]=!0,O.queue[x.mode].length>0){b=!1,O.operating[x.mode]=!1;break}O.operating[x.mode]=!1}if(b){W=D;break}}if(W!==-1){for(var ne=W,Y=W+A;ne<Y;ne++)(O=U[ne]).operating[x.mode]=!0,O.queue[x.mode].unshift(x),x.prior&&(delete O.bookId[x.mode],S.logger&&S.logger.info(ne+"\u53F7\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528")),O.operating[x.mode]=!1;return x.prior&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u8FD0\u884C\u5B8C\u6BD5"),delete x.bookChannelId,B.player&&B.bulletBtn.main.data.some(function(Ye){return Ye.id===x.id&&(delete Ye.bookChannelId,!0)})),x.channel_id=[W,A],S.direction==="b2t"?(x.top=W*C,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerWidth*S.danmu.config.area.start)):(x.top=W*R,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerHeight*S.danmu.config.area.start)),{result:x,message:"success"}}if(x.options.realTime){var H=0,J=-1,ce=null;if(S.danmu.bulletBtn.main.queue.forEach(function(Ye,et){!Ye.prior&&!Ye.options.realTime&&Ye.el&&Ye.el.getBoundingClientRect().left>S.containerPos.right&&Ye.start>=H&&(H=Ye.start,J=et,ce=Ye)}),ce){ce.remove(),S.removeBullet(ce),S.danmu.bulletBtn.main.queue.splice(J,1),x.channel_id=ce.channel_id;for(var he=ce.channel_id[0],ee=ce.channel_id[0]+ce.channel_id[1];he<ee;he++)(O=U[he]).operating[x.mode]=!0,O.queue[x.mode].unshift(x),x.prior&&delete O.bookId[x.mode],O.operating[x.mode]=!1;return x.top=ce.top,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerHeight*S.danmu.config.area.start),{result:x,message:"success"}}}if(x.prior)if(x.bookChannelId||S.danmu.live)B.player&&B.bulletBtn.main.data.some(function(Ye){return Ye.id===x.id&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),Ye.start+=2e3,!0)});else{W=-1;for(var Se=0,Le=U.length-A;Se<=Le;Se++){b=!0;for(var ke=Se;ke<Se+A;ke++)if(U[ke].bookId[x.mode]){b=!1;break}if(b){W=Se;break}}if(W!==-1){for(var Ne=W;Ne<W+A;Ne++)U[Ne].bookId[x.mode]=x.id,S.logger&&S.logger.info(Ne+"\u53F7\u8F68\u9053\u88AB"+x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A");B.player&&B.bulletBtn.main.data.some(function(Ye){return Ye.id===x.id&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),Ye.start+=2e3,Ye.bookChannelId=[W,A],S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u4E86"+W+"~"+(W+A-1)+"\u53F7\u8F68\u9053"),!0)})}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(x){this.logger&&this.logger.info("removeBullet "+(x.options.txt||"[DOM Element]"));for(var S=this.channels,B=x.channel_id,U=void 0,R=B[0],C=B[0]+B[1];R<C;R++)if(U=S[R]){U.operating[x.mode]=!0;var A=-1;U.queue[x.mode].some(function(b,O){return b.id===x.id&&(A=O,!0)}),A>-1&&U.queue[x.mode].splice(A,1),U.operating[x.mode]=!1}x.options.loop&&this.danmu.bulletBtn.main.playedData.push(x.options)}},{key:"resizeSync",value:function(){this.resize(!0)}},{key:"resize",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("resize");var S=this;function B(){var U=S.danmu,R=U.container,C=U.config,A=U.bulletBtn,b=void 0;if(S.updatePos(),S._cancelResizeTimer(),A.main.data&&A.main.data.forEach(function(ze){ze.bookChannelId&&(delete ze.bookChannelId,S.logger&&S.logger.info("resize\u5BFC\u81F4"+ze.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u53D6\u6D88"))}),S.logger&&S.logger.info("resize\u5BFC\u81F4\u6240\u6709\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528"),S.width=S.containerWidth,S.height=S.containerHeight,C.area){var O=C.area,W=O.lines,K=O.start,G=O.end;(0,m.validAreaLineRule)(W)?b=W:K>=0&&G>=K&&(S.direction==="b2t"?S.width=S.width*(G-K):S.height=S.height*(G-K))}S.container=R;var F=C.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,y.isNumber)(b)||(b=S.direction==="b2t"?Math.floor(S.width/F):Math.floor(S.height/F));for(var j=[],N=0;N<b;N++)j[N]={id:N,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(S.channels&&S.channels.length<=j.length){for(var $=function(Ce){j[Ce]={id:Ce,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach(function(Oe){S.channels[Ce].queue[Oe].forEach(function($e){$e.el&&j[Ce].queue[Oe].push($e)})}),S.channels[Ce].queue.bottom.forEach(function(Oe){if(Oe.el&&(j[Ce+j.length-S.channels.length].queue.bottom.push(Oe),Oe.channel_id[0]+Oe.channel_id[1]-1===Ce)){var $e=[].concat(Oe.channel_id);Oe.channel_id=[$e[0]-S.channels.length+j.length,$e[1]],Oe.top=Oe.channel_id[0]*F,S.danmu.config.area&&S.danmu.config.area.start&&(Oe.top+=S.containerHeight*S.danmu.config.area.start),Oe.topInit()}})},Z=0;Z<S.channels.length;Z++)$(Z);for(var te=function(Ce){["scroll","top","bottom"].forEach(function(Oe){j[Ce].queue[Oe].forEach(function($e){$e.resized=!1})})},ae=0;ae<j.length;ae++)te(ae);S.channels=j,S.direction==="b2t"?S.channelWidth=F:S.channelHeight=F}else if(S.channels&&S.channels.length>j.length){for(var Ee=function(Ce){j[Ce]={id:Ce,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach(function(Oe){if(!(Oe==="top"&&Ce>Math.floor(j.length/2))){if(!(Oe==="bottom"&&Ce<=Math.floor(j.length/2))){var $e=Oe==="bottom"?Ce-j.length+S.channels.length:Ce;S.channels[$e].queue[Oe].forEach(function(D,fe){if(D.el&&(j[Ce].queue[Oe].push(D),Oe==="bottom"&&D.channel_id[0]+D.channel_id[1]-1===$e)){var ne=[].concat(D.channel_id);D.channel_id=[ne[0]-S.channels.length+j.length,ne[1]],D.top=D.channel_id[0]*F,S.danmu.config.area&&S.danmu.config.area.start&&(D.top+=S.containerHeight*S.danmu.config.area.start),D.topInit()}S.channels[$e].queue[Oe].splice(fe,1)})}}})},Te=0;Te<j.length;Te++)Ee(Te);for(var Ae=function(Ce){["scroll","top","bottom"].forEach(function(Oe){j[Ce].queue[Oe].forEach(function($e){$e.resized=!1})})},De=0;De<j.length;De++)Ae(De);S.channels=j,S.direction==="b2t"?S.channelWidth=F:S.channelHeight=F}S.resizing=!1}S.resizing||(S.resizing=!0,x?B():(this._cancelResizeTimer(),this.resizeId=requestAnimationFrame(B)))}},{key:"_cancelResizeTimer",value:function(){this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=null)}},{key:"reset",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("reset");var S=this,B=S.danmu,U=B.container,R=B.bulletBtn,C=B.config;function A(){var b=void 0,O=U.getBoundingClientRect();if(S.width=O.width,S.height=O.height,S.resetId&&(cancelAnimationFrame(S.resetId),S.resetId=null),C.area){var W=C.area,K=W.lines,G=W.start,F=W.end;(0,m.validAreaLineRule)(K)?b=K:G>=0&&F>=G&&(S.direction==="b2t"?S.width=S.width*(F-G):S.height=S.height*(F-G))}var j=C.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,y.isNumber)(b)||(b=S.direction==="b2t"?Math.floor(S.width/j):Math.floor(S.height/j));for(var N=[],$=0;$<b;$++)N[$]={id:$,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};S.channels=N,S.direction==="b2t"?S.channelWidth=j:S.channelHeight=j}S.container=U,R&&R.main&&R.main.queue.forEach(function(b){b.remove()}),S.channels&&S.channels.length>0&&["scroll","top","bottom"].forEach(function(b){for(var O=0;O<S.channels.length;O++)S.channels[O].queue[b].forEach(function(W){W.remove()})}),R&&R.main&&R.main.data&&R.main.data.forEach(function(b){b.attached_=!1}),x?this.resetId=requestAnimationFrame(A):A()}}]),w}(c.default);p.default=_,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.validAreaLineRule=function(s){return typeof s=="number"&&s>=0&&Number.isInteger(s)}},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function c(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&c(y.prototype,m),_&&c(y,_),y}}(),l=e(0),f=function(){function c(y){(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")})(this,c),y={initDOM:function(){return document.createElement("div")},initSize:10},this.init(y)}return s(c,[{key:"init",value:function(m){this.idleList=[],this.usingList=[],this._id=0,this.options=m,this._expand(m.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var m=this.idleList.shift();return this.usingList.push(m),m}},{key:"unused",value:function(m){var _=this.usingList.indexOf(m);_<0||(this.usingList.splice(_,1),m.innerHTML="",m.textcontent="",this.clearElementStyle(m),this.idleList.push(m))}},{key:"_expand",value:function(m){for(var _=0;_<m;_++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var m=0;m<this.idleList.length;m++)this.idleList[m].innerHTML="",this.idleList[m].textcontent="",this.clearElementStyle(this.idleList[m]);for(var _=0;_<this.usingList.length;_++)this.usingList[_].innerHTML="",this.usingList[_].textcontent="",this.clearElementStyle(this.usingList[_]);for(var E in this)l.hasOwnProperty.call(this,E)&&delete this[E]}},{key:"clearElementStyle",value:function(m){var _=typeof window!="undefined"?window.navigator.userAgent:null;_&&(_.indexOf("MSIE ")>-1||_.indexOf("Trident/")>-1?(0,l.styleUtil)(m,"transform","none"):m.setAttribute("style",""))}}]),c}();p.default=f,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.destroyObserver=p.unObserver=p.addObserver=void 0;var s=function(){function c(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&c(y.prototype,m),_&&c(y,_),y}}(),l=e(0),f=new(function(){function c(){var y=this;if(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")}(this,c),this.__handlers=[],window.ResizeObserver)try{this.observer=new window.ResizeObserver((0,l.throttle)(function(m){y.__trigger(m)},100))}catch(m){}}return s(c,[{key:"addObserver",value:function(m,_){if(this.observer){this.observer&&this.observer.observe(m);for(var E=this.__handlers,w=-1,k=0;k<E.length;k++)E[k]&&m===E[k].target&&(w=k);w>-1?this.__handlers[w].handler.push(_):this.__handlers.push({target:m,handler:[_]})}}},{key:"unObserver",value:function(m){var _=-1;this.__handlers.map(function(E,w){m===E.target&&(_=w)}),this.observer&&this.observer.unobserve(m),_>-1&&this.__handlers.splice(_,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(m){for(var _=this.__handlers,E=0;E<_.length;E++)if(_[E]&&m===_[E].target){_[E].handler&&_[E].handler.map(function(w){try{w()}catch(k){console.error(k)}});break}}},{key:"__trigger",value:function(m){var _=this;m.map(function(E){_.__runHandler(E.target)})}}]),c}());p.addObserver=function(c,y){f.addObserver(c,y)},p.unObserver=function(c,y){f.unObserver(c,y)},p.destroyObserver=function(c,y){f.destroyObserver(c,y)}},function(v,p,e){var s=e(35);typeof s=="string"&&(s=[[v.i,s,""]]);var l={hmr:!0,transform:void 0,insertInto:void 0};e(37)(s,l),s.locals&&(v.exports=s.locals)},function(v,p,e){(v.exports=e(36)(!1)).push([v.i,".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}",""])},function(v,p){v.exports=function(e){var s=[];return s.toString=function(){return this.map(function(l){var f=function(c,y){var m=c[1]||"",_=c[3];if(!_)return m;if(y&&typeof btoa=="function"){var E=(k=_,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(k))))+" */"),w=_.sources.map(function(x){return"/*# sourceURL="+_.sourceRoot+x+" */"});return[m].concat(w).concat([E]).join(`
`)}var k;return[m].join(`
`)}(l,e);return l[2]?"@media "+l[2]+"{"+f+"}":f}).join("")},s.i=function(l,f){typeof l=="string"&&(l=[[null,l,""]]);for(var c={},y=0;y<this.length;y++){var m=this[y][0];typeof m=="number"&&(c[m]=!0)}for(y=0;y<l.length;y++){var _=l[y];typeof _[0]=="number"&&c[_[0]]||(f&&!_[2]?_[2]=f:f&&(_[2]="("+_[2]+") and ("+f+")"),s.push(_))}},s}},function(v,p,e){var s,l,f={},c=(s=function(){return window&&document&&document.all&&!window.atob},function(){return l===void 0&&(l=s.apply(this,arguments)),l}),y=function(j){return document.querySelector(j)},m=function(F){var j={};return function(N){if(typeof N=="function")return N();if(j[N]===void 0){var $=y.call(this,N);if(window.HTMLIFrameElement&&$ instanceof window.HTMLIFrameElement)try{$=$.contentDocument.head}catch(Z){$=null}j[N]=$}return j[N]}}(),_=null,E=0,w=[],k=e(38);function x(F,j){for(var N=0;N<F.length;N++){var $=F[N],Z=f[$.id];if(Z){Z.refs++;for(var te=0;te<Z.parts.length;te++)Z.parts[te]($.parts[te]);for(;te<$.parts.length;te++)Z.parts.push(A($.parts[te],j))}else{var ae=[];for(te=0;te<$.parts.length;te++)ae.push(A($.parts[te],j));f[$.id]={id:$.id,refs:1,parts:ae}}}}function S(F,j){for(var N=[],$={},Z=0;Z<F.length;Z++){var te=F[Z],ae=j.base?te[0]+j.base:te[0],Ee={css:te[1],media:te[2],sourceMap:te[3]};$[ae]?$[ae].parts.push(Ee):N.push($[ae]={id:ae,parts:[Ee]})}return N}function B(F,j){var N=m(F.insertInto);if(!N)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var $=w[w.length-1];if(F.insertAt==="top")$?$.nextSibling?N.insertBefore(j,$.nextSibling):N.appendChild(j):N.insertBefore(j,N.firstChild),w.push(j);else if(F.insertAt==="bottom")N.appendChild(j);else{if(g(F.insertAt)!="object"||!F.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var Z=m(F.insertInto+" "+F.insertAt.before);N.insertBefore(j,Z)}}function U(F){if(F.parentNode===null)return!1;F.parentNode.removeChild(F);var j=w.indexOf(F);j>=0&&w.splice(j,1)}function R(F){var j=document.createElement("style");return F.attrs.type===void 0&&(F.attrs.type="text/css"),C(j,F.attrs),B(F,j),j}function C(F,j){Object.keys(j).forEach(function(N){F.setAttribute(N,j[N])})}function A(F,j){var N,$,Z,te;if(j.transform&&F.css){if(!(te=j.transform(F.css)))return function(){};F.css=te}if(j.singleton){var ae=E++;N=_||(_=R(j)),$=W.bind(null,N,ae,!1),Z=W.bind(null,N,ae,!0)}else F.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(N=function(Ee){var Te=document.createElement("link");return Ee.attrs.type===void 0&&(Ee.attrs.type="text/css"),Ee.attrs.rel="stylesheet",C(Te,Ee.attrs),B(Ee,Te),Te}(j),$=G.bind(null,N,j),Z=function(){U(N),N.href&&URL.revokeObjectURL(N.href)}):(N=R(j),$=K.bind(null,N),Z=function(){U(N)});return $(F),function(Ee){if(Ee){if(Ee.css===F.css&&Ee.media===F.media&&Ee.sourceMap===F.sourceMap)return;$(F=Ee)}else Z()}}v.exports=function(F,j){if(typeof DEBUG!="undefined"&&DEBUG&&(typeof document=="undefined"?"undefined":g(document))!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(j=j||{}).attrs=g(j.attrs)=="object"?j.attrs:{},j.singleton||typeof j.singleton=="boolean"||(j.singleton=c()),j.insertInto||(j.insertInto="head"),j.insertAt||(j.insertAt="bottom");var N=S(F,j);return x(N,j),function($){for(var Z=[],te=0;te<N.length;te++){var ae=N[te];(Ee=f[ae.id]).refs--,Z.push(Ee)}for($&&x(S($,j),j),te=0;te<Z.length;te++){var Ee;if((Ee=Z[te]).refs===0){for(var Te=0;Te<Ee.parts.length;Te++)Ee.parts[Te]();delete f[Ee.id]}}}};var b,O=(b=[],function(F,j){return b[F]=j,b.filter(Boolean).join(`
`)});function W(F,j,N,$){var Z=N?"":$.css;if(F.styleSheet)F.styleSheet.cssText=O(j,Z);else{var te=document.createTextNode(Z),ae=F.childNodes;ae[j]&&F.removeChild(ae[j]),ae.length?F.insertBefore(te,ae[j]):F.appendChild(te)}}function K(F,j){var N=j.css,$=j.media;if($&&F.setAttribute("media",$),F.styleSheet)F.styleSheet.cssText=N;else{for(;F.firstChild;)F.removeChild(F.firstChild);F.appendChild(document.createTextNode(N))}}function G(F,j,N){var $=N.css,Z=N.sourceMap,te=j.convertToAbsoluteUrls===void 0&&Z;(j.convertToAbsoluteUrls||te)&&($=k($)),Z&&($+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(Z))))+" */");var ae=new Blob([$],{type:"text/css"}),Ee=F.href;F.href=URL.createObjectURL(ae),Ee&&URL.revokeObjectURL(Ee)}},function(v,p){v.exports=function(e){var s=typeof window!="undefined"&&window.location;if(!s)throw new Error("fixUrls requires window.location");if(!e||typeof e!="string")return e;var l=s.protocol+"//"+s.host,f=l+s.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(c,y){var m,_=y.trim().replace(/^"(.*)"$/,function(E,w){return w}).replace(/^'(.*)'$/,function(E,w){return w});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(_)?c:(m=_.indexOf("//")===0?_:_.indexOf("/")===0?l+_:f+_.replace(/^\.\//,""),"url("+JSON.stringify(m)+")")})}}])})}).call(this,r(135)(t))},function(t,i){t.exports=function(r){return r.webpackPolyfill||(r.deprecate=function(){},r.paths=[],r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),r.webpackPolyfill=1),r}},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40">
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>
</svg>
`},function(t,i,r){var n=r(138);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .danmu-switch{-webkit-order:6;-moz-box-ordinal-group:7;order:6;z-index:26}.xgplayer-skin-default .xgplayer-danmu{display:none;position:absolute;top:0;left:0;right:0;height:100%;overflow:hidden;z-index:9;outline:none;pointer-events:none}.xgplayer-skin-default .xgplayer-danmu>*{position:absolute;white-space:nowrap;z-index:9;pointer-events:auto}.xgplayer-skin-default .xgplayer-danmu.xgplayer-has-danmu{display:block}.xgplayer-skin-default .xgplayer-panel{outline:none;-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:40px;height:40px;display:inline-block;position:relative;font-family:PingFangSC-Regular;font-size:13px;color:hsla(0,0%,100%,.8);z-index:36}.xgplayer-skin-default .xgplayer-panel .xgplayer-panel-icon{cursor:pointer;position:absolute;margin-left:5px;top:10px}.xgplayer-skin-default .xgplayer-panel-active{display:block!important;bottom:30px}.xgplayer-skin-default .xgplayer-panel-slider{z-index:36;display:none;position:absolute;width:230px;height:230px;background:rgba(0,0,0,.54);border-radius:1px;padding:10px 20px;outline:none;left:-115px;bottom:40px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode{padding-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-radio li{display:inline;list-style:none;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode ul{display:-webkit-flex;display:-moz-box;display:flex;-webkit-justify-content:space-around;justify-content:space-around}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode li{margin:0 12px;font-size:11px;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-font{margin-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency{display:block;margin-top:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-progress{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:4px;border-radius:4px;background:linear-gradient(90deg,#f85959,#f85959 100%,#aaa)}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea{display:block;margin-top:8px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-threequarters,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-twoquarters{margin-left:-6px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-full{margin-right:3px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-full-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-onequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-threequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-twoquarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-zero-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(140);var u=function(){var d=this;if(!(!d.config.pip||typeof d.video.requestPictureInPicture!="function")){var g=d.lang.PIP,v=(0,n.createDom)("xg-pip",'<p class="name"><span>'+g+"</span></p>",{tabindex:9},"xgplayer-pip");d.once("ready",function(){d.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),d.userGestureTrigEvent("pipBtnClick")})})}};i.default={name:"s_pip",method:u},t.exports=i.default},function(t,i,r){var n=r(141);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-pip{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-pip .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-pip .name span{width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.lang-is-jp .xgplayer-pip .name span{width:70px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(143);var u=function(){var d=this;if(!!d.config.miniplayer){var g=d.lang.MINIPLAYER,v=(0,n.createDom)("xg-miniplayer",'<p class="name"><span>'+g+"</span></p>",{tabindex:9},"xgplayer-miniplayer");d.once("ready",function(){d.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),d.userGestureTrigEvent("miniplayerBtnClick")})})}};i.default={name:"s_miniplayer",method:u},t.exports=i.default},function(t,i,r){var n=r(144);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-miniplayer{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-miniplayer .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-miniplayer .name span{width:80px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-miniplayer-lay{position:absolute;top:26px;left:0;width:100%;height:100%;z-index:130;cursor:pointer;background-color:transparent;display:none}.xgplayer-skin-default .xgplayer-miniplayer-lay div{width:100%;height:100%}.xgplayer-skin-default .xgplayer-miniplayer-drag{cursor:move;position:absolute;top:0;left:0;width:100%;height:26px;line-height:26px;background-image:linear-gradient(rgba(0,0,0,.3),transparent);z-index:130;display:none}.xgplayer-skin-default .xgplayer-miniplayer-drag .drag-handle{width:100%}.xgplayer-skin-default.xgplayer-miniplayer-active{position:fixed;right:0;bottom:200px;width:320px;height:180px;z-index:110}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-controls,.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-danmu{display:none}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-lay{display:block}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-drag{display:-webkit-flex;display:-moz-box;display:flex}.xgplayer-skin-default.xgplayer-inactive .xgplayer-miniplayer-drag{display:none}.lang-is-jp .xgplayer-miniplayer .name span{width:70px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(146),o=d(u);r(147);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.config.playNext;if(!e||!e.urlList)return;var s=(0,n.createDom)("xg-playnext",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-playnext"),l=p.lang.PLAYNEXT_TIPS,f=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-playnext">'+l+"</span>",{},"xgplayer-tips");s.appendChild(f),p.once("ready",function(){p.controls.appendChild(s)}),["click","touchend"].forEach(function(m){s.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-is-enter"),p.userGestureTrigEvent("playNextBtnClick")})});var c=function(){(0,n.addClass)(p.root,"xgplayer-playnext-inactive")};p.on("urlListEnd",c);function y(){p.off("urlListEnd",c),p.off("destroy",y)}p.once("destroy",y)};i.default={name:"s_playNext",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`},function(t,i,r){var n=r(148);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-playnext{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;cursor:pointer;top:-2px}.xgplayer-skin-default .xgplayer-playnext .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-playnext .xgplayer-tips .xgplayer-tip-playnext{display:block}.xgplayer-skin-default .xgplayer-playnext:hover{opacity:.85}.xgplayer-skin-default .xgplayer-playnext:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-playnext .xgplayer-tips{margin-left:-25px}.xgplayer-lang-is-jp .xgplayer-playnext .xgplayer-tips{margin-left:-38px}.xgplayer-skin-default.xgplayer-playnext-inactive .xgplayer-playnext{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(150),o=d(u);r(151);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.rotate){var e=(0,n.createDom)("xg-rotate",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-rotate"),s=p.lang.ROTATE_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-rotate">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(c){c.preventDefault(),c.stopPropagation(),p.userGestureTrigEvent("rotateBtnClick")})})}};i.default={name:"s_rotate",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`},function(t,i,r){var n=r(152);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-rotate{position:relative;-webkit-order:10;-moz-box-ordinal-group:11;order:10;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips .xgplayer-tip-rotate{display:block}.xgplayer-skin-default .xgplayer-rotate:hover{opacity:.85}.xgplayer-skin-default .xgplayer-rotate:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-rotate .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-rotate .xgplayer-tips{margin-left:-38px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(154),o=d(u);r(155);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.reload){var e=(0,n.createDom)("xg-reload",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-reload"),s=p.lang.RELOAD_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-reload">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(c){c.preventDefault(),c.stopPropagation(),p.userGestureTrigEvent("reloadBtnClick")})})}};i.default={name:"s_reload",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
    <path fill="#FFF" fill-opacity="1" fill-rule="nonzero" d="M18.17 19.988a7.182 7.182 0 0 1-4.256 1.318 7.806 7.806 0 0 1-.595-.03c-.08-.008-.16-.021-.242-.031a8.004 8.004 0 0 1-.458-.071c-.094-.018-.185-.042-.276-.063a7.743 7.743 0 0 1-.439-.113c-.068-.022-.136-.047-.205-.07a7.03 7.03 0 0 1-.492-.181c-.037-.015-.072-.032-.108-.049a7.295 7.295 0 0 1-.554-.269l-.025-.012a7.347 7.347 0 0 1-2.111-1.753c-.03-.036-.057-.074-.086-.11a7.305 7.305 0 0 1-1.594-4.557h1.686a.123.123 0 0 0 .108-.064.119.119 0 0 0-.006-.125L5.684 9.532a.123.123 0 0 0-.103-.056.123.123 0 0 0-.102.056l-2.834 4.276a.121.121 0 0 0-.005.125c.022.04.064.064.107.064h1.687c0 2.025.627 3.902 1.693 5.454.013.021.022.044.037.066.11.159.233.305.352.455.043.057.085.116.13.171.175.213.36.413.55.61.02.018.036.038.054.055a9.447 9.447 0 0 0 2.91 1.996c.058.026.115.054.175.079.202.084.41.158.619.228.098.034.196.069.296.1.183.054.37.1.558.145.125.029.249.06.376.085.052.01.102.027.155.035.177.032.355.05.533.071.064.007.128.018.19.026.32.03.639.052.956.052a9.46 9.46 0 0 0 5.47-1.746 1.16 1.16 0 0 0 .282-1.608 1.143 1.143 0 0 0-1.6-.283zm5.397-5.991a9.604 9.604 0 0 0-1.685-5.441c-.016-.027-.026-.054-.043-.078-.132-.19-.276-.366-.419-.543-.017-.022-.032-.044-.05-.065a9.467 9.467 0 0 0-3.571-2.7l-.114-.051a11.2 11.2 0 0 0-.673-.248c-.082-.027-.163-.057-.247-.082a9.188 9.188 0 0 0-.6-.156c-.113-.026-.224-.055-.337-.077-.057-.011-.109-.028-.164-.037-.151-.027-.304-.039-.455-.058-.104-.013-.208-.03-.313-.04a10.05 10.05 0 0 0-.759-.039c-.045 0-.09-.007-.136-.007l-.025.003a9.45 9.45 0 0 0-5.46 1.737 1.16 1.16 0 0 0-.284 1.608c.363.523 1.08.65 1.6.284a7.182 7.182 0 0 1 4.222-1.32c.217.002.429.013.639.033.065.007.129.017.193.025.173.021.344.046.513.08.075.014.149.033.221.05.166.037.331.077.494.127l.152.051c.185.061.366.127.545.201l.054.025a7.308 7.308 0 0 1 2.741 2.067l.013.018a7.302 7.302 0 0 1 1.652 4.633h-1.686a.123.123 0 0 0-.108.064.12.12 0 0 0 .006.124l2.834 4.277c.022.033.06.054.103.054.042 0 .08-.021.102-.054l2.833-4.277a.12.12 0 0 0 .005-.124.123.123 0 0 0-.108-.064h-1.685z"/>
</svg>
`},function(t,i,r){var n=r(156);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-reload{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;width:40px;height:40px;cursor:pointer}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips .xgplayer-tip-reload{display:block}.xgplayer-skin-default .xgplayer-reload:hover{opacity:.85}.xgplayer-skin-default .xgplayer-reload:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-reload .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-reload .xgplayer-tips{margin-left:-38px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(158);var u=function(){var d=this;if(!(!d.config.screenShot||d.config.screenShot.hideButton)){var g=d.lang.SCREENSHOT,v=(0,n.createDom)("xg-screenshot",'<p class="name"><span>'+(d.config.screenShot.iconText||g)+"</span></p>",{tabindex:11},"xgplayer-screenshot");d.once("ready",function(){d.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),d.userGestureTrigEvent("screenShotBtnClick")})})}};i.default={name:"s_screenShot",method:u},t.exports=i.default},function(t,i,r){var n=r(159);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-screenshot{-webkit-order:11;-moz-box-ordinal-group:12;order:11;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-screenshot .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-screenshot .name span{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;padding:0 10px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-lang-is-en .xgplayer-screenshot .name span,.xgplayer-lang-is-jp .xgplayer-screenshot .name span{width:75px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(9),u=o(n);r(78);function o(g){return g&&g.__esModule?g:{default:g}}var d=function(){if(!!this.config.nativeTextTrack){var v=this,p=v.root,e=u.default.util,s=e.createDom("xg-texttrack","",{tabindex:7},"xgplayer-texttrack"),l=v.config.nativeTextTrack;l&&Array.isArray(l)&&l.length>0&&(e.addClass(v.root,"xgplayer-is-texttrack"),v.once("canplay",function(){var f=this,c=["<ul>"];c.push("<li class='"+(this.textTrackShowDefault?"":"selected")+"'}'>"+v.lang.OFF+"</li>"),l.forEach(function(w){c.push("<li class='"+(w.default&&f.textTrackShowDefault?"selected":"")+"'>"+w.label+"</li>")});var y=v.lang.TEXTTRACK;c.push('</ul><p class="name">'+y+"</p>");var m=p.querySelector(".xgplayer-texttrack");if(m){m.innerHTML=c.join("");var _=m.querySelector(".name");(!v.config.textTrackActive||v.config.textTrackActive==="hover")&&_.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),e.addClass(p,"xgplayer-texttrack-active"),m.focus()})}else{s.innerHTML=c.join("");var E=s.querySelector(".name");(!v.config.textTrackActive||v.config.textTrackActive==="hover")&&E.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),e.addClass(v.root,"xgplayer-texttrack-active"),s.focus()}),v.controls.appendChild(s)}})),["touchend","click"].forEach(function(f){s.addEventListener(f,function(c){c.preventDefault(),c.stopPropagation();var y=c.target||c.srcElement;if(y&&y.tagName.toLocaleLowerCase()==="li"){Array.prototype.forEach.call(y.parentNode.childNodes,function(_){e.removeClass(_,"selected")}),e.addClass(y,"selected");var m=v.root.getElementsByTagName("Track");y.innerHTML===v.lang.OFF?(m[0].track.mode="hidden",m[0].src="",e.removeClass(v.root,"xgplayer-texttrack-active")):(m[0].style.display="block",e.addClass(v.root,"xgplayer-texttrack-active"),m[0].track.mode="showing",l.some(function(_){if(_.label===y.innerHTML)return m[0].src=_.src,_.kind&&(m[0].kind=_.kind),m[0].label=_.label,_.srclang&&(m[0].srclang=_.srclang),!0}),v.emit("textTrackChange",y.innerHTML))}else v.config.textTrackActive==="click"&&y&&(y.tagName.toLocaleLowerCase()==="p"||y.tagName.toLocaleLowerCase()==="em")&&(e.addClass(v.root,"xgplayer-texttrack-active"),s.focus())},!1)}),v.on("play",function(){var f=p.querySelector(".xgplayer-texttrack ul"),c=p.getElementsByTagName("Track");!v.hls||!f||!c||(c[0].src="",Array.prototype.forEach.call(f.childNodes,function(y){e.hasClass(y,"selected")&&(y.innerHTML===v.lang.OFF?(c[0].track.mode="hidden",c[0].src=""):(c[0].track.mode="hidden",l.some(function(m){if(m.label!==y.innerHTML)return c[0].src=m.src,m.kind&&(c[0].kind=m.kind),c[0].label=m.label,m.srclang&&(c[0].srclang=m.srclang),!0}),l.some(function(m){if(m.label===y.innerHTML)return setTimeout(function(){c[0].src=m.src,m.kind&&(c[0].kind=m.kind),c[0].label=m.label,m.srclang&&(c[0].srclang=m.srclang),c[0].track.mode="showing"}),!0})))}),e.removeClass(v.root,"xgplayer-texttrack-active"))}),s.addEventListener("mouseleave",function(f){f.preventDefault(),f.stopPropagation(),e.removeClass(v.root,"xgplayer-texttrack-active")})}};i.default={name:"s_nativeTextTrack",method:d},t.exports=i.default},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-texttrack{-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-texttrack ul{display:none;list-style:none;min-width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;text-align:center;white-space:nowrap;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-texttrack ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:auto;padding:6px 13px}.xgplayer-skin-default .xgplayer-texttrack ul li.selected,.xgplayer-skin-default .xgplayer-texttrack ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-texttrack .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-texttrack.xgplayer-texttrack-hide{display:none}xg-text-track{transition:bottom .3s ease}.xgplayer-skin-default.xgplayer-is-texttrack .xgplayer-texttrack,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-texttrack ul{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(78);function u(d,g,v,p){if(g.length===0){d.innerHTML="";return}var e=[];e.push('<li data-type="off" class="'+(p?"":"selected")+'">'+v+"</li>"),g.forEach(function(s){e.push("<li data-id="+s.id+" data-language="+s.language+' class="'+(s.isDefault&&p?"selected":"")+'">'+s.label+"</li>")}),d.innerHTML=e.join("")}var o=function(){var g=this;if(!this.config.textTrack)return;var v=this.config.textTrack,p=g.lang.TEXTTRACK,e=(0,n.createDom)("xg-texttrack",'<ul></ul><p class="name">'+p+"</p>",{tabindex:7},"xgplayer-texttrack");function s(){var f=g.root.querySelector(".xgplayer-texttrack");if(!f){g.controls.appendChild(e);var c=e.querySelector(".name");!g.config.textTrackActive||g.config.textTrackActive==="hover"?(c.addEventListener("mouseenter",function(m){m.preventDefault(),m.stopPropagation(),(0,n.addClass)(g.root,"xgplayer-texttrack-active"),e.focus()}),e.addEventListener("mouseleave",function(m){m.preventDefault(),m.stopPropagation(),(0,n.removeClass)(g.root,"xgplayer-texttrack-active")})):c.addEventListener("click",function(m){m.preventDefault(),m.stopPropagation(),(0,n.hasClass)(g.root,"xgplayer-texttrack-active")?(0,n.removeClass)(g.root,"xgplayer-texttrack-active"):(0,n.addClass)(g.root,"xgplayer-texttrack-active")})}["touchend","click"].forEach(function(m){e.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation();var E=_.target||_.srcElement;if(E&&E.tagName.toLocaleLowerCase()==="li"){var w=E.getAttribute("data-id"),k=E.getAttribute("data-type"),x=E.getAttribute("data-language");Array.prototype.forEach.call(E.parentNode.childNodes,function(S){(0,n.removeClass)(S,"selected")}),(0,n.addClass)(E,"selected"),k==="off"?(g.switchOffSubtile(),(0,n.removeClass)(g.root,"xgplayer-texttrack-active")):(g.switchSubTitle({id:w,language:x}),(0,n.addClass)(g.root,"xgplayer-texttrack-active"))}})});var y=e.getElementsByTagName("ul")[0];u(y,v,g.lang.OFF,g.textTrackShowDefault),v.length===0?(0,n.addClass)(e,"xgplayer-texttrack-hide"):(0,n.removeClass)(e,"xgplayer-texttrack-hide")}var l=function(c){if(!!c.isListUpdate){var y=e.getElementsByTagName("ul")[0];v=c.list,u(y,c.list,g.lang.OFF,g.textTrackShowDefault),c.list.length>0?(0,n.addClass)(g.root,"xgplayer-is-texttrack"):(0,n.removeClass)(g.root,"xgplayer-is-texttrack"),c.list.length===0?(0,n.addClass)(e,"xgplayer-texttrack-hide"):(0,n.removeClass)(e,"xgplayer-texttrack-hide")}};v&&Array.isArray(v)&&(v.length>0&&(0,n.addClass)(g.root,"xgplayer-is-texttrack"),g.once("canplay",s),g.on("subtitle_change",l))};i.default={name:"s_textTrack",method:o},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(164);var u=function(){var d=this,g=d.root,v=(0,n.createDom)("xg-error",'<span class="xgplayer-error-text">\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5</span>',{},"xgplayer-error");d.once("ready",function(){g.appendChild(v)});var p=v.querySelector(".xgplayer-error-text");d.config.lang&&d.config.lang==="zh-cn"?p.innerHTML=d.config.errorTips||'\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5':p.innerHTML=d.config.errorTips||'please try to <span class="xgplayer-error-refresh">refresh</span>';var e=null;function s(){(0,n.addClass)(d.root,"xgplayer-is-error"),e=v.querySelector(".xgplayer-error-refresh"),e&&["touchend","click"].forEach(function(f){e.addEventListener(f,function(c){c.preventDefault(),c.stopPropagation(),d.autoplay=!0;var y=d.currentTime;d.once("playing",function(){d.currentTime=y,(0,n.removeClass)(d.root,"xgplayer-is-error")}),d.src=d.config.url})})}d.on("error",s);function l(){d.off("error",s),d.off("destroy",l)}d.once("destroy",l)};i.default={name:"s_error",method:u},t.exports=i.default},function(t,i,r){var n=r(165);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-error{background:#000;display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:125;font-family:PingFangSC-Regular;font-size:14px;color:#fff;text-align:center;line-height:100%;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center}.xgplayer-skin-default .xgplayer-error .xgplayer-error-refresh{color:#fa1f41;padding:0 3px;cursor:pointer}.xgplayer-skin-default .xgplayer-error .xgplayer-error-text{line-height:18px;margin:auto 6px}.xgplayer-skin-default.xgplayer-is-error .xgplayer-error{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(167);var u=function(){var d=this,g=d.config.lastPlayTime||0,v=d.config.lastPlayTimeHideDelay||0,p=null;if(!(g<=0)){p=(0,n.createDom)("xg-memoryplay",'<div class="xgplayer-memoryplay-spot"><div class="xgplayer-progress-tip">\u60A8\u4E0A\u6B21\u89C2\u770B\u5230 <span class="xgplayer-lasttime">'+(0,n.format)(g)+'</span> \uFF0C\u4E3A\u60A8\u81EA\u52A8\u7EED\u64AD <span class="btn-close"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="close" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"></path></svg></span></div></div>',{},"xgplayer-memoryplay"),p.addEventListener("mouseover",function(l){l.stopPropagation()});var e=function(){p&&p.parentNode&&p.parentNode.removeChild(p),p=null};p.querySelector(".xgplayer-progress-tip .btn-close").addEventListener("click",e);var s=function(){v>0&&d.root.appendChild(p),d.emit("memoryPlayStart",g),v>0&&setTimeout(function(){e()},v*1e3)};d.once("playing",s),d.once("ended",e)}};i.default={name:"s_memoryPlay",method:u},t.exports=i.default},function(t,i,r){var n=r(168);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-memoryplay-spot{position:absolute;height:32px;left:10px;bottom:46px;background:rgba(0,0,0,.5);border-radius:32px;line-height:32px;color:#ddd;z-index:15;padding:0 32px 0 16px}.xgplayer-skin-default .xgplayer-memoryplay-spot .xgplayer-lasttime{color:red;font-weight:700}.xgplayer-skin-default .xgplayer-memoryplay-spot .btn-close{position:absolute;width:16px;height:16px;right:10px;top:2px;cursor:pointer;color:#fff;font-size:16px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(170),o=d(u);r(171);function d(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!(!p.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)){var e=(0,n.createDom)("xg-airplay",`<xg-icon class="xgplayer-icon">
    <div class="xgplayer-icon-airplay">`+o.default+`</div>
  </xg-icon>`,{},"xgplayer-airplay"),s=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-airplay">'+p.lang.AIRPLAY_TIPS+"</span>",{},"xgplayer-tips");e.appendChild(s),p.once("ready",function(){p.controls.appendChild(e),p.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(l){switch(l.availability){case"available":e.hidden=!1,e.disabled=!1;break;case"not-available":e.hidden=!0,e.disabled=!0;break}})}),["click","touchend"].forEach(function(l){e.addEventListener(l,function(f){f.preventDefault(),f.stopPropagation(),p.userGestureTrigEvent("airplayBtnClick")})})}};i.default={name:"s_airplay",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default='<svg t="1600422191774" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3100" width="28" height="28"><path d="M256 938.666667h512L512 597.333333 256 938.666667z m170.666667-85.333334l85.333333-113.781333L597.333333 853.333333H426.666667zM853.333333 85.333333H170.666667C99.946667 85.333333 42.666667 142.613333 42.666667 213.333333v426.666667c0 70.72 57.28 128 128 128h106.666666l64-85.333333H170.666667c-23.573333 0-42.666667-19.093333-42.666667-42.666667V213.333333c0-23.573333 19.093333-42.666667 42.666667-42.666666h682.666666c23.573333 0 42.666667 19.093333 42.666667 42.666666v426.666667c0 23.573333-19.093333 42.666667-42.666667 42.666667H682.666667l64 85.333333h106.666666c70.72 0 128-57.28 128-128V213.333333c0-70.72-57.28-128-128-128z" p-id="3101" fill="#ffffff"></path></svg>'},function(t,i,r){var n=r(172);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-airplay{position:relative;-webkit-order:11;-moz-box-ordinal-group:12;order:11;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon{margin-top:6px;margin-left:6px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon .xgplayer-icon-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips .xgplayer-tip-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay:hover{opacity:.85}.xgplayer-skin-default .xgplayer-airplay:hover .xgplayer-tips{display:block}",""])}])})})(po);var Ct=qu(po.exports),go={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},vo={SEEK:"SEEK"},yo={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},mo={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},_o={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},xo={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},Eo={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Bf={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Cr=Object.assign({},yo,mo,_o,xo,Eo,vo,go),bo=[],wo=[];for(var To in Cr)Cr.hasOwnProperty(To)&&bo.push(Cr[To]);for(var So in Cr)Cr.hasOwnProperty(So)&&wo.push(Cr[So]);var Bt={ALLEVENTS:Cr,HLS_EVENTS:Eo,REMUX_EVENTS:_o,DEMUX_EVENTS:mo,MSE_EVENTS:xo,LOADER_EVENTS:yo,FlvAllowedEvents:bo,HlsAllowedEvents:wo,CRYPTO_EVENTS:Bf,PLAYER_EVENTS:vo,BROWSER_EVENTS:go},Ff=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Of(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var If=function(){function h(a){Of(this,h),this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this.end=!1,this.autoclear=a.autoclear||!1,this.logger=a.logger,this.downloadedUrls=[],this._avgSegmentDuration=4}return Ff(h,[{key:"push",value:function(t,i,r,n,u,o){this._ts[t]||(this._ts[t]={duration:i,downloaded:!1,downloading:!1,start:this.duration,discontinue:!!r,id:n,cc:u,isLast:o||!1},this._list[this.duration]=t,this.duration+=i,this.fragLength+=1)}},{key:"deleteFrag",value:function(t){this._ts[t]&&(this._ts[t].start>this._lastget.time&&(this._lastget={duration:this._ts[t].duration,time:this._ts[t].start,downloaded:!1,downloading:!1,url:t,id:this._ts[t].id}),delete this._list[this._ts[t].start],delete this._ts[t],this.fragLength-=1)}},{key:"_calcAvgFrgmentDuration",value:function(t){if(!t.frags)return t.targetduration;var i=t.frags.length;return Math.floor(t.duration/i/1e3)}},{key:"pushM3U8",value:function(t,i){if(!t)throw new Error("No m3u8 data received.");if(this.version=t.version,this.targetduration=t.targetduration,this._avgSegmentDuration=Math.min(this.targetduration,this._calcAvgFrgmentDuration(t)),t.encrypt&&!this.encrypt&&(this.encrypt=t.encrypt),this.end=t.end||!1,t.sequence||(t.sequence=0),t.sequence>this.sequence){var r=t.frags.length;this.logger&&this.logger.log("PLAYLIST","new playlist ["+t.sequence+", "+(t.sequence+r-1)+"]"),this.sequence=t.sequence;for(var n=[],u=0;u<r;u++){var o=t.frags[u];!this._ts[o.url]&&this.downloadedUrls.indexOf(o.url)<0&&(n.push(o.url),this.push(o.url,o.duration,o.discontinue,o.id,o.cc,o.isLast))}if(n.length<1)throw new Error("Can not read ts file list.");if(i)for(var d=this.getTsList(),g=0;g<d.length;g++)n.indexOf(d[g])<0&&this.deleteFrag(d[g])}else throw new Error("Old m3u8 file received, "+t.sequence)}},{key:"getTsList",value:function(){return Object.keys(this._ts)}},{key:"downloaded",value:function(t,i){var r=this._ts[t];r&&(r.downloaded=i)}},{key:"downloading",value:function(t,i){var r=this._ts[t];r&&(r.downloading=i)}},{key:"getTsByName",value:function(t){return this._ts[t]}},{key:"getTs",value:function(t){var i=Object.keys(this._list),r=void 0;if(t===void 0&&(this._lastget?t=this._lastget.time+this._lastget.duration:t=0),!(i.length<1||t>=this.duration)){i=i.sort(function(g,v){return parseFloat(g)-parseFloat(v)});for(var n=0;n<i.length&&t>=parseInt(i[n]);n++){var u=this._list[i[n]],o=this._ts[u].downloaded,d=this._ts[u].downloading;r={url:u,downloaded:o,downloading:d,time:parseInt(i[n]),duration:parseInt(this._ts[u].duration),id:this._ts[u].id,cc:this._ts[u].cc,isLast:this._ts[u].isLast},this.autoclear&&this._lastget&&(delete this._ts[this._lastget.url],delete this._list[this._lastget.time]),this._lastget=r}return r&&this.downloadedUrls.push(r.url),r}}},{key:"getLastDownloadedTs",value:function(){for(var t=Object.keys(this._list).sort(function(d,g){var v=Number(d)-Number(g);return v}),i=void 0,r=0;r<t.length;r++){var n=this._list[t[r]],u=this._ts[n].downloaded,o=this._ts[n].downloading;if(u)i={url:n,downloaded:u,downloading:o,time:parseInt(t[r]),duration:parseInt(this._ts[n].duration)};else break}return i}},{key:"clear",value:function(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0}},{key:"clearDownloaded",value:function(){for(var t=Object.keys(this._ts),i=0,r=t.length;i<r;i++){var n=this._ts[t[i]];n.downloaded=!1,n.downloading=!1}}},{key:"destroy",value:function(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this.autoclear=!1}},{key:"resetSequence",value:function(){this.sequence=-1}},{key:"list",get:function(){return this._list}},{key:"baseURL",set:function(t){this.baseURL!==t&&(this.clear(),this._baseURL=t)},get:function(){return this._baseURL}},{key:"avgSegmentDuration",get:function(){return this._avgSegmentDuration}}]),h}(),Oa=If,Mf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ko(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Nf=function h(){ko(this,h),this.mimetype="",this.init=null,this.data=[],this.bufferDuration=0},zf=function(){function h(){ko(this,h),this.sources={}}return Mf(h,[{key:"getSource",value:function(t){return this.sources[t]}},{key:"createSource",value:function(t){return this.sources[t]=new Nf,this.sources[t]}},{key:"clear",value:function(){this.sources={}}},{key:"destroy",value:function(){this.clear()}}]),h}(),Ao=zf,Vf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Hf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var jf=function(){function h(a){if(Hf(this,h),a instanceof ArrayBuffer)this.buffer=a,this.dataview=new DataView(a),this.dataview.position=0;else throw new Error("data is invalid")}return Vf(h,[{key:"back",value:function(t){this.position-=t}},{key:"getUint8",value:function(t){return this.dataview.getUint8(t)}},{key:"skip",value:function(t){for(var i=Math.floor(t/4),r=t%4,n=0;n<i;n++)h.readByte(this.dataview,4);r>0&&h.readByte(this.dataview,r)}},{key:"readUint8",value:function(){return h.readByte(this.dataview,1)}},{key:"readUint16",value:function(){return h.readByte(this.dataview,2)}},{key:"readUint24",value:function(){return h.readByte(this.dataview,3)}},{key:"readUint32",value:function(){return h.readByte(this.dataview,4)}},{key:"readUint64",value:function(){return h.readByte(this.dataview,8)}},{key:"readInt8",value:function(){return h.readByte(this.dataview,1,!0)}},{key:"readInt16",value:function(){return h.readByte(this.dataview,2,!0)}},{key:"readInt32",value:function(){return h.readByte(this.dataview,4,!0)}},{key:"writeUint32",value:function(t){return new Uint8Array([t>>>24&255,t>>>16&255,t>>>8&255,t&255])}},{key:"length",get:function(){return this.buffer.byteLength}},{key:"position",set:function(t){this.dataview.position=t},get:function(){return this.dataview.position}}],[{key:"readByte",value:function(t,i,r){var n=void 0;switch(i){case 1:r?n=t.getInt8(t.position):n=t.getUint8(t.position);break;case 2:r?n=t.getInt16(t.position):n=t.getUint16(t.position);break;case 3:if(r)throw new Error("not supported for readByte 3");n=t.getUint8(t.position)<<16,n|=t.getUint8(t.position+1)<<8,n|=t.getUint8(t.position+2);break;case 4:r?n=t.getInt32(t.position):n=t.getUint32(t.position);break;case 8:if(r)throw new Error("not supported for readBody 8");n=t.getUint32(t.position)<<32,n|=t.getUint32(t.position+4);break;default:n=""}return t.position+=i,n}}]),h}(),yn=jf,Ia=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Co(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Do(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function Xn(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Ma=function(){function h(){Xn(this,h),this.id=-1,this.sequenceNumber=0,this.samples=[],this.droppedSamples=[],this.length=0}return Ia(h,[{key:"reset",value:function(){this.sequenceNumber=0,this.samples=[],this.length=0}},{key:"destroy",value:function(){this.reset(),this.id=-1}}]),h}(),Na=Ma,Gf=function(h){Do(a,h);function a(){Xn(this,a);var t=Co(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.TAG="AudioTrack",t.type="audio",t}return a}(Ma),$f=function(h){Do(a,h);function a(){Xn(this,a);var t=Co(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.TAG="VideoTrack",t.type="video",t.dropped=0,t.sequenceNumber=0,t}return Ia(a,[{key:"reset",value:function(){this.sequenceNumber=0,this.samples=[],this.length=0,this.dropped=0}}]),a}(Ma);(function(){function h(){Xn(this,h),this.audioTrack=null,this.videoTrack=null}return Ia(h,[{key:"destroy",value:function(){this.audioTrack=null,this.videoTrack=null}}]),h})();var Wf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Yf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Xf=function(){function h(a){Yf(this,h),this.length=a||0,this.historyLen=a||0,this.array=[],this.offset=0}return Wf(h,[{key:"push",value:function(t){this.array.push(t),this.length+=t.byteLength,this.historyLen+=t.byteLength}},{key:"shift",value:function(t){if(this.array.length<1)return new Uint8Array(0);if(t===void 0)return this._shiftBuffer();if(this.offset+t===this.array[0].length){var i=this.array[0].slice(this.offset,this.offset+t);return this.offset=0,this.array.shift(),this.length-=t,i}if(this.offset+t<this.array[0].length){var r=this.array[0].slice(this.offset,this.offset+t);return this.offset+=t,this.length-=t,r}for(var n=new Uint8Array(t),u=0;this.array.length>0&&t>0;)if(this.offset+t<this.array[0].length){var o=this.array[0].slice(this.offset,this.offset+t);n.set(o,u),this.offset+=t,this.length-=t,t=0;break}else{var d=this.array[0].length-this.offset;n.set(this.array[0].slice(this.offset,this.array[0].length),u),this.array.shift(),this.offset=0,u+=d,this.length-=d,t-=d}return n}},{key:"clear",value:function(){this.array=[],this.length=0,this.offset=0}},{key:"destroy",value:function(){this.clear(),this.historyLen=0}},{key:"_shiftBuffer",value:function(){return this.length-=this.array[0].length,this.offset=0,this.array.shift()}},{key:"toInt",value:function(t,i){for(var r=0,n=this.offset+t;n<this.offset+i+t;)n<this.array[0].length?r=r*256+this.array[0][n]:this.array[1]&&(r=r*256+this.array[1][n-this.array[0].length]),n++;return r}}]),h}(),jr=Xf,Ro=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Uo(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Kf=function(){function h(a){Uo(this,h);var t={sampleRate:48e3,channelCount:2,codec:"mp4a.40.2",config:[41,401,136,0],duration:0,id:2,refSampleDuration:21,sampleRateIndex:3,timescale:1e3,type:"audio"};return a?Object.assign({},t,a):t}return Ro(h,[{key:"destroy",value:function(){this.init=null}}]),h}(),Lo=function(){function h(a){Uo(this,h);var t={avcc:null,sps:new Uint8Array(0),pps:new Uint8Array(0),chromaFormat:420,codec:"avc1.640020",codecHeight:720,codecWidth:1280,duration:0,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},id:1,level:"3.2",presentHeight:720,presentWidth:1280,profile:"High",refSampleDuration:40,parRatio:{height:1,width:1},timescale:1e3,type:"video"};return a?Object.assign({},t,a):t}return Ro(h,[{key:"destroy",value:function(){this.init=null,this.sps=null,this.pps=null}}]),h}(),Po=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Bo(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qf=function(){function h(a){Bo(this,h);var t=h.getDefault();return a?Object.assign({},t,a):t}return Po(h,null,[{key:"getDefault",value:function(){return{dts:-1,pts:-1,originDts:-1,data:new Uint8Array}}}]),h}(),Fo=function(){function h(a){Bo(this,h);var t=h.getDefault();if(!a)return t;var i=Object.assign({},t,a);return i}return Po(h,null,[{key:"getDefault",value:function(){return{dts:-1,pts:void 0,isKeyframe:!1,originDts:-1,data:new Uint8Array,nals:[]}}}]),h}(),Zf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Jf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var za=function(a){for(var t in a)if(a.hasOwnProperty(t)&&a[t]===null)return!1;return!0},Qf=function(){function h(){Jf(this,h),this.mimeType=null,this.duration=null,this.hasVideo=!1,this.video={codec:null,width:null,height:null,profile:null,level:null,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},chromaFormat:null,parRatio:{width:1,height:1}},this.hasAudio=!1,this.audio={codec:null,sampleRate:null,sampleRateIndex:null,channelCount:null}}return Zf(h,[{key:"isComplete",value:function(){return h.isBaseInfoReady(this)&&h.isVideoReady(this)&&h.isAudioReady(this)}}],[{key:"isBaseInfoReady",value:function(t){return za(t)}},{key:"isVideoReady",value:function(t){return t.hasVideo?za(t.video):!0}},{key:"isAudioReady",value:function(t){return t.hasAudio?za(t.video):!0}}]),h}(),Oo=Qf,ed=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function td(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var id=function(){ed(h,null,[{key:"getDefault",value:function(){return{id:-1,url:"",start:-1,duration:-1,discontinue:!1,cc:-1}}}]);function h(a){td(this,h);var t=Object.assign({},h.getDefault(),a);this.id=t.id,this.url=t.url,this.start=t.start,this.duration=t.duration,this.discontinue=t.discontinue,this.cc=t.cc}return h}(),rd=id,Io={exports:{}};(function(h){var a=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(d,g,v){this.fn=d,this.context=g,this.once=v||!1}function n(d,g,v,p,e){if(typeof v!="function")throw new TypeError("The listener must be a function");var s=new r(v,p||d,e),l=t?t+g:g;return d._events[l]?d._events[l].fn?d._events[l]=[d._events[l],s]:d._events[l].push(s):(d._events[l]=s,d._eventsCount++),d}function u(d,g){--d._eventsCount==0?d._events=new i:delete d._events[g]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var g=[],v,p;if(this._eventsCount===0)return g;for(p in v=this._events)a.call(v,p)&&g.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(v)):g},o.prototype.listeners=function(g){var v=t?t+g:g,p=this._events[v];if(!p)return[];if(p.fn)return[p.fn];for(var e=0,s=p.length,l=new Array(s);e<s;e++)l[e]=p[e].fn;return l},o.prototype.listenerCount=function(g){var v=t?t+g:g,p=this._events[v];return p?p.fn?1:p.length:0},o.prototype.emit=function(g,v,p,e,s,l){var f=t?t+g:g;if(!this._events[f])return!1;var c=this._events[f],y=arguments.length,m,_;if(c.fn){switch(c.once&&this.removeListener(g,c.fn,void 0,!0),y){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,v),!0;case 3:return c.fn.call(c.context,v,p),!0;case 4:return c.fn.call(c.context,v,p,e),!0;case 5:return c.fn.call(c.context,v,p,e,s),!0;case 6:return c.fn.call(c.context,v,p,e,s,l),!0}for(_=1,m=new Array(y-1);_<y;_++)m[_-1]=arguments[_];c.fn.apply(c.context,m)}else{var E=c.length,w;for(_=0;_<E;_++)switch(c[_].once&&this.removeListener(g,c[_].fn,void 0,!0),y){case 1:c[_].fn.call(c[_].context);break;case 2:c[_].fn.call(c[_].context,v);break;case 3:c[_].fn.call(c[_].context,v,p);break;case 4:c[_].fn.call(c[_].context,v,p,e);break;default:if(!m)for(w=1,m=new Array(y-1);w<y;w++)m[w-1]=arguments[w];c[_].fn.apply(c[_].context,m)}}return!0},o.prototype.on=function(g,v,p){return n(this,g,v,p,!1)},o.prototype.once=function(g,v,p){return n(this,g,v,p,!0)},o.prototype.removeListener=function(g,v,p,e){var s=t?t+g:g;if(!this._events[s])return this;if(!v)return u(this,s),this;var l=this._events[s];if(l.fn)l.fn===v&&(!e||l.once)&&(!p||l.context===p)&&u(this,s);else{for(var f=0,c=[],y=l.length;f<y;f++)(l[f].fn!==v||e&&!l[f].once||p&&l[f].context!==p)&&c.push(l[f]);c.length?this._events[s]=c.length===1?c[0]:c:u(this,s)}return this},o.prototype.removeAllListeners=function(g){var v;return g?(v=t?t+g:g,this._events[v]&&u(this,v)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,h.exports=o})(Io);var Kn=Io.exports,Mo=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},No=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function nd(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function ad(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function zo(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var mn="__TO__",sd=function(){function h(a,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];zo(this,h),this._emitter=new Kn,this._emitter.off||(this._emitter.off=this._emitter.removeListener),this.mediaInfo=new Oo,this._instanceMap={},this._clsMap={},this._inited=!1,this.allowedEvents=i,this._configs=t,this._player=a,this._hooks={}}return No(h,[{key:"getInstance",value:function(t){var i=this._instanceMap[t];return i||null}},{key:"initInstance",value:function(t){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var u=r[0],o=r[1],d=r[2],g=r[3];if(this._clsMap[t]){var v=new this._clsMap[t](u,o,d,g);return this._instanceMap[t]=v,v.init&&v.init(),v}else throw new Error(t+"\u672A\u5728context\u4E2D\u6CE8\u518C")}},{key:"init",value:function(t){if(!this._inited){for(var i in this._clsMap)this._clsMap.hasOwnProperty(i)&&!this._instanceMap[i]&&this.initInstance(i,t);this._inited=!0}}},{key:"registry",value:function(t,i){var r=this,n=this._emitter,u=this._isMessageNameValid.bind(this),o=this,d=function(g){ad(v,g);function v(p,e,s){zo(this,v);var l=nd(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,p,e,s));return l.listeners={},l.onceListeners={},l.TAG=t,l._context=o,l}return No(v,[{key:"on",value:function(e,s){return u(e),this.listeners[e]?this.listeners[e].push(s):this.listeners[e]=[s],n.on(""+e+mn+t,s),n.on(e,s)}},{key:"before",value:function(e,s){u(e),o._hooks[e]?o._hooks[e].push(s):o._hooks[e]=[s]}},{key:"once",value:function(e,s){return u(e),this.onceListeners[e]?this.onceListeners[e].push(s):this.onceListeners[e]=[s],n.once(""+e+mn+t,s),n.once(e,s)}},{key:"emit",value:function(e){u(e);for(var s=o._hooks?o._hooks[e]:null,l=arguments.length,f=Array(l>1?l-1:0),c=1;c<l;c++)f[c-1]=arguments[c];if(s)for(var y=0,m=s.length;y<m;y++){var _=s[y];_.apply(void 0,f)}return n.emit.apply(n,[e].concat(f))}},{key:"emitTo",value:function(e,s){u(s);for(var l=arguments.length,f=Array(l>2?l-2:0),c=2;c<l;c++)f[c-2]=arguments[c];return n.emit.apply(n,[""+s+mn+e].concat(f))}},{key:"off",value:function(e,s){return u(e),n.off(e,s)}},{key:"removeListeners",value:function(){var e=Object.prototype.hasOwnProperty.bind(this.listeners);for(var s in this.listeners)if(e(s))for(var l=this.listeners[s]||[],f=0;f<l.length;f++){var c=l[f];n.off(s,c),n.off(""+s+mn+t,c)}for(var y in this.onceListeners)if(e(y))for(var m=this.onceListeners[y]||[],_=0;_<m.length;_++){var E=m[_];n.off(y,E),n.off(""+y+mn+t,E)}}},{key:"destroy",value:function(){if(this.removeListeners(),this.listeners={},delete o._instanceMap[t],Mo(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this))return Mo(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this);this._context=null}},{key:"_player",get:function(){return this._context?this._context._player:null},set:function(e){this._context&&(this._context._player=e)}},{key:"_pluginConfig",get:function(){return this._context?this._context._configs:null}}]),v}(i);return this._clsMap[t]=d,function(){for(var g=arguments.length,v=Array(g),p=0;p<g;p++)v[p]=arguments[p];return r.initInstance.apply(r,[t].concat(v))}}},{key:"seek",value:function(t){this._emitter.emit(Bt.PLAYER_EVENTS.SEEK,t)}},{key:"destroyInstances",value:function(){var t=this;Object.keys(this._instanceMap).forEach(function(i){t._instanceMap[i].destroy&&t._instanceMap[i].destroy()})}},{key:"destroy",value:function(){this.destroyInstances(),this._emitter&&this._emitter.removeAllListeners(),this._emitter=null,this.allowedEvents=[],this._clsMap=null,this._hooks=null,this._player=null,this._configs=null}},{key:"_isMessageNameValid",value:function(t){if(!this.allowedEvents.indexOf(t)<0)throw new Error("unregistered message name: "+t)}}]),h}(),Va=sd,od=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ld(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Vo=Bt.CRYPTO_EVENTS,ud=function(){function h(a){ld(this,h),this.inputBuffer=a.inputbuffer,this.outputBuffer=a.outputbuffer,this.key=a.key,this.iv=a.iv,this.method=a.method,this.crypto=window.crypto||window.msCrypto}return od(h,[{key:"init",value:function(){this.on(Vo.START_DECRYPTO,this.decrypto.bind(this))}},{key:"decrypto",value:function(){var t=this;if(this.aeskey)this.decryptoData();else{var i=this.crypto.subtle.importKey("raw",this.key.buffer,{name:"AES-CBC"},!1,["encrypt","decrypt"]);i.then(function(r){t.aeskey=r,t.decryptoData()})}}},{key:"decryptoData",value:function(){var t=this,i=this._context.getInstance(this.inputBuffer),r=this._context.getInstance(this.outputBuffer),n=i.shift();n&&this.crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv.buffer},this.aeskey,n).then(function(u){r.push(new Uint8Array(u)),t.emit(Vo.DECRYPTED),t.decryptoData(n)})}}]),h}(),Ha=ud,fd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function dd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ja=Bt.MSE_EVENTS,cd=function(){function h(a,t){dd(this,h),t&&(this._context=t,this.emit=t._emitter.emit.bind(t._emitter)),this.TAG="MSE",this.configs=Object.assign({},a),this.container=this.configs.container,this.format=this.configs.format,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=this.configs.preloadTime||1,this.onSourceOpen=this.onSourceOpen.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onUpdateEnd=this.onUpdateEnd.bind(this),this.onWaiting=this.onWaiting.bind(this),this.opened=!1}return fd(h,[{key:"init",value:function(){this.mediaSource=new self.MediaSource,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen),this._url=null,this.container.addEventListener("timeupdate",this.onTimeUpdate),this.container.addEventListener("waiting",this.onWaiting)}},{key:"resetContext",value:function(t,i){if(this._context=t,this.emit=t._emitter.emit.bind(t._emitter),!i)for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||h.clearBuffer(n)}}},{key:"onTimeUpdate",value:function(){this.emit("TIME_UPDATE",this.container)}},{key:"onWaiting",value:function(){this.emit("WAITING",this.container)}},{key:"onSourceOpen",value:function(){this.opened=!0,this.addSourceBuffers()}},{key:"onUpdateEnd",value:function(){this.emit(ja.SOURCE_UPDATE_END),this.doAppend()}},{key:"addSourceBuffers",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState!=="open"||!this.opened)){var t=this._context.getInstance("PRE_SOURCE_BUFFER"),i=this._context.getInstance("TRACKS"),r=void 0;if(!(!t||!i)){t=t.sources;for(var n=!1,u=0,o=Object.keys(t).length;u<o;u++){var d=Object.keys(t)[u];n=!1,d==="audio"?r=i.audioTrack:d==="video"&&(r=i.videoTrack),r&&t[d].init!==null&&t[d].data.length&&(n=!0)}if(n){if(Object.keys(this.sourceBuffers).length>1)return;for(var g=0,v=Object.keys(t).length;g<v;g++){var p=Object.keys(t)[g];if(!this.sourceBuffers[p]){var e=t[p],s=p==="video"?"video/mp4;codecs="+e.mimetype:"audio/mp4;codecs="+e.mimetype;try{var l=this.mediaSource.addSourceBuffer(s);this.sourceBuffers[p]=l,l.addEventListener("updateend",this.onUpdateEnd)}catch(f){if(f.code===22&&Object.keys(this.sourceBuffers).length>0)return this.emit(ja.MSE_WRONG_TRACK_ADD,p);this.emit(ja.MSE_ERROR,this.TAG,new Error(f.message))}}}Object.keys(this.sourceBuffers).length===this.sourceBufferLen&&this.doAppend()}}}}},{key:"doAppend",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState==="closed")){this._doCleanupSourceBuffer();var t=this._context.getInstance("PRE_SOURCE_BUFFER");if(!!t&&!(Object.keys(this.sourceBuffers).length<this.sourceBufferLen))for(var i=0;i<Object.keys(this.sourceBuffers).length;i++){var r=Object.keys(this.sourceBuffers)[i],n=this.sourceBuffers[r];if(!n.updating){var u=t.sources[r];if(this["no"+r]){u.data=[],u.init.buffer=null;continue}if(u&&!u.inited)try{n.appendBuffer(u.init.buffer.buffer),u.inited=!0}catch(d){}else if(u){var o=u.data.shift();if(o)try{n.appendBuffer(o.buffer.buffer)}catch(d){u.data.unshift(o)}}}}}}},{key:"endOfStream",value:function(){try{var t=this.mediaSource.readyState;t==="open"&&this.mediaSource.endOfStream()}catch(i){}}},{key:"remove",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;try{for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||t>i&&n.remove(i,t)}}catch(u){}}},{key:"_doCleanupSourceBuffer",value:function(){for(var t=this.container.currentTime,i=60*3,r={video:[],audio:[]},n=0;n<Object.keys(this.sourceBuffers).length;n++){for(var u=Object.keys(this.sourceBuffers)[n],o=this.sourceBuffers[u],d=o.buffered,g=!1,v=0;v<d.length;v++){var p=d.start(v),e=d.end(v);if(p<=t&&t<e+3){if(t-p>=i){g=!0;var s=t-i;r[u].push({start:p,end:s})}}else e<t&&t-p>=i&&(g=!0,r[u].push({start:p,end:e}))}g&&!o.updating&&this._doRemoveRanges(r)}}},{key:"_doRemoveRanges",value:function(t){for(var i in t)if(!(!this.sourceBuffers[i]||this.sourceBuffers[i].updating))for(var r=this.sourceBuffers[i],n=t[i];n.length&&!r.updating;){var u=n.shift();try{u&&u.end>u.start&&r.remove(u.start,u.end)}catch(o){}}}},{key:"cleanBuffers",value:function(){for(var t=this,i=[],r=function(o){var d=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]],g=void 0;d.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){d.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(d),d.addEventListener("updateend",function(){v()}))};setTimeout(l,200),d.removeEventListener("updateend",e)};d.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(d),d.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"removeBuffers",value:function(){for(var t=this,i=[],r=function(o){var d=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]];d.removeEventListener("updateend",t.onUpdateEnd);var g=void 0;d.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){d.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(d),d.addEventListener("updateend",function(){v()}))};setTimeout(l,200),d.removeEventListener("updateend",e)};d.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(d),d.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"destroy",value:function(){var t=this;return this.container?(this.container.removeEventListener("timeupdate",this.onTimeUpdate),this.container.removeEventListener("waiting",this.onWaiting),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen),this.removeBuffers().then(function(){for(var i=Object.keys(t.sourceBuffers),r=0;r<i.length;r++){var n=t.sourceBuffers[i[r]];delete t.sourceBuffers[i[r]],t.mediaSource.readyState==="open"&&t.mediaSource.removeSourceBuffer(n)}t.endOfStream();try{window.URL.revokeObjectURL(t.url)}catch(u){}t.url=null,t.configs={},t.container=null,t.mediaSource=null,t.sourceBuffers={},t.preloadTime=1,t.onSourceOpen=null,t.onTimeUpdate=null,t.onUpdateEnd=null,t.onWaiting=null,t.noaudio=void 0,t.novideo=void 0})):Promise.resolve()}},{key:"sourceBufferLen",get:function(){return this._context.mediaInfo?(!!this._context.mediaInfo.hasVideo&&!this.novideo)+(!!this._context.mediaInfo.hasAudio&&!this.noaudio):this.noaudio||this.novideo?1:2}},{key:"url",set:function(t){this._url=t},get:function(){if(!this._url)try{this._url=window.URL.createObjectURL(this.mediaSource)}catch(t){}return this._url}}],[{key:"clearBuffer",value:function(t){try{for(var i=t.buffered,r=.1,n=0,u=i.length;n<u;n++)r=i.end(n);t.remove(0,r)}catch(o){}}}]),h}(),hd=cd,pd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function gd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var vd=function(){function h(){gd(this,h),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0,this._now=Date.now}return pd(h,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0}},{key:"addBytes",value:function(t){var i=this._now()-this._lastCheckpoint;this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=t):i<5e3?this._intervalBytes+=t:(this._lastSamplingBytes=this._intervalBytes/(i/1e3),this._intervalBytes=t,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var t=(this._now()-this._lastCheckpoint)/1e3;return t===0&&(t=1),this._intervalBytes/t/1024}},{key:"lastSamplingKBps",get:function(){return this.addBytes(0),this._lastSamplingBytes!==0?this._lastSamplingBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}}]),h}(),yd=vd,Ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},md=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function _d(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var It=Bt.LOADER_EVENTS,xd=0,Ed=1,bd=2,wd=3,Td=function(){function h(a){_d(this,h),this.configs=Object.assign({},a),this.url=null,this.status=0,this.error=null,this._reader=null,this._canceled=!1,this._destroyed=!1,this.readtype=this.configs.readtype,this.buffer=this.configs.buffer||"LOADER_BUFFER",this._loaderTaskNo=0,this._ttfb=0,this._speed=new yd,window.AbortController&&(this.abortControllerEnabled=!0)}return md(h,[{key:"init",value:function(){this.on(It.LADER_START,this.load.bind(this))}},{key:"fetch",value:function(a){function t(i,r,n){return a.apply(this,arguments)}return t.toString=function(){return a.toString()},t}(function(a,t,i){var r=this,n=null;this.abortControllerEnabled&&(this.abortController=new window.AbortController),Object.assign(t,{signal:this.abortController?this.abortController.signal:void 0});var u=new Date().getTime();return Promise.race([fetch(a,t),new Promise(function(o,d){n=setTimeout(function(){d({code:999,message:"fetch timeout"}),r.abortController&&r.abortController.abort()},i||1e4)})]).then(function(o){n&&(clearTimeout(n),n=null);var d=new Date().getTime();return r.emit(It.LOADER_TTFB,{start:u,end:d,elapsed:d-u}),o})})},{key:"internalLoad",value:function(t,i,r,n){var u=this,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,d=arguments[5];if(!this._destroyed)return this.loading=!0,this.fetch(this.url,i,d).then(function(g){if(!u._destroyed&&u.emit(It.LOADER_RESPONSE_HEADERS,u.TAG,g.headers),g.ok)return u.status=g.status,Promise.resolve().then(function(){u._onFetchResponse(g)}),Promise.resolve(g);r-- >0?u._retryTimer=setTimeout(function(){return u.emit(It.LOADER_RETRY,u.TAG,{response:g,reason:"response not ok",retryTime:n-r}),u.internalLoad(t,i,r,n,o,d)},o):(u.loading=!1,u.emit(It.LOADER_ERROR,u.TAG,{code:g.status||21,message:g.status+" ("+g.statusText+")"}))}).catch(function(g){if(u._destroyed){u.loading=!1;return}if(r-- >0)u._retryTimer=setTimeout(function(){return u.emit(It.LOADER_RETRY,u.TAG,{error:g,reason:"fetch error",retryTime:n-r}),u.internalLoad(t,i,r,n,o,d)},o);else{if(u.loading=!1,g&&g.name==="AbortError")return;u.emit(It.LOADER_ERROR,u.TAG,Object.assign({code:21},g))}})}},{key:"load",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.retryCount,u=r.retryDelay,o=r.loadTimeout;n=n===void 0?3:n,this.url=t,this._canceled=!1;var d=this.getParams(i);return this.internalLoad(t,d,n,n,u,o)}},{key:"_onFetchResponse",value:function(t){var i=this,r=this,n=this._context.getInstance(this.buffer);this._loaderTaskNo++;var u=this._loaderTaskNo;if(t.ok===!0)switch(this.readtype){case bd:t.json().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(It.LOADER_COMPLETE,n)):r.emit(It.LOADER_COMPLETE,o))});break;case Ed:t.text().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(It.LOADER_COMPLETE,n)):r.emit(It.LOADER_COMPLETE,o))});break;case wd:t.arrayBuffer().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(new Uint8Array(o)),i._speed.addBytes(o.byteLength),r.emit(It.LOADER_COMPLETE,n)):r.emit(It.LOADER_COMPLETE,o))}).catch(function(){});break;case xd:default:return this._onReader(t.body.getReader(),u)}}},{key:"_onReader",value:function(t,i){var r=this,n=this._context.getInstance(this.buffer);if(!n&&this._reader||this._destroyed)try{this._reader.cancel()}catch(u){}this._reader=t,this.loading!==!1&&(this._noDataTimer=setTimeout(function(){r.loading!==!1&&r.emit(It.LOADER_COMPLETE)},3e3),this._reader&&this._reader.read().then(function(u){if(clearTimeout(r._noDataTimer),r._canceled||r._destroyed){if(r._reader)try{r._reader.cancel()}catch(o){}return}if(u.done){r.loading=!1,r.status=0,Promise.resolve().then(function(){r.emit(It.LOADER_COMPLETE,n)});return}return n.push(u.value),r._speed.addBytes(u.value.byteLength),Promise.resolve().then(function(){r.emit(It.LOADER_DATALOADED,n)}),r._onReader(t,i)}).catch(function(u){clearTimeout(r._noDataTimer),r.loading=!1,!(u&&u.name==="AbortError")&&r.emit(It.LOADER_ERROR,r.TAG,u)}))}},{key:"getParams",value:function(t){var i=Object.assign({},t),r=new Headers,n={method:"GET",headers:r,mode:"cors",cache:"default"};if(Ho(this.configs.headers)==="object"){var u=this.configs.headers;for(var o in u)u.hasOwnProperty(o)&&r.append(o,u[o])}if(Ho(i.headers)==="object"){var d=i.headers;for(var g in d)d.hasOwnProperty(g)&&r.append(g,d[g])}return i.cors===!1&&(n.mode="same-origin"),i.withCredentials&&(n.credentials="include"),n}},{key:"cancel",value:function(){if(this._reader){try{this._reader.cancel()}catch(t){}this._reader=null,this.loading=!1}clearTimeout(this._noDataTimer),this._canceled=!0,this.abortController&&this.abortController.abort()}},{key:"destroy",value:function(){this._destroyed=!0,clearTimeout(this._retryTimer),clearTimeout(this._noDataTimer),this.cancel(),this._speed.reset()}},{key:"currentSpeed",get:function(){return this._speed.lastSamplingKBps}}],[{key:"isSupported",value:function(){return!!window.fetch}},{key:"type",get:function(){return"loader"}}]),h}(),Ga=Td,Sd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function kd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Oi=Bt.LOADER_EVENTS,ur=Bt.REMUX_EVENTS,fr=Bt.DEMUX_EVENTS,$a=Bt.HLS_EVENTS,jo=Bt.CRYTO_EVENTS,Go=Bt.MSE_EVENTS,Ad="HLS_ERROR",Cd=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,Dd=function(){function h(a){kd(this,h),this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.preloadTime=this.configs.preloadTime,this.container=this.configs.container,this._m3u8lasttime=0,this._timmer=setInterval(this._checkStatus.bind(this),300),this._lastCheck=0,this.m3u8Text=null}return Sd(h,[{key:"init",value:function(){var t=this._player.hlsOps,i=t.XgBuffer,r=t.Tracks,n=t.Playlist,u=t.RemuxedBufferManager,o=t.Compatibility,d=t.FetchLoader,g=t.TsDemuxer,v=t.Mp4Remuxer,p=t.Mse;this._context.registry("M3U8_BUFFER",i),this._context.registry("TS_BUFFER",i),this._context.registry("TRACKS",r),this._playlist=this._context.registry("PLAYLIST",n)({autoclear:!0}),this._context.registry("PRE_SOURCE_BUFFER",u),this._context.registry("COMPATIBILITY",o),this._m3u8loader=this._context.registry("M3U8_LOADER",d)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",d)({buffer:"TS_BUFFER",readtype:3}),this._context.registry("TS_DEMUXER",g)({inputbuffer:"TS_BUFFER"}),this._context.registry("MP4_REMUXER",v),this.mse=this._context.registry("MSE",p)({container:this.container}),this.initEvents()}},{key:"initEvents",value:function(){this.on(Oi.LOADER_COMPLETE,this._onLoadComplete.bind(this)),this.on(Oi.LOADER_RETRY,this._handleFetchRetry.bind(this)),this.on(ur.INIT_SEGMENT,this.mse.addSourceBuffers.bind(this.mse)),this.on(ur.MEDIA_SEGMENT,this.mse.doAppend.bind(this.mse)),this.on(fr.METADATA_PARSED,this._onMetadataParsed.bind(this)),this.on(fr.SEI_PARSED,this._handleSEIParsed.bind(this)),this.on(fr.DEMUX_COMPLETE,this._onDemuxComplete.bind(this)),this.on(Oi.LOADER_ERROR,this._onLoadError.bind(this)),this.on(fr.DEMUX_ERROR,this._onDemuxError.bind(this)),this.on(ur.REMUX_ERROR,this._onRemuxError.bind(this)),this.on(Go.MSE_ERROR,this._handleMseError.bind(this))}},{key:"_onError",value:function(t,i,r,n){var u={code:r.code,errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player.emit(Ad,u)}},{key:"_onDemuxComplete",value:function(){this.emit(ur.REMUX_MEDIA,"ts")}},{key:"_onMetadataParsed",value:function(t){t==="video"&&(this._context.mediaInfo.hasVideo=!0),t==="audio"&&(this._context.mediaInfo.hasAudio=!0),this.emit(ur.REMUX_METADATA,t)}},{key:"_onLoadError",value:function(t,i){!this._tsloader.loading&&!this._m3u8loader.loading&&this.retrytimes>=1?(this.retrytimes--,this._onError(Oi.LOADER_ERROR,t,i,!1)):this.retrytimes<=1&&(this._player.emit("error",{code:i.code,errorType:"network",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(Oi.LOADER_ERROR,t,i,!0),this.emit($a.RETRY_TIME_EXCEEDED),this.mse.endOfStream())}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{code:i.code,errorType:"network",ex:"["+t+"]: "+(i?i.message:""),errd:{}}),this._onError(Oi.LOADER_ERROR,t,i,r)}},{key:"_onRemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(ur.REMUX_ERROR,t,i,r)}},{key:"_handleMseError",value:function(t,i,r){r===void 0&&(r=!1),this._player.emit("error",{errorType:"format",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(Go.MSE_ERROR,t,i,r)}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onLoadComplete",value:function(t){if(t.TAG==="M3U8_BUFFER"){var i=void 0;try{this.m3u8Text=t.shift();var r=Cd.exec(this.m3u8Text);r&&r[2]?this.load(r[2]):i=this._player.hlsOps.M3U8Parser.parse(this.m3u8Text,this.url)}catch(g){this._onError("M3U8_PARSER_ERROR","M3U8_PARSER",g,!1)}if(!i){this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit($a.RETRY_TIME_EXCEEDED),this.mse.endOfStream());return}try{this._playlist.pushM3U8(i,!0)}catch(g){this._onError("M3U8_PARSER_ERROR","PLAYLIST",g,!1)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key){var n=this._player.hlsOps.XgBuffer;this._context.registry("DECRYPT_BUFFER",n)(),this._context.registry("KEY_BUFFER",n)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",Ga)({buffer:"KEY_BUFFER",readtype:3});var u=this._player.config.retry||{},o=u.count,d=u.delay;this.emitTo("KEY_LOADER",Oi.LADER_START,this._playlist.encrypt.uri,{},o,d)}else this._m3u8Loaded(i)}else t.TAG==="TS_BUFFER"?(this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emit(fr.DEMUX_START)):t.TAG==="DECRYPT_BUFFER"?(this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",jo.START_DECRYPT)):t.TAG==="KEY_BUFFER"&&(this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",Ha)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(jo.DECRYPTED,this._onDcripted.bind(this)))}},{key:"_handleFetchRetry",value:function(t,i){this._player.emit("retry",Object.assign({tag:t},i))}},{key:"_onDcripted",value:function(){this.emit(fr.DEMUX_START)}},{key:"_m3u8Loaded",value:function(t){this.preloadTime||(this.preloadTime=this._playlist.targetduration?this._playlist.targetduration:5),this._playlist.fragLength>0&&this._playlist.sequence<t.sequence?this.retrytimes=this.configs.retrytimes||3:this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit($a.RETRY_TIME_EXCEEDED),this.mse.endOfStream())}},{key:"_checkStatus",value:function(){if(!(this.retrytimes<1&&Date.now()-this._lastCheck<4e3))if(this.retrytimes<1&&clearInterval(this._timmer),this._lastCheck=new Date().getTime(),this.container.buffered.length<1)this._preload();else{var t=this.container.currentTime,i=this.container.buffered.start(this.container.buffered.length-1);this.container.readyState<=2&&(t<i?(this.container.currentTime=i,t=i):this._preload());var r=this.container.buffered.end(this.container.buffered.length-1);t<r-this.preloadTime*2&&(this.container.currentTime=r-this.preloadTime),t>r-this.preloadTime&&this._preload()}}},{key:"_preload",value:function(){if(!(this._tsloader.loading||this._m3u8loader.loading)){var t=this._playlist.getTs(),i=this._player.config.retry||{},r=i.count,n=i.delay;if(t&&!t.downloaded&&!t.downloading)this._playlist.downloading(t.url,!0),this.emitTo("TS_LOADER",Oi.LADER_START,t.url,{},r,n);else{var u=this.preloadTime?this.preloadTime:0,o=new Date().getTime();(!t||t.downloaded)&&(o-this._m3u8lasttime)/1e3>u&&(this._m3u8lasttime=o,this.emitTo("M3U8_LOADER",Oi.LADER_START,this.url,{},r,n))}}}},{key:"load",value:function(t){this.url=t,this._preload()}},{key:"destroy",value:function(){clearInterval(this._timmer),this.off(Oi.LOADER_COMPLETE,this._onLoadComplete),this.off(ur.INIT_SEGMENT,this.mse.addSourceBuffers),this.off(ur.MEDIA_SEGMENT,this.mse.doAppend),this.off(fr.METADATA_PARSED,this._onMetadataParsed),this.off(fr.DEMUX_COMPLETE,this._onDemuxComplete),this.mse=null,this.m3u8Text=null}}]),h}(),Rd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ud(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Ld=function(){function h(){Ud(this,h)}return Rd(h,null,[{key:"getSilentFrame",value:function(t,i){if(t==="mp4a.40.2"){if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),h}(),Pd=Ld,Bd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Fd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Od=function(){function h(){Fd(this,h)}return Bd(h,null,[{key:"isHeader",value:function(t,i){return!!(i+1<t.length&&h.isHeaderPattern(t,i))}},{key:"getFrameDuration",value:function(t){return 1024*9e4/t}},{key:"isHeaderPattern",value:function(t,i){return t[i]===255&&(t[i+1]&246)==240}},{key:"getHeaderLength",value:function(t,i){return t[i+1]&1?7:9}},{key:"getFullFrameLength",value:function(t,i){return(t[i+3]&3)<<11|t[i+4]<<3|(t[i+5]&224)>>>5}},{key:"parseFrameHeader",value:function(t,i,r,n,u){var o=void 0,d=void 0,g=void 0,v=t.length;if(o=h.getHeaderLength(t,i),d=h.getFullFrameLength(t,i),d-=o,d>0&&i+o+d<=v)return g=r+n*u,{headerLength:o,frameLength:d,stamp:g}}},{key:"appendFrame",value:function(t,i,r,n,u){var o=h.getFrameDuration(t),d=h.parseFrameHeader(i,r,n,u,o);if(d){var g=d.stamp,v=d.headerLength,p=d.frameLength,e={unit:i.subarray(r+v,r+v+p),pts:g,dts:g};return{sample:e,length:p+v}}}}]),h}(),$o=Od,Id=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Md(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Nd=function(){function h(a){Md(this,h),this.TAG="Golomb",this._buffer=a,this._bufferIndex=0,this._totalBytes=a.byteLength,this._totalBits=a.byteLength*8,this._currentWord=0,this._currentWordBitsLeft=0}return Id(h,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var t=this._totalBytes-this._bufferIndex,i=Math.min(4,t),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+i)),this._currentWord=new DataView(r.buffer).getUint32(0),this._bufferIndex+=i,this._currentWordBitsLeft=i*8}},{key:"readBits",value:function(t){var i=Math.min(this._currentWordBitsLeft,t),r=this._currentWord>>>32-i;if(t>32)throw new Error("Cannot read more than 32 bits at a time");return this._currentWordBitsLeft-=i,this._currentWordBitsLeft>0?this._currentWord<<=i:this._totalBytes-this._bufferIndex>0&&this._fillCurrentWord(),i=t-i,i>0&&this._currentWordBitsLeft?r<<i|this.readBits(i):r}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var t=void 0;for(t=0;t<this._currentWordBitsLeft;t++)if((this._currentWord&2147483648>>>t)!=0)return this._currentWord<<=t,this._currentWordBitsLeft-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()}},{key:"readUEG",value:function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1}},{key:"readSEG",value:function(){var t=this.readUEG();return t&1?t+1>>>1:-1*(t>>>1)}},{key:"readSliceType",value:function(){return this.readByte(),this.readUEG(),this.readUEG()}}]),h}(),zd=Nd,Vd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Hd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var jd=function(){function h(){Hd(this,h)}return Vd(h,null,[{key:"_ebsp2rbsp",value:function(t){for(var i=t,r=i.byteLength,n=new Uint8Array(r),u=0,o=0;o<r;o++)o>=2&&i[o]===3&&i[o-1]===0&&i[o-2]===0||(n[u]=i[o],u++);return new Uint8Array(n.buffer,0,u)}},{key:"parseSPS",value:function(t){var i=h._ebsp2rbsp(t),r=new zd(i);r.readByte();var n=r.readByte();r.readByte();var u=r.readByte();r.readUEG();var o=h.getProfileString(n),d=h.getLevelString(u),g=1,v=420,p=[0,420,422,444],e=8;if((n===100||n===110||n===122||n===244||n===44||n===83||n===86||n===118||n===128||n===138||n===144)&&(g=r.readUEG(),g===3&&r.readBits(1),g<=3&&(v=p[g]),e=r.readUEG()+8,r.readUEG(),r.readBits(1),r.readBool()))for(var s=g!==3?8:12,l=0;l<s;l++)r.readBool()&&(l<6?h._skipScalingList(r,16):h._skipScalingList(r,64));r.readUEG();var f=r.readUEG();if(f===0)r.readUEG();else if(f===1){r.readBits(1),r.readSEG(),r.readSEG();for(var c=r.readUEG(),y=0;y<c;y++)r.readSEG()}r.readUEG(),r.readBits(1);var m=r.readUEG(),_=r.readUEG(),E=r.readBits(1);E===0&&r.readBits(1),r.readBits(1);var w=0,k=0,x=0,S=0,B=r.readBool();B&&(w=r.readUEG(),k=r.readUEG(),x=r.readUEG(),S=r.readUEG());var U=1,R=1,C=0,A=!0,b=0,O=0,W=r.readBool();if(W){if(r.readBool()){var K=r.readByte(),G=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],F=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];K>0&&K<16?(U=G[K-1],R=F[K-1]):K===255&&(U=r.readByte()<<8|r.readByte(),R=r.readByte()<<8|r.readByte())}if(r.readBool()&&r.readBool(),r.readBool()&&(r.readBits(4),r.readBool()&&r.readBits(24)),r.readBool()&&(r.readUEG(),r.readUEG()),r.readBool()){var j=r.readBits(32),N=r.readBits(32);A=r.readBool(),b=N,O=j*2,C=b/O}}var $=1;(U!==1||R!==1)&&($=U/R);var Z=0,te=0;if(g===0)Z=1,te=2-E;else{var ae=g===3?1:2,Ee=g===1?2:1;Z=ae,te=Ee*(2-E)}var Te=(m+1)*16,Ae=(2-E)*((_+1)*16);Te-=(w+k)*Z,Ae-=(x+S)*te;var De=Math.ceil(Te*$);return r.destroy(),r=null,{profile_string:o,level_string:d,bit_depth:e,chroma_format:v,chroma_format_string:h.getChromaFormatString(v),frame_rate:{fixed:A,fps:C,fps_den:O,fps_num:b},par_ratio:{width:U,height:R},codec_size:{width:Te,height:Ae},present_size:{width:De,height:Ae}}}},{key:"_skipScalingList",value:function(t,i){for(var r=8,n=8,u=0,o=0;o<i;o++)n!==0&&(u=t.readSEG(),n=(r+u+256)%256),r=n===0?r:n}},{key:"getProfileString",value:function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(t){return(t/10).toFixed(1)}},{key:"getChromaFormatString",value:function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}},{key:"toVideoMeta",value:function(t){var i={};t&&t.codec_size&&(i.codecWidth=t.codec_size.width,i.codecHeight=t.codec_size.height,i.presentWidth=t.present_size.width,i.presentHeight=t.present_size.height),i.profile=t.profile_string,i.level=t.level_string,i.bitDepth=t.bit_depth,i.chromaFormat=t.chroma_format,i.parRatio={width:t.par_ratio.width,height:t.par_ratio.height},i.frameRate=t.frame_rate;var r=i.frameRate.fps_den,n=i.frameRate.fps_num;return i.refSampleDuration=Math.floor(i.timescale*(r/n)),i}}]),h}(),Gd=jd,$d=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Wd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Yd=function(){function h(){Wd(this,h)}return $d(h,null,[{key:"EBSP2RBSP",value:function(t){return t.filter(function(i,r){return r<2?!0:!(t[r-2]===0&&t[r-1]===0&&i===3)})}},{key:"EBSP2SODB",value:function(t){var i=t[t.byteLength-1];return i&&i===128?t.slice(0,t.byteLength-1):t}}]),h}(),Wo=Yd,Xd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Kd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Yo=function(a){for(var t="",i=0;i<a.byteLength;i++)t+=String.fromCharCode(a[i]);return t},qd=function(){function h(){Kd(this,h)}return Xd(h,null,[{key:"_resolveNalu",value:function(t){return t.length>=1?Wo.EBSP2SODB(Wo.EBSP2RBSP(t.slice(1))):null}},{key:"parse",value:function(t){var i=h._resolveNalu(t),r=h.switchPayloadType(i),n=r.payloadType,u=r.offset,o=i.slice(u);switch(n){case 5:return h.user_data_unregistered(o);default:return{code:n,content:o}}}},{key:"switchPayloadType",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadType:r,offset:n}}},{key:"getPayloadLength",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadLength:r,offset:n}}},{key:"user_data_unregistered",value:function(t){var i=h.getPayloadLength(t),r=i.payloadLength,n=i.offset;if(r<16)return{uuid:"",content:null};var u=t.slice(n),o=Yo(u.slice(0,16)),d=Yo(u.slice(16,r));return{code:5,uuid:o,content:d}}}]),h}(),Zd=qd,Jd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Qd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ec=function(){function h(){Qd(this,h)}return Jd(h,null,[{key:"getNalunits",value:function(t){if(t.length-t.position<4)return[];var i=t.dataview,r=t.position;return i.getInt32(r)===1||i.getInt16(r)===0&&i.getInt8(r+2)===1?h.getAnnexbNals(t):h.getAvccNals(t)}},{key:"getAnnexbNals",value:function(t){for(var i=[],r=h.getHeaderPositionAnnexB(t),n=r.pos,u=n;n<t.length-4;){var o=t.buffer.slice(n,n+r.headerLength);r.pos===t.position&&t.skip(r.headerLength),r=h.getHeaderPositionAnnexB(t),u=r.pos;var d=new Uint8Array(t.buffer.slice(n+o.byteLength,u)),g={header:o,body:d};h.analyseNal(g),g.type<=9&&g.type!==0&&i.push(g),t.skip(u-t.position),n=u}return i}},{key:"getAvccNals",value:function(t){for(var i=[];t.position<t.length-4;){var r=t.dataview.getInt32(t.dataview.position);if(t.length-t.position>=r){var n=t.buffer.slice(t.position,t.position+4);t.skip(4);var u=new Uint8Array(t.buffer.slice(t.position,t.position+r));t.skip(r);var o={header:n,body:u};h.analyseNal(o),o.type<=9&&o.type!==0&&i.push(o)}else break}return i}},{key:"analyseNal",value:function(t){var i=t.body[0]&31;switch(t.type=i,i){case 1:t.ndr=!0;break;case 5:t.idr=!0;break;case 6:try{t.sei=Zd.parse(t.body)}catch(r){}break;case 7:t.sps=Gd.parseSPS(t.body);break;case 8:t.pps=!0;break}}},{key:"getHeaderPositionAnnexB",value:function(t){for(var i=t.position,r=0,n=t.length;r!==3&&r!==4&&i<n-4;)t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:t.dataview.getInt8(i+2)===1?r=3:i++:i++;return i===n-4&&(t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:i=n:(i++,t.dataview.getInt16(i)===0&&t.dataview.getInt8(i)===1?r=3:i=n)),{pos:i,headerLength:r}}},{key:"getAvcc",value:function(t,i){var r=new Uint8Array(t.byteLength+i.byteLength+11);r[0]=1,r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=255,r[5]=225;var n=6;return r.set(new Uint8Array([t.byteLength>>>8&255,t.byteLength&255]),n),n+=2,r.set(t,n),n+=t.byteLength,r[n]=1,n++,r.set(new Uint8Array([i.byteLength>>>8&255,i.byteLength&255]),n),n+=2,r.set(i,n),r}}]),h}(),Xo=ec,tc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ic(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var rc=function(){function h(a){ic(this,h),this.TAG="Golomb",this._buffer=a,this._bufferIndex=0,this._totalBytes=a.byteLength,this._totalBits=a.byteLength*8,this._currentWord=0,this._currentWordBitsLeft=0}return tc(h,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var t=this._totalBytes-this._bufferIndex,i=Math.min(4,t),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+i)),this._currentWord=new DataView(r.buffer).getUint32(0),this._bufferIndex+=i,this._currentWordBitsLeft=i*8}},{key:"readBits",value:function(t){var i=Math.min(this._currentWordBitsLeft,t),r=this._currentWord>>>32-i;if(t>32)throw new Error("Cannot read more than 32 bits at a time");return this._currentWordBitsLeft-=i,this._currentWordBitsLeft>0?this._currentWord<<=i:this._totalBytes-this._bufferIndex>0&&this._fillCurrentWord(),i=t-i,i>0&&this._currentWordBitsLeft?r<<i|this.readBits(i):r}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var t=void 0;for(t=0;t<this._currentWordBitsLeft;t++)if((this._currentWord&2147483648>>>t)!=0)return this._currentWord<<=t,this._currentWordBitsLeft-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()}},{key:"readUEG",value:function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1}},{key:"readSEG",value:function(){var t=this.readUEG();return t&1?t+1>>>1:-1*(t>>>1)}},{key:"readSliceType",value:function(){return this.readByte(),this.readUEG(),this.readUEG()}}]),h}(),nc=rc,ac=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function sc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var oc=function(){function h(){sc(this,h)}return ac(h,null,[{key:"_ebsp2rbsp",value:function(t){for(var i=t,r=i.byteLength,n=new Uint8Array(r),u=0,o=0;o<r;o++)o>=2&&i[o]===3&&i[o-1]===0&&i[o-2]===0||(n[u]=i[o],u++);return new Uint8Array(n.buffer,0,u)}},{key:"parseSPS",value:function(t){var i=h._ebsp2rbsp(t),r=new nc(i),n=0,u=0,o=0,d=0,g=0,v=0,p=0,e=0,s=0,l=0,f=0,c=0,y=0,m=0,_={};return r.readByte(),r.readByte(),r.readBits(4),n=r.readBits(3),r.readBits(1),_=h._readProfileTierLevel(r,n),r.readUEG(),o=r.readUEG(),o===3&&(u=r.readBits(1)),d=r.readUEG(),g=r.readUEG(),l=r.readBits(1),l===1&&(v=r.readUEG(),p=r.readUEG(),e=r.readUEG(),s=r.readUEG()),f=r.readUEG(),c=r.readUEG(),l===1&&(y=(o===1||o===2)&&u===0?2:1,m=o===1&&u===0?2:1,d-=y*p+y*v,g-=m*s+m*e),r.destroy(),r=null,{width:d,height:g,general_profile_space:_.general_profile_space,general_tier_flag:_.general_tier_flag,general_profile_idc:_.general_profile_idc,general_level_idc:_.general_level_idc,chromaFormatIdc:o,bitDepthLumaMinus8:f,bitDepthChromaMinus8:c}}},{key:"_readProfileTierLevel",value:function(t,i){var r=0,n=0,u=0,o=0;r=t.readBits(2)||0,n=t.readBits(1)||0,u=t.readBits(5)||0,t.readBits(16),t.readBits(16),t.readBits(1),t.readBits(1),t.readBits(1),t.readBits(1),t.readBits(16),t.readBits(16),t.readBits(12),o=t.readBits(8)||0;for(var d=[],g=[],v=0;v<i;v++)d[v]=t.readBits(1),g[v]=t.readBits(1);i>0&&t.readBits((8-i)*2);for(var p=0;p<i;p++)d[p]!==0&&(t.readBits(2),t.readBits(1),t.readBits(5),t.readBits(16),t.readBits(16),t.readBits(4),t.readBits(16),t.readBits(16),t.readBits(12)),g[p]!==0&&t.readBits(8);return{general_profile_space:r,general_tier_flag:n,general_profile_idc:u,general_level_idc:o}}},{key:"_skipScalingList",value:function(t,i){for(var r=8,n=8,u=0,o=0;o<i;o++)n!==0&&(u=t.readSEG(),n=(r+u+256)%256),r=n===0?r:n}},{key:"getProfileString",value:function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(t){return(t/10).toFixed(1)}},{key:"getChromaFormatString",value:function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}},{key:"toVideoMeta",value:function(t){var i={};return t&&t.codec_size?(i.codecWidth=t.codec_size.width,i.codecHeight=t.codec_size.height,i.presentWidth=t.present_size.width,i.presentHeight=t.present_size.height):t.width&&t.height&&(i.codecWidth=t.width,i.codecHeight=t.height,i.presentWidth=t.width,i.presentHeight=t.height),i.profile=t.profile_string,i.level=t.level_string,i.bitDepth=t.bit_depth,i.chromaFormat=t.chroma_format,i}}]),h}(),lc=oc,uc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function fc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var dc=function(){function h(){fc(this,h)}return uc(h,null,[{key:"EBSP2RBSP",value:function(t){return t.filter(function(i,r){return r<2?!0:!(t[r-2]===0&&t[r-1]===0&&i===3)})}},{key:"EBSP2SODB",value:function(t){var i=t[t.byteLength-1];return i&&i===128?t.slice(0,t.byteLength-1):t}}]),h}(),Ko=dc,cc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function hc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qo=function(a){for(var t="",i=0;i<a.byteLength;i++)t+=String.fromCharCode(a[i]);return t},pc=function(){function h(){hc(this,h)}return cc(h,null,[{key:"_resolveNalu",value:function(t){return t.length>=1?Ko.EBSP2SODB(Ko.EBSP2RBSP(t.slice(1))):null}},{key:"parse",value:function(t){var i=h._resolveNalu(t),r=h.switchPayloadType(i),n=r.payloadType,u=r.offset,o=i.slice(u);switch(n){case 5:return h.user_data_unregistered(o);default:return{code:n,content:o}}}},{key:"switchPayloadType",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadType:r,offset:n}}},{key:"getPayloadLength",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadLength:r,offset:n}}},{key:"user_data_unregistered",value:function(t){var i=h.getPayloadLength(t),r=i.payloadLength,n=i.offset;if(r<16)return{uuid:"",content:null};var u=t.slice(n),o=qo(u.slice(0,16)),d=qo(u.slice(16,r));return{code:5,uuid:o,content:d}}}]),h}(),Zo=pc,gc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function vc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var yc=function(){function h(){vc(this,h)}return gc(h,null,[{key:"getNalunits",value:function(t){if(t.length-t.position<4)return[];var i=t.dataview,r=t.position;return i.getInt32(r)===1||i.getInt16(r)===0&&i.getInt8(r+2)===1?h.getAnnexbNals(t):h.getHvccNals(t)}},{key:"getAnnexbNals",value:function(t){for(var i=[],r=h.getHeaderPositionAnnexB(t),n=r.pos,u=n;n<t.length-4;){var o=t.buffer.slice(n,n+r.headerLength);r.pos===t.position&&t.skip(r.headerLength),r=h.getHeaderPositionAnnexB(t),u=r.pos;var d=new Uint8Array(t.buffer.slice(n+o.byteLength,u)),g={header:o,body:d};h.analyseNal(g),g.type<=40&&i.push(g),t.skip(u-t.position),n=u}return i}},{key:"getHvccNals",value:function(t){for(var i=[];t.position<t.length-4;){var r=t.dataview.getInt32(t.dataview.position);if(t.length-t.position>=r){var n=t.buffer.slice(t.position,t.position+4);t.skip(4);var u=new Uint8Array(t.buffer.slice(t.position,t.position+r));t.skip(r);var o={header:n,body:u};try{h.analyseNal(o)}catch(d){continue}o.type<=40&&i.push(o)}else break}return i}},{key:"analyseNal",value:function(t){var i=t.body[0]>>>1&63;switch(t.type=i,i){case 0:t.slice_trail_n=!0;break;case 1:t.slice_trail_r=!0,t.key=!0;break;case 2:t.slice_tsa_n=!0;break;case 3:t.slice_tsa_r=!0,t.key=!0;break;case 4:t.slice_stsa_n=!0;break;case 5:t.slice_stsa_r=!0,t.key=!0;break;case 6:t.slice_radl_n=!0;break;case 7:t.slice_radl_r=!0,t.key=!0;break;case 8:t.slice_rasl_n=!0;break;case 9:t.slice_rasl_r=!0,t.key=!0;break;case 16:t.slice_bla_w_lp=!0;break;case 17:t.slice_bla_w_radl=!0;break;case 18:t.slice_bla_n_lp=!0;break;case 19:t.slice_idl_w_radl=!0,t.key=!0;break;case 20:t.slice_idr_n_lp=!0,t.key=!0;break;case 21:t.slice_cra_nut=!0,t.key=!0;break;case 32:t.vps=!0;break;case 33:t.sps=lc.parseSPS(t.body);break;case 34:t.pps=!0;break;case 35:break;case 36:t.aud=!0;break;case 37:t.eob=!0;break;case 38:t.fd=!0;break;case 39:try{t.sei=Zo.parse(t.body.slice(1))}catch(r){}break;case 40:t.sei=Zo.parse(t.body.slice(1));break}}},{key:"getHeaderPositionAnnexB",value:function(t){for(var i=t.position,r=0,n=t.length;r!==3&&r!==4&&i<n-4;)t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:t.dataview.getInt8(i+2)===1?r=3:i++:i++;return i===n-4&&(t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1&&(r=4):(i++,t.dataview.getInt16(i)===0&&t.dataview.getInt8(i)===1?r=3:i=n)),{pos:i,headerLength:r}}}]),h}(),Jo=yc,Qo={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},el={SEEK:"SEEK"},tl={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},il={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},rl={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},nl={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},al={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},mc={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Dr=Object.assign({},tl,il,rl,nl,al,el,Qo),sl=[],ol=[];for(var ll in Dr)Dr.hasOwnProperty(ll)&&sl.push(Dr[ll]);for(var ul in Dr)Dr.hasOwnProperty(ul)&&ol.push(Dr[ul]);var _c={ALLEVENTS:Dr,HLS_EVENTS:al,REMUX_EVENTS:rl,DEMUX_EVENTS:il,MSE_EVENTS:nl,LOADER_EVENTS:tl,FlvAllowedEvents:sl,HlsAllowedEvents:ol,CRYPTO_EVENTS:mc,PLAYER_EVENTS:el,BROWSER_EVENTS:Qo},xc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ec(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function bc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var wc=function(){function h(){var a=this;bc(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,d,g,v,p,e,s){var l;if(!!a._status){var f=r,c=[n,u,o,d,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(Ec(c)))}}})}return xc(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),Kt=new wc,Tc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function fl(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function Sc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ui=_c.REMUX_EVENTS,kc=function(){function h(){var a=this;Sc(this,h),this.TAG="Compatibility",this.nextAudioDts=0,this.nextVideoDts=0,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this.allAudioSamplesCount=0,this.allVideoSamplesCount=0,this._firstAudioSample=null,this._firstVideoSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[],this._lastSegmentId=0,this._currentSegmentId=0,this.videoLastSample=null,this.audioLastSample=null,Object.defineProperties(this,{_videoLargeGap:{set:function(i){a.___videoLargeGap=i,i!==0&&a.emit(ui.DETECT_LARGE_GAP,"video",i)},get:function(){return a.___videoLargeGap||0}},_audioLargeGap:{set:function(i){a.___audioLargeGap=i,i!==0&&a.emit(ui.DETECT_LARGE_GAP,"audio",i)},get:function(){return a.___audioLargeGap||0}}}),this.audioUnsyncTime=0}return Tc(h,[{key:"init",value:function(){this.before(ui.REMUX_MEDIA,this.doFix.bind(this))}},{key:"reset",value:function(){this.nextAudioDts=null,this.nextVideoDts=null,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this._audioLargeGap=0,this._videoLargeGap=0,this.videoLastSample=null,this.audioLastSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[],this.audioUnsyncTime=0}},{key:"_isSegmentsContinuous",value:function(){return this._lastSegmentId===0||this._currentSegmentId-this._lastSegmentId==1}},{key:"doFix",value:function(){var t=void 0,i=void 0,r=void 0,n=0;this.videoTrack.samples.length&&(i=this.videoTrack.samples[0],t=i.options,Kt.long&&Kt.log(this.TAG,this.videoTrack.samples.slice())),this.audioTrack.samples.length&&(r=this.audioTrack.samples[0],Kt.long&&Kt.log(this.TAG,this.audioTrack.samples.slice())),i&&r&&(n=r.dts-i.dts),this._currentSegmentId=t&&t.id||this._currentSegmentId+1,Kt.log(this.TAG,"lastSeg:"+this._lastSegmentId+" , currentSeg:"+this._currentSegmentId+", discontinue:"+(t&&t.discontinue)+" vSamp0:"+(i&&i.dts)+" aSamp0:"+(r&&r.dts));var u=this.getFirstSample(),o=u.isFirstAudioSamples,d=u.isFirstVideoSamples;this.recordSamplesCount(),this._firstVideoSample&&this.fixVideoRefSampleDuration(this.videoTrack.meta,this.videoTrack.samples);var g=h.detectChangeStream(this.videoTrack.samples,d),v=g.changed,p=g.changedIdxes;if(v){for(var e=!1,s=0;s<p.length;s++)this.fixChangeStreamVideo(p[s],d)&&(e=!0);e||this.doFixVideo(d)}else if(!this._isSegmentsContinuous()&&t&&t.start!==void 0){this.videoLastSample=null;var l=t.start;n<0&&(l-=n),Kt.log(this.TAG,"fix video for _isSegmentsContinuous()\uFF0C delta:",n),this.doFixVideo(d,l),this.emit(ui.DETECT_FRAG_ID_DISCONTINUE,t.start/1e3)}else this.doFixVideo(d);this._appendSampleForLastSegment(t&&t.isLast);var f=h.detectChangeStream(this.audioTrack.samples,o),c=f.changed,y=f.changedIdxes;if(c){for(var m=!1,_=0;_<y.length;_++)this.fixChangeStreamAudio(y[_],o)&&(m=!0);if(!m)this.doFixAudio(o);else return}else if(!this._isSegmentsContinuous()&&t&&t.start!==void 0){Kt.log(this.TAG,"fix audio for _isSegmentsContinuous()");var E=this.audioTrack.samples[0];this.nextAudioDts=t.start||E&&E.dts,this.doFixAudio(o,t.start),this.emit(ui.DETECT_FRAG_ID_DISCONTINUE,t.start/1e3)}else this.doFixAudio(o);this.removeInvalidSamples(),this._lastSegmentId=this._currentSegmentId}},{key:"doFixVideo",value:function(t,i){for(var r=this.videoTrack,n=r.samples,u=r.meta,o=n.length,d=0;d<o;d++){var g=n[d];g.originDts=g.dts,g.originPts=g.pts}if(!(!n||!o||!this._firstVideoSample)){var v=n[0];if(Kt.log(this.TAG,"doFixVideo:: lastVideoDts: "+this.lastVideoDts+" ,  _videoLargeGap: "+this._videoLargeGap+" ,streamChangeStart:"+i+", lastVideoSample:[dts="+(this.videoLastSample&&this.videoLastSample.dts)+" , pts="+(this.videoLastSample&&this.videoLastSample.pts)+"] ,  firstDTS:"+v.dts+" ,firstPTS:"+v.pts+" ,lastDTS:"+n[o-1].dts+" , lastPTS: "+n[o-1].pts),!t&&i===void 0&&this.videoLastSample&&h.detectVideoLargeGap(this.videoLastSample?this.videoLastSample.dts:0,v.dts+this._videoLargeGap)&&(this._videoLargeGap=this.videoLastSample.dts+u.refSampleDuration-v.dts),this._videoLargeGap!==0&&(h.doFixLargeGap(n,this._videoLargeGap),this._videoLargeGap!==this.preVideoGap&&(this.preVideoGap=this._videoLargeGap,this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"video",{prevDts:this.videoLastSample&&this.videoLastSample.originDts,curDts:v.originDts}))),!t&&i!==void 0&&i!==0&&(this._videoLargeGap=i-v.dts,h.doFixLargeGap(n,this._videoLargeGap)),t&&this._firstAudioSample){var p=this._firstVideoSample.originDts,e=this._firstAudioSample.dts,s=p-e;if(s>2*u.refSampleDuration&&s<10*u.refSampleDuration){for(var l=Math.floor(s/u.refSampleDuration),f=0;f<l;f++){var c=Object.assign({},v);c.dts=p-(f+1)*u.refSampleDuration,c.pts=c.dts+c.cts,n.unshift(c),this.filledVideoSamples.push({dts:c.dts,size:c.data.byteLength})}this._firstVideoSample=this.filledVideoSamples[0]||this._firstVideoSample}else Math.abs(s)>2*u.refSampleDuration&&!this._videoLargeGap&&(this._videoLargeGap=-1*s,h.doFixLargeGap(n,-1*s))}for(var y=n.length,m=1;m<y;m++){var _=n[m],E=n[m-1],w=_.dts-_.pts;Math.abs(w)<2e3&&Math.abs(_.dts-E.dts)>1e4&&(_.dts=E.dts+u.refSampleDuration,_.pts=E.pts+u.refSampleDuration)}var k=n.pop();if(n.length&&(n[n.length-1].duration=k.dts-n[n.length-1].dts),y<4){var x=n[n.length-1];x=x||k;var S=x.options&&x.options.duration,B=u.refSampleDuration;if(S&&B&&S/B>5)for(var U=x.pts,R=x.dts,C=0;C<3;C++){R+=B,U+=B;var A=Object.assign({},x,{dts:R,pts:U});C===2&&(A.duration=S),n.push(A)}k=null}if(this.videoLastSample){var b=this.videoLastSample;b.duration=v.dts-b.dts,n.unshift(this.videoLastSample)}this.videoLastSample=k,n[n.length-1]&&(this.lastVideoDts=n[n.length-1].dts),this.videoTrack.samples=n}}},{key:"_appendSampleForLastSegment",value:function(t){t&&this.videoLastSample&&this.videoTrack.samples.push(this.videoLastSample)}},{key:"doFixAudio",value:function(t,i){var r=this,n=this.audioTrack,u=n.samples,o=n.meta;if(!(!u||!u.length)){this.fixAudioRefSampleDuration(o);for(var d=0,g=u.length;d<g;d++){var v=u[d];v.originDts=v.dts}var p=u.length,e=Pd.getSilentFrame(o.originCodec,o.channelCount),s=Math.floor(o.refSampleDuration),l=this._firstAudioSample,f=u[0];if(Kt.log(this.TAG,"doFixAudio:: audioDtsBase:"+this.audioDtsBase+" ,  _audioLargeGap: "+this._audioLargeGap+", streamChangeStart:"+i+" ,  nextAudioDts:"+this.nextAudioDts+",  audio: firstDTS:"+f.dts+" ,firstPTS:"+f.pts+" ,lastDTS:"+u[p-1].dts+" , lastPTS: "+u[p-1].pts),!t&&this.nextAudioDts===null&&f.options&&f.options.start&&i!==void 0&&(i=f.options.start),!t&&i===void 0&&this.nextAudioDts&&h.detectAudioLargeGap(this.nextAudioDts||0,f.dts+this._audioLargeGap)){var c=this.nextAudioDts-f.dts;this._audioLargeGap=Math.abs(c-this._videoLargeGap)<200?this._videoLargeGap:c}if(this._audioLargeGap!==0?(h.doFixLargeGap(u,this._audioLargeGap),this._audioLargeGap!==this.preAudioGap&&(this.preAudioGap=this._audioLargeGap,this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"audio",{prevDts:this.lastAudioOriginDts,curDts:f.originDts}))):!t&&(i!==void 0||h.detectAudioLargeGap(this.nextAudioDts,f.dts))&&(i!==void 0&&i!==0&&(this.nextAudioDts=i),this._audioLargeGap=this.nextAudioDts-f.dts,f.options.start&&!f.options.start.isContinue&&h.doFixLargeGap(u,this._audioLargeGap)),this._firstVideoSample&&t){var y=this._firstVideoSample.originDts||this._firstVideoSample.dts,m=l.dts-y;if(m!==this._videoLargeGap)if(m>o.refSampleDuration&&m<10*o.refSampleDuration){var _=Math.floor((l.dts-y)/o.refSampleDuration);Kt.warn(this.TAG,"fill "+_+" frames for av align");for(var E=0;E<_;E++){var w={data:e,datasize:e.byteLength,dts:l.dts-(E+1)*o.refSampleDuration,filtered:0};u.unshift(w),this.filledAudioSamples.push({dts:w.dts,size:w.data.byteLength})}this._firstAudioSample=this.filledAudioSamples[0]||this._firstAudioSample}else m<-1*o.refSampleDuration&&(this._audioLargeGap=-1*m,h.doFixLargeGap(u,-1*m))}var k=void 0,x=u[0].dts;if(this.nextAudioDts){k=x-this.nextAudioDts;var S=Math.abs(k);if(k>=s&&k<1e4&&e){for(var B=Math.ceil(k/s),U=0;U<B;U++){var R=x-(U+1)*s,C={dts:R>this.nextAudioDts?R:this.nextAudioDts,pts:R>this.nextAudioDts?R:this.nextAudioDts,datasize:e.byteLength,filtered:0,data:e};this.filledAudioSamples.push({dts:C.dts,size:C.data.byteLength}),this.audioTrack.samples.unshift(C),f=C}this.emit(ui.DETECT_AUDIO_GAP,k,B)}else S<o.refSampleDuration&&S>0?(f.dts=this.nextAudioDts,f.pts=this.nextAudioDts):k<0&&S<s&&(h.doFixLargeGap(u,-1*k),this.emit(ui.DETECT_AUDIO_OVERLAP,k))}for(var A=u[0].dts+s,b=1;b<u.length;){var O=u[b],W=O.dts-A;if(W<=-1*s){Kt.warn("drop 1 audio sample for "+W+" ms overlap"),u.splice(b,1);continue}if(W>=10*s){var K=Math.round(W/s);if(K>1e3)break;Kt.warn(this.TAG,"inject "+K+" audio frame for "+W+" ms gap, index="+b);for(var G=0;G<K;G++){var F={data:e,datasize:e.byteLength,dts:A,originDts:A,filtered:0};u.splice(b,0,F),A+=s,b++}O.dts=O.pts=O.originDts=A,A+=s,b++}else O.dts=O.pts=O.originDts=A,A+=s,b++}var j=o.refSampleDuration-s;u.forEach(function(Z,te){if(te!==0){var ae=u[te-1];Z.dts=Z.pts=ae.dts+ae.duration}Z.duration=s,r.audioUnsyncTime=r.audioUnsyncTime+j,r.audioUnsyncTime>=1&&(Z.duration+=1,r.audioUnsyncTime-=1)});var N=u[u.length-1];this.lastAudioDts=N.dts;var $=N.duration;this.lastAudioSamplesLen=p,this.nextAudioDts=this.lastAudioDts+($||s),this.lastAudioOriginDts=N.originDts,this.audioTrack.samples=h.sortAudioSamples(u)}}},{key:"fixChangeStreamVideo",value:function(t){Kt.log(this.TAG,"fixChangeStreamVideo(), changeIdx=",t);var i=this.videoTrack.samples,r=t===0?this.lastVideoDts?this.lastVideoDts:this.getStreamChangeStart(i[0]):i[t-1].dts,n=i[t].dts,u=Math.abs(r-n)<=1e4;if(this.emit(ui.DETECT_CHANGE_STREAM,"video",n),u)return i[t].options?i[t].options.isContinue=!0:i[t].options={isContinue:!0},!1;this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"video",{prevDts:r,curDts:n});var o=i.slice(0,t),d=i.slice(t),g=i[t],v=void 0;return this._videoLargeGap=0,this.videoLastSample=null,this.lastVideoDts=null,g.options&&g.options.start!==void 0?v=g.options.start:v=r-this.videoDtsBase,this.videoTrack.samples=i.slice(0,t),this.doFixVideo(!1),this.videoTrack.samples=i.slice(t),this.doFixVideo(!1,v),this.videoTrack.samples=o.concat(d),!0}},{key:"fixChangeStreamAudio",value:function(t){Kt.log(this.TAG,"fixChangeStreamAudio(), changeIdx=",t);var i=this.audioTrack.samples,r=t===0?this.lastAudioDts:i[t-1].dts,n=i[t].dts,u=Math.abs(r-n)<=1e4;if(this.emit(ui.DETECT_CHANGE_STREAM,"audio",n),u)return i[t].options?i[t].options.isContinue=!0:i[t].options={isContinue:!0},!1;this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"audio",{prevDts:r,curDts:n}),this._audioLargeGap=0;var o=this.nextAudioDts;this.nextAudioDts=null;var d=i.slice(0,t),g=i.slice(t),v=i[t],p=void 0;return v.options&&v.options.start!==void 0?p=v.options.start:(p=o,v.options.isContinue=!0),this.audioTrack.samples=d,this.doFixAudio(!1),this.audioTrack.samples=g,this.doFixAudio(!1,p),this.audioTrack.samples=d.concat(g),!0}},{key:"getFirstSample",value:function(){var t=this.videoTrack.samples,i=this.audioTrack.samples,r=!1,n=!1;return!this._firstVideoSample&&t.length&&(this._firstVideoSample=h.findFirstVideoSample(t),this.removeInvalidSamples(),r=!0),!this._firstAudioSample&&i.length&&(this._firstAudioSample=h.findFirstAudioSample(i),this.removeInvalidSamples(),n=!0),{isFirstVideoSamples:r,isFirstAudioSamples:n}}},{key:"fixVideoRefSampleDuration",value:function(t,i){if(!!t){var r=this.allVideoSamplesCount,n=this._firstVideoSample.dts,u=this.filledVideoSamples.length;if(h.isRefSampleDurationValid(t.refSampleDuration)){if(t.refSampleDuration&&i.length>=5){var g=i[i.length-1].dts,v=i[0].dts,p=(g-v)/(i.length-1);if(p>0&&p<1e3){var e=Math.floor(Math.abs(t.refSampleDuration-p)<=5?t.refSampleDuration:p);h.isRefSampleDurationValid(e)&&(t.refSampleDuration=e)}}}else if(i.length>=1){var o=i[i.length-1].dts,d=Math.floor((o-n)/(r+u-1));h.isRefSampleDurationValid(d)&&(t.refSampleDuration=d)}h.isRefSampleDurationValid(t.refSampleDuration)||(t.refSampleDuration=66)}}},{key:"fixAudioRefSampleDuration",value:function(t){!t||(t.refSampleDuration=t.timescale*1024/t.sampleRate)}},{key:"recordSamplesCount",value:function(){var t=this.audioTrack,i=this.videoTrack;this.allAudioSamplesCount+=t.samples.length,this.allVideoSamplesCount+=i.samples.length}},{key:"removeInvalidSamples",value:function(){var t=this.audioTrack.samples[0],i=this.videoTrack.samples[0];t&&(this.audioTrack.samples=this.audioTrack.samples.filter(function(r,n){return r===t?!0:r.dts>=t.dts})),i&&(this.videoTrack.samples=this.videoTrack.samples.filter(function(r,n){return r===i?!0:r.dts>=i.dts}))}},{key:"getStreamChangeStart",value:function(t){return t.options&&t.options.start?t.options.start-this.dtsBase:1/0}},{key:"tracks",get:function(){return this._context.getInstance("TRACKS")}},{key:"audioTrack",get:function(){return this.tracks&&this.tracks.audioTrack?this.tracks.audioTrack:{samples:[],meta:{}}}},{key:"videoTrack",get:function(){return this.tracks&&this.tracks.videoTrack?this.tracks.videoTrack:{samples:[],meta:{}}}},{key:"dtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t?t._dtsBase:0}},{key:"audioDtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t&&t._audioDtsBase!==null?t._audioDtsBase:this.dtsBase}},{key:"videoDtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t&&t._videoDtsBase!==null?t._videoDtsBase:this.dtsBase}}],[{key:"sortAudioSamples",value:function(t){return t.length===1?t:[].concat(fl(t)).sort(function(i,r){return i.dts-r.dts})}},{key:"isRefSampleDurationValid",value:function(t){return t&&t>0&&!Number.isNaN(t)}},{key:"findFirstAudioSample",value:function(t){return!t||t.length===0?null:h.sortAudioSamples(t)[0]}},{key:"findFirstVideoSample",value:function(t){if(!t.length)return null;for(var i=[].concat(fl(t)).sort(function(u,o){return u.dts-o.dts}),r=0,n=i.length;r<n;r++)if(i[r].isKeyframe)return i[r]}},{key:"detectVideoLargeGap",value:function(t,i){if(t!==null){var r=1e3;return t-i>=r||i-t>=r}}},{key:"detectAudioLargeGap",value:function(t,i){if(t!==null)return t-i>=1e3||i-t>=1e3}},{key:"doFixLargeGap",value:function(t,i){for(var r=0,n=t.length;r<n;r++){var u=t[r];u.dts+=i,u.pts&&(u.pts+=i)}var o=t[0];o&&o.dts===0&&(o.dts=o.pts=1)}},{key:"detectChangeStream",value:function(t,i){for(var r=!1,n=[],u=0,o=t.length;u<o;u++){var d=t[u];d.options&&d.options.meta&&!(i&&u===0)&&(r=!0,n.push(u))}return{changed:r,changedIdxes:n}}}]),h}(),dl=kc,cl={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},hl={SEEK:"SEEK"},pl={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},gl={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},vl={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},yl={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},ml={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Ac={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Rr=Object.assign({},pl,gl,vl,yl,ml,hl,cl),_l=[],xl=[];for(var El in Rr)Rr.hasOwnProperty(El)&&_l.push(Rr[El]);for(var bl in Rr)Rr.hasOwnProperty(bl)&&xl.push(Rr[bl]);var Wa={ALLEVENTS:Rr,HLS_EVENTS:ml,REMUX_EVENTS:vl,DEMUX_EVENTS:gl,MSE_EVENTS:yl,LOADER_EVENTS:pl,FlvAllowedEvents:_l,HlsAllowedEvents:xl,CRYPTO_EVENTS:Ac,PLAYER_EVENTS:hl,BROWSER_EVENTS:cl},Cc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Dc(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function Rc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Uc=function(){function h(){var a=this;Rc(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,d,g,v,p,e,s){var l;if(!!a._status){var f=r,c=[n,u,o,d,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(Dc(c)))}}})}return Cc(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),vi=new Uc,Lc=function(){function h(a,t){var i=[],r=!0,n=!1,u=void 0;try{for(var o=a[Symbol.iterator](),d;!(r=(d=o.next()).done)&&(i.push(d.value),!(t&&i.length===t));r=!0);}catch(g){n=!0,u=g}finally{try{!r&&o.return&&o.return()}finally{if(n)throw u}}return i}return function(a,t){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return h(a,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},wl=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Bc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function Fc(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Oc(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var Tl=Xo,Ic=Jo,Mc={1:["video","MPEG-1"],2:["video","MPEG-2"],27:["video","AVC.H264"],36:["video","HVC.H265"],234:["video","VC-1"],3:["audio","MPEG-1"],4:["audio","MPEG-2"],15:["audio","MPEG-2.AAC"],17:["audio","MPEG-4.AAC"],128:["audio","LPCM"],129:["audio","AC3"],6:["audio","AC3"],130:["audio","DTS"],131:["audio","Dolby TrueHD"],132:["audio","AC3-Plus"],133:["audio","DTS-HD"],134:["audio","DTS-MA"],161:["audio","AC3-Plus-SEC"],162:["audio","DTS-HD-SEC"]},Nc=function(h){Oc(a,h),wl(a,null,[{key:"EVENTS",get:function(){return{DEMUX_COMPLETE:"DEMUX_COMPLETE",METADATA_PARSED:"METADATA_PARSED",VIDEO_SAMPLE_PARSED:"VIDEO_SAMPLE_PARSED",AUDIO_SAMPLE_PARSED:"AUDIO_SAMPLES_PARSED",SEI_PARSED:"SEI_PARSED"}}}]);function a(t){var i=t.videoTrack,r=t.audioTrack;Bc(this,a);var n=Fc(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return n.TAG="TsDemuxer",n.demuxing=!1,n.videoTrack=i,n.audioTrack=r,n.pat=[],n.pmt=[],n._hasVideoMeta=!1,n._hasAudioMeta=!1,n.gopId=0,n}return wl(a,[{key:"demux",value:function(i,r,n){if(i&&vi.log(this.TAG,"do demux: id="+i.id+",demuxing="+this.demuxing),!this.demuxing){for(var u={pat:[],pmt:[]},o={};r.length>=188;){if(r.length>=1&&r.array[0][r.offset]!==71)throw new Error("Untrust sync code: "+r.array[0][r.offset]+", try to recover;");for(;r.length>=1&&r.array[0][r.offset]!==71;)r.shift(1);if(!(r.length<188)){var d=r.shift(188),g=new yn(d.buffer),v={};a.read(g,v,u);var p=o[v.header.pid];v.pes?(v.pes.codec=v.header.codec,v.pes.streamType=v.header.streamType,o[v.header.pid]||(o[v.header.pid]=[]),o[v.header.pid].push(v.pes),v.pes.ES.buffer=[v.pes.ES.buffer]):p&&p[p.length-1].ES.buffer.push(v.payload.stream)}}for(var e=Object.assign({},i),s=Object.assign({},i),l=n&&this._hasVideoMeta&&!this._hasAudioMeta,f=n&&this._hasAudioMeta&&!this._hasVideoMeta,c=0;c<Object.keys(o).length;c++)for(var y=o[Object.keys(o)[c]],m=0;m<y.length;m++){var _=y[m];_.id=Object.keys(o)[c];var E=_.streamType===15||_.streamType===17;_.type==="audio"&&!l&&E?(_.ES.buffer=a.mergeAudioES(_.ES.buffer),this.pushAudioSample(_,e),e={}):_.type==="video"&&!f&&(_.ES.buffer=a.mergeVideoES(_.ES.buffer),_.codec==="HVC.H265"?this.pushVideoSampleHEVC(y[m],s):this.pushVideoSample(y[m],s),s={spsFound:!!s.spsFound})}}}},{key:"pushAudioSample",value:function(i,r){var n=new Kf({audioSampleRate:i.ES.frequence,sampleRate:i.ES.frequence,channelCount:i.ES.channel,codec:"mp4a.40."+i.ES.audioObjectType,originCodec:"mp4a.40."+i.ES.originAudioObjectType,originObjectType:i.ES.originAudioObjectType,config:i.ES.audioConfig,id:2,sampleRateIndex:i.ES.frequencyIndex});n.refSampleDuration=Math.floor(1024/n.audioSampleRate*n.timescale);var u=a.compareMeta(this.audioTrack.meta,n,!0);(!this._hasAudioMeta||!u)&&(this._hasAudioMeta=!0,r?r.meta=Object.assign({},n):r={meta:Object.assign({},n)},this.emit(a.EVENTS.METADATA_PARSED,"audio",n));var o=0;i.ES.buffer.skip(i.pesHeaderLength+9);for(var d=!1;i.ES.buffer.position<i.ES.buffer.length;)if($o.isHeader(new Uint8Array(i.ES.buffer.buffer),i.ES.buffer.position)&&i.ES.buffer.position+5<i.ES.buffer.length){var g=$o.appendFrame(this.audioTrack.meta.sampleRate,new Uint8Array(i.ES.buffer.buffer),i.ES.buffer.position,i.pts,o);if(g&&g.sample){i.ES.buffer.skip(g.length);var v=new qf({dts:g.sample.dts,pts:g.sample.pts,data:g.sample.unit,options:d?{}:r});r.meta&&(d=!0),v.dts=v.pts=Math.ceil(v.pts/90),this.emit(a.EVENTS.AUDIO_SAMPLE_PARSED,v),o++}else break}else i.ES.buffer.skip(1)}},{key:"pushVideoSample",value:function(i,r){for(var n=this,u=Tl.getNalunits(i.ES.buffer),o=new Lo,d=r.spsFound,g=0,v=!1,p=!1,e=[],s=0;s<u.length;s++){var l=u[s];if(l.type<9&&!l.sei&&(g+=4+l.body.byteLength),l.sps){v=l,o.sps=l.body,o.chromaFormat=v.sps.chroma_format,o.codec="avc1.";for(var f=1;f<4;f++){var c=v.body[f].toString(16);c.length<2&&(c="0"+c),o.codec+=c}o.codecHeight=v.sps.codec_size.height,o.codecWidth=v.sps.codec_size.width,o.frameRate=v.sps.frame_rate,o.id=1,o.level=v.sps.level_string,o.presentHeight=v.sps.present_size.height,o.presentWidth=v.sps.present_size.width,o.profile=v.sps.profile_string,o.refSampleDuration=Math.floor(o.timescale*(v.sps.frame_rate.fps_den/v.sps.frame_rate.fps_num)),o.sarRatio=v.sps.sar_ratio?v.sps.sar_ratio:v.sps.par_ratio}else l.pps?(o.pps=l.body,p=l):l.sei&&e.push(l.sei)}if(v&&p){o.avcc=Tl.getAvcc(v.body,p.body);var y=a.compareMeta(this.videoTrack.meta,o,!0);(!this._hasVideoMeta||!y)&&(r?r.meta=Object.assign({},o):r={meta:Object.assign({},o)},d||this.emit(a.EVENTS.METADATA_PARSED,"video",o),r.spsFound=!0,this._hasVideoMeta=!0)}for(var m=new Uint8Array(g),_=0,E=!1,w=0;w<u.length;w++){var k=u[w];if(!(k.type&&k.type>=9)){var x=k.body.byteLength;k.idr&&(E=!0),k.sei||(m.set(new Uint8Array([x>>>24&255,x>>>16&255,x>>>8&255,x&255]),_),_+=4,m.set(k.body,_),_+=x)}}var S=parseInt(i.dts/90),B=parseInt(i.pts/90);e.length&&e.forEach(function(R){R.dts=S,n.emit(a.EVENTS.SEI_PARSED,R)});var U=new Fo({dts:S,pts:B,cts:B-S,originDts:i.dts,purePts:i.purePts,isKeyframe:E,data:m,nals:u,options:r,firstInGop:E,gopId:E?++this.gopId:this.gopId});this.emit(a.EVENTS.VIDEO_SAMPLE_PARSED,U)}},{key:"pushVideoSampleHEVC",value:function(i,r){var n=this,u=Ic.getNalunits(i.ES.buffer);u=u.filter(function(A){return A.body&&A.body.length});var o=new Lo;o.streamType=36;for(var d=0,g=!1,v=!1,p=!1,e=[],s=!1,l=!1,f=!1,c=!1,y=0;y<u.length;y++){var m=u[y];if(m.vps){if(s)continue;s=!0}else if(m.sps){if(l)continue;l=!0}else if(m.pps){if(f)continue;f=!0}else if(m.key)(m.type===20||m.type===19)&&(c=!0);else if(m.type!==0){if(m.type===35)continue}m.sps?(v=m,o.sps=m.body,o.presentWidth=v.sps.width,o.presentHeight=v.sps.height,o.general_profile_space=v.sps.general_profile_space,o.general_tier_flag=v.sps.general_tier_flag,o.general_profile_idc=v.sps.general_profile_idc,o.general_level_idc=v.sps.general_level_idc,o.codec="hev1.1.6.L93.B0",o.chromaFormatIdc=v.sps.chromaFormatIdc,o.bitDepthLumaMinus8=v.sps.bitDepthLumaMinus8,o.bitDepthChromaMinus8=v.sps.bitDepthChromaMinus8):m.pps?(o.pps=m.body,p=m):m.vps?(o.vps=m.body,g=m):m.sei&&e.push(m.sei),m.type<=40&&(d+=4+m.body.byteLength)}if(v&&p&&g){var _=a.compareMeta(this.videoTrack.meta,o,!0);(!this._hasVideoMeta||!_)&&(r?r.meta=Object.assign({},o):r={meta:Object.assign({},o)},o.streamType=36,this.videoTrack.meta=o,this._hasVideoMeta=!0,this.emit(a.EVENTS.METADATA_PARSED,"video",o))}var E=new Uint8Array(d),w=0,k=!1;s=!1,l=!1,f=!1;for(var x=0;x<u.length;x++){var S=u[x];if(!(S.type&&S.type>40)){if(S.vps){if(s)continue;s=!0}else if(S.sps){if(l)continue;l=!0}else if(S.pps){if(f)continue;f=!0}else if(!S.key){if(S.type!==0){if(S.type===35)continue}}var B=S.body.byteLength;S.key&&(k=!0),E.set(new Uint8Array([B>>>24&255,B>>>16&255,B>>>8&255,B&255]),w),w+=4,E.set(S.body,w),w+=B}}var U=parseInt(i.dts/90),R=parseInt(i.pts/90);e&&e.forEach(function(A){A.dts=U,n.emit(a.EVENTS.SEI_PARSED,A)});var C=new Fo({dts:U,pts:R,cts:R-U,originDts:i.dts,purePts:i.purePts,isKeyframe:k,data:E,nals:u,options:r,firstInGop:c,gopId:c?++this.gopId:this.gopId});this.emit(a.EVENTS.VIDEO_SAMPLE_PARSED,C)}},{key:"destroy",value:function(){this.removeAllListeners(),this.configs={},this.demuxing=!1,this.pat=[],this.pmt=[],this._hasVideoMeta=!1,this._hasAudioMeta=!1}}],[{key:"compareArray",value:function(i,r,n){var u=0,o=0;if(n==="Uint8Array"?(u=i.byteLength,o=r.byteLength):n==="Array"&&(u=i.length,o=r.length),u!==o)return!1;for(var d=0;d<u;d++)if(i[d]!==r[d])return!1;return!0}},{key:"compareMeta",value:function(i,r,n){if(!i||!r)return!1;for(var u=0,o=Object.keys(i).length;u<o;u++){var d=i[Object.keys(i)[u]],g=r[Object.keys(i)[u]];if(!d&&!g)return!0;if(d==null&&g||d&&g===void 0)return!1;if((typeof d=="undefined"?"undefined":Pc(d))!=="object"){if(n&&Object.keys(i)[u]!=="duration"&&Object.keys(i)[u]!=="refSampleDuration"&&Object.keys(i)[u]!=="refSampleDurationFixed"&&d!==g)return!1}else if(d.byteLength!==void 0){if(g.byteLength===void 0||!a.compareArray(d,g,"Uint8Array"))return!1}else if(d.length!==void 0){if(g.length===void 0||!a.compareArray(d,g,"Array"))return!1}else if(!a.compareMeta(d,g))return!1}return!0}},{key:"mergeVideoES",value:function(i){for(var r=void 0,n=0,u=0,o=0;o<i.length;o++)n+=i[o].length-i[o].position;r=new Uint8Array(n);for(var d=0;d<i.length;d++){var g=i[d];r.set(new Uint8Array(g.buffer,g.position),u),u+=g.length-g.position}return new yn(r.buffer)}},{key:"mergeAudioES",value:function(i){for(var r=void 0,n=0,u=0,o=0;o<i.length;o++)n+=i[o].length;r=new Uint8Array(n);for(var d=0;d<i.length;d++){var g=i[d];r.set(new Uint8Array(g.buffer),u),u+=g.length}return new yn(r.buffer)}},{key:"read",value:function(i,r,n){a.readHeader(i,r),a.readPayload(i,r,n),r.header.packet==="MEDIA"&&r.header.payload===1&&!r.unknownPIDs&&(r.pes=a.PES(r))}},{key:"readPayload",value:function(i,r,n){var u=r.header,o=u.pid;switch(o){case 0:a.PAT(i,r,n);break;case 1:a.CAT(i,r,n);break;case 2:a.TSDT(i,r,n);break;case 8191:break;default:for(var d=!1,g=0,v=n.pat.length;g<v;g++)if(n.pat[g].pid===o){d=!0;break}if(d)a.PMT(i,r,n);else{for(var p=[],e=0,s=n.pmt.length;e<s;e++)if(n.pmt[e].pid===o){p.push(n.pmt[e]);break}if(p.length>0){var l=p[0].streamType;a.Media(i,r,l)}else r.unknownPIDs=!0}}}},{key:"readHeader",value:function(i,r){var n={};n.sync=i.readUint8();var u=i.readUint16();n.error=u>>>15,n.payload=u>>>14&1,n.priority=u>>>13&1,n.pid=u&8191,u=i.readUint8(),n.scrambling=u>>6&3,n.adaptation=u>>4&3,n.continuity=u&15,n.packet=n.pid===0?"PAT":"MEDIA",r.header=n}},{key:"PAT",value:function(i,r,n){var u={},o=i.readUint8();i.skip(o),o=i.readUint8(),u.tabelID=o,o=i.readUint16(),u.error=o>>>7,u.zero=o>>>6&1,u.sectionLength=o&4095,u.streamID=i.readUint16(),u.current=i.readUint8()&1,u.sectionNumber=i.readUint8(),u.lastSectionNumber=i.readUint8();for(var d=(u.sectionLength-9)/4,g=[],v=0;v<d;v++){var p=i.readUint16(),e=i.readUint16()&8191;g.push({program:p,pid:e,type:p===0?"network":"mapPID"})}g.length>0&&(n.pat=n.pat.concat(g)),u.list=g,u.program=i.readUint16(),u.pid=i.readUint16()&8191,r.payload=u}},{key:"PMT",value:function(i,r,n){var u=r.header;u.packet="PMT";var o=i.position;o+=i.getUint8(o),o+=1;var d=(i.getUint8(o+1)&15)<<8|i.getUint8(o+2),g=o+3+d-4,v=(i.getUint8(o+10)&15)<<8|i.getUint8(o+11);o+=12+v;for(var p=[];o<g;){var e=(i.getUint8(o+1)&31)<<8|i.getUint8(o+2);p.push({streamType:i.getUint8(o),pid:e}),o+=((i.getUint8(o+3)&15)<<8|i.getUint8(o+4))+5}n.pmt=p,i.skip(g+4)}},{key:"Media",value:function(i,r,n){var u=r.header,o={},d=Lc(Mc[n],2),g=d[0],v=d[1];if(u.streamType=n,u.type=g,u.codec=v,u.adaptation===3&&(o.adaptationLength=i.readUint8(),o.adaptationLength>0)){var p=i.readUint8();o.discontinue=p>>>7,o.access=p>>>6&1,o.priority=p>>>5&1,o.PCR=p>>>4&1,o.OPCR=p>>>3&1,o.splicePoint=p>>>2&1,o.transportPrivate=p>>>1&1,o.adaptationField=p&1;var e=i.position;if(o.PCR===1&&(o.programClockBase=i.readUint32()<<1,p=i.readUint16(),o.programClockBase|=p>>>15,o.programClockExtension=p&511),o.OPCR===1&&(o.originProgramClockBase=i.readUint32()<<1,p=i.readUint16(),o.originProgramClockBase+=p>>>15,o.originProgramClockExtension=p&511),o.splicePoint===1&&(o.spliceCountdown=i.readUint8()),o.transportPrivate===1)for(var s=i.readUint8(),l=[],f=0;f<s;f++)l.push(i.readUint8());if(o.adaptationField===1){var c=i.readUint8(),y=i.readUint8(),m=i.position,_=y>>>7,E=y>>>6&1,w=y>>>5&1;_===1&&(y=i.readUint16(),o.ltwValid=y>>>15,o.ltwOffset=y&61439),E===1&&(y=i.readUint24(),o.piecewiseRate=y&4194303),w===1&&(y=i.readInt8(),o.spliceType=y>>>4,o.dtsNextAU1=y>>>1&7,o.marker1=y&1,y=i.readUint16(),o.dtsNextAU2=y>>>1,o.marker2=y&1,y=i.readUint16(),o.dtsNextAU3=y),i.skip(c-1-(i.position-m))}var k=o.adaptationLength-1-(i.position-e);i.skip(k)}o.stream=new yn(i.buffer.slice(i.position)),r.payload=o}},{key:"PES",value:function(i){var r={},n=i.payload.stream,u=n.readUint24();if(u!==1)r.ES={},r.ES.buffer=n;else{var o=n.readUint8();o>=224&&o<=239&&(r.type="video"),o>=192&&o<=223&&(r.type="audio");var d=n.readUint16();if(r.packetLength=d,r.type==="video"||r.type==="audio"){var g=n.readUint8(),v=g>>>6;if(v!==2)throw new Error("error when parse pes header");g=n.readUint8(),r.ptsDTSFlag=g>>>6,r.escrFlag=g>>>5&1,r.esRateFlag=g>>>4&1,r.dsmFlag=g>>>3&1,r.additionalFlag=g>>>2&1,r.crcFlag=g>>>1&1,r.extensionFlag=g&1,r.pesHeaderLength=n.readUint8();var p=r.pesHeaderLength,e=[];e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8());var s=(e[0]&14)*536870912+(e[1]&255)*4194304+(e[2]&254)*16384+(e[3]&255)*128+(e[4]&254)/2;if(r.purePts=s,n.dataview.position-=5,e=[],g=n.readUint8(),e.push(g>>>1&7),g=n.readUint16(),e.push(g>>>1),g=n.readUint16(),e.push(g>>>1),r.pts=e[0]<<30|e[1]<<15|e[2],p-=5,r.type==="video"&&(r.dts=r.pts),r.ptsDTSFlag===3){var l=[];g=n.readUint8(),l.push(g>>>1&7),g=n.readUint16(),l.push(g>>>1),g=n.readUint16(),l.push(g>>>1),r.dts=l[0]<<30|l[1]<<15|l[2],p-=5}if(r.escrFlag===1){var f=[],c=[];g=n.readUint8(),f.push(g>>>3&7),f.push(g&3),g=n.readUint16(),f.push(g>>>13),f.push(g&3),g=n.readUint16(),f.push(g>>>13),c.push(g&3),g=n.readUint8(),c.push(g>>>1),r.escr=(f[0]<<30|f[1]<<28|f[2]<<15|f[3]<<13|f[4])*300+(c[0]<<7|c[1]),p-=6}if(r.esRateFlag===1&&(g=n.readUint24(),r.esRate=g>>>1&4194303,p-=3),r.dsmFlag===1)throw new Error("not support DSM_trick_mode");if(r.additionalFlag===1&&(g=n.readUint8(),r.additionalCopyInfo=g&127,p-=1),r.crcFlag===1&&(r.pesCRC=n.readUint16(),p-=2),r.extensionFlag===1)throw new Error("not support extension");p>0&&n.skip(p),r.dts>r.pts&&(r.dts=r.pts),r.ES=a.ES(n,r.type,i.header.streamType)}else throw new Error("format is not supported")}return r}},{key:"ES",value:function(i,r,n){var u={};if(r==="video")u.buffer=i;else if(r==="audio")(n===15||n===17)&&(u=a.parseADTSHeader(i)),u.buffer=i;else throw new Error("ES "+r+" is not supported");return u}},{key:"parseADTSHeader",value:function(i){var r={},n=i.readUint16();if(n>>>4!=4095)throw new Error("aac ES parse Error");var u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r.id=(n>>>3&1)==0?"MPEG-4":"MPEG-2",r.layer=n>>>1&3,r.absent=n&1,n=i.readUint16(),r.audioObjectType=(n>>>14&3)+1,r.profile=r.audioObjectType-1,r.frequencyIndex=n>>>10&15,r.frequence=u[r.frequencyIndex],r.channel=n>>>6&7,r.frameLength=(n&3)<<11|i.readUint16()>>>5,a.getAudioConfig(r),i.skip(1),r.buffer=i,r}},{key:"TSDT",value:function(i,r,n){r.payload={}}},{key:"CAT",value:function(i,r,n){var u={};u.tableID=i.readUint8();var o=i.readUint16();u.sectionIndicator=o>>>7,u.sectionLength=o&4095,i.skip(2),o=i.readUint8(),u.version=o>>>3,u.currentNextIndicator=o&1,u.sectionNumber=i.readUint8(),u.lastSectionNumber=i.readUint8(),(this.sectionLength-9)/4,u.crc32=i.readUint32(),r.payload=u}},{key:"getAudioConfig",value:function(i){var r=navigator.userAgent.toLowerCase(),n=void 0,u=void 0;i.originAudioObjectType=i.audioObjectType,/firefox/i.test(r)?i.frequencyIndex>=8?(i.audioObjectType=5,n=new Array(4),u=i.frequencyIndex-3):(i.audioObjectType=2,n=new Array(2),u=i.frequencyIndex):r.indexOf("android")!==-1?(i.audioObjectType=2,n=new Array(2),u=i.frequencyIndex):(i.audioObjectType=5,n=new Array(4),i.frequencyIndex>=6?u=i.frequencyIndex-3:(i.channel===1&&(i.audioObjectType=2,n=new Array(2)),u=i.frequencyIndex)),n[0]=i.audioObjectType<<3,n[0]|=(i.frequencyIndex&14)>>1,n[1]=(i.frequencyIndex&1)<<7,n[1]|=i.channel<<3,i.audioObjectType===5&&(n[1]|=(u&14)>>1,n[2]=(u&1)<<7,n[2]|=2<<2,n[3]=0),i.audioConfig=n}}]),a}(Kn),_n=Nc,zc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Vc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Ur=Wa.DEMUX_EVENTS,Hc=function(){function h(a){Vc(this,h),this.configs=Object.assign({},a),this.demuxer=null}return zc(h,[{key:"init",value:function(){this.on(Ur.DEMUX_START,this.demux.bind(this))}},{key:"initDemuxer",value:function(){this.demuxer.on(_n.EVENTS.METADATA_PARSED,this.onMetaDataParsed.bind(this)),this.demuxer.on(_n.EVENTS.VIDEO_SAMPLE_PARSED,this.onVideoSampleParsed.bind(this)),this.demuxer.on(_n.EVENTS.AUDIO_SAMPLE_PARSED,this.onAudioSampleParsed.bind(this)),this.demuxer.on(_n.EVENTS.SEI_PARSED,this.emit.bind(this,Ur.SEI_PARSED))}},{key:"demux",value:function(t,i){if(!!this._tracks){this._tracks.audioTrack||(this._tracks.audioTrack=new Gf),this._tracks.videoTrack||(this._tracks.videoTrack=new $f),this.demuxer||(this.demuxer=new _n(this._tracks),this.initDemuxer());try{this.demuxer.demux(t,this.inputBuffer,i)}catch(u){this.emit(Ur.DEMUX_ERROR,this.TAG,u,!1)}var r=this._tracks.videoTrack&&this._tracks.videoTrack.samples.length?1:0,n=this._tracks.audioTrack&&this._tracks.audioTrack.samples.length?1:0;this.emit(Ur.DEMUX_COMPLETE,r,n)}}},{key:"onMetaDataParsed",value:function(t,i){var r=this._tracks,n=r.videoTrack,u=r.audioTrack,o=n;switch(t){case"video":o=n;break;case"audio":o=u;break;default:o=n}o.meta=i,this.emit(Ur.METADATA_PARSED,t,i)}},{key:"onVideoSampleParsed",value:function(t){t.isKeyframe&&this.emit(Ur.ISKEYFRAME,t.pts),this._tracks.videoTrack.samples.push(t)}},{key:"onAudioSampleParsed",value:function(t){this._tracks.audioTrack.samples.push(t)}},{key:"destroy",value:function(){this.off(Ur.DEMUX_START,this.demux),this.configs={},this.demuxer&&this.demuxer.destroy()}},{key:"inputBuffer",get:function(){return this._context.getInstance(this.configs.inputbuffer)}},{key:"_tracks",get:function(){return this._context.getInstance("TRACKS")}}]),h}(),Ya=Hc,jc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Gc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var $c=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,Wc=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function Yc(h,a){if(!a||!h||$c.test(h))return h;var t=Wc.exec(a);return t?h[0]==="/"?t[1]+h:t[1]+t[2]+h:h}var Xc=function(){function h(){Gc(this,h)}return jc(h,null,[{key:"parse",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r={duration:0};if(!(!t||!t.split)){var n=t.split(/\r|\n/);n=n.filter(function(e){return e});var u=n.shift();if(!u.match("#EXTM3U"))throw new Error('Invalid m3u8 file: not "#EXTM3U"');u=n.shift();for(var o=!1,d=0;u;){var g=u.match(/#(.[A-Z|-]*):(.*)/),v=u.match(/#(.[A-Z|-]*)/);if(v&&g&&g.length>2)switch(g[1]){case"EXT-X-VERSION":r.version=parseInt(g[2]);break;case"EXT-X-MEDIA-SEQUENCE":r.sequence=parseInt(g[2]);break;case"EXT-X-TARGETDURATION":r.targetduration=parseFloat(g[2]);break;case"EXTINF":d=h.parseFrag(g,n,r,i,o,d),o=!1;break;case"EXT-X-KEY":h.parseDecrypt(g[2],r);break}if(v&&v.length>1)switch(v[1]){case"EXT-X-DISCONTINUITY":o=!0;break;case"EXT-X-ENDLIST":var p=r.frags[r.frags.length-1];p.isLast=!0,r.end=!0;break}u=n[d++]}return r}}},{key:"parseFrag",value:function(t,i,r,n,u,o){r.frags||(r.frags=[]);var d=new rd({start:r.duration,duration:parseInt(parseFloat(t[2])*1e3)});if(d.duration<200)return o;r.duration+=d.duration;var g=i[o++];if((g.match(/#(.*):(.*)/)||g.match(/^#/))&&(g=i[o++]),d.url=Yc(g,n),d.discontinue=u,r.frags.length){var v=r.frags[r.frags.length-1];d.id=v.id+1,d.cc=u?v.cc+1:v.cc}else d.id=r.sequence||1,d.cc=0;return r.frags.push(d),o}},{key:"parseDecrypt",value:function(t,i){i.encrypt={};var r=t.split(",");for(var n in r){var u=r[n];if(u.match(/METHOD=(.*)/)&&(i.encrypt.method=u.match(/METHOD=(.*)/)[1]),u.match(/URI="(.*)"/)&&(i.encrypt.uri=u.match(/URI="(.*)"/)[1]),u.match(/IV=0x(.*)/)){var o=u.match(/IV=0x(.*)/)[1],d=Math.ceil(o.length/2);i.encrypt.ivb=new Uint8Array(d);for(var g=d-1;g>=0;g--){var v=parseInt(o.substr(g*2,2),16);i.encrypt.ivb[g]=v}i.encrypt.iv=o}}}},{key:"isHTTPS",value:function(t){var i=/^https:\/\//i;return i.test(t)}}]),h}(),Xa=Xc,Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});Ka.default=function(h){for(var a=0,t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];var n=!0,u=!1,o=void 0;try{for(var d=i[Symbol.iterator](),g;!(n=(g=d.next()).done);n=!0){var v=g.value;a+=v.length}}catch(_){u=!0,o=_}finally{try{!n&&d.return&&d.return()}finally{if(u)throw o}}var p=new h(a),e=0,s=!0,l=!1,f=void 0;try{for(var c=i[Symbol.iterator](),y;!(s=(y=c.next()).done);s=!0){var m=y.value;p.set(m,e),e+=m.length}}catch(_){l=!0,f=_}finally{try{!s&&c.return&&c.return()}finally{if(l)throw f}}return p};var Kc=Ka,qc=Zc(Kc);function Zc(h){return h&&h.__esModule?h:{default:h}}var Jc=qc.default,Qc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function eh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var th=function(){function h(a){eh(this,h),this.buffer=a||new Uint8Array(0)}return Qc(h,[{key:"write",value:function(){for(var t=this,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];r.forEach(function(u){t.buffer=Jc(Uint8Array,t.buffer,u)})}}],[{key:"writeUint32",value:function(t){return new Uint8Array([t>>24,t>>16&255,t>>8&255,t&255])}},{key:"readAsInt",value:function(t){var i="";function r(n){var u=n.toString(16);return u.padStart(2,"0")}return t.forEach(function(n){i+=r(n)}),parseInt(i,16)}}]),h}(),Dt=th,ih=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function rh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qa=function(){function h(){rh(this,h)}return ih(h,null,[{key:"size",value:function(t){return Dt.writeUint32(t)}},{key:"initBox",value:function(t,i){for(var r=new Dt,n=arguments.length,u=Array(n>2?n-2:0),o=2;o<n;o++)u[o-2]=arguments[o];return r.write.apply(r,[h.size(t),h.type(i)].concat(u)),r.buffer}},{key:"extension",value:function(t,i){return new Uint8Array([t,i>>16&255,i>>8&255,i&255])}},{key:"ftyp",value:function(){return h.initBox(24,"ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))}},{key:"ftypHEVC",value:function(){return h.initBox(24,"ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,100,97,115,104]))}},{key:"moov",value:function(t){var i=t.type,r=t.meta,n=8,u=h.mvhd(r.duration,r.timescale),o=void 0;i==="video"?o=h.videoTrak(r):o=h.audioTrak(r);var d=h.mvex(r.duration,r.timescale||1e3,r.id);return[u,o,d].forEach(function(g){n+=g.byteLength}),h.initBox(n,"moov",u,o,d)}},{key:"mvhd",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h.initBox(8+r.length,"mvhd",new Uint8Array(r))}},{key:"videoTrak",value:function(t){var i=8,r=h.tkhd({id:1,duration:t.duration,timescale:t.timescale||1e3,width:t.presentWidth,height:t.presentHeight,type:"video"}),n=h.mdia({type:"video",timescale:t.timescale||1e3,duration:t.duration,avcc:t.avcc,parRatio:t.parRatio,width:t.presentWidth,height:t.presentHeight,streamType:t.streamType});return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"trak",r,n)}},{key:"audioTrak",value:function(t){var i=8,r=h.tkhd({id:2,duration:t.duration,timescale:t.timescale||1e3,width:0,height:0,type:"audio"}),n=h.mdia({type:"audio",timescale:t.timescale||1e3,duration:t.duration,channelCount:t.channelCount,samplerate:t.sampleRate,config:t.config});return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"trak",r,n)}},{key:"tkhd",value:function(t){var i=t.id,r=t.duration,n=t.width,u=t.height,o=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,n&255,0,0,u>>>8&255,u&255,0,0]);return h.initBox(8+o.byteLength,"tkhd",o)}},{key:"edts",value:function(t){var i=new Dt,r=t.duration,n=t.mediaTime;return i.write(h.size(36),h.type("edts")),i.write(h.size(28),h.type("elst")),i.write(new Uint8Array([0,0,0,1,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,1])),i.buffer}},{key:"mdia",value:function(t){var i=8,r=h.mdhd(t.timescale,t.duration),n=h.hdlr(t.type),u=h.minf(t);return[r,n,u].forEach(function(o){i+=o.byteLength}),h.initBox(i,"mdia",r,n,u)}},{key:"mdhd",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1e3,i=arguments[1],r=new Uint8Array([0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255,85,196,0,0]);return h.initBox(12+r.byteLength,"mdhd",h.extension(0,0),r)}},{key:"hdlr",value:function(t){var i=[0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0];return t==="audio"&&(i.splice.apply(i,[8,4].concat([115,111,117,110])),i.splice.apply(i,[24,13].concat([83,111,117,110,100,72,97,110,100,108,101,114,0]))),h.initBox(8+i.length,"hdlr",new Uint8Array(i))}},{key:"minf",value:function(t){var i=8,r=t.type==="video"?h.vmhd():h.smhd(),n=h.dinf(),u=h.stbl(t);return[r,n,u].forEach(function(o){i+=o.byteLength}),h.initBox(i,"minf",r,n,u)}},{key:"vmhd",value:function(){return h.initBox(20,"vmhd",new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))}},{key:"smhd",value:function(){return h.initBox(16,"smhd",new Uint8Array([0,0,0,0,0,0,0,0]))}},{key:"dinf",value:function(){var t=new Dt,i=[0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1];return t.write(h.size(36),h.type("dinf"),h.size(28),h.type("dref"),new Uint8Array(i)),t.buffer}},{key:"stbl",value:function(t){var i=8,r=h.stsd(t),n=h.stts(),u=h.stsc(),o=h.stsz(),d=h.stco();return[r,n,u,o,d].forEach(function(g){i+=g.byteLength}),h.initBox(i,"stbl",r,n,u,o,d)}},{key:"stsd",value:function(t){var i=void 0;return t.type==="audio"?i=h.mp4a(t):t.streamType===36?i=h.hvc1(t):i=h.avc1(t),h.initBox(16+i.byteLength,"stsd",h.extension(0,0),new Uint8Array([0,0,0,1]),i)}},{key:"mp4a",value:function(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.samplerate>>8&255,t.samplerate&255,0,0]),r=h.esds(t.config);return h.initBox(8+i.byteLength+r.byteLength,"mp4a",i,r)}},{key:"esds",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[43,146,8,0],i=t.length,r=new Dt,n=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(t).concat([6,1,2]));return r.write(h.size(8+n.byteLength),h.type("esds"),n),r.buffer}},{key:"avc1",value:function(t){var i=new Dt,r=40,n=t.width,u=t.height,o=t.parRatio.width,d=t.parRatio.height,g=t.avcc,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,n&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p=new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]),e=new Uint8Array([o>>24,o>>16&255,o>>8&255,o&255,d>>24,d>>16&255,d>>8&255,d&255]);return i.write(h.size(r+v.byteLength+g.byteLength+p.byteLength),h.type("avc1"),v,h.size(8+g.byteLength),h.type("avcC"),g,h.size(20),h.type("btrt"),p,h.size(16),h.type("pasp"),e),i.buffer}},{key:"hvc1",value:function(t){var i=new Dt,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,t.width&255,t.height>>8&255,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255,0,0,0,122,104,118,99,67,1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64]);return i.write(h.size(8+r.byteLength+10),h.type("hvc1"),r,h.size(10),h.type("fiel"),new Uint8Array([1,0])),i.buffer}},{key:"stts",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stts",t)}},{key:"stsc",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stsc",t)}},{key:"stco",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stco",t)}},{key:"stsz",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);return h.initBox(20,"stsz",t)}},{key:"mvex",value:function(t){var i=arguments[2],r=new Dt,n=Dt.writeUint32(t);return r.write(h.size(56),h.type("mvex"),h.size(16),h.type("mehd"),h.extension(0,0),n,h.trex(i)),r.buffer}},{key:"trex",value:function(t){var i=new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.initBox(8+i.byteLength,"trex",i)}},{key:"moof",value:function(t){var i=8,r=h.mfhd(),n=h.traf(t);return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"moof",r,n)}},{key:"mfhd",value:function(){var t=Dt.writeUint32(h.sequence);return h.sequence+=1,h.initBox(16,"mfhd",h.extension(0,0),t)}},{key:"traf",value:function(t){var i=8,r=h.tfhd(t.id),n=h.tfdt(t.time),u=h.sdtp(t),o=h.trun(t,u.byteLength);return[r,n,o,u].forEach(function(d){i+=d.byteLength}),h.initBox(i,"traf",r,n,o,u)}},{key:"tfhd",value:function(t){var i=Dt.writeUint32(t);return h.initBox(16,"tfhd",h.extension(0,0),i)}},{key:"tfdt",value:function(t){return h.initBox(16,"tfdt",h.extension(0,0),Dt.writeUint32(t))}},{key:"trun",value:function(t,i){var r=new Dt,n=Dt.writeUint32(t.samples.length),u=Dt.writeUint32(8+8+16+8+16+16+12+4+4+16*t.samples.length+i);return r.write(h.size(20+16*t.samples.length),h.type("trun"),new Uint8Array([0,0,15,1]),n,u),t.samples.forEach(function(o){var d=o.flags;r.write(new Uint8Array([o.duration>>>24&255,o.duration>>>16&255,o.duration>>>8&255,o.duration&255,o.size>>>24&255,o.size>>>16&255,o.size>>>8&255,o.size&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.isNonSync,0,0,o.cts>>>24&255,o.cts>>>16&255,o.cts>>>8&255,o.cts&255]))}),r.buffer}},{key:"sdtp",value:function(t){var i=new Dt;return i.write(h.size(12+t.samples.length),h.type("sdtp"),h.extension(0,0)),t.samples.forEach(function(r){var n=r.flags,u=n.isLeading<<6|n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;i.write(new Uint8Array([u]))}),i.buffer}},{key:"mdat",value:function(t){var i=new Dt,r=8;t.samples.forEach(function(o){r+=o.size}),i.write(h.size(r),h.type("mdat"));var n=new Uint8Array(r),u=0;return n.set(i.buffer,u),u+=8,t.samples.forEach(function(o){o.buffer.forEach(function(d){n.set(d,u),u+=d.byteLength})}),n}}]),h}();qa.type=function(h){return new Uint8Array([h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)])};qa.sequence=1;var Lr=qa,nh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ah(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function sh(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function oh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var lh=function(h){oh(a,h);function a(t){var i=t.videoMeta,r=t.audioMeta,n=t.curTime;ah(this,a);var u=sh(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return u.TAG="Fmp4Remuxer",u._dtsBase=n*1e3,u._videoMeta=i,u._audioMeta=r,u._audioDtsBase=null,u._videoDtsBase=null,u._isDtsBaseInited=!1,u.isFirstVideo=!0,u.isFirstAudio=!0,u.videoAllDuration=0,u.audioAllDuration=0,u.audioRemuxed=0,u.videoRemuxed=0,u.mp4Durations={keys:[]},u}return nh(a,[{key:"destroy",value:function(){this._dtsBase=-1,this._isDtsBaseInited=!1,this.mp4Durations={keys:[]},this.removeAllListeners()}},{key:"remux",value:function(i,r){!this._isDtsBaseInited&&this.calcDtsBase(i,r),this.remuxVideo(r),this.remuxAudio(i),vi.groupEnd()}},{key:"resetDtsBase",value:function(){this._dtsBase=0}},{key:"seek",value:function(i){vi.log(this.TAG,"set dtsBase for seek(),time=",i),this._isDtsBaseInited?(this._isDtsBaseInited=!1,this._dtsBase=i*1e3):this._dtsBase=i*1e3,this._audioDtsBase=this._videoDtsBase=null}},{key:"remuxInitSegment",value:function(i,r){vi.log(this.TAG,"remuxInitSegment: type=",i);var n=new Dt,u=r.streamType===36?Lr.ftypHEVC():Lr.ftyp(),o=Lr.moov({type:i,meta:r});return n.write(u,o),n}},{key:"calcDtsBase",value:function(i,r){if(!i&&r.samples.length){var n=r.samples[0],u=void 0;n.options&&n.options.start&&(u=n.options.start),this._videoDtsBase=n.dts-(u||this._dtsBase),this._isDtsBaseInited=!0;return}if(!((!i||!i.samples.length)&&(!r||!r.samples.length))){var o=null,d=null,g=null;if(i&&i.samples&&i.samples.length){var v=i.samples[0];o=v.dts,v.options&&v.options.start&&(g=v.options.start)}if(r&&r.samples&&r.samples.length){var p=r.samples[0];d=p.dts,p.options&&p.options.start&&(g=p.options.start)}var e=o-d;!!o&&e<0&&g!==null&&r.samples.forEach(function(s){s.dts-=e,s.pts&&(s.pts-=e)}),this._videoDtsBase=(d||o)-(g||this._dtsBase),this._audioDtsBase=(o||d)-(g||this._dtsBase),this._dtsBase=Math.min(d,o),this._isDtsBaseInited=!0,vi.log(this.TAG,"calcDtsBase"),vi.log(this.TAG,"video first dts: "+d+" , start:"+g+" , _videoDtsBase:"+this._videoDtsBase+" , _dtsBase:"+this._dtsBase),vi.log(this.TAG,"audio first dts: "+o+" , start:"+g+" , _audioDtsBase:"+this._audioDtsBase+", _dtsBase:"+this._dtsBase)}}},{key:"remuxVideo",value:function(i){var r=this,n=i||{};if(!(!i||!i.samples||!i.samples.length)){var u=n.samples,o=n.meta;if(!!o){for(var d=-1,g=null,v=[],p={samples:[]},e=1e4;u.length&&e-- >0;){var s=u.shift(),l=s.isKeyframe,f=s.options;if(!this.isFirstVideo&&f&&f.meta){g=this.remuxInitSegment("video",f.meta),f.meta=null,u.unshift(s),f.isContinue||(this._videoDtsBase=0);break}var c=Math.max(0,s.dts-this.videoDtsBase);d===-1&&(d=c);var y=void 0,m=void 0;s.pts!==void 0&&(m=s.pts-this._dtsBase,y=m-c),s.cts!==void 0&&(m=s.cts+c,y=s.cts);var _={buffer:[],size:0},E=0;if(s.duration)E=s.duration;else if(u.length>=1){var w=u[0].dts-this.videoDtsBase;E=w-c}else v.length>=1?E=v[v.length-1].duration:E=this._videoMeta.refSampleDuration;this.videoAllDuration+=E,vi.long&&vi.log(this.TAG,"video dts "+c,"pts "+m,"cts: "+y,l,"originDts "+s.originDts,"duration "+E),E>=0&&(p.samples.push(_),_.buffer.push(s.data),_.size+=s.data.byteLength,v.push({dts:c,cts:y,pts:m,data:s.data,size:s.data.byteLength,isKeyframe:l,duration:E,flags:{isLeading:0,dependsOn:l?2:1,isDependedOn:l?1:0,hasRedundancy:0,isNonSync:l?0:1},originDts:c,type:"video"}),this.mp4Durations[m]=E,this.mp4Durations.keys.push(m)),l&&this.emit(a.EVENTS.RANDOM_ACCESS_POINT,m)}if(this.mp4Durations.keys.length>1e4){var k=this.mp4Durations;this.mp4Durations={},this.mp4Durations.keys=k.keys.slice(-100),this.mp4Durations.keys.forEach(function(U){r.mp4Durations[U]=k[U]})}v.length&&vi.log(this.TAG,"remux to mp4 video:",[d/1e3,v[v.length-1].dts/1e3]);var x=new Dt;if(v.length&&n.meta){var S=Lr.moof({id:n.meta.id,time:d,samples:v}),B=Lr.mdat(p);x.write(S,B),this.segmentRemuxed("video",x,v[v.length-1].pts-v[0].pts)}if(g&&(this.segmentRemuxed("video",g),u.length))return n.samples=u,this.remuxVideo(n);this.isFirstVideo=!1,this.emit(a.EVENTS.TRACK_REMUXED,"video",x),n.samples=[],n.length=0}}}},{key:"remuxAudio",value:function(i){var r=i||{},n=r.samples,u=-1,o=[],d=null,g={samples:[]};if(!(!n||!n.length)){for(var v=1e4,p=!1;n.length&&v-- >0;){var e=n.shift(),s=e.data,l=e.options;if(!this.isFirstAudio&&l&&l.meta){d=this.remuxInitSegment("audio",l.meta),l.meta=null,n.unshift(e),l.isContinue||(this._audioDtsBase=0);break}var f=Math.max(0,e.dts-this.audioDtsBase),c=e.originDts;p||(u=f,p=!0);var y=0;if(e.duration)y=e.duration;else if(this._audioMeta.refSampleDurationFixed)y=this._audioMeta.refSampleDurationFixed;else if(n.length>=1){var m=n[0].dts-this.audioDtsBase;y=m-f}else o.length>=1?y=o[o.length-1].duration:y=this._audioMeta.refSampleDuration;vi.long,this.audioAllDuration+=y;var _={dts:f,pts:f,cts:0,size:s.byteLength,duration:e.duration?e.duration:y,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,isNonSync:0},isKeyframe:!0,originDts:c,type:"audio"},E={buffer:[],size:0};y>=0&&(E.buffer.push(s),E.size+=s.byteLength,g.samples.push(E),o.push(_))}var w=new Dt;if(o.length&&i.meta){vi.log(this.TAG,"remux to mp4 audio:",[u/1e3,o[o.length-1].dts/1e3]);var k=Lr.moof({id:i.meta.id,time:u,samples:o}),x=Lr.mdat(g);w.write(k,x),this.segmentRemuxed("audio",w,o[o.length-1].dts-o[0].dts)}if(d&&(this.segmentRemuxed("audio",d),n.length))return i.samples=n,this.remuxAudio(i);this.isFirstAudio=!1,this.emit(a.EVENTS.TRACK_REMUXED,"audio",w),i.samples=[],i.length=0}}},{key:"segmentRemuxed",value:function(i,r,n){this.emit(a.EVENTS.MEDIA_SEGMENT,i,r,n)}},{key:"videoDtsBase",get:function(){return this._videoDtsBase!==null?this._videoDtsBase:this._dtsBase},set:function(i){this._videoDtsBase=i}},{key:"audioDtsBase",get:function(){return this._audioDtsBase!==null?this._audioDtsBase:this._dtsBase}}],[{key:"EVENTS",get:function(){return{MEDIA_SEGMENT:"MEDIA_SEGMENT",INIT_SEGMENT:"INIT_SEGMENT",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",TRACK_REMUXED:"TRACK_REMUXED"}}}]),a}(Kn),Za=lh,uh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function fh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Gr=Wa.REMUX_EVENTS,dh=Wa.PLAYER_EVENTS,ch=function(){function h(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;fh(this,h),this.TAG="Mp4Remuxer",this._curTime=a,this.remuxer||this.initRemuxer()}return uh(h,[{key:"init",value:function(){this.on(Gr.REMUX_MEDIA,this.remux.bind(this)),this.on(Gr.REMUX_METADATA,this.onMetaDataReady.bind(this)),this.on(Gr.DETECT_CHANGE_STREAM,this.resetDtsBase.bind(this)),this.on(Gr.DETECT_FRAG_ID_DISCONTINUE,this.seek.bind(this)),this.on(dh.SEEK,this.seek.bind(this))}},{key:"initRemuxer",value:function(){this.remuxer=new Za({audioMeta:null,videoMeta:null,curTime:this._curTime}),this.remuxer.on(Za.EVENTS.MEDIA_SEGMENT,this.writeToSource.bind(this)),this.remuxer.on(Za.EVENTS.TRACK_REMUXED,this.onTrackRemuxed.bind(this))}},{key:"remux",value:function(){this.remuxer._videoMeta||(this.remuxer._videoMeta=this.videoMeta,this.remuxer._audioMeta=this.audioMeta);var t=this._context.getInstance("TRACKS"),i=t.audioTrack,r=t.videoTrack;return this.remuxer.remux(i,r)}},{key:"resetDtsBase",value:function(){this.remuxer&&this.remuxer.resetDtsBase()}},{key:"seek",value:function(t){this.remuxer&&this.remuxer.seek(t)}},{key:"onMetaDataReady",value:function(t){this.remuxer||this.initRemuxer();var i=void 0;if(t==="audio"){var r=this._context.getInstance("TRACKS"),n=r.audioTrack;i=n}else{var u=this._context.getInstance("TRACKS"),o=u.videoTrack;i=o}var d=this._context.getInstance("PRE_SOURCE_BUFFER"),g=d.getSource(t);g||(g=d.createSource(t)),g.mimetype=i.meta.codec,g.init=this.remuxer.remuxInitSegment(t,i.meta),this.emit(Gr.INIT_SEGMENT,t)}},{key:"onTrackRemuxed",value:function(t){this.emit(Gr.MEDIA_SEGMENT,t)}},{key:"writeToSource",value:function(t,i,r){var n=this._context.getInstance("PRE_SOURCE_BUFFER"),u=n.getSource(t);u||(u=n.createSource(t)),u.data.push(i),r&&(u.bufferDuration=r+(u.bufferDuration||0))}},{key:"destroy",value:function(){this.remuxer&&this.remuxer.destroy(),this.remuxer=null}},{key:"videoMeta",get:function(){return this._context.getInstance("TRACKS").videoTrack.meta}},{key:"audioMeta",get:function(){return this._context.getInstance("TRACKS").audioTrack.meta}}]),h}(),Sl=ch,kl={Mse:hd,Tracks:Na,RemuxedBufferManager:Ao,XgBuffer:jr,FetchLoader:Ga,Compatibility:dl,Mp4Remuxer:Sl,Crypto:Ha,M3U8Parser:Xa,TsDemuxer:Ya,Playlist:Oa},hh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}(),Ja=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}};function ph(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function gh(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function vh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var yh=Bt.HlsAllowedEvents,mh=Bt.REMUX_EVENTS,qn=Ct.util,Qa=function(h){vh(a,h);function a(t){ph(this,a);var i=gh(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.hlsOps=Object.assign(i.hlsOps,kl),qn.deepCopy(i.hlsOps,t),i._played=!1,i}return hh(a,[{key:"_initEvents",value:function(){var i=this;this.__core__.once(mh.INIT_SEGMENT,function(){var r=i._context.getInstance("MSE");if(!i.started){var n=qn.createDom("xg-live","\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");qn.addClass(i.root,"xgplayer-is-live"),i.controls.appendChild(n)}i.started=!0,Ja(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",i).call(i,r.url)})}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;!i||this.started||(this._context||(this._context=new Va(this,this.hlsOps,yh)),this.hlsOps||(this.hlsOps={},this.hlsOps=Object.assign(this.hlsOps,kl),qn.deepCopy(this.hlsOps,this.config),this._played=!1),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Dd)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.url=i,this.__core__.load(i),this._initEvents(),this.started=!0)}},{key:"play",value:function(){var i=this;if(this._played){this.src=this.config.url,this.once("canplay",function(){i.video.play()});return}this._played=!0,Ja(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"play",this).call(this)}},{key:"destroy",value:function(){var i=this;this._context&&this._context.destroy();var r=new Promise(function(n){i.__core__&&i.__core__.mse?i.__core__.mse.destroy().then(function(){setTimeout(function(){n()},50)}):setTimeout(function(){n()},50)});return Ja(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",this).call(this),r}},{key:"src",set:function(i){var r=this;this.onWaiting=this.onWaiting.bind(this),this.__core__.mse.destroy().then(function(){r._context.destroy(),r._context=null,r.started=!1,r.video.currentTime=0,r.start(i)})}}],[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct);Qa.install=Ct.install.bind(Ct);var _h=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function xh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Eh=Jo,bh=Xo,Zi=Bt.LOADER_EVENTS,dr=Bt.DEMUX_EVENTS,es=Bt.HLS_EVENTS,Al=Bt.CRYTO_EVENTS,wh="HLS_ERROR",Th=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,Cl=function(){function h(a){xh(this,h),this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.preloadTime=this.configs.preloadTime,this.container=this.configs.container,this._m3u8lasttime=0,this._timmer=setInterval(this._checkStatus.bind(this),50),this._lastCheck=0,this.m3u8Text=null}return _h(h,[{key:"init",value:function(){var t=this._player.hlsOps,i=t.XgBuffer,r=t.Tracks,n=t.Playlist,u=t.FetchLoader,o=t.TsDemuxer;this._context.registry("M3U8_BUFFER",i),this._context.registry("TS_BUFFER",i),this._context.registry("TRACKS",r),this._playlist=this._context.registry("PLAYLIST",n)({autoclear:!0}),this._m3u8loader=this._context.registry("M3U8_LOADER",u)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",u)({buffer:"TS_BUFFER",readtype:3}),this._context.registry("TS_DEMUXER",o)({inputbuffer:"TS_BUFFER"}),this.initEvents()}},{key:"initEvents",value:function(){this.on(Zi.LOADER_COMPLETE,this._onLoadComplete.bind(this)),this.on(dr.METADATA_PARSED,this._onMetadataParsed.bind(this)),this.on(dr.SEI_PARSED,this._handleSEIParsed.bind(this)),this.on(dr.DEMUX_COMPLETE,this._onDemuxComplete.bind(this)),this.on(Zi.LOADER_ERROR,this._onLoadError.bind(this)),this.on(dr.DEMUX_ERROR,this._onDemuxError.bind(this))}},{key:"_onError",value:function(t,i,r,n){var u={errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player.emit(wh,u)}},{key:"_onDemuxComplete",value:function(){var t=this;if(this._player.video){var i=this._context.getInstance("TRACKS"),r=i.videoTrack,n=i.audioTrack;r.samples.forEach(function(u){if(!u.analyzed){u.analyzed=!0;var o=new yn(u.data.buffer),d=void 0;t._isHEVC(r.meta)?d=Eh.getHvccNals(o):d=bh.getNalunits(o);var g=d.reduce(function(e,s){return e+4+s.body.byteLength},0),v=new Uint8Array(g),p=0;d.forEach(function(e){v.set([0,0,0,1],p),p+=4,v.set(new Uint8Array(e.body),p),p+=e.body.byteLength}),u.data=v}}),this._player.video.onDemuxComplete(r,n)}}},{key:"_onMetadataParsed",value:function(t){if(t==="audio"){var i=this._context.getInstance("TRACKS"),r=i.audioTrack;r&&r.meta&&this._setMetaToAudio(r.meta)}else{var n=this._context.getInstance("TRACKS"),u=n.videoTrack;u&&u.meta&&this._setMetaToVideo(u.meta)}}},{key:"_setMetaToAudio",value:function(t){this._player.video&&this._player.video.setAudioMeta(t)}},{key:"_setMetaToVideo",value:function(t){this._player.video&&this._player.video.setVideoMeta(t)}},{key:"_onLoadError",value:function(t,i){!this._tsloader.loading&&!this._m3u8loader.loading&&this.retrytimes>1?(this.retrytimes--,this._onError(Zi.LOADER_ERROR,t,i,!1)):this.retrytimes<=1&&(this._onError(Zi.LOADER_ERROR,t,i,!0),this.emit(es.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded())}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._onError(Zi.LOADER_ERROR,t,i,r)}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onLoadComplete",value:function(t){if(t.TAG==="M3U8_BUFFER"){var i=void 0;try{this.m3u8Text=t.shift();var r=Th.exec(this.m3u8Text);r&&r[2]?this.load(r[2]):i=this._player.hlsOps.M3U8Parser.parse(this.m3u8Text,this.url)}catch(g){this._onError("M3U8_PARSER_ERROR","M3U8_PARSER",g,!1)}if(!i){this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(es.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded());return}try{this._playlist.pushM3U8(i,!0)}catch(g){this._onError("M3U8_PARSER_ERROR","PLAYLIST",g,!1)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key){var n=this._player.hlsOps,u=n.XgBuffer,o=n.FetchLoader;this._context.registry("DECRYPT_BUFFER",u)(),this._context.registry("KEY_BUFFER",u)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",o)({buffer:"KEY_BUFFER",readtype:3}),this.emitTo("KEY_LOADER",Zi.LADER_START,this._playlist.encrypt.uri)}else this._m3u8Loaded(i)}else if(t.TAG==="TS_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emit(dr.DEMUX_START);else if(t.TAG==="DECRYPT_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",Al.START_DECRYPT);else if(t.TAG==="KEY_BUFFER"){var d=this._player.hlsOps.Crypto;this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",d)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(Al.DECRYPTED,this._onDcripted.bind(this))}}},{key:"_onDcripted",value:function(){this.emit(dr.DEMUX_START)}},{key:"_m3u8Loaded",value:function(t){this.preloadTime||(this.preloadTime=this._playlist.targetduration?this._playlist.targetduration:5),this._playlist.fragLength>0&&this._playlist.sequence<t.sequence?this.retrytimes=this.configs.retrytimes||3:this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(es.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded())}},{key:"_checkStatus",value:function(){if(!(this.retrytimes<1&&new Date().getTime()-this._lastCheck<1e4))if(this._lastCheck=new Date().getTime(),this.container.buffered.length<1)this._preload();else{var t=this.container.currentTime;this.container.readyState<=2&&this._preload();var i=this.container.buffered.end(this.container.buffered.length-1);t>i-this.preloadTime&&this._preload()}}},{key:"_preload",value:function(){if(!(this._tsloader.loading||this._m3u8loader.loading)){var t=this._playlist.getTs();if(t&&!t.downloaded&&!t.downloading)this._playlist.downloading(t.url,!0),this.emitTo("TS_LOADER",Zi.LADER_START,t.url);else{var i=this.preloadTime?this.preloadTime:0,r=new Date().getTime();(!t||t.downloaded)&&(r-this._m3u8lasttime)/1e3>i&&(this._m3u8lasttime=r,this.emitTo("M3U8_LOADER",Zi.LADER_START,this.url))}}}},{key:"_isHEVC",value:function(t){return t&&t.codec==="hev1.1.6.L93.B0"}},{key:"load",value:function(t){this.url=t,this._preload()}},{key:"destroy",value:function(){clearInterval(this._timmer),this.off(Zi.LOADER_COMPLETE,this._onLoadComplete),this.off(dr.METADATA_PARSED,this._onMetadataParsed),this.off(dr.DEMUX_COMPLETE,this._onDemuxComplete),this.m3u8Text=null}}]),h}(),Sh={Tracks:Na,XgBuffer:jr,FetchLoader:Ga,Crypto:Ha,M3U8Parser:Xa,TsDemuxer:Ya,Playlist:Oa},Zn=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},Dl=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function kh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function Ah(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Ch(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var Rl=Bt.HlsAllowedEvents,ts=function(h){Ch(a,h),Dl(a,null,[{key:"isSupported",value:function(){var i="WebAssembly"in window,r="customElements"in window&&window.customElements.define,n=!1;return r&&(n=window.customElements.get("live-video")),i&&n}}]);function a(t){kh(this,a),t.mediaType||(t.mediaType="live-video",t.videoConfig?t.videoConfig.preloadtime=t.preloadTime||5:t.videoConfig={preloadtime:t.preloadTime||5});var i=Ah(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.util=Ct.util,i.hlsOps=Object.assign(i.hlsOps,Sh),i.util.deepCopy(i.hlsOps,t),i.playerInited||i.initPlayer(),i}return Dl(a,[{key:"initPlayer",value:function(){this.video.width=Number.parseInt(this.hlsOps.width||600),this.video.height=Number.parseInt(this.hlsOps.height||337.5),this.video.style.outline="none",this.playerInited=!0}},{key:"_initEvents",value:function(){var i=this;this.once("canplay",function(){i.video.play()})}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hlsOps.url;!i||this.started||(this.playerInited||this.initPlayer(),this._context||(this._context=new Va(Rl)),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Cl)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.url=i,this.__core__.load(i),Zn(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",this).call(this,i),this._initEvents(),this.started=!0,this.addLiveFlag())}},{key:"play",value:function(){this.started&&(this._context.destroy(),this._context=new Va(Rl),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Cl)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this._initEvents(),this.__core__.load(this.url)),Zn(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"play",this).call(this)}},{key:"addLiveFlag",value:function(){var i=this;if(Ct.util.addClass(i.root,"xgplayer-is-live"),!Ct.util.findDom(this.root,"xg-live")){var r=Ct.util.createDom("xg-live","\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");i.controls.appendChild(r)}}},{key:"destroy",value:function(){var i=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return new Promise(function(n){Zn(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i);var u=i.video,o=i.root;Zn(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i,r),u&&u.remove?u.remove():o&&o.removeChild(u),u&&u.destroy(),setTimeout(function(){n()},50)})}},{key:"src",set:function(i){this.onWaiting=this.onWaiting.bind(this),this._context.destroy(),this._context=null,this.started=!1,this.video.currentTime=0,this.start(i)}}],[{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct);ts.install=Ct.install.bind(Ct);var Dh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Rh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Ul=function(){function h(a){return Rh(this,h),ts.isSupported()&&a.useWASM?new ts(a):Qa.isSupported()?new Qa(a):new Ct(a)}return Dh(h,null,[{key:"install",value:function(t,i){return Ct.install(t,i)}}]),h}();Ul.EVENTS=Bt;var Uh=function(h,a){var t=Date.now(),i=null,r=!0;return function(){for(var n=arguments.length,u=Array(n),o=0;o<n;o++)u[o]=arguments[o];var d=Date.now();r&&(t=Date.now(),r=!1,h.apply(void 0,u)),d-t>a?(t=d,h.apply(void 0,u)):(i&&window.clearTimeout(i),i=setTimeout(function(){h.apply(void 0,u)},a))}},Ll={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},Pl={SEEK:"SEEK"},Bl={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},Fl={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},Ol={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},Il={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},Ml={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Lh={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Pr=Object.assign({},Bl,Fl,Ol,Il,Ml,Pl,Ll),Nl=[],zl=[];for(var Vl in Pr)Pr.hasOwnProperty(Vl)&&Nl.push(Pr[Vl]);for(var Hl in Pr)Pr.hasOwnProperty(Hl)&&zl.push(Pr[Hl]);var Xt={ALLEVENTS:Pr,HLS_EVENTS:Ml,REMUX_EVENTS:Ol,DEMUX_EVENTS:Fl,MSE_EVENTS:Il,LOADER_EVENTS:Bl,FlvAllowedEvents:Nl,HlsAllowedEvents:zl,CRYPTO_EVENTS:Lh,PLAYER_EVENTS:Pl,BROWSER_EVENTS:Ll},jl=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},Gl=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ph(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Bh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function $l(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var xn="__TO__",Fh=function(){function h(a,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];$l(this,h),this._emitter=new Kn,this._emitter.off||(this._emitter.off=this._emitter.removeListener),this.mediaInfo=new Oo,this._instanceMap={},this._clsMap={},this._inited=!1,this.allowedEvents=i,this._configs=t,this._player=a,this._hooks={}}return Gl(h,[{key:"getInstance",value:function(t){var i=this._instanceMap[t];return i||null}},{key:"initInstance",value:function(t){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var u=r[0],o=r[1],d=r[2],g=r[3];if(this._clsMap[t]){var v=new this._clsMap[t](u,o,d,g);return this._instanceMap[t]=v,v.init&&v.init(),v}else throw new Error(t+"\u672A\u5728context\u4E2D\u6CE8\u518C")}},{key:"init",value:function(t){if(!this._inited){for(var i in this._clsMap)this._clsMap.hasOwnProperty(i)&&!this._instanceMap[i]&&this.initInstance(i,t);this._inited=!0}}},{key:"registry",value:function(t,i){var r=this,n=this._emitter,u=this._isMessageNameValid.bind(this),o=this,d=function(g){Bh(v,g);function v(p,e,s){$l(this,v);var l=Ph(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,p,e,s));return l.listeners={},l.onceListeners={},l.TAG=t,l._context=o,l}return Gl(v,[{key:"on",value:function(e,s){return u(e),this.listeners[e]?this.listeners[e].push(s):this.listeners[e]=[s],n.on(""+e+xn+t,s),n.on(e,s)}},{key:"before",value:function(e,s){u(e),o._hooks[e]?o._hooks[e].push(s):o._hooks[e]=[s]}},{key:"once",value:function(e,s){return u(e),this.onceListeners[e]?this.onceListeners[e].push(s):this.onceListeners[e]=[s],n.once(""+e+xn+t,s),n.once(e,s)}},{key:"emit",value:function(e){u(e);for(var s=o._hooks?o._hooks[e]:null,l=arguments.length,f=Array(l>1?l-1:0),c=1;c<l;c++)f[c-1]=arguments[c];if(s)for(var y=0,m=s.length;y<m;y++){var _=s[y];_.apply(void 0,f)}return n.emit.apply(n,[e].concat(f))}},{key:"emitTo",value:function(e,s){u(s);for(var l=arguments.length,f=Array(l>2?l-2:0),c=2;c<l;c++)f[c-2]=arguments[c];return n.emit.apply(n,[""+s+xn+e].concat(f))}},{key:"off",value:function(e,s){return u(e),n.off(e,s)}},{key:"removeListeners",value:function(){var e=Object.prototype.hasOwnProperty.bind(this.listeners);for(var s in this.listeners)if(e(s))for(var l=this.listeners[s]||[],f=0;f<l.length;f++){var c=l[f];n.off(s,c),n.off(""+s+xn+t,c)}for(var y in this.onceListeners)if(e(y))for(var m=this.onceListeners[y]||[],_=0;_<m.length;_++){var E=m[_];n.off(y,E),n.off(""+y+xn+t,E)}}},{key:"destroy",value:function(){if(this.removeListeners(),this.listeners={},delete o._instanceMap[t],jl(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this))return jl(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this);this._context=null}},{key:"_player",get:function(){return this._context?this._context._player:null},set:function(e){this._context&&(this._context._player=e)}},{key:"_pluginConfig",get:function(){return this._context?this._context._configs:null}}]),v}(i);return this._clsMap[t]=d,function(){for(var g=arguments.length,v=Array(g),p=0;p<g;p++)v[p]=arguments[p];return r.initInstance.apply(r,[t].concat(v))}}},{key:"seek",value:function(t){this._emitter.emit(Xt.PLAYER_EVENTS.SEEK,t)}},{key:"destroyInstances",value:function(){var t=this;Object.keys(this._instanceMap).forEach(function(i){t._instanceMap[i].destroy&&t._instanceMap[i].destroy()})}},{key:"destroy",value:function(){this.destroyInstances(),this._emitter&&this._emitter.removeAllListeners(),this._emitter=null,this.allowedEvents=[],this._clsMap=null,this._hooks=null,this._player=null,this._configs=null}},{key:"_isMessageNameValid",value:function(t){if(!this.allowedEvents.indexOf(t)<0)throw new Error("unregistered message name: "+t)}}]),h}(),Wl=Fh,Oh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ih(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Yl=Xt.CRYPTO_EVENTS,Mh=function(){function h(a){Ih(this,h),this.inputBuffer=a.inputbuffer,this.outputBuffer=a.outputbuffer,this.key=a.key,this.iv=a.iv,this.method=a.method,this.crypto=window.crypto||window.msCrypto}return Oh(h,[{key:"init",value:function(){this.on(Yl.START_DECRYPTO,this.decrypto.bind(this))}},{key:"decrypto",value:function(){var t=this;if(this.aeskey)this.decryptoData();else{var i=this.crypto.subtle.importKey("raw",this.key.buffer,{name:"AES-CBC"},!1,["encrypt","decrypt"]);i.then(function(r){t.aeskey=r,t.decryptoData()})}}},{key:"decryptoData",value:function(){var t=this,i=this._context.getInstance(this.inputBuffer),r=this._context.getInstance(this.outputBuffer),n=i.shift();n&&this.crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv.buffer},this.aeskey,n).then(function(u){r.push(new Uint8Array(u)),t.emit(Yl.DECRYPTED),t.decryptoData(n)})}}]),h}(),Nh=Mh,zh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Vh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var is=Xt.MSE_EVENTS,Hh=function(){function h(a,t){Vh(this,h),t&&(this._context=t,this.emit=t._emitter.emit.bind(t._emitter)),this.TAG="MSE",this.configs=Object.assign({},a),this.container=this.configs.container,this.format=this.configs.format,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=this.configs.preloadTime||1,this.onSourceOpen=this.onSourceOpen.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onUpdateEnd=this.onUpdateEnd.bind(this),this.onWaiting=this.onWaiting.bind(this),this.opened=!1}return zh(h,[{key:"init",value:function(){this.mediaSource=new self.MediaSource,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen),this._url=null,this.container.addEventListener("timeupdate",this.onTimeUpdate),this.container.addEventListener("waiting",this.onWaiting)}},{key:"resetContext",value:function(t,i){if(this._context=t,this.emit=t._emitter.emit.bind(t._emitter),!i)for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||h.clearBuffer(n)}}},{key:"onTimeUpdate",value:function(){this.emit("TIME_UPDATE",this.container)}},{key:"onWaiting",value:function(){this.emit("WAITING",this.container)}},{key:"onSourceOpen",value:function(){this.opened=!0,this.addSourceBuffers()}},{key:"onUpdateEnd",value:function(){this.emit(is.SOURCE_UPDATE_END),this.doAppend()}},{key:"addSourceBuffers",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState!=="open"||!this.opened)){var t=this._context.getInstance("PRE_SOURCE_BUFFER"),i=this._context.getInstance("TRACKS"),r=void 0;if(!(!t||!i)){t=t.sources;for(var n=!1,u=0,o=Object.keys(t).length;u<o;u++){var d=Object.keys(t)[u];n=!1,d==="audio"?r=i.audioTrack:d==="video"&&(r=i.videoTrack),r&&t[d].init!==null&&t[d].data.length&&(n=!0)}if(n){if(Object.keys(this.sourceBuffers).length>1)return;for(var g=0,v=Object.keys(t).length;g<v;g++){var p=Object.keys(t)[g];if(!this.sourceBuffers[p]){var e=t[p],s=p==="video"?"video/mp4;codecs="+e.mimetype:"audio/mp4;codecs="+e.mimetype;try{var l=this.mediaSource.addSourceBuffer(s);this.sourceBuffers[p]=l,l.addEventListener("updateend",this.onUpdateEnd)}catch(f){if(f.code===22&&Object.keys(this.sourceBuffers).length>0)return this.emit(is.MSE_WRONG_TRACK_ADD,p);this.emit(is.MSE_ERROR,this.TAG,new Error(f.message))}}}Object.keys(this.sourceBuffers).length===this.sourceBufferLen&&this.doAppend()}}}}},{key:"doAppend",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState==="closed")){this._doCleanupSourceBuffer();var t=this._context.getInstance("PRE_SOURCE_BUFFER");if(!!t&&!(Object.keys(this.sourceBuffers).length<this.sourceBufferLen))for(var i=0;i<Object.keys(this.sourceBuffers).length;i++){var r=Object.keys(this.sourceBuffers)[i],n=this.sourceBuffers[r];if(!n.updating){var u=t.sources[r];if(this["no"+r]){u.data=[],u.init.buffer=null;continue}if(u&&!u.inited)try{n.appendBuffer(u.init.buffer.buffer),u.inited=!0}catch(d){}else if(u){var o=u.data.shift();if(o)try{n.appendBuffer(o.buffer.buffer)}catch(d){u.data.unshift(o)}}}}}}},{key:"endOfStream",value:function(){try{var t=this.mediaSource.readyState;t==="open"&&this.mediaSource.endOfStream()}catch(i){}}},{key:"remove",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;try{for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||t>i&&n.remove(i,t)}}catch(u){}}},{key:"_doCleanupSourceBuffer",value:function(){for(var t=this.container.currentTime,i=60*3,r={video:[],audio:[]},n=0;n<Object.keys(this.sourceBuffers).length;n++){for(var u=Object.keys(this.sourceBuffers)[n],o=this.sourceBuffers[u],d=o.buffered,g=!1,v=0;v<d.length;v++){var p=d.start(v),e=d.end(v);if(p<=t&&t<e+3){if(t-p>=i){g=!0;var s=t-i;r[u].push({start:p,end:s})}}else e<t&&t-p>=i&&(g=!0,r[u].push({start:p,end:e}))}g&&!o.updating&&this._doRemoveRanges(r)}}},{key:"_doRemoveRanges",value:function(t){for(var i in t)if(!(!this.sourceBuffers[i]||this.sourceBuffers[i].updating))for(var r=this.sourceBuffers[i],n=t[i];n.length&&!r.updating;){var u=n.shift();try{u&&u.end>u.start&&r.remove(u.start,u.end)}catch(o){}}}},{key:"cleanBuffers",value:function(){for(var t=this,i=[],r=function(o){var d=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]],g=void 0;d.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){d.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(d),d.addEventListener("updateend",function(){v()}))};setTimeout(l,200),d.removeEventListener("updateend",e)};d.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(d),d.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"removeBuffers",value:function(){for(var t=this,i=[],r=function(o){var d=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]];d.removeEventListener("updateend",t.onUpdateEnd);var g=void 0;d.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){d.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(d),d.addEventListener("updateend",function(){v()}))};setTimeout(l,200),d.removeEventListener("updateend",e)};d.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(d),d.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"destroy",value:function(){var t=this;return this.container?(this.container.removeEventListener("timeupdate",this.onTimeUpdate),this.container.removeEventListener("waiting",this.onWaiting),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen),this.removeBuffers().then(function(){for(var i=Object.keys(t.sourceBuffers),r=0;r<i.length;r++){var n=t.sourceBuffers[i[r]];delete t.sourceBuffers[i[r]],t.mediaSource.readyState==="open"&&t.mediaSource.removeSourceBuffer(n)}t.endOfStream();try{window.URL.revokeObjectURL(t.url)}catch(u){}t.url=null,t.configs={},t.container=null,t.mediaSource=null,t.sourceBuffers={},t.preloadTime=1,t.onSourceOpen=null,t.onTimeUpdate=null,t.onUpdateEnd=null,t.onWaiting=null,t.noaudio=void 0,t.novideo=void 0})):Promise.resolve()}},{key:"sourceBufferLen",get:function(){return this._context.mediaInfo?(!!this._context.mediaInfo.hasVideo&&!this.novideo)+(!!this._context.mediaInfo.hasAudio&&!this.noaudio):this.noaudio||this.novideo?1:2}},{key:"url",set:function(t){this._url=t},get:function(){if(!this._url)try{this._url=window.URL.createObjectURL(this.mediaSource)}catch(t){}return this._url}}],[{key:"clearBuffer",value:function(t){try{for(var i=t.buffered,r=.1,n=0,u=i.length;n<u;n++)r=i.end(n);t.remove(0,r)}catch(o){}}}]),h}(),jh=Hh,Gh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function $h(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Wh=function(){function h(){$h(this,h),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0,this._now=Date.now}return Gh(h,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0}},{key:"addBytes",value:function(t){var i=this._now()-this._lastCheckpoint;this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=t):i<5e3?this._intervalBytes+=t:(this._lastSamplingBytes=this._intervalBytes/(i/1e3),this._intervalBytes=t,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var t=(this._now()-this._lastCheckpoint)/1e3;return t===0&&(t=1),this._intervalBytes/t/1024}},{key:"lastSamplingKBps",get:function(){return this.addBytes(0),this._lastSamplingBytes!==0?this._lastSamplingBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}}]),h}(),Yh=Wh,Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},Xh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Kh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Mt=Xt.LOADER_EVENTS,qh=0,Zh=1,Jh=2,Qh=3,ep=function(){function h(a){Kh(this,h),this.configs=Object.assign({},a),this.url=null,this.status=0,this.error=null,this._reader=null,this._canceled=!1,this._destroyed=!1,this.readtype=this.configs.readtype,this.buffer=this.configs.buffer||"LOADER_BUFFER",this._loaderTaskNo=0,this._ttfb=0,this._speed=new Yh,window.AbortController&&(this.abortControllerEnabled=!0)}return Xh(h,[{key:"init",value:function(){this.on(Mt.LADER_START,this.load.bind(this))}},{key:"fetch",value:function(a){function t(i,r,n){return a.apply(this,arguments)}return t.toString=function(){return a.toString()},t}(function(a,t,i){var r=this,n=null;this.abortControllerEnabled&&(this.abortController=new window.AbortController),Object.assign(t,{signal:this.abortController?this.abortController.signal:void 0});var u=new Date().getTime();return Promise.race([fetch(a,t),new Promise(function(o,d){n=setTimeout(function(){d({code:999,message:"fetch timeout"}),r.abortController&&r.abortController.abort()},i||1e4)})]).then(function(o){n&&(clearTimeout(n),n=null);var d=new Date().getTime();return r.emit(Mt.LOADER_TTFB,{start:u,end:d,elapsed:d-u}),o})})},{key:"internalLoad",value:function(t,i,r,n){var u=this,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,d=arguments[5];if(!this._destroyed)return this.loading=!0,this.fetch(this.url,i,d).then(function(g){if(!u._destroyed&&u.emit(Mt.LOADER_RESPONSE_HEADERS,u.TAG,g.headers),g.ok)return u.status=g.status,Promise.resolve().then(function(){u._onFetchResponse(g)}),Promise.resolve(g);r-- >0?u._retryTimer=setTimeout(function(){return u.emit(Mt.LOADER_RETRY,u.TAG,{response:g,reason:"response not ok",retryTime:n-r}),u.internalLoad(t,i,r,n,o,d)},o):(u.loading=!1,u.emit(Mt.LOADER_ERROR,u.TAG,{code:g.status||21,message:g.status+" ("+g.statusText+")"}))}).catch(function(g){if(u._destroyed){u.loading=!1;return}if(r-- >0)u._retryTimer=setTimeout(function(){return u.emit(Mt.LOADER_RETRY,u.TAG,{error:g,reason:"fetch error",retryTime:n-r}),u.internalLoad(t,i,r,n,o,d)},o);else{if(u.loading=!1,g&&g.name==="AbortError")return;u.emit(Mt.LOADER_ERROR,u.TAG,Object.assign({code:21},g))}})}},{key:"load",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.retryCount,u=r.retryDelay,o=r.loadTimeout;n=n===void 0?3:n,this.url=t,this._canceled=!1;var d=this.getParams(i);return this.internalLoad(t,d,n,n,u,o)}},{key:"_onFetchResponse",value:function(t){var i=this,r=this,n=this._context.getInstance(this.buffer);this._loaderTaskNo++;var u=this._loaderTaskNo;if(t.ok===!0)switch(this.readtype){case Jh:t.json().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(Mt.LOADER_COMPLETE,n)):r.emit(Mt.LOADER_COMPLETE,o))});break;case Zh:t.text().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(Mt.LOADER_COMPLETE,n)):r.emit(Mt.LOADER_COMPLETE,o))});break;case Qh:t.arrayBuffer().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(new Uint8Array(o)),i._speed.addBytes(o.byteLength),r.emit(Mt.LOADER_COMPLETE,n)):r.emit(Mt.LOADER_COMPLETE,o))}).catch(function(){});break;case qh:default:return this._onReader(t.body.getReader(),u)}}},{key:"_onReader",value:function(t,i){var r=this,n=this._context.getInstance(this.buffer);if(!n&&this._reader||this._destroyed)try{this._reader.cancel()}catch(u){}this._reader=t,this.loading!==!1&&(this._noDataTimer=setTimeout(function(){r.loading!==!1&&r.emit(Mt.LOADER_COMPLETE)},3e3),this._reader&&this._reader.read().then(function(u){if(clearTimeout(r._noDataTimer),r._canceled||r._destroyed){if(r._reader)try{r._reader.cancel()}catch(o){}return}if(u.done){r.loading=!1,r.status=0,Promise.resolve().then(function(){r.emit(Mt.LOADER_COMPLETE,n)});return}return n.push(u.value),r._speed.addBytes(u.value.byteLength),Promise.resolve().then(function(){r.emit(Mt.LOADER_DATALOADED,n)}),r._onReader(t,i)}).catch(function(u){clearTimeout(r._noDataTimer),r.loading=!1,!(u&&u.name==="AbortError")&&r.emit(Mt.LOADER_ERROR,r.TAG,u)}))}},{key:"getParams",value:function(t){var i=Object.assign({},t),r=new Headers,n={method:"GET",headers:r,mode:"cors",cache:"default"};if(Xl(this.configs.headers)==="object"){var u=this.configs.headers;for(var o in u)u.hasOwnProperty(o)&&r.append(o,u[o])}if(Xl(i.headers)==="object"){var d=i.headers;for(var g in d)d.hasOwnProperty(g)&&r.append(g,d[g])}return i.cors===!1&&(n.mode="same-origin"),i.withCredentials&&(n.credentials="include"),n}},{key:"cancel",value:function(){if(this._reader){try{this._reader.cancel()}catch(t){}this._reader=null,this.loading=!1}clearTimeout(this._noDataTimer),this._canceled=!0,this.abortController&&this.abortController.abort()}},{key:"destroy",value:function(){this._destroyed=!0,clearTimeout(this._retryTimer),clearTimeout(this._noDataTimer),this.cancel(),this._speed.reset()}},{key:"currentSpeed",get:function(){return this._speed.lastSamplingKBps}}],[{key:"isSupported",value:function(){return!!window.fetch}},{key:"type",get:function(){return"loader"}}]),h}(),Jn=ep,tp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ip(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function rp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var np=function(){function h(){var a=this;rp(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,d,g,v,p,e,s){var l;if(!!a._status){var f=r,c=[n,u,o,d,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(ip(c)))}}})}return tp(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),$r=new np,ap=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function sp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qt=Xt.LOADER_EVENTS,cr=Xt.REMUX_EVENTS,Br=Xt.DEMUX_EVENTS,Kl=Xt.CRYTO_EVENTS,Qn=Xt.MSE_EVENTS,op="HLS_ERROR",ql=function(){function h(a){sp(this,h),this.TAG="HlsVodController",this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.container=this.configs.container,this.preloadTime=this.configs.preloadTime||5,this.mse=this.configs.mse,this._lastSeekTime=0,this.m3u8Text=null}return ap(h,[{key:"init",value:function(){this._context.registry("M3U8_BUFFER",jr),this._tsBuffer=this._context.registry("TS_BUFFER",jr)(),this._tracks=this._context.registry("TRACKS",Na)(),this._playlist=this._context.registry("PLAYLIST",Oa)({autoclear:!1}),this._presource=this._context.registry("PRE_SOURCE_BUFFER",Ao)(),this._compat=this._context.registry("COMPATIBILITY",dl)(),this._context.registry("M3U8_LOADER",Jn)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",Jn)({buffer:"TS_BUFFER",readtype:3}),this._demuxer=this._context.registry("TS_DEMUXER",Ya)({inputbuffer:"TS_BUFFER"}),this._context.registry("MP4_REMUXER",Sl)(this._player.currentTime),this.mse||(this.mse=new jh({container:this.container,preloadTime:this.preloadTime},this._context),this.mse.init()),this.initEvents()}},{key:"initEvents",value:function(){this._onLoaderCompete=this._onLoaderCompete.bind(this),this._onLoadError=this._onLoadError.bind(this),this._onInitSegment=this._onInitSegment.bind(this),this._handleSEIParsed=this._handleSEIParsed.bind(this),this._onMediaSegment=this._onMediaSegment.bind(this),this._onMetadataParsed=this._onMetadataParsed.bind(this),this._onDemuxComplete=this._onDemuxComplete.bind(this),this._onDemuxError=this._onDemuxError.bind(this),this._onRemuxError=this._onRemuxError.bind(this),this._handleMseError=this._handleMseError.bind(this),this._onUpdateEnd=this._onUpdateEnd.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onWaiting=this._onWaiting.bind(this),this.on(qt.LOADER_COMPLETE,this._onLoaderCompete),this.on(qt.LOADER_ERROR,this._onLoadError),this.on(cr.INIT_SEGMENT,this._onInitSegment),this.on(Br.SEI_PARSED,this._handleSEIParsed),this.on(cr.MEDIA_SEGMENT,this._onMediaSegment),this.on(Br.METADATA_PARSED,this._onMetadataParsed),this.on(Br.DEMUX_COMPLETE,this._onDemuxComplete),this.on(Br.DEMUX_ERROR,this._onDemuxError),this.on(cr.REMUX_ERROR,this._onRemuxError),this.on(Qn.MSE_ERROR,this._handleMseError),this.on(Qn.SOURCE_UPDATE_END,this._onUpdateEnd),this.on("TIME_UPDATE",this._onTimeUpdate),this.on(Qn.SOURCE_UPDATE_END,this._onTimeUpdate),this.on("WAITING",this._onWaiting)}},{key:"_onError",value:function(t,i,r,n){var u={errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player&&this._player.emit(op,u)}},{key:"_onLoadError",value:function(t,i){this._player.emit("error",{errorType:"network",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(qt.LOADER_ERROR,t,i,!0)}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(qt.LOADER_ERROR,t,i,r)}},{key:"_onRemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(cr.REMUX_ERROR,t,i,r)}},{key:"_handleMseError",value:function(t,i,r){r===void 0&&(r=!1),this._player.emit("error",{errorType:"format",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(Qn.MSE_ERROR,t,i,r)}},{key:"_onWaiting",value:function(t){var i=!0;$r.log(this.TAG,"waiting.......",this._player.video.currentTime),this._seekToBufferStart();var r=Object.keys(this._playlist.list),n=r.length;if(!!n){for(var u=0;u<n;u++)this.container.currentTime*1e3<parseInt(r[u])&&(i=!1);if(i){var o=this._playlist.getTs(this.container.currentTime*1e3);o?o.downloaded&&(this._player.emit("ended"),this.mse.endOfStream()):(this._player.emit("ended"),this.mse.endOfStream())}}}},{key:"_seekToBufferStart",value:function(){var t=this._player.video,i=t.buffered,r=[0,0],n=t.currentTime;if(i){for(var u=0,o=i.length;u<o;u++)if(r[0]=i.start(u),r[1]=i.end(u),r[0]<=n&&n<=r[1])return}var d=r[0];n===0&&n<d&&Math.abs(n-d)<5&&(t.currentTime=d)}},{key:"_checkEnd",value:function(){var t=this._player.video,i=t.buffered,r=i.length;if(!!r){var n=i.end(r-1);Math.abs(n-t.duration)<1&&this.mse.endOfStream()}}},{key:"_onUpdateEnd",value:function(){this._checkEnd(),this._seekToBufferStart(),this._preload(this._player.currentTime)}},{key:"_onTimeUpdate",value:function(){this._seekToBufferStart(),this._preload(this._player.currentTime)}},{key:"_onDemuxComplete",value:function(){this.emit(cr.REMUX_MEDIA,"ts")}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onMetadataParsed",value:function(t){try{var i=this._tracks[t+"Track"].meta;$r.warn(this.TAG,"meta detect or changed , ",t,Object.assign({},i))}catch(n){}var r=parseInt(this._playlist.duration);t==="video"?(this._context.mediaInfo.hasVideo=!0,this._tracks.videoTrack.meta.duration=r):t==="audio"&&(this._context.mediaInfo.hasAudio=!0,this._tracks.audioTrack.meta.duration=r),this.emit(cr.REMUX_METADATA,t)}},{key:"_onMediaSegment",value:function(){Object.keys(this.mse.sourceBuffers).length<1&&this.mse.addSourceBuffers(),this.mse.doAppend()}},{key:"_onInitSegment",value:function(){this.mse.addSourceBuffers()}},{key:"_onLoaderCompete",value:function(t){if(t.TAG==="M3U8_BUFFER"){this.m3u8Text=t.shift();try{var i=Xa.parse(this.m3u8Text,this.url);this._playlist.pushM3U8(i)}catch(u){this._onError("M3U8_PARSER_ERROR","PLAYLIST",u,!0)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key)this._context.registry("DECRYPT_BUFFER",jr)(),this._context.registry("KEY_BUFFER",jr)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",Jn)({buffer:"KEY_BUFFER",readtype:3}),this.emitTo("KEY_LOADER",qt.LADER_START,this._playlist.encrypt.uri);else{this.preloadTime||(this._playlist.targetduration?(this.preloadTime=this._playlist.targetduration,this.mse.preloadTime=this._playlist.targetduration):(this.preloadTime=5,this.mse.preloadTime=5));var r=this._playlist.getTs((this._player.currentTime+.5)*1e3);r?(this._logDownSegment(r),this._playlist.downloading(r.url,!0),this.emitTo("TS_LOADER",qt.LADER_START,r.url)):this.retrytimes>0&&(this.retrytimes--,this.emitTo("M3U8_LOADER",qt.LADER_START,this.url))}}else if(t.TAG==="TS_BUFFER")this._playlist.downloaded(this._tsloader.url,!0),this._demuxer.demux(Object.assign({url:this._tsloader.url},this._playlist._ts[this._tsloader.url]),!0),this._preload(this.mse.container.currentTime);else if(t.TAG==="DECRYPT_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",Kl.START_DECRYPT,Object.assign({url:this._tsloader.url},this._playlist._ts[this._tsloader.url]));else if(t.TAG==="KEY_BUFFER"){this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",Nh)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(Kl.DECRYPTED,this._onDcripted.bind(this));var n=this._playlist.getTs();n?(this._playlist.downloading(n.url,!0),this.emitTo("TS_LOADER",qt.LADER_START,n.url)):this.retrytimes>0&&(this.retrytimes--,this.emitTo("M3U8_LOADER",qt.LADER_START,this.url))}}},{key:"_onDcripted",value:function(){this.emit(Br.DEMUX_START)}},{key:"seek",value:function(t){for(var i=this._player.video,r=0;r<i.buffered.length;r++)if(t>=i.buffered.start(r)&&t<i.buffered.end(r))return;$r.warn(this.TAG,"seek: ",t,"tsloading:",this._tsloader.loading);var n=this._playlist.getTs((t+.5)*1e3);n&&this._tsloader.loading&&this._tsloader.url===n.url||(this._lastSeekTime=t,this._tsloader.destroy(),this._tsloader=this._context.registry("TS_LOADER",Jn)({buffer:"TS_BUFFER",readtype:3}),this._presource.sources.video&&(this._presource.sources.video.data=[]),this._presource.sources.audio&&(this._presource.sources.audio.data=[]),this._tracks.audioTrack&&(this._tracks.audioTrack.samples=[]),this._tracks.videoTrack&&(this._tracks.videoTrack.samples=[]),this._compat&&this._compat.reset(),this._tsBuffer&&(this._tsBuffer.array=[],this._tsBuffer.length=0,this._tsBuffer.offset=0),this._playlist.clearDownloaded(),this._context.seek(t),this._preload(t))}},{key:"replay",value:function(){this._compat.reset(),this._playlist.clearDownloaded()}},{key:"load",value:function(t){this.url=t,this.emitTo("M3U8_LOADER",qt.LADER_START,t,null,0)}},{key:"_preload",value:function(t){if(t=Math.floor(t),!this._tsloader.loading){$r.log(this.TAG,"preload: time=",t);var i=this.mse.container,r=-1;!t&&i.buffered.length&&(t=i.buffered.start(0));for(var n=0;n<i.buffered.length;n++)t>=Math.floor(i.buffered.start(n))&&t<=Math.ceil(i.buffered.end(n))&&(r=i.buffered.end(n));if(r<0){var u=this._playlist.getTs((t+.5)*1e3);u&&u.downloaded&&(u=this._playlist.getTs(u.time+u.duration)),u&&!u.downloading&&!u.downloaded&&(this._logDownSegment(u),this._playlist.downloading(u.url,!0),this.emitTo("TS_LOADER",qt.LADER_START,u.url))}else if(r<t+this.preloadTime){var o=this._playlist.getLastDownloadedTs()||this._playlist.getTs(r*1e3);if(!o)return;var d=o.time+o.duration,g=o.time;if(o.downloaded)for(var v=1e3;v-- >0&&(d+=10,o=this._playlist.getTs(d),!(!o||o.time>g)););o&&!o.downloading&&!o.downloaded&&(this._logDownSegment(o),this._playlist.downloading(o.url,!0),this.emitTo("TS_LOADER",qt.LADER_START,o.url))}}}},{key:"cleanBuffer",value:function(){var t=this,i=this._player.currentTime,r=this._player.video,n=r.buffered;if(!(!n||!n.length)){var u=[0,0],o=r.currentTime;if(n)for(var d=0,g=n.length;d<g&&(u[0]=n.start(d),u[1]=n.end(d),!(u[0]<=o&&o<=u[1]));d++);var v=u[0],p=u[1];(i-v>10||n.length>1)&&(this.mse.remove(Math.max(Math.min(i-10,p-10),.1),0),this.bufferClearTimer=setTimeout(function(){t.bufferClearTimer=null},5e3))}}},{key:"destory",value:function(){this.configs={},this.url="",this.sequence=0,this._playlist=null,this.retrytimes=3,this.container=void 0,this.preloadTime=5,this._lastSeekTime=0,this.m3u8Text=null,this.mse=null,this.off(qt.LOADER_COMPLETE,this._onLoaderCompete),this.off(qt.LOADER_ERROR,this._onLoadError),this.off(cr.INIT_SEGMENT,this._onInitSegment),this.off(cr.MEDIA_SEGMENT,this._onMediaSegment),this.off(Br.METADATA_PARSED,this._onMetadataParsed),this.off(Br.DEMUX_COMPLETE,this._onDemuxComplete),this.off("TIME_UPDATE",this._onTimeUpdate),this.off("WAITING",this._onWaiting)}},{key:"_logDownSegment",value:function(t){!t||($r.groupEnd(),$r.group(this.TAG,"load "+t.id+": ["+t.time/1e3+" , "+(t.time+t.duration)/1e3+"], downloading: "+t.downloading+" , donwloaded: "+t.downloaded))}}]),h}(),lp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}(),up=function h(a,t,i,r){var n=Object.getOwnPropertyDescriptor(a,t);if(n===void 0){var u=Object.getPrototypeOf(a);u!==null&&h(u,t,i,r)}else if("value"in n&&n.writable)n.value=i;else{var o=n.set;o!==void 0&&o.call(r,i)}return i},Wr=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}};function fp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function dp(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function cp(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var hp=Uh,Zl=Xt.HlsAllowedEvents,Jl=Xt.REMUX_EVENTS,pp=Xt.HLS_EVENTS,gp=Xt.MSE_EVENTS,vp=function(h){cp(a,h);function a(t){fp(this,a);var i=dp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.util=Ct.util,i.util.deepCopy(i.hlsOps,t),i._handleSetCurrentTime=hp(i._handleSetCurrentTime.bind(i),200),i.onWaiting=i.onWaiting.bind(i),i}return lp(a,[{key:"_handleSetCurrentTime",value:function(i){i=parseFloat(i),i!==this.currentTime&&(up(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"currentTime",i,this),this._context&&this.__core__.seek(i))}},{key:"play",value:function(){var i=this;return this.video.play().catch(function(r){r&&r.code===20&&i.once("canplay",function(){i.video.play()})})}},{key:"replay",value:function(){var i=this;this.__core__.mse.cleanBuffers().then(function(){i.__core__.replay(),Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"replay",i).call(i)})}},{key:"_initEvents",value:function(){var i=this;this.__core__.once(Jl.INIT_SEGMENT,function(){var r=i.__core__.mse;Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",i).call(i,r.url)}),this.__core__.once(pp.RETRY_TIME_EXCEEDED,function(){i.emit("error",new Ct.Errors("network",i.config.url))}),this.__core__.on(gp.SOURCE_UPDATE_END,function(){i._onSourceUpdateEnd()}),this.once("canplay",function(){i.config.autoplay&&i.play()})}},{key:"initHlsBackupEvents",value:function(i,r){var n=this;i.once(Jl.INIT_SEGMENT,function(){if(!n.video.src){console.log("\u6302\u8F7D src blob");var u=i.mse;Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",n).call(n,u.url)}}),i.once(Xt.REMUX_EVENTS.MEDIA_SEGMENT,function(){n.__core__=i,n.__core__.mse.cleanBuffers().then(function(){n.__core__.mse.resetContext(r),n.__core__.mse.doAppend(),n._context=r})}),i.once(Xt.LOADER_EVENTS.LOADER_ERROR,function(){r.destroy()})}},{key:"_onSourceUpdateEnd",value:function(){if(this.video.readyState===1||this.video.readyState===2){var i=this.detectBufferGap(),r=i.gap,n=i.start,u=i.method;r&&(u==="ceil"&&this.currentTime<Math[u](n)?this.currentTime=Math[u](n):u==="floor"&&this.currentTime>Math[u](n)&&(this.currentTime=Math[u](n)))}}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;!i||this.started||(this._context||(this._context=new Wl(this,this.hlsOps,Zl)),this.__core__=this._context.registry("HLS_VOD_CONTROLLER",ql)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.__core__.load(i),this._initEvents(),this.started=!0)}},{key:"switchURL",value:function(i){this.config.url=i;var r=new Wl(this,this.hlsOps,Zl),n=r.registry("HLS_VOD_CONTROLLER",ql)({player:this,container:this.video,mse:this.__core__.mse,preloadTime:this.config.preloadTime});this.newContext=r,this.newHls=n,r.init(),this._context.destroy(),this.initHlsBackupEvents(n,r),this.__core__.mse.cleanBuffers().then(function(){n.load(i)})}},{key:"destroy",value:function(){var i=this;return new Promise(function(r){i.__core__&&i.__core__.mse?(i.__core__.mse.destroy().then(function(){i._context&&i._context.destroy(),Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i),r()}),setTimeout(function(){r()},100)):(Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i),setTimeout(function(){r()},50))})}},{key:"detectBufferGap",value:function(){for(var i=this.video,r={gap:!1,start:-1},n=this.currentTime===0,u=0;u<i.buffered.length;u++){var o=i.buffered.start(u),d=i.buffered.end(u);if((!i.played.length||o<=this.currentTime&&d-this.currentTime>=.5)&&!n)break;var g=o-this.currentTime,v=this.currentTime-d;if(g>.01&&(g<=2||n)){r={gap:!0,start:o,method:"ceil"};break}else v>.1&&(v<=2||n)?r={gap:!0,start:d,method:"floor"}:r={gap:!1,start:-1}}return r}},{key:"currentTime",get:function(){return Wr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"currentTime",this)},set:function(i){this._handleSetCurrentTime(i)}},{key:"src",get:function(){return this.currentSrc},set:function(i){var r=this;this.onWaiting=this.onWaiting.bind(this),this.__core__.mse.destroy().then(function(){r._context.destroy(),r._context=null,r.video.src="",r.video.load(),r.started=!1,r.video.currentTime=0,r.paused?r.play():(r.pause(),r.once("canplay",function(){r.play()})),r.start(i)})}},{key:"context",get:function(){return this._context}}],[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct),yp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function mp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var _p=function(){function h(a){return mp(this,h),a.isLive?new Ul(a):new vp(a)}return yp(h,null,[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(t,i){return Ct.install(t,i)}}]),h}(),xp=_p;const Ep=(h,a)=>{for(let t=0;t<h.length;t++){const i=h.start(t),r=h.end(t);if(a>=i&&a<=r)return!0}return!1};class bp{constructor(){ge(this,"emitter",Yn());ge(this,"loopMode","listloop");ge(this,"playHistory",[]);ge(this,"playList",[]);ge(this,"playInfo",null);ge(this,"playInfoIdKey","id");ge(this,"playHandler",a=>oe(this,null,function*(){return a}));ge(this,"silentMediaEl",new Audio(tf));ge(this,"currentMediaRes",null);ge(this,"xgplayer");ge(this,"videoEl");ge(this,"audioEl",new Pf);ge(this,"mixedMediaSource");ge(this,"customAudioMediaSource");ge(this,"customVideoMediaSource");ge(this,"audioElStatus","waiting");ge(this,"isVideoShow",!1);ge(this,"isVideoPlaying",!1);ge(this,"isVideoWaiting",!1);ge(this,"setCurrentTimeRateBebounce");ge(this,"setCurrentTimeRateing",!1);ge(this,"httpAxios",dn.create());this.silentMediaEl.loop=!0,this.silentMediaEl.autoplay=!1,this.silentMediaEl.volume=.1,this.setCurrentTimeRateBebounce=Js(a=>{this.setCurrentTimeRateing=!1;let t=this.audioEl.duration*(a/100);t>this.audioEl.duration&&(t=this.audioEl.duration),this.audioEl.currentTime=t},500,!1)}selectToPlay(a){return oe(this,null,function*(){console.log("silentAudioEl play"),this.silentMediaEl.play(),this.reset(),this.emitter.emit("changePlayInfo",a);let t=yield this.playHandler(a);this.currentMediaRes=t,this.playInfo=a;let i=this.playHistory.findIndex(r=>r[this.playInfoIdKey]==a[this.playInfoIdKey]);i>=0&&this.playHistory.splice(i,1),this.playHistory.push(wi({},a)),t.type==="url"?this.audioEl.src=t.data.audio:t.type==="arraybuffer"?this.audioEl.src=URL.createObjectURL(new Blob([t.data.audio])):t.type==="rangeurl"?(this.customAudioMediaSource=new co(this.getMediaAxios(t.data.audio),t.data.audio,'audio/mp4; codecs="mp4a.40.2"'),this.audioEl.src=URL.createObjectURL(this.customAudioMediaSource.mediaSource)):t.type==="mixedurl"?(this.mixedMediaSource=new Rf(this.getMediaAxios(t.data.url),t.data.url),this.mixedMediaSource.on("error",r=>{alert(r)}),this.audioEl.src=this.mixedMediaSource.audioUrl,this.videoEl.src=this.mixedMediaSource.videoUrl):t.type==="hlsurl"&&(this.audioEl.src=t.data.url),this.audioEl.load(),this.audioEl.play(),this.isVideoShow&&this.syncVideoPlayByMediaRes(),this.audioEl.addEventListener("canplay",()=>{console.log("silentMediaEl pause"),setTimeout(()=>{this.silentMediaEl.pause()},0),document.pictureInPictureElement&&(this.isVideoPlaying&&document.pictureInPictureElement!=this.videoEl?this.videoEl.requestPictureInPicture():this.xgplayer.root.style.display!="none"&&document.pictureInPictureElement!=this.xgplayer.video&&this.xgplayer.video.requestPictureInPicture())},{once:!0})})}bind(a,t){this.videoEl=a,this.videoEl.muted=!0,this.videoEl.controls=!1,this.videoEl.autoplay=!1,this.xgplayer=new xp({el:t,url:"",autoplay:!0,playsinline:!0,width:"100%",height:"100%",controls:!1,volume:1,keyShortcut:"off",ignores:["time","definition","error","fullscreen","i18n","loading","mobile","pc","play","poster","progress","replay","volume"]}),this.audioEl.bindXgplayer(this.xgplayer),this.audioEl.addEventListener("seeking",i=>{console.log("audioEl seeking",this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaSeeking(this.audioEl)}),this.audioEl.addEventListener("waiting",i=>{console.log("audioEl waiting",this.audioEl.currentTime),this.audioElStatus="waiting",this.customAudioMediaSource&&this.customAudioMediaSource.onMediaWaiting(this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaWaiting(this.audioEl)}),this.audioEl.addEventListener("loadedmetadata",i=>{console.log("audioEl loadedmetadata")}),this.audioEl.addEventListener("canplay",i=>{console.log("audioEl canplay",this.audioEl.currentTime),this.audioElStatus="canplay"}),this.audioEl.addEventListener("timeupdate",i=>{console.log("audioEl timeupdate",this.audioEl.currentTime),this.emitter.emit("timeupdate",{setCurrentTimeRateing:this.setCurrentTimeRateing,audioEl:this.audioEl}),this.customAudioMediaSource&&this.customAudioMediaSource.onMediaTimeupdate(this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaTimeupdate(this.audioEl)}),this.audioEl.addEventListener("play",i=>{console.log("audioEl play",this.audioEl.currentTime),this.emitter.emit("play",this.audioEl)}),this.audioEl.addEventListener("pause",i=>{console.log("audioEl pause",this.audioEl.currentTime),this.emitter.emit("pause",this.audioEl),this.mixedMediaSource&&this.mixedMediaSource.onMediaPause(this.audioEl)}),this.audioEl.addEventListener("ended",i=>{console.log("audioEl ended",this.audioEl.currentTime),this.playNextAduio()}),this.videoEl.addEventListener("waiting",i=>{console.log("videoEl waiting",this.videoEl.currentTime),this.isVideoWaiting=!0,this.customVideoMediaSource&&this.customVideoMediaSource.onMediaWaiting(this.videoEl.currentTime)}),this.videoEl.addEventListener("loadedmetadata",i=>{console.log("videoEl loadedmetadata")}),this.videoEl.addEventListener("canplay",i=>{console.log("videoEl canplay",this.videoEl.currentTime),this.isVideoWaiting=!1}),this.videoEl.addEventListener("timeupdate",i=>{console.log("videoEl timeupdate",this.videoEl.currentTime),this.customVideoMediaSource&&this.customVideoMediaSource.onMediaTimeupdate(this.videoEl.currentTime)}),this.videoEl.addEventListener("play",i=>{console.log("videoEl play",this.videoEl.currentTime)}),this.videoEl.addEventListener("pause",i=>{console.log("videoEl pause",this.videoEl.currentTime)}),this.videoEl.addEventListener("ended",i=>{console.log("videoEl ended",this.videoEl.currentTime)}),this.bindSyncVideoByAudio()}bindBridgeIframe(a){this.audioEl.bindBrigeIframe(a)}play(){return oe(this,null,function*(){this.audioEl.play()})}pause(){return oe(this,null,function*(){setTimeout(()=>{this.audioEl.pause()},0)})}setCurrentTimeRate(a){return oe(this,null,function*(){this.setCurrentTimeRateing=!0,this.setCurrentTimeRateBebounce(a)})}reset(){this.customAudioMediaSource&&(this.customAudioMediaSource.destory(),this.customAudioMediaSource=null),this.mixedMediaSource&&(this.mixedMediaSource.destory(),this.mixedMediaSource=null),this.resetVideoPlayer(),URL.revokeObjectURL(this.audioEl.src),this.audioEl.src="",this.audioEl.load()}setPlayHandler(a){this.playHandler=a}setPlayList(a){this.playList=a}setLoopMode(a){this.loopMode=a}setPlayInfoIdKey(a){this.playInfoIdKey=a}setAxios(a){this.httpAxios=a}getMediaAxios(a){return Si.isOssMediaUrl(a)?Si.getAxios():this.httpAxios}playNextAduio(){let a=-1;if(this.playInfo&&(a=this.playList.findIndex(t=>t[this.playInfoIdKey]==this.playInfo[this.playInfoIdKey])),this.loopMode=="random"){let t=[...this.playList];t.length>1&&t.splice(a,1);let i=Math.floor(t.length*Math.random());if(t.length>0)this.selectToPlay(t[i]);else return}else if(this.loopMode=="listloop")if(a+1<this.playList.length)this.selectToPlay(this.playList[a+1]);else if(this.playList.length>=1)this.selectToPlay(this.playList[0]);else return;else if(this.loopMode=="oneloop")this.audioEl.currentTime=0,this.audioEl.play();else if(this.loopMode=="listplay")if(a+1<this.playList.length)this.selectToPlay(this.playList[a+1]);else return}playPrevAudio(){if(this.playHistory.length<2)throw new Error("\u6CA1\u6709\u4E0A\u4E00\u9996\u53EF\u64AD\u653E\u54E6");let a=this.playHistory.splice(-2,2)[0];this.selectToPlay(a)}setVideoShow(a){var t;if(a!==this.isVideoShow){if(this.isVideoShow=a,((t=this.currentMediaRes)==null?void 0:t.type)==="mixedurl"){this.isVideoShow===!1?(this.isVideoPlaying=!1,this.videoEl.currentTime=0,this.videoEl.pause()):this.audioEl.paused||(this.isVideoPlaying=!0,this.videoEl.play());return}this.isVideoShow===!1?this.resetVideoPlayer():this.audioEl.paused||this.syncVideoPlayByMediaRes()}}syncVideoPlayByMediaRes(){const a=this.currentMediaRes;if(this.isVideoPlaying=!0,a.type==="url"){if(!a.data.video){this.isVideoPlaying=!1;return}this.videoEl.src=a.data.video}else if(a.type==="arraybuffer"){if(!a.data.video){this.isVideoPlaying=!1;return}this.videoEl.src=URL.createObjectURL(new Blob([a.data.video]))}else if(a.type==="rangeurl"){if(!a.data.video){this.isVideoPlaying=!1;return}this.customVideoMediaSource=new co(this.getMediaAxios(a.data.video),a.data.video,'video/mp4; codecs="avc1.640032"'),this.videoEl.src=URL.createObjectURL(this.customVideoMediaSource.mediaSource)}else{if(a.type==="mixedurl")return;if(a.type==="hlsurl"){this.xgplayer.root.style.display=this.isVideoShow?"":"none",this.isVideoPlaying=!1;return}}this.videoEl.load()}syncVideoCurrentStatus(a){if(a&&this.videoEl.paused)return this.videoEl.play(),!0;if(!a&&!this.videoEl.paused)return setTimeout(()=>{this.videoEl.pause()},0),!0}syncVideoCurrentTime(a){if(Math.abs(a-this.videoEl.currentTime)>.15){if(this.currentMediaRes.type=="rangeurl"){if(this.isVideoWaiting)return!1}else if(Ep(this.videoEl.buffered,a)==!1)return!1;return this.videoEl.currentTime=a,!0}else return!1}resetVideoPlayer(){this.customVideoMediaSource&&(this.customVideoMediaSource.destory(),this.customVideoMediaSource=null),this.xgplayer.root.style.display="none",this.isVideoPlaying=!1,this.isVideoWaiting=!1,this.videoEl&&(URL.revokeObjectURL(this.videoEl.src),this.videoEl.src="",this.videoEl.poster="",this.videoEl.load())}bindSyncVideoByAudio(){this.audioEl.addEventListener("play",()=>{}),this.audioEl.addEventListener("pause",()=>{!this.isVideoPlaying||this.videoEl.pause()}),this.audioEl.addEventListener("waiting",()=>{if(!this.isVideoPlaying||document.visibilityState==="hidden"&&!document.pictureInPictureElement)return;this.syncVideoCurrentTime(this.audioEl.currentTime)&&console.log("\u97F3\u753B\u65F6\u95F4\u4FEE\u6B63")}),this.audioEl.addEventListener("timeupdate",()=>{if(!this.isVideoPlaying||document.visibilityState==="hidden"&&!document.pictureInPictureElement)return;this.syncVideoCurrentTime(this.audioEl.currentTime)&&console.log("\u97F3\u753B\u65F6\u95F4\u4FEE\u6B63"),a()}),this.videoEl.addEventListener("timeupdate",()=>{!this.isVideoPlaying||a()});const a=rf(()=>{if(!!this.isVideoPlaying)if(document.visibilityState==="hidden"&&!document.pictureInPictureElement)this.syncVideoCurrentStatus(!1);else{let t=!this.audioEl.paused;t&&this.audioElStatus=="waiting"&&(t=!1),this.syncVideoCurrentStatus(t)&&console.log("\u97F3\u753B\u72B6\u6001\u4FEE\u6B63")}},350,{leading:!1,trailing:!0})}on(a,t){this.emitter.on(a,t)}once(a,t){let i=r=>{this.emitter.off(a,i),t(r)};this.emitter.on(a,i)}}var Ql={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(h,a){(function(t){h.exports=t()})(function(){return function t(i,r,n){function u(g,v){if(!r[g]){if(!i[g]){var p=typeof Nn=="function"&&Nn;if(!v&&p)return p(g,!0);if(o)return o(g,!0);var e=new Error("Cannot find module '"+g+"'");throw e.code="MODULE_NOT_FOUND",e}var s=r[g]={exports:{}};i[g][0].call(s.exports,function(l){var f=i[g][1][l];return u(f||l)},s,s.exports,t,i,r,n)}return r[g].exports}for(var o=typeof Nn=="function"&&Nn,d=0;d<n.length;d++)u(n[d]);return u}({1:[function(t,i,r){var n=t("./utils"),u=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(d){for(var g,v,p,e,s,l,f,c=[],y=0,m=d.length,_=m,E=n.getTypeOf(d)!=="string";y<d.length;)_=m-y,p=E?(g=d[y++],v=y<m?d[y++]:0,y<m?d[y++]:0):(g=d.charCodeAt(y++),v=y<m?d.charCodeAt(y++):0,y<m?d.charCodeAt(y++):0),e=g>>2,s=(3&g)<<4|v>>4,l=1<_?(15&v)<<2|p>>6:64,f=2<_?63&p:64,c.push(o.charAt(e)+o.charAt(s)+o.charAt(l)+o.charAt(f));return c.join("")},r.decode=function(d){var g,v,p,e,s,l,f=0,c=0,y="data:";if(d.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var m,_=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===o.charAt(64)&&_--,d.charAt(d.length-2)===o.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=u.uint8array?new Uint8Array(0|_):new Array(0|_);f<d.length;)g=o.indexOf(d.charAt(f++))<<2|(e=o.indexOf(d.charAt(f++)))>>4,v=(15&e)<<4|(s=o.indexOf(d.charAt(f++)))>>2,p=(3&s)<<6|(l=o.indexOf(d.charAt(f++))),m[c++]=g,s!==64&&(m[c++]=v),l!==64&&(m[c++]=p);return m}},{"./support":30,"./utils":32}],2:[function(t,i,r){var n=t("./external"),u=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),d=t("./stream/DataLengthProbe");function g(v,p,e,s,l){this.compressedSize=v,this.uncompressedSize=p,this.crc32=e,this.compression=s,this.compressedContent=l}g.prototype={getContentWorker:function(){var v=new u(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),p=this;return v.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new u(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(v,p,e){return v.pipe(new o).pipe(new d("uncompressedSize")).pipe(p.compressWorker(e)).pipe(new d("compressedSize")).withStreamInfo("compression",p)},i.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var n=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var n=t("./utils"),u=function(){for(var o,d=[],g=0;g<256;g++){o=g;for(var v=0;v<8;v++)o=1&o?3988292384^o>>>1:o>>>1;d[g]=o}return d}();i.exports=function(o,d){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?function(g,v,p,e){var s=u,l=e+p;g^=-1;for(var f=e;f<l;f++)g=g>>>8^s[255&(g^v[f])];return-1^g}(0|d,o,o.length,0):function(g,v,p,e){var s=u,l=e+p;g^=-1;for(var f=e;f<l;f++)g=g>>>8^s[255&(g^v.charCodeAt(f))];return-1^g}(0|d,o,o.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var n=null;n=typeof Promise!="undefined"?Promise:t("lie"),i.exports={Promise:n}},{lie:37}],7:[function(t,i,r){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",u=t("pako"),o=t("./utils"),d=t("./stream/GenericWorker"),g=n?"uint8array":"array";function v(p,e){d.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=e,this.meta={}}r.magic="\b\0",o.inherits(v,d),v.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(g,p.data),!1)},v.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new u[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(e){p.push({data:e,meta:p.meta})}},r.compressWorker=function(p){return new v("Deflate",p)},r.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function n(s,l){var f,c="";for(f=0;f<l;f++)c+=String.fromCharCode(255&s),s>>>=8;return c}function u(s,l,f,c,y,m){var _,E,w=s.file,k=s.compression,x=m!==g.utf8encode,S=o.transformTo("string",m(w.name)),B=o.transformTo("string",g.utf8encode(w.name)),U=w.comment,R=o.transformTo("string",m(U)),C=o.transformTo("string",g.utf8encode(U)),A=B.length!==w.name.length,b=C.length!==U.length,O="",W="",K="",G=w.dir,F=w.date,j={crc32:0,compressedSize:0,uncompressedSize:0};l&&!f||(j.crc32=s.crc32,j.compressedSize=s.compressedSize,j.uncompressedSize=s.uncompressedSize);var N=0;l&&(N|=8),x||!A&&!b||(N|=2048);var $=0,Z=0;G&&($|=16),y==="UNIX"?(Z=798,$|=function(ae,Ee){var Te=ae;return ae||(Te=Ee?16893:33204),(65535&Te)<<16}(w.unixPermissions,G)):(Z=20,$|=function(ae){return 63&(ae||0)}(w.dosPermissions)),_=F.getUTCHours(),_<<=6,_|=F.getUTCMinutes(),_<<=5,_|=F.getUTCSeconds()/2,E=F.getUTCFullYear()-1980,E<<=4,E|=F.getUTCMonth()+1,E<<=5,E|=F.getUTCDate(),A&&(W=n(1,1)+n(v(S),4)+B,O+="up"+n(W.length,2)+W),b&&(K=n(1,1)+n(v(R),4)+C,O+="uc"+n(K.length,2)+K);var te="";return te+=`
\0`,te+=n(N,2),te+=k.magic,te+=n(_,2),te+=n(E,2),te+=n(j.crc32,4),te+=n(j.compressedSize,4),te+=n(j.uncompressedSize,4),te+=n(S.length,2),te+=n(O.length,2),{fileRecord:p.LOCAL_FILE_HEADER+te+S+O,dirRecord:p.CENTRAL_FILE_HEADER+n(Z,2)+te+n(R.length,2)+"\0\0\0\0"+n($,4)+n(c,4)+S+O+R}}var o=t("../utils"),d=t("../stream/GenericWorker"),g=t("../utf8"),v=t("../crc32"),p=t("../signature");function e(s,l,f,c){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=l,this.zipPlatform=f,this.encodeFileName=c,this.streamFiles=s,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(e,d),e.prototype.push=function(s){var l=s.meta.percent||0,f=this.entriesCount,c=this._sources.length;this.accumulate?this.contentBuffer.push(s):(this.bytesWritten+=s.data.length,d.prototype.push.call(this,{data:s.data,meta:{currentFile:this.currentFile,percent:f?(l+100*(f-c-1))/f:100}}))},e.prototype.openedSource=function(s){this.currentSourceOffset=this.bytesWritten,this.currentFile=s.file.name;var l=this.streamFiles&&!s.file.dir;if(l){var f=u(s,l,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},e.prototype.closedSource=function(s){this.accumulate=!1;var l=this.streamFiles&&!s.file.dir,f=u(s,l,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),l)this.push({data:function(c){return p.DATA_DESCRIPTOR+n(c.crc32,4)+n(c.compressedSize,4)+n(c.uncompressedSize,4)}(s),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},e.prototype.flush=function(){for(var s=this.bytesWritten,l=0;l<this.dirRecords.length;l++)this.push({data:this.dirRecords[l],meta:{percent:100}});var f=this.bytesWritten-s,c=function(y,m,_,E,w){var k=o.transformTo("string",w(E));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(y,2)+n(y,2)+n(m,4)+n(_,4)+n(k.length,2)+k}(this.dirRecords.length,f,s,this.zipComment,this.encodeFileName);this.push({data:c,meta:{percent:100}})},e.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},e.prototype.registerPrevious=function(s){this._sources.push(s);var l=this;return s.on("data",function(f){l.processChunk(f)}),s.on("end",function(){l.closedSource(l.previous.streamInfo),l._sources.length?l.prepareNextSource():l.end()}),s.on("error",function(f){l.error(f)}),this},e.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},e.prototype.error=function(s){var l=this._sources;if(!d.prototype.error.call(this,s))return!1;for(var f=0;f<l.length;f++)try{l[f].error(s)}catch(c){}return!0},e.prototype.lock=function(){d.prototype.lock.call(this);for(var s=this._sources,l=0;l<s.length;l++)s[l].lock()},i.exports=e},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var n=t("../compressions"),u=t("./ZipFileWorker");r.generateWorker=function(o,d,g){var v=new u(d.streamFiles,g,d.platform,d.encodeFileName),p=0;try{o.forEach(function(e,s){p++;var l=function(m,_){var E=m||_,w=n[E];if(!w)throw new Error(E+" is not a valid compression method !");return w}(s.options.compression,d.compression),f=s.options.compressionOptions||d.compressionOptions||{},c=s.dir,y=s.date;s._compressWorker(l,f).withStreamInfo("file",{name:e,dir:c,date:y,comment:s.comment||"",unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions}).pipe(v)}),v.entriesCount=p}catch(e){v.error(e)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var u=new n;for(var o in this)typeof this[o]!="function"&&(u[o]=this[o]);return u}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(u,o){return new n().loadAsync(u,o)},n.external=t("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var n=t("./utils"),u=t("./external"),o=t("./utf8"),d=t("./zipEntries"),g=t("./stream/Crc32Probe"),v=t("./nodejsUtils");function p(e){return new u.Promise(function(s,l){var f=e.decompressed.getContentWorker().pipe(new g);f.on("error",function(c){l(c)}).on("end",function(){f.streamInfo.crc32!==e.decompressed.crc32?l(new Error("Corrupted zip : CRC32 mismatch")):s()}).resume()})}i.exports=function(e,s){var l=this;return s=n.extend(s||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),v.isNode&&v.isStream(e)?u.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,s.optimizedBinaryString,s.base64).then(function(f){var c=new d(s);return c.load(f),c}).then(function(f){var c=[u.Promise.resolve(f)],y=f.files;if(s.checkCRC32)for(var m=0;m<y.length;m++)c.push(p(y[m]));return u.Promise.all(c)}).then(function(f){for(var c=f.shift(),y=c.files,m=0;m<y.length;m++){var _=y[m],E=_.fileNameStr,w=n.resolve(_.fileNameStr);l.file(w,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:s.createFolders}),_.dir||(l.file(w).unsafeOriginalName=E)}return c.zipComment.length&&(l.comment=c.zipComment),l})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var n=t("../utils"),u=t("../stream/GenericWorker");function o(d,g){u.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(g)}n.inherits(o,u),o.prototype._bindStream=function(d){var g=this;(this._stream=d).pause(),d.on("data",function(v){g.push({data:v,meta:{percent:0}})}).on("error",function(v){g.isPaused?this.generatedError=v:g.error(v)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},o.prototype.pause=function(){return!!u.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var n=t("readable-stream").Readable;function u(o,d,g){n.call(this,d),this._helper=o;var v=this;o.on("data",function(p,e){v.push(p)||v._helper.pause(),g&&g(e)}).on("error",function(p){v.emit("error",p)}).on("end",function(){v.push(null)})}t("../utils").inherits(u,n),u.prototype._read=function(){this._helper.resume()},i.exports=u},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,u){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,u);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,u)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var u=new Buffer(n);return u.fill(0),u},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,i,r){function n(w,k,x){var S,B=o.getTypeOf(k),U=o.extend(x||{},v);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(w=y(w)),U.createFolders&&(S=c(w))&&m.call(this,S,!0);var R=B==="string"&&U.binary===!1&&U.base64===!1;x&&x.binary!==void 0||(U.binary=!R),(k instanceof p&&k.uncompressedSize===0||U.dir||!k||k.length===0)&&(U.base64=!1,U.binary=!0,k="",U.compression="STORE",B="string");var C=null;C=k instanceof p||k instanceof d?k:l.isNode&&l.isStream(k)?new f(w,k):o.prepareContent(w,k,U.binary,U.optimizedBinaryString,U.base64);var A=new e(w,C,U);this.files[w]=A}var u=t("./utf8"),o=t("./utils"),d=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),v=t("./defaults"),p=t("./compressedObject"),e=t("./zipObject"),s=t("./generate"),l=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),c=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var k=w.lastIndexOf("/");return 0<k?w.substring(0,k):""},y=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},m=function(w,k){return k=k!==void 0?k:v.createFolders,w=y(w),this.files[w]||n.call(this,w,null,{dir:!0,createFolders:k}),this.files[w]};function _(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var k,x,S;for(k in this.files)S=this.files[k],(x=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&w(x,S)},filter:function(w){var k=[];return this.forEach(function(x,S){w(x,S)&&k.push(S)}),k},file:function(w,k,x){if(arguments.length!==1)return w=this.root+w,n.call(this,w,k,x),this;if(_(w)){var S=w;return this.filter(function(U,R){return!R.dir&&S.test(U)})}var B=this.files[this.root+w];return B&&!B.dir?B:null},folder:function(w){if(!w)return this;if(_(w))return this.filter(function(B,U){return U.dir&&w.test(B)});var k=this.root+w,x=m.call(this,k),S=this.clone();return S.root=x.name,S},remove:function(w){w=this.root+w;var k=this.files[w];if(k||(w.slice(-1)!=="/"&&(w+="/"),k=this.files[w]),k&&!k.dir)delete this.files[w];else for(var x=this.filter(function(B,U){return U.name.slice(0,w.length)===w}),S=0;S<x.length;S++)delete this.files[x[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var k,x={};try{if((x=o.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:u.utf8encode})).type=x.type.toLowerCase(),x.compression=x.compression.toUpperCase(),x.type==="binarystring"&&(x.type="string"),!x.type)throw new Error("No output type specified.");o.checkSupport(x.type),x.platform!=="darwin"&&x.platform!=="freebsd"&&x.platform!=="linux"&&x.platform!=="sunos"||(x.platform="UNIX"),x.platform==="win32"&&(x.platform="DOS");var S=x.comment||this.comment||"";k=s.generateWorker(this,x,S)}catch(B){(k=new d("error")).error(B)}return new g(k,x.type||"string",x.mimeType)},generateAsync:function(w,k){return this.generateInternalStream(w).accumulate(k)},generateNodeStream:function(w,k){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(k)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var n=t("./DataReader");function u(o){n.call(this,o);for(var d=0;d<this.data.length;d++)o[d]=255&o[d]}t("../utils").inherits(u,n),u.prototype.byteAt=function(o){return this.data[this.zero+o]},u.prototype.lastIndexOfSignature=function(o){for(var d=o.charCodeAt(0),g=o.charCodeAt(1),v=o.charCodeAt(2),p=o.charCodeAt(3),e=this.length-4;0<=e;--e)if(this.data[e]===d&&this.data[e+1]===g&&this.data[e+2]===v&&this.data[e+3]===p)return e-this.zero;return-1},u.prototype.readAndCheckSignature=function(o){var d=o.charCodeAt(0),g=o.charCodeAt(1),v=o.charCodeAt(2),p=o.charCodeAt(3),e=this.readData(4);return d===e[0]&&g===e[1]&&v===e[2]&&p===e[3]},u.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=u},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var n=t("../utils");function u(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}u.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var d,g=0;for(this.checkOffset(o),d=this.index+o-1;d>=this.index;d--)g=(g<<8)+this.byteAt(d);return this.index+=o,g},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=u},{"../utils":32}],19:[function(t,i,r){var n=t("./Uint8ArrayReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=u},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var n=t("./DataReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},u.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},u.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},u.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=u},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var n=t("./ArrayReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},i.exports=u},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var n=t("../utils"),u=t("../support"),o=t("./ArrayReader"),d=t("./StringReader"),g=t("./NodeBufferReader"),v=t("./Uint8ArrayReader");i.exports=function(p){var e=n.getTypeOf(p);return n.checkSupport(e),e!=="string"||u.uint8array?e==="nodebuffer"?new g(p):u.uint8array?new v(n.transformTo("uint8array",p)):new o(n.transformTo("array",p)):new d(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var n=t("./GenericWorker"),u=t("../utils");function o(d){n.call(this,"ConvertWorker to "+d),this.destType=d}u.inherits(o,n),o.prototype.processChunk=function(d){this.push({data:u.transformTo(this.destType,d.data),meta:d.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var n=t("./GenericWorker"),u=t("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,n),o.prototype.processChunk=function(d){this.streamInfo.crc32=u(d.data,this.streamInfo.crc32||0),this.push(d)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var n=t("../utils"),u=t("./GenericWorker");function o(d){u.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}n.inherits(o,u),o.prototype.processChunk=function(d){if(d){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+d.data.length}u.prototype.processChunk.call(this,d)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var n=t("../utils"),u=t("./GenericWorker");function o(d){u.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(v){g.dataIsReady=!0,g.data=v,g.max=v&&v.length||0,g.type=n.getTypeOf(v),g.isPaused||g._tickAndRepeat()},function(v){g.error(v)})}n.inherits(o,u),o.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,g);break;case"uint8array":d=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":d=this.data.slice(this.index,g)}return this.index=g,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function n(u){this.name=u||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(u){this.emit("data",u)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(u){this.emit("error",u)}return!0},error:function(u){return!this.isFinished&&(this.isPaused?this.generatedError=u:(this.isFinished=!0,this.emit("error",u),this.previous&&this.previous.error(u),this.cleanUp()),!0)},on:function(u,o){return this._listeners[u].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(u,o){if(this._listeners[u])for(var d=0;d<this._listeners[u].length;d++)this._listeners[u][d].call(this,o)},pipe:function(u){return u.registerPrevious(this)},registerPrevious:function(u){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=u.streamInfo,this.mergeStreamInfo(),this.previous=u;var o=this;return u.on("data",function(d){o.processChunk(d)}),u.on("end",function(){o.end()}),u.on("error",function(d){o.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var u=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),u=!0),this.previous&&this.previous.resume(),!u},flush:function(){},processChunk:function(u){this.push(u)},withStreamInfo:function(u,o){return this.extraStreamInfo[u]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var u in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,u)&&(this.streamInfo[u]=this.extraStreamInfo[u])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var u="Worker "+this.name;return this.previous?this.previous+" -> "+u:u}},i.exports=n},{}],29:[function(t,i,r){var n=t("../utils"),u=t("./ConvertWorker"),o=t("./GenericWorker"),d=t("../base64"),g=t("../support"),v=t("../external"),p=null;if(g.nodestream)try{p=t("../nodejs/NodejsStreamOutputAdapter")}catch(l){}function e(l,f){return new v.Promise(function(c,y){var m=[],_=l._internalType,E=l._outputType,w=l._mimeType;l.on("data",function(k,x){m.push(k),f&&f(x)}).on("error",function(k){m=[],y(k)}).on("end",function(){try{var k=function(x,S,B){switch(x){case"blob":return n.newBlob(n.transformTo("arraybuffer",S),B);case"base64":return d.encode(S);default:return n.transformTo(x,S)}}(E,function(x,S){var B,U=0,R=null,C=0;for(B=0;B<S.length;B++)C+=S[B].length;switch(x){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(R=new Uint8Array(C),B=0;B<S.length;B++)R.set(S[B],U),U+=S[B].length;return R;case"nodebuffer":return Buffer.concat(S);default:throw new Error("concat : unsupported type '"+x+"'")}}(_,m),w);c(k)}catch(x){y(x)}m=[]}).resume()})}function s(l,f,c){var y=f;switch(f){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=f,this._mimeType=c,n.checkSupport(y),this._worker=l.pipe(new u(y)),l.lock()}catch(m){this._worker=new o("error"),this._worker.error(m)}}s.prototype={accumulate:function(l){return e(this,l)},on:function(l,f){var c=this;return l==="data"?this._worker.on(l,function(y){f.call(c,y.data,y.meta)}):this._worker.on(l,function(){n.delay(f,arguments,c)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(l){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},l)}},i.exports=s},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",r.nodebuffer=typeof Buffer!="undefined",r.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=new Blob([n],{type:"application/zip"}).size===0}catch(o){try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);u.append(n),r.blob=u.getBlob("application/zip").size===0}catch(d){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(o){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var n=t("./utils"),u=t("./support"),o=t("./nodejsUtils"),d=t("./stream/GenericWorker"),g=new Array(256),v=0;v<256;v++)g[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;g[254]=g[254]=1;function p(){d.call(this,"utf-8 decode"),this.leftOver=null}function e(){d.call(this,"utf-8 encode")}r.utf8encode=function(s){return u.nodebuffer?o.newBufferFrom(s,"utf-8"):function(l){var f,c,y,m,_,E=l.length,w=0;for(m=0;m<E;m++)(64512&(c=l.charCodeAt(m)))==55296&&m+1<E&&(64512&(y=l.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(y-56320),m++),w+=c<128?1:c<2048?2:c<65536?3:4;for(f=u.uint8array?new Uint8Array(w):new Array(w),m=_=0;_<w;m++)(64512&(c=l.charCodeAt(m)))==55296&&m+1<E&&(64512&(y=l.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(y-56320),m++),c<128?f[_++]=c:(c<2048?f[_++]=192|c>>>6:(c<65536?f[_++]=224|c>>>12:(f[_++]=240|c>>>18,f[_++]=128|c>>>12&63),f[_++]=128|c>>>6&63),f[_++]=128|63&c);return f}(s)},r.utf8decode=function(s){return u.nodebuffer?n.transformTo("nodebuffer",s).toString("utf-8"):function(l){var f,c,y,m,_=l.length,E=new Array(2*_);for(f=c=0;f<_;)if((y=l[f++])<128)E[c++]=y;else if(4<(m=g[y]))E[c++]=65533,f+=m-1;else{for(y&=m===2?31:m===3?15:7;1<m&&f<_;)y=y<<6|63&l[f++],m--;1<m?E[c++]=65533:y<65536?E[c++]=y:(y-=65536,E[c++]=55296|y>>10&1023,E[c++]=56320|1023&y)}return E.length!==c&&(E.subarray?E=E.subarray(0,c):E.length=c),n.applyFromCharCode(E)}(s=n.transformTo(u.uint8array?"uint8array":"array",s))},n.inherits(p,d),p.prototype.processChunk=function(s){var l=n.transformTo(u.uint8array?"uint8array":"array",s.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var f=l;(l=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),l.set(f,this.leftOver.length)}else l=this.leftOver.concat(l);this.leftOver=null}var c=function(m,_){var E;for((_=_||m.length)>m.length&&(_=m.length),E=_-1;0<=E&&(192&m[E])==128;)E--;return E<0||E===0?_:E+g[m[E]]>_?E:_}(l),y=l;c!==l.length&&(u.uint8array?(y=l.subarray(0,c),this.leftOver=l.subarray(c,l.length)):(y=l.slice(0,c),this.leftOver=l.slice(c,l.length))),this.push({data:r.utf8decode(y),meta:s.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=p,n.inherits(e,d),e.prototype.processChunk=function(s){this.push({data:r.utf8encode(s.data),meta:s.meta})},r.Utf8EncodeWorker=e},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var n=t("./support"),u=t("./base64"),o=t("./nodejsUtils"),d=t("./external");function g(f){return f}function v(f,c){for(var y=0;y<f.length;++y)c[y]=255&f.charCodeAt(y);return c}t("setimmediate"),r.newBlob=function(f,c){r.checkSupport("blob");try{return new Blob([f],{type:c})}catch(m){try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(f),y.getBlob(c)}catch(_){throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(f,c,y){var m=[],_=0,E=f.length;if(E<=y)return String.fromCharCode.apply(null,f);for(;_<E;)c==="array"||c==="nodebuffer"?m.push(String.fromCharCode.apply(null,f.slice(_,Math.min(_+y,E)))):m.push(String.fromCharCode.apply(null,f.subarray(_,Math.min(_+y,E)))),_+=y;return m.join("")},stringifyByChar:function(f){for(var c="",y=0;y<f.length;y++)c+=String.fromCharCode(f[y]);return c},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(f){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch(f){return!1}}()}};function e(f){var c=65536,y=r.getTypeOf(f),m=!0;if(y==="uint8array"?m=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(m=p.applyCanBeUsed.nodebuffer),m)for(;1<c;)try{return p.stringifyByChunk(f,y,c)}catch(_){c=Math.floor(c/2)}return p.stringifyByChar(f)}function s(f,c){for(var y=0;y<f.length;y++)c[y]=f[y];return c}r.applyFromCharCode=e;var l={};l.string={string:g,array:function(f){return v(f,new Array(f.length))},arraybuffer:function(f){return l.string.uint8array(f).buffer},uint8array:function(f){return v(f,new Uint8Array(f.length))},nodebuffer:function(f){return v(f,o.allocBuffer(f.length))}},l.array={string:e,array:g,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(f)}},l.arraybuffer={string:function(f){return e(new Uint8Array(f))},array:function(f){return s(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:g,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(new Uint8Array(f))}},l.uint8array={string:e,array:function(f){return s(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:g,nodebuffer:function(f){return o.newBufferFrom(f)}},l.nodebuffer={string:e,array:function(f){return s(f,new Array(f.length))},arraybuffer:function(f){return l.nodebuffer.uint8array(f).buffer},uint8array:function(f){return s(f,new Uint8Array(f.length))},nodebuffer:g},r.transformTo=function(f,c){if(c=c||"",!f)return c;r.checkSupport(f);var y=r.getTypeOf(c);return l[y][f](c)},r.resolve=function(f){for(var c=f.split("/"),y=[],m=0;m<c.length;m++){var _=c[m];_==="."||_===""&&m!==0&&m!==c.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},r.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(f)?"nodebuffer":n.uint8array&&f instanceof Uint8Array?"uint8array":n.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(f){if(!n[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(f){var c,y,m="";for(y=0;y<(f||"").length;y++)m+="\\x"+((c=f.charCodeAt(y))<16?"0":"")+c.toString(16).toUpperCase();return m},r.delay=function(f,c,y){setImmediate(function(){f.apply(y||null,c||[])})},r.inherits=function(f,c){function y(){}y.prototype=c.prototype,f.prototype=new y},r.extend=function(){var f,c,y={};for(f=0;f<arguments.length;f++)for(c in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],c)&&y[c]===void 0&&(y[c]=arguments[f][c]);return y},r.prepareContent=function(f,c,y,m,_){return d.Promise.resolve(c).then(function(E){return n.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader!="undefined"?new d.Promise(function(w,k){var x=new FileReader;x.onload=function(S){w(S.target.result)},x.onerror=function(S){k(S.target.error)},x.readAsArrayBuffer(E)}):E}).then(function(E){var w=r.getTypeOf(E);return w?(w==="arraybuffer"?E=r.transformTo("uint8array",E):w==="string"&&(_?E=u.decode(E):y&&m!==!0&&(E=function(k){return v(k,n.uint8array?new Uint8Array(k.length):new Array(k.length))}(E))),E):d.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var n=t("./reader/readerFor"),u=t("./utils"),o=t("./signature"),d=t("./zipEntry"),g=t("./support");function v(p){this.files=[],this.loadOptions=p}v.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+u.pretty(e)+", expected "+u.pretty(p)+")")}},isSignature:function(p,e){var s=this.reader.index;this.reader.setIndex(p);var l=this.reader.readString(4)===e;return this.reader.setIndex(s),l},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),e=g.uint8array?"uint8array":"array",s=u.transformTo(e,p);this.zipComment=this.loadOptions.decodeFileName(s)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,e,s,l=this.zip64EndOfCentralSize-44;0<l;)p=this.reader.readInt(2),e=this.reader.readInt(4),s=this.reader.readData(e),this.zip64ExtensibleData[p]={id:p,length:e,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,e;for(p=0;p<this.files.length;p++)e=this.files[p],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(p=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var e=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===u.MAX_VALUE_16BITS||this.diskWithCentralDirStart===u.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===u.MAX_VALUE_16BITS||this.centralDirRecords===u.MAX_VALUE_16BITS||this.centralDirSize===u.MAX_VALUE_32BITS||this.centralDirOffset===u.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var s=this.centralDirOffset+this.centralDirSize;this.zip64&&(s+=20,s+=12+this.zip64EndOfCentralSize);var l=e-s;if(0<l)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=l);else if(l<0)throw new Error("Corrupted zip: missing "+Math.abs(l)+" bytes.")},prepareReader:function(p){this.reader=n(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var n=t("./reader/readerFor"),u=t("./utils"),o=t("./compressedObject"),d=t("./crc32"),g=t("./utf8"),v=t("./compressions"),p=t("./support");function e(s,l){this.options=s,this.loadOptions=l}e.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(s){var l,f;if(s.skip(22),this.fileNameLength=s.readInt(2),f=s.readInt(2),this.fileName=s.readData(this.fileNameLength),s.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((l=function(c){for(var y in v)if(Object.prototype.hasOwnProperty.call(v,y)&&v[y].magic===c)return v[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+u.pretty(this.compressionMethod)+" unknown (inner file : "+u.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,l,s.readData(this.compressedSize))},readCentralPart:function(s){this.versionMadeBy=s.readInt(2),s.skip(2),this.bitFlag=s.readInt(2),this.compressionMethod=s.readString(2),this.date=s.readDate(),this.crc32=s.readInt(4),this.compressedSize=s.readInt(4),this.uncompressedSize=s.readInt(4);var l=s.readInt(2);if(this.extraFieldsLength=s.readInt(2),this.fileCommentLength=s.readInt(2),this.diskNumberStart=s.readInt(2),this.internalFileAttributes=s.readInt(2),this.externalFileAttributes=s.readInt(4),this.localHeaderOffset=s.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");s.skip(l),this.readExtraFields(s),this.parseZIP64ExtraField(s),this.fileComment=s.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var s=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),s==0&&(this.dosPermissions=63&this.externalFileAttributes),s==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var s=n(this.extraFields[1].value);this.uncompressedSize===u.MAX_VALUE_32BITS&&(this.uncompressedSize=s.readInt(8)),this.compressedSize===u.MAX_VALUE_32BITS&&(this.compressedSize=s.readInt(8)),this.localHeaderOffset===u.MAX_VALUE_32BITS&&(this.localHeaderOffset=s.readInt(8)),this.diskNumberStart===u.MAX_VALUE_32BITS&&(this.diskNumberStart=s.readInt(4))}},readExtraFields:function(s){var l,f,c,y=s.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});s.index+4<y;)l=s.readInt(2),f=s.readInt(2),c=s.readData(f),this.extraFields[l]={id:l,length:f,value:c};s.setIndex(y)},handleUTF8:function(){var s=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var l=this.findExtraFieldUnicodePath();if(l!==null)this.fileNameStr=l;else{var f=u.transformTo(s,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var c=this.findExtraFieldUnicodeComment();if(c!==null)this.fileCommentStr=c;else{var y=u.transformTo(s,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var s=this.extraFields[28789];if(s){var l=n(s.value);return l.readInt(1)!==1||d(this.fileName)!==l.readInt(4)?null:g.utf8decode(l.readData(s.length-5))}return null},findExtraFieldUnicodeComment:function(){var s=this.extraFields[25461];if(s){var l=n(s.value);return l.readInt(1)!==1||d(this.fileComment)!==l.readInt(4)?null:g.utf8decode(l.readData(s.length-5))}return null}},i.exports=e},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function n(l,f,c){this.name=l,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=f,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}}var u=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),d=t("./utf8"),g=t("./compressedObject"),v=t("./stream/GenericWorker");n.prototype={internalStream:function(l){var f=null,c="string";try{if(!l)throw new Error("No output type specified.");var y=(c=l.toLowerCase())==="string"||c==="text";c!=="binarystring"&&c!=="text"||(c="string"),f=this._decompressWorker();var m=!this._dataBinary;m&&!y&&(f=f.pipe(new d.Utf8EncodeWorker)),!m&&y&&(f=f.pipe(new d.Utf8DecodeWorker))}catch(_){(f=new v("error")).error(_)}return new u(f,c,"")},async:function(l,f){return this.internalStream(l).accumulate(f)},nodeStream:function(l,f){return this.internalStream(l||"nodebuffer").toNodejsStream(f)},_compressWorker:function(l,f){if(this._data instanceof g&&this._data.compression.magic===l.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new d.Utf8EncodeWorker)),g.createWorkerFrom(c,l,f)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof v?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],e=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},s=0;s<p.length;s++)n.prototype[p[s]]=e;i.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(n){var u,o,d=n.MutationObserver||n.WebKitMutationObserver;if(d){var g=0,v=new d(l),p=n.document.createTextNode("");v.observe(p,{characterData:!0}),u=function(){p.data=g=++g%2}}else if(n.setImmediate||n.MessageChannel===void 0)u="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var f=n.document.createElement("script");f.onreadystatechange=function(){l(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},n.document.documentElement.appendChild(f)}:function(){setTimeout(l,0)};else{var e=new n.MessageChannel;e.port1.onmessage=l,u=function(){e.port2.postMessage(0)}}var s=[];function l(){var f,c;o=!0;for(var y=s.length;y;){for(c=s,s=[],f=-1;++f<y;)c[f]();y=s.length}o=!1}i.exports=function(f){s.push(f)!==1||o||u()}}).call(this,typeof cn!="undefined"?cn:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(t,i,r){var n=t("immediate");function u(){}var o={},d=["REJECTED"],g=["FULFILLED"],v=["PENDING"];function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,y!==u&&f(this,y)}function e(y,m,_){this.promise=y,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function s(y,m,_){n(function(){var E;try{E=m(_)}catch(w){return o.reject(y,w)}E===y?o.reject(y,new TypeError("Cannot resolve promise with itself")):o.resolve(y,E)})}function l(y){var m=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof m=="function")return function(){m.apply(y,arguments)}}function f(y,m){var _=!1;function E(x){_||(_=!0,o.reject(y,x))}function w(x){_||(_=!0,o.resolve(y,x))}var k=c(function(){m(w,E)});k.status==="error"&&E(k.value)}function c(y,m){var _={};try{_.value=y(m),_.status="success"}catch(E){_.status="error",_.value=E}return _}(i.exports=p).prototype.finally=function(y){if(typeof y!="function")return this;var m=this.constructor;return this.then(function(_){return m.resolve(y()).then(function(){return _})},function(_){return m.resolve(y()).then(function(){throw _})})},p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,m){if(typeof y!="function"&&this.state===g||typeof m!="function"&&this.state===d)return this;var _=new this.constructor(u);return this.state!==v?s(_,this.state===g?y:m,this.outcome):this.queue.push(new e(_,y,m)),_},e.prototype.callFulfilled=function(y){o.resolve(this.promise,y)},e.prototype.otherCallFulfilled=function(y){s(this.promise,this.onFulfilled,y)},e.prototype.callRejected=function(y){o.reject(this.promise,y)},e.prototype.otherCallRejected=function(y){s(this.promise,this.onRejected,y)},o.resolve=function(y,m){var _=c(l,m);if(_.status==="error")return o.reject(y,_.value);var E=_.value;if(E)f(y,E);else{y.state=g,y.outcome=m;for(var w=-1,k=y.queue.length;++w<k;)y.queue[w].callFulfilled(m)}return y},o.reject=function(y,m){y.state=d,y.outcome=m;for(var _=-1,E=y.queue.length;++_<E;)y.queue[_].callRejected(m);return y},p.resolve=function(y){return y instanceof this?y:o.resolve(new this(u),y)},p.reject=function(y){var m=new this(u);return o.reject(m,y)},p.all=function(y){var m=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,E=!1;if(!_)return this.resolve([]);for(var w=new Array(_),k=0,x=-1,S=new this(u);++x<_;)B(y[x],x);return S;function B(U,R){m.resolve(U).then(function(C){w[R]=C,++k!==_||E||(E=!0,o.resolve(S,w))},function(C){E||(E=!0,o.reject(S,C))})}},p.race=function(y){var m=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,E=!1;if(!_)return this.resolve([]);for(var w=-1,k=new this(u);++w<_;)x=y[w],m.resolve(x).then(function(S){E||(E=!0,o.resolve(k,S))},function(S){E||(E=!0,o.reject(k,S))});var x;return k}},{immediate:36}],38:[function(t,i,r){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var n=t("./zlib/deflate"),u=t("./utils/common"),o=t("./utils/strings"),d=t("./zlib/messages"),g=t("./zlib/zstream"),v=Object.prototype.toString,p=0,e=-1,s=0,l=8;function f(y){if(!(this instanceof f))return new f(y);this.options=u.assign({level:e,method:l,chunkSize:16384,windowBits:15,memLevel:8,strategy:s,to:""},y||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var _=n.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(_!==p)throw new Error(d[_]);if(m.header&&n.deflateSetHeader(this.strm,m.header),m.dictionary){var E;if(E=typeof m.dictionary=="string"?o.string2buf(m.dictionary):v.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(_=n.deflateSetDictionary(this.strm,E))!==p)throw new Error(d[_]);this._dict_set=!0}}function c(y,m){var _=new f(m);if(_.push(y,!0),_.err)throw _.msg||d[_.err];return _.result}f.prototype.push=function(y,m){var _,E,w=this.strm,k=this.options.chunkSize;if(this.ended)return!1;E=m===~~m?m:m===!0?4:0,typeof y=="string"?w.input=o.string2buf(y):v.call(y)==="[object ArrayBuffer]"?w.input=new Uint8Array(y):w.input=y,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new u.Buf8(k),w.next_out=0,w.avail_out=k),(_=n.deflate(w,E))!==1&&_!==p)return this.onEnd(_),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(u.shrinkBuf(w.output,w.next_out))):this.onData(u.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&_!==1);return E===4?(_=n.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===p):E!==2||(this.onEnd(p),!(w.avail_out=0))},f.prototype.onData=function(y){this.chunks.push(y)},f.prototype.onEnd=function(y){y===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},r.Deflate=f,r.deflate=c,r.deflateRaw=function(y,m){return(m=m||{}).raw=!0,c(y,m)},r.gzip=function(y,m){return(m=m||{}).gzip=!0,c(y,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var n=t("./zlib/inflate"),u=t("./utils/common"),o=t("./utils/strings"),d=t("./zlib/constants"),g=t("./zlib/messages"),v=t("./zlib/zstream"),p=t("./zlib/gzheader"),e=Object.prototype.toString;function s(f){if(!(this instanceof s))return new s(f);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},f||{});var c=this.options;c.raw&&0<=c.windowBits&&c.windowBits<16&&(c.windowBits=-c.windowBits,c.windowBits===0&&(c.windowBits=-15)),!(0<=c.windowBits&&c.windowBits<16)||f&&f.windowBits||(c.windowBits+=32),15<c.windowBits&&c.windowBits<48&&(15&c.windowBits)==0&&(c.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var y=n.inflateInit2(this.strm,c.windowBits);if(y!==d.Z_OK)throw new Error(g[y]);this.header=new p,n.inflateGetHeader(this.strm,this.header)}function l(f,c){var y=new s(c);if(y.push(f,!0),y.err)throw y.msg||g[y.err];return y.result}s.prototype.push=function(f,c){var y,m,_,E,w,k,x=this.strm,S=this.options.chunkSize,B=this.options.dictionary,U=!1;if(this.ended)return!1;m=c===~~c?c:c===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof f=="string"?x.input=o.binstring2buf(f):e.call(f)==="[object ArrayBuffer]"?x.input=new Uint8Array(f):x.input=f,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new u.Buf8(S),x.next_out=0,x.avail_out=S),(y=n.inflate(x,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&B&&(k=typeof B=="string"?o.string2buf(B):e.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,y=n.inflateSetDictionary(this.strm,k)),y===d.Z_BUF_ERROR&&U===!0&&(y=d.Z_OK,U=!1),y!==d.Z_STREAM_END&&y!==d.Z_OK)return this.onEnd(y),!(this.ended=!0);x.next_out&&(x.avail_out!==0&&y!==d.Z_STREAM_END&&(x.avail_in!==0||m!==d.Z_FINISH&&m!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=o.utf8border(x.output,x.next_out),E=x.next_out-_,w=o.buf2string(x.output,_),x.next_out=E,x.avail_out=S-E,E&&u.arraySet(x.output,x.output,_,E,0),this.onData(w)):this.onData(u.shrinkBuf(x.output,x.next_out)))),x.avail_in===0&&x.avail_out===0&&(U=!0)}while((0<x.avail_in||x.avail_out===0)&&y!==d.Z_STREAM_END);return y===d.Z_STREAM_END&&(m=d.Z_FINISH),m===d.Z_FINISH?(y=n.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===d.Z_OK):m!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(x.avail_out=0))},s.prototype.onData=function(f){this.chunks.push(f)},s.prototype.onEnd=function(f){f===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},r.Inflate=s,r.inflate=l,r.inflateRaw=function(f,c){return(c=c||{}).raw=!0,l(f,c)},r.ungzip=l},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";r.assign=function(d){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var v=g.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var p in v)v.hasOwnProperty(p)&&(d[p]=v[p])}}return d},r.shrinkBuf=function(d,g){return d.length===g?d:d.subarray?d.subarray(0,g):(d.length=g,d)};var u={arraySet:function(d,g,v,p,e){if(g.subarray&&d.subarray)d.set(g.subarray(v,v+p),e);else for(var s=0;s<p;s++)d[e+s]=g[v+s]},flattenChunks:function(d){var g,v,p,e,s,l;for(g=p=0,v=d.length;g<v;g++)p+=d[g].length;for(l=new Uint8Array(p),g=e=0,v=d.length;g<v;g++)s=d[g],l.set(s,e),e+=s.length;return l}},o={arraySet:function(d,g,v,p,e){for(var s=0;s<p;s++)d[e+s]=g[v+s]},flattenChunks:function(d){return[].concat.apply([],d)}};r.setTyped=function(d){d?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,u)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(t,i,r){var n=t("./common"),u=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(p){u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(p){o=!1}for(var d=new n.Buf8(256),g=0;g<256;g++)d[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function v(p,e){if(e<65537&&(p.subarray&&o||!p.subarray&&u))return String.fromCharCode.apply(null,n.shrinkBuf(p,e));for(var s="",l=0;l<e;l++)s+=String.fromCharCode(p[l]);return s}d[254]=d[254]=1,r.string2buf=function(p){var e,s,l,f,c,y=p.length,m=0;for(f=0;f<y;f++)(64512&(s=p.charCodeAt(f)))==55296&&f+1<y&&(64512&(l=p.charCodeAt(f+1)))==56320&&(s=65536+(s-55296<<10)+(l-56320),f++),m+=s<128?1:s<2048?2:s<65536?3:4;for(e=new n.Buf8(m),f=c=0;c<m;f++)(64512&(s=p.charCodeAt(f)))==55296&&f+1<y&&(64512&(l=p.charCodeAt(f+1)))==56320&&(s=65536+(s-55296<<10)+(l-56320),f++),s<128?e[c++]=s:(s<2048?e[c++]=192|s>>>6:(s<65536?e[c++]=224|s>>>12:(e[c++]=240|s>>>18,e[c++]=128|s>>>12&63),e[c++]=128|s>>>6&63),e[c++]=128|63&s);return e},r.buf2binstring=function(p){return v(p,p.length)},r.binstring2buf=function(p){for(var e=new n.Buf8(p.length),s=0,l=e.length;s<l;s++)e[s]=p.charCodeAt(s);return e},r.buf2string=function(p,e){var s,l,f,c,y=e||p.length,m=new Array(2*y);for(s=l=0;s<y;)if((f=p[s++])<128)m[l++]=f;else if(4<(c=d[f]))m[l++]=65533,s+=c-1;else{for(f&=c===2?31:c===3?15:7;1<c&&s<y;)f=f<<6|63&p[s++],c--;1<c?m[l++]=65533:f<65536?m[l++]=f:(f-=65536,m[l++]=55296|f>>10&1023,m[l++]=56320|1023&f)}return v(m,l)},r.utf8border=function(p,e){var s;for((e=e||p.length)>p.length&&(e=p.length),s=e-1;0<=s&&(192&p[s])==128;)s--;return s<0||s===0?e:s+d[p[s]]>e?s:e}},{"./common":41}],43:[function(t,i,r){i.exports=function(n,u,o,d){for(var g=65535&n|0,v=n>>>16&65535|0,p=0;o!==0;){for(o-=p=2e3<o?2e3:o;v=v+(g=g+u[d++]|0)|0,--p;);g%=65521,v%=65521}return g|v<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var n=function(){for(var u,o=[],d=0;d<256;d++){u=d;for(var g=0;g<8;g++)u=1&u?3988292384^u>>>1:u>>>1;o[d]=u}return o}();i.exports=function(u,o,d,g){var v=n,p=g+d;u^=-1;for(var e=g;e<p;e++)u=u>>>8^v[255&(u^o[e])];return-1^u}},{}],46:[function(t,i,r){var n,u=t("../utils/common"),o=t("./trees"),d=t("./adler32"),g=t("./crc32"),v=t("./messages"),p=0,e=4,s=0,l=-2,f=-1,c=4,y=2,m=8,_=9,E=286,w=30,k=19,x=2*E+1,S=15,B=3,U=258,R=U+B+1,C=42,A=113,b=1,O=2,W=3,K=4;function G(D,fe){return D.msg=v[fe],fe}function F(D){return(D<<1)-(4<D?9:0)}function j(D){for(var fe=D.length;0<=--fe;)D[fe]=0}function N(D){var fe=D.state,ne=fe.pending;ne>D.avail_out&&(ne=D.avail_out),ne!==0&&(u.arraySet(D.output,fe.pending_buf,fe.pending_out,ne,D.next_out),D.next_out+=ne,fe.pending_out+=ne,D.total_out+=ne,D.avail_out-=ne,fe.pending-=ne,fe.pending===0&&(fe.pending_out=0))}function $(D,fe){o._tr_flush_block(D,0<=D.block_start?D.block_start:-1,D.strstart-D.block_start,fe),D.block_start=D.strstart,N(D.strm)}function Z(D,fe){D.pending_buf[D.pending++]=fe}function te(D,fe){D.pending_buf[D.pending++]=fe>>>8&255,D.pending_buf[D.pending++]=255&fe}function ae(D,fe){var ne,Y,H=D.max_chain_length,J=D.strstart,ce=D.prev_length,he=D.nice_match,ee=D.strstart>D.w_size-R?D.strstart-(D.w_size-R):0,Se=D.window,Le=D.w_mask,ke=D.prev,Ne=D.strstart+U,Ye=Se[J+ce-1],et=Se[J+ce];D.prev_length>=D.good_match&&(H>>=2),he>D.lookahead&&(he=D.lookahead);do if(Se[(ne=fe)+ce]===et&&Se[ne+ce-1]===Ye&&Se[ne]===Se[J]&&Se[++ne]===Se[J+1]){J+=2,ne++;do;while(Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&Se[++J]===Se[++ne]&&J<Ne);if(Y=U-(Ne-J),J=Ne-U,ce<Y){if(D.match_start=fe,he<=(ce=Y))break;Ye=Se[J+ce-1],et=Se[J+ce]}}while((fe=ke[fe&Le])>ee&&--H!=0);return ce<=D.lookahead?ce:D.lookahead}function Ee(D){var fe,ne,Y,H,J,ce,he,ee,Se,Le,ke=D.w_size;do{if(H=D.window_size-D.lookahead-D.strstart,D.strstart>=ke+(ke-R)){for(u.arraySet(D.window,D.window,ke,ke,0),D.match_start-=ke,D.strstart-=ke,D.block_start-=ke,fe=ne=D.hash_size;Y=D.head[--fe],D.head[fe]=ke<=Y?Y-ke:0,--ne;);for(fe=ne=ke;Y=D.prev[--fe],D.prev[fe]=ke<=Y?Y-ke:0,--ne;);H+=ke}if(D.strm.avail_in===0)break;if(ce=D.strm,he=D.window,ee=D.strstart+D.lookahead,Se=H,Le=void 0,Le=ce.avail_in,Se<Le&&(Le=Se),ne=Le===0?0:(ce.avail_in-=Le,u.arraySet(he,ce.input,ce.next_in,Le,ee),ce.state.wrap===1?ce.adler=d(ce.adler,he,Le,ee):ce.state.wrap===2&&(ce.adler=g(ce.adler,he,Le,ee)),ce.next_in+=Le,ce.total_in+=Le,Le),D.lookahead+=ne,D.lookahead+D.insert>=B)for(J=D.strstart-D.insert,D.ins_h=D.window[J],D.ins_h=(D.ins_h<<D.hash_shift^D.window[J+1])&D.hash_mask;D.insert&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[J+B-1])&D.hash_mask,D.prev[J&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=J,J++,D.insert--,!(D.lookahead+D.insert<B)););}while(D.lookahead<R&&D.strm.avail_in!==0)}function Te(D,fe){for(var ne,Y;;){if(D.lookahead<R){if(Ee(D),D.lookahead<R&&fe===p)return b;if(D.lookahead===0)break}if(ne=0,D.lookahead>=B&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+B-1])&D.hash_mask,ne=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),ne!==0&&D.strstart-ne<=D.w_size-R&&(D.match_length=ae(D,ne)),D.match_length>=B)if(Y=o._tr_tally(D,D.strstart-D.match_start,D.match_length-B),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=B){for(D.match_length--;D.strstart++,D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+B-1])&D.hash_mask,ne=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart,--D.match_length!=0;);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+1])&D.hash_mask;else Y=o._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(Y&&($(D,!1),D.strm.avail_out===0))return b}return D.insert=D.strstart<B-1?D.strstart:B-1,fe===e?($(D,!0),D.strm.avail_out===0?W:K):D.last_lit&&($(D,!1),D.strm.avail_out===0)?b:O}function Ae(D,fe){for(var ne,Y,H;;){if(D.lookahead<R){if(Ee(D),D.lookahead<R&&fe===p)return b;if(D.lookahead===0)break}if(ne=0,D.lookahead>=B&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+B-1])&D.hash_mask,ne=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),D.prev_length=D.match_length,D.prev_match=D.match_start,D.match_length=B-1,ne!==0&&D.prev_length<D.max_lazy_match&&D.strstart-ne<=D.w_size-R&&(D.match_length=ae(D,ne),D.match_length<=5&&(D.strategy===1||D.match_length===B&&4096<D.strstart-D.match_start)&&(D.match_length=B-1)),D.prev_length>=B&&D.match_length<=D.prev_length){for(H=D.strstart+D.lookahead-B,Y=o._tr_tally(D,D.strstart-1-D.prev_match,D.prev_length-B),D.lookahead-=D.prev_length-1,D.prev_length-=2;++D.strstart<=H&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+B-1])&D.hash_mask,ne=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),--D.prev_length!=0;);if(D.match_available=0,D.match_length=B-1,D.strstart++,Y&&($(D,!1),D.strm.avail_out===0))return b}else if(D.match_available){if((Y=o._tr_tally(D,0,D.window[D.strstart-1]))&&$(D,!1),D.strstart++,D.lookahead--,D.strm.avail_out===0)return b}else D.match_available=1,D.strstart++,D.lookahead--}return D.match_available&&(Y=o._tr_tally(D,0,D.window[D.strstart-1]),D.match_available=0),D.insert=D.strstart<B-1?D.strstart:B-1,fe===e?($(D,!0),D.strm.avail_out===0?W:K):D.last_lit&&($(D,!1),D.strm.avail_out===0)?b:O}function De(D,fe,ne,Y,H){this.good_length=D,this.max_lazy=fe,this.nice_length=ne,this.max_chain=Y,this.func=H}function ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(2*x),this.dyn_dtree=new u.Buf16(2*(2*w+1)),this.bl_tree=new u.Buf16(2*(2*k+1)),j(this.dyn_ltree),j(this.dyn_dtree),j(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(S+1),this.heap=new u.Buf16(2*E+1),j(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*E+1),j(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(D){var fe;return D&&D.state?(D.total_in=D.total_out=0,D.data_type=y,(fe=D.state).pending=0,fe.pending_out=0,fe.wrap<0&&(fe.wrap=-fe.wrap),fe.status=fe.wrap?C:A,D.adler=fe.wrap===2?0:1,fe.last_flush=p,o._tr_init(fe),s):G(D,l)}function Oe(D){var fe=Ce(D);return fe===s&&function(ne){ne.window_size=2*ne.w_size,j(ne.head),ne.max_lazy_match=n[ne.level].max_lazy,ne.good_match=n[ne.level].good_length,ne.nice_match=n[ne.level].nice_length,ne.max_chain_length=n[ne.level].max_chain,ne.strstart=0,ne.block_start=0,ne.lookahead=0,ne.insert=0,ne.match_length=ne.prev_length=B-1,ne.match_available=0,ne.ins_h=0}(D.state),fe}function $e(D,fe,ne,Y,H,J){if(!D)return l;var ce=1;if(fe===f&&(fe=6),Y<0?(ce=0,Y=-Y):15<Y&&(ce=2,Y-=16),H<1||_<H||ne!==m||Y<8||15<Y||fe<0||9<fe||J<0||c<J)return G(D,l);Y===8&&(Y=9);var he=new ze;return(D.state=he).strm=D,he.wrap=ce,he.gzhead=null,he.w_bits=Y,he.w_size=1<<he.w_bits,he.w_mask=he.w_size-1,he.hash_bits=H+7,he.hash_size=1<<he.hash_bits,he.hash_mask=he.hash_size-1,he.hash_shift=~~((he.hash_bits+B-1)/B),he.window=new u.Buf8(2*he.w_size),he.head=new u.Buf16(he.hash_size),he.prev=new u.Buf16(he.w_size),he.lit_bufsize=1<<H+6,he.pending_buf_size=4*he.lit_bufsize,he.pending_buf=new u.Buf8(he.pending_buf_size),he.d_buf=1*he.lit_bufsize,he.l_buf=3*he.lit_bufsize,he.level=fe,he.strategy=J,he.method=ne,Oe(D)}n=[new De(0,0,0,0,function(D,fe){var ne=65535;for(ne>D.pending_buf_size-5&&(ne=D.pending_buf_size-5);;){if(D.lookahead<=1){if(Ee(D),D.lookahead===0&&fe===p)return b;if(D.lookahead===0)break}D.strstart+=D.lookahead,D.lookahead=0;var Y=D.block_start+ne;if((D.strstart===0||D.strstart>=Y)&&(D.lookahead=D.strstart-Y,D.strstart=Y,$(D,!1),D.strm.avail_out===0)||D.strstart-D.block_start>=D.w_size-R&&($(D,!1),D.strm.avail_out===0))return b}return D.insert=0,fe===e?($(D,!0),D.strm.avail_out===0?W:K):(D.strstart>D.block_start&&($(D,!1),D.strm.avail_out),b)}),new De(4,4,8,4,Te),new De(4,5,16,8,Te),new De(4,6,32,32,Te),new De(4,4,16,16,Ae),new De(8,16,32,32,Ae),new De(8,16,128,128,Ae),new De(8,32,128,256,Ae),new De(32,128,258,1024,Ae),new De(32,258,258,4096,Ae)],r.deflateInit=function(D,fe){return $e(D,fe,m,15,8,0)},r.deflateInit2=$e,r.deflateReset=Oe,r.deflateResetKeep=Ce,r.deflateSetHeader=function(D,fe){return D&&D.state?D.state.wrap!==2?l:(D.state.gzhead=fe,s):l},r.deflate=function(D,fe){var ne,Y,H,J;if(!D||!D.state||5<fe||fe<0)return D?G(D,l):l;if(Y=D.state,!D.output||!D.input&&D.avail_in!==0||Y.status===666&&fe!==e)return G(D,D.avail_out===0?-5:l);if(Y.strm=D,ne=Y.last_flush,Y.last_flush=fe,Y.status===C)if(Y.wrap===2)D.adler=0,Z(Y,31),Z(Y,139),Z(Y,8),Y.gzhead?(Z(Y,(Y.gzhead.text?1:0)+(Y.gzhead.hcrc?2:0)+(Y.gzhead.extra?4:0)+(Y.gzhead.name?8:0)+(Y.gzhead.comment?16:0)),Z(Y,255&Y.gzhead.time),Z(Y,Y.gzhead.time>>8&255),Z(Y,Y.gzhead.time>>16&255),Z(Y,Y.gzhead.time>>24&255),Z(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),Z(Y,255&Y.gzhead.os),Y.gzhead.extra&&Y.gzhead.extra.length&&(Z(Y,255&Y.gzhead.extra.length),Z(Y,Y.gzhead.extra.length>>8&255)),Y.gzhead.hcrc&&(D.adler=g(D.adler,Y.pending_buf,Y.pending,0)),Y.gzindex=0,Y.status=69):(Z(Y,0),Z(Y,0),Z(Y,0),Z(Y,0),Z(Y,0),Z(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),Z(Y,3),Y.status=A);else{var ce=m+(Y.w_bits-8<<4)<<8;ce|=(2<=Y.strategy||Y.level<2?0:Y.level<6?1:Y.level===6?2:3)<<6,Y.strstart!==0&&(ce|=32),ce+=31-ce%31,Y.status=A,te(Y,ce),Y.strstart!==0&&(te(Y,D.adler>>>16),te(Y,65535&D.adler)),D.adler=1}if(Y.status===69)if(Y.gzhead.extra){for(H=Y.pending;Y.gzindex<(65535&Y.gzhead.extra.length)&&(Y.pending!==Y.pending_buf_size||(Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),N(D),H=Y.pending,Y.pending!==Y.pending_buf_size));)Z(Y,255&Y.gzhead.extra[Y.gzindex]),Y.gzindex++;Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),Y.gzindex===Y.gzhead.extra.length&&(Y.gzindex=0,Y.status=73)}else Y.status=73;if(Y.status===73)if(Y.gzhead.name){H=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),N(D),H=Y.pending,Y.pending===Y.pending_buf_size)){J=1;break}J=Y.gzindex<Y.gzhead.name.length?255&Y.gzhead.name.charCodeAt(Y.gzindex++):0,Z(Y,J)}while(J!==0);Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),J===0&&(Y.gzindex=0,Y.status=91)}else Y.status=91;if(Y.status===91)if(Y.gzhead.comment){H=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),N(D),H=Y.pending,Y.pending===Y.pending_buf_size)){J=1;break}J=Y.gzindex<Y.gzhead.comment.length?255&Y.gzhead.comment.charCodeAt(Y.gzindex++):0,Z(Y,J)}while(J!==0);Y.gzhead.hcrc&&Y.pending>H&&(D.adler=g(D.adler,Y.pending_buf,Y.pending-H,H)),J===0&&(Y.status=103)}else Y.status=103;if(Y.status===103&&(Y.gzhead.hcrc?(Y.pending+2>Y.pending_buf_size&&N(D),Y.pending+2<=Y.pending_buf_size&&(Z(Y,255&D.adler),Z(Y,D.adler>>8&255),D.adler=0,Y.status=A)):Y.status=A),Y.pending!==0){if(N(D),D.avail_out===0)return Y.last_flush=-1,s}else if(D.avail_in===0&&F(fe)<=F(ne)&&fe!==e)return G(D,-5);if(Y.status===666&&D.avail_in!==0)return G(D,-5);if(D.avail_in!==0||Y.lookahead!==0||fe!==p&&Y.status!==666){var he=Y.strategy===2?function(ee,Se){for(var Le;;){if(ee.lookahead===0&&(Ee(ee),ee.lookahead===0)){if(Se===p)return b;break}if(ee.match_length=0,Le=o._tr_tally(ee,0,ee.window[ee.strstart]),ee.lookahead--,ee.strstart++,Le&&($(ee,!1),ee.strm.avail_out===0))return b}return ee.insert=0,Se===e?($(ee,!0),ee.strm.avail_out===0?W:K):ee.last_lit&&($(ee,!1),ee.strm.avail_out===0)?b:O}(Y,fe):Y.strategy===3?function(ee,Se){for(var Le,ke,Ne,Ye,et=ee.window;;){if(ee.lookahead<=U){if(Ee(ee),ee.lookahead<=U&&Se===p)return b;if(ee.lookahead===0)break}if(ee.match_length=0,ee.lookahead>=B&&0<ee.strstart&&(ke=et[Ne=ee.strstart-1])===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]){Ye=ee.strstart+U;do;while(ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&ke===et[++Ne]&&Ne<Ye);ee.match_length=U-(Ye-Ne),ee.match_length>ee.lookahead&&(ee.match_length=ee.lookahead)}if(ee.match_length>=B?(Le=o._tr_tally(ee,1,ee.match_length-B),ee.lookahead-=ee.match_length,ee.strstart+=ee.match_length,ee.match_length=0):(Le=o._tr_tally(ee,0,ee.window[ee.strstart]),ee.lookahead--,ee.strstart++),Le&&($(ee,!1),ee.strm.avail_out===0))return b}return ee.insert=0,Se===e?($(ee,!0),ee.strm.avail_out===0?W:K):ee.last_lit&&($(ee,!1),ee.strm.avail_out===0)?b:O}(Y,fe):n[Y.level].func(Y,fe);if(he!==W&&he!==K||(Y.status=666),he===b||he===W)return D.avail_out===0&&(Y.last_flush=-1),s;if(he===O&&(fe===1?o._tr_align(Y):fe!==5&&(o._tr_stored_block(Y,0,0,!1),fe===3&&(j(Y.head),Y.lookahead===0&&(Y.strstart=0,Y.block_start=0,Y.insert=0))),N(D),D.avail_out===0))return Y.last_flush=-1,s}return fe!==e?s:Y.wrap<=0?1:(Y.wrap===2?(Z(Y,255&D.adler),Z(Y,D.adler>>8&255),Z(Y,D.adler>>16&255),Z(Y,D.adler>>24&255),Z(Y,255&D.total_in),Z(Y,D.total_in>>8&255),Z(Y,D.total_in>>16&255),Z(Y,D.total_in>>24&255)):(te(Y,D.adler>>>16),te(Y,65535&D.adler)),N(D),0<Y.wrap&&(Y.wrap=-Y.wrap),Y.pending!==0?s:1)},r.deflateEnd=function(D){var fe;return D&&D.state?(fe=D.state.status)!==C&&fe!==69&&fe!==73&&fe!==91&&fe!==103&&fe!==A&&fe!==666?G(D,l):(D.state=null,fe===A?G(D,-3):s):l},r.deflateSetDictionary=function(D,fe){var ne,Y,H,J,ce,he,ee,Se,Le=fe.length;if(!D||!D.state||(J=(ne=D.state).wrap)===2||J===1&&ne.status!==C||ne.lookahead)return l;for(J===1&&(D.adler=d(D.adler,fe,Le,0)),ne.wrap=0,Le>=ne.w_size&&(J===0&&(j(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0),Se=new u.Buf8(ne.w_size),u.arraySet(Se,fe,Le-ne.w_size,ne.w_size,0),fe=Se,Le=ne.w_size),ce=D.avail_in,he=D.next_in,ee=D.input,D.avail_in=Le,D.next_in=0,D.input=fe,Ee(ne);ne.lookahead>=B;){for(Y=ne.strstart,H=ne.lookahead-(B-1);ne.ins_h=(ne.ins_h<<ne.hash_shift^ne.window[Y+B-1])&ne.hash_mask,ne.prev[Y&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=Y,Y++,--H;);ne.strstart=Y,ne.lookahead=B-1,Ee(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=B-1,ne.match_available=0,D.next_in=he,D.input=ee,D.avail_in=ce,ne.wrap=J,s},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(n,u){var o,d,g,v,p,e,s,l,f,c,y,m,_,E,w,k,x,S,B,U,R,C,A,b,O;o=n.state,d=n.next_in,b=n.input,g=d+(n.avail_in-5),v=n.next_out,O=n.output,p=v-(u-n.avail_out),e=v+(n.avail_out-257),s=o.dmax,l=o.wsize,f=o.whave,c=o.wnext,y=o.window,m=o.hold,_=o.bits,E=o.lencode,w=o.distcode,k=(1<<o.lenbits)-1,x=(1<<o.distbits)-1;e:do{_<15&&(m+=b[d++]<<_,_+=8,m+=b[d++]<<_,_+=8),S=E[m&k];t:for(;;){if(m>>>=B=S>>>24,_-=B,(B=S>>>16&255)==0)O[v++]=65535&S;else{if(!(16&B)){if((64&B)==0){S=E[(65535&S)+(m&(1<<B)-1)];continue t}if(32&B){o.mode=12;break e}n.msg="invalid literal/length code",o.mode=30;break e}U=65535&S,(B&=15)&&(_<B&&(m+=b[d++]<<_,_+=8),U+=m&(1<<B)-1,m>>>=B,_-=B),_<15&&(m+=b[d++]<<_,_+=8,m+=b[d++]<<_,_+=8),S=w[m&x];i:for(;;){if(m>>>=B=S>>>24,_-=B,!(16&(B=S>>>16&255))){if((64&B)==0){S=w[(65535&S)+(m&(1<<B)-1)];continue i}n.msg="invalid distance code",o.mode=30;break e}if(R=65535&S,_<(B&=15)&&(m+=b[d++]<<_,(_+=8)<B&&(m+=b[d++]<<_,_+=8)),s<(R+=m&(1<<B)-1)){n.msg="invalid distance too far back",o.mode=30;break e}if(m>>>=B,_-=B,(B=v-p)<R){if(f<(B=R-B)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break e}if(A=y,(C=0)===c){if(C+=l-B,B<U){for(U-=B;O[v++]=y[C++],--B;);C=v-R,A=O}}else if(c<B){if(C+=l+c-B,(B-=c)<U){for(U-=B;O[v++]=y[C++],--B;);if(C=0,c<U){for(U-=B=c;O[v++]=y[C++],--B;);C=v-R,A=O}}}else if(C+=c-B,B<U){for(U-=B;O[v++]=y[C++],--B;);C=v-R,A=O}for(;2<U;)O[v++]=A[C++],O[v++]=A[C++],O[v++]=A[C++],U-=3;U&&(O[v++]=A[C++],1<U&&(O[v++]=A[C++]))}else{for(C=v-R;O[v++]=O[C++],O[v++]=O[C++],O[v++]=O[C++],2<(U-=3););U&&(O[v++]=O[C++],1<U&&(O[v++]=O[C++]))}break}}break}}while(d<g&&v<e);d-=U=_>>3,m&=(1<<(_-=U<<3))-1,n.next_in=d,n.next_out=v,n.avail_in=d<g?g-d+5:5-(d-g),n.avail_out=v<e?e-v+257:257-(v-e),o.hold=m,o.bits=_}},{}],49:[function(t,i,r){var n=t("../utils/common"),u=t("./adler32"),o=t("./crc32"),d=t("./inffast"),g=t("./inftrees"),v=1,p=2,e=0,s=-2,l=1,f=852,c=592;function y(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(C){var A;return C&&C.state?(A=C.state,C.total_in=C.total_out=A.total=0,C.msg="",A.wrap&&(C.adler=1&A.wrap),A.mode=l,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new n.Buf32(f),A.distcode=A.distdyn=new n.Buf32(c),A.sane=1,A.back=-1,e):s}function E(C){var A;return C&&C.state?((A=C.state).wsize=0,A.whave=0,A.wnext=0,_(C)):s}function w(C,A){var b,O;return C&&C.state?(O=C.state,A<0?(b=0,A=-A):(b=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?s:(O.window!==null&&O.wbits!==A&&(O.window=null),O.wrap=b,O.wbits=A,E(C))):s}function k(C,A){var b,O;return C?(O=new m,(C.state=O).window=null,(b=w(C,A))!==e&&(C.state=null),b):s}var x,S,B=!0;function U(C){if(B){var A;for(x=new n.Buf32(512),S=new n.Buf32(32),A=0;A<144;)C.lens[A++]=8;for(;A<256;)C.lens[A++]=9;for(;A<280;)C.lens[A++]=7;for(;A<288;)C.lens[A++]=8;for(g(v,C.lens,0,288,x,0,C.work,{bits:9}),A=0;A<32;)C.lens[A++]=5;g(p,C.lens,0,32,S,0,C.work,{bits:5}),B=!1}C.lencode=x,C.lenbits=9,C.distcode=S,C.distbits=5}function R(C,A,b,O){var W,K=C.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new n.Buf8(K.wsize)),O>=K.wsize?(n.arraySet(K.window,A,b-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(O<(W=K.wsize-K.wnext)&&(W=O),n.arraySet(K.window,A,b-O,W,K.wnext),(O-=W)?(n.arraySet(K.window,A,b-O,O,0),K.wnext=O,K.whave=K.wsize):(K.wnext+=W,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=W))),0}r.inflateReset=E,r.inflateReset2=w,r.inflateResetKeep=_,r.inflateInit=function(C){return k(C,15)},r.inflateInit2=k,r.inflate=function(C,A){var b,O,W,K,G,F,j,N,$,Z,te,ae,Ee,Te,Ae,De,ze,Ce,Oe,$e,D,fe,ne,Y,H=0,J=new n.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return s;(b=C.state).mode===12&&(b.mode=13),G=C.next_out,W=C.output,j=C.avail_out,K=C.next_in,O=C.input,F=C.avail_in,N=b.hold,$=b.bits,Z=F,te=j,fe=e;e:for(;;)switch(b.mode){case l:if(b.wrap===0){b.mode=13;break}for(;$<16;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(2&b.wrap&&N===35615){J[b.check=0]=255&N,J[1]=N>>>8&255,b.check=o(b.check,J,2,0),$=N=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&N)<<8)+(N>>8))%31){C.msg="incorrect header check",b.mode=30;break}if((15&N)!=8){C.msg="unknown compression method",b.mode=30;break}if($-=4,D=8+(15&(N>>>=4)),b.wbits===0)b.wbits=D;else if(D>b.wbits){C.msg="invalid window size",b.mode=30;break}b.dmax=1<<D,C.adler=b.check=1,b.mode=512&N?10:12,$=N=0;break;case 2:for(;$<16;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(b.flags=N,(255&b.flags)!=8){C.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){C.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=N>>8&1),512&b.flags&&(J[0]=255&N,J[1]=N>>>8&255,b.check=o(b.check,J,2,0)),$=N=0,b.mode=3;case 3:for(;$<32;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.head&&(b.head.time=N),512&b.flags&&(J[0]=255&N,J[1]=N>>>8&255,J[2]=N>>>16&255,J[3]=N>>>24&255,b.check=o(b.check,J,4,0)),$=N=0,b.mode=4;case 4:for(;$<16;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.head&&(b.head.xflags=255&N,b.head.os=N>>8),512&b.flags&&(J[0]=255&N,J[1]=N>>>8&255,b.check=o(b.check,J,2,0)),$=N=0,b.mode=5;case 5:if(1024&b.flags){for(;$<16;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.length=N,b.head&&(b.head.extra_len=N),512&b.flags&&(J[0]=255&N,J[1]=N>>>8&255,b.check=o(b.check,J,2,0)),$=N=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(F<(ae=b.length)&&(ae=F),ae&&(b.head&&(D=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),n.arraySet(b.head.extra,O,K,ae,D)),512&b.flags&&(b.check=o(b.check,O,ae,K)),F-=ae,K+=ae,b.length-=ae),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(F===0)break e;for(ae=0;D=O[K+ae++],b.head&&D&&b.length<65536&&(b.head.name+=String.fromCharCode(D)),D&&ae<F;);if(512&b.flags&&(b.check=o(b.check,O,ae,K)),F-=ae,K+=ae,D)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(F===0)break e;for(ae=0;D=O[K+ae++],b.head&&D&&b.length<65536&&(b.head.comment+=String.fromCharCode(D)),D&&ae<F;);if(512&b.flags&&(b.check=o(b.check,O,ae,K)),F-=ae,K+=ae,D)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;$<16;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(N!==(65535&b.check)){C.msg="header crc mismatch",b.mode=30;break}$=N=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),C.adler=b.check=0,b.mode=12;break;case 10:for(;$<32;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}C.adler=b.check=y(N),$=N=0,b.mode=11;case 11:if(b.havedict===0)return C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=F,b.hold=N,b.bits=$,2;C.adler=b.check=1,b.mode=12;case 12:if(A===5||A===6)break e;case 13:if(b.last){N>>>=7&$,$-=7&$,b.mode=27;break}for(;$<3;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}switch(b.last=1&N,$-=1,3&(N>>>=1)){case 0:b.mode=14;break;case 1:if(U(b),b.mode=20,A!==6)break;N>>>=2,$-=2;break e;case 2:b.mode=17;break;case 3:C.msg="invalid block type",b.mode=30}N>>>=2,$-=2;break;case 14:for(N>>>=7&$,$-=7&$;$<32;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if((65535&N)!=(N>>>16^65535)){C.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&N,$=N=0,b.mode=15,A===6)break e;case 15:b.mode=16;case 16:if(ae=b.length){if(F<ae&&(ae=F),j<ae&&(ae=j),ae===0)break e;n.arraySet(W,O,K,ae,G),F-=ae,K+=ae,j-=ae,G+=ae,b.length-=ae;break}b.mode=12;break;case 17:for(;$<14;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(b.nlen=257+(31&N),N>>>=5,$-=5,b.ndist=1+(31&N),N>>>=5,$-=5,b.ncode=4+(15&N),N>>>=4,$-=4,286<b.nlen||30<b.ndist){C.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;$<3;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.lens[ce[b.have++]]=7&N,N>>>=3,$-=3}for(;b.have<19;)b.lens[ce[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,ne={bits:b.lenbits},fe=g(0,b.lens,0,19,b.lencode,0,b.work,ne),b.lenbits=ne.bits,fe){C.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;De=(H=b.lencode[N&(1<<b.lenbits)-1])>>>16&255,ze=65535&H,!((Ae=H>>>24)<=$);){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(ze<16)N>>>=Ae,$-=Ae,b.lens[b.have++]=ze;else{if(ze===16){for(Y=Ae+2;$<Y;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(N>>>=Ae,$-=Ae,b.have===0){C.msg="invalid bit length repeat",b.mode=30;break}D=b.lens[b.have-1],ae=3+(3&N),N>>>=2,$-=2}else if(ze===17){for(Y=Ae+3;$<Y;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}$-=Ae,D=0,ae=3+(7&(N>>>=Ae)),N>>>=3,$-=3}else{for(Y=Ae+7;$<Y;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}$-=Ae,D=0,ae=11+(127&(N>>>=Ae)),N>>>=7,$-=7}if(b.have+ae>b.nlen+b.ndist){C.msg="invalid bit length repeat",b.mode=30;break}for(;ae--;)b.lens[b.have++]=D}}if(b.mode===30)break;if(b.lens[256]===0){C.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,ne={bits:b.lenbits},fe=g(v,b.lens,0,b.nlen,b.lencode,0,b.work,ne),b.lenbits=ne.bits,fe){C.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,ne={bits:b.distbits},fe=g(p,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,ne),b.distbits=ne.bits,fe){C.msg="invalid distances set",b.mode=30;break}if(b.mode=20,A===6)break e;case 20:b.mode=21;case 21:if(6<=F&&258<=j){C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=F,b.hold=N,b.bits=$,d(C,te),G=C.next_out,W=C.output,j=C.avail_out,K=C.next_in,O=C.input,F=C.avail_in,N=b.hold,$=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;De=(H=b.lencode[N&(1<<b.lenbits)-1])>>>16&255,ze=65535&H,!((Ae=H>>>24)<=$);){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(De&&(240&De)==0){for(Ce=Ae,Oe=De,$e=ze;De=(H=b.lencode[$e+((N&(1<<Ce+Oe)-1)>>Ce)])>>>16&255,ze=65535&H,!(Ce+(Ae=H>>>24)<=$);){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}N>>>=Ce,$-=Ce,b.back+=Ce}if(N>>>=Ae,$-=Ae,b.back+=Ae,b.length=ze,De===0){b.mode=26;break}if(32&De){b.back=-1,b.mode=12;break}if(64&De){C.msg="invalid literal/length code",b.mode=30;break}b.extra=15&De,b.mode=22;case 22:if(b.extra){for(Y=b.extra;$<Y;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.length+=N&(1<<b.extra)-1,N>>>=b.extra,$-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;De=(H=b.distcode[N&(1<<b.distbits)-1])>>>16&255,ze=65535&H,!((Ae=H>>>24)<=$);){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if((240&De)==0){for(Ce=Ae,Oe=De,$e=ze;De=(H=b.distcode[$e+((N&(1<<Ce+Oe)-1)>>Ce)])>>>16&255,ze=65535&H,!(Ce+(Ae=H>>>24)<=$);){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}N>>>=Ce,$-=Ce,b.back+=Ce}if(N>>>=Ae,$-=Ae,b.back+=Ae,64&De){C.msg="invalid distance code",b.mode=30;break}b.offset=ze,b.extra=15&De,b.mode=24;case 24:if(b.extra){for(Y=b.extra;$<Y;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}b.offset+=N&(1<<b.extra)-1,N>>>=b.extra,$-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){C.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(j===0)break e;if(ae=te-j,b.offset>ae){if((ae=b.offset-ae)>b.whave&&b.sane){C.msg="invalid distance too far back",b.mode=30;break}Ee=ae>b.wnext?(ae-=b.wnext,b.wsize-ae):b.wnext-ae,ae>b.length&&(ae=b.length),Te=b.window}else Te=W,Ee=G-b.offset,ae=b.length;for(j<ae&&(ae=j),j-=ae,b.length-=ae;W[G++]=Te[Ee++],--ae;);b.length===0&&(b.mode=21);break;case 26:if(j===0)break e;W[G++]=b.length,j--,b.mode=21;break;case 27:if(b.wrap){for(;$<32;){if(F===0)break e;F--,N|=O[K++]<<$,$+=8}if(te-=j,C.total_out+=te,b.total+=te,te&&(C.adler=b.check=b.flags?o(b.check,W,te,G-te):u(b.check,W,te,G-te)),te=j,(b.flags?N:y(N))!==b.check){C.msg="incorrect data check",b.mode=30;break}$=N=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;$<32;){if(F===0)break e;F--,N+=O[K++]<<$,$+=8}if(N!==(4294967295&b.total)){C.msg="incorrect length check",b.mode=30;break}$=N=0}b.mode=29;case 29:fe=1;break e;case 30:fe=-3;break e;case 31:return-4;case 32:default:return s}return C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=F,b.hold=N,b.bits=$,(b.wsize||te!==C.avail_out&&b.mode<30&&(b.mode<27||A!==4))&&R(C,C.output,C.next_out,te-C.avail_out)?(b.mode=31,-4):(Z-=C.avail_in,te-=C.avail_out,C.total_in+=Z,C.total_out+=te,b.total+=te,b.wrap&&te&&(C.adler=b.check=b.flags?o(b.check,W,te,C.next_out-te):u(b.check,W,te,C.next_out-te)),C.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(Z==0&&te===0||A===4)&&fe===e&&(fe=-5),fe)},r.inflateEnd=function(C){if(!C||!C.state)return s;var A=C.state;return A.window&&(A.window=null),C.state=null,e},r.inflateGetHeader=function(C,A){var b;return C&&C.state?(2&(b=C.state).wrap)==0?s:((b.head=A).done=!1,e):s},r.inflateSetDictionary=function(C,A){var b,O=A.length;return C&&C.state?(b=C.state).wrap!==0&&b.mode!==11?s:b.mode===11&&u(1,A,O,0)!==b.check?-3:R(C,A,O,O)?(b.mode=31,-4):(b.havedict=1,e):s},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var n=t("../utils/common"),u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(v,p,e,s,l,f,c,y){var m,_,E,w,k,x,S,B,U,R=y.bits,C=0,A=0,b=0,O=0,W=0,K=0,G=0,F=0,j=0,N=0,$=null,Z=0,te=new n.Buf16(16),ae=new n.Buf16(16),Ee=null,Te=0;for(C=0;C<=15;C++)te[C]=0;for(A=0;A<s;A++)te[p[e+A]]++;for(W=R,O=15;1<=O&&te[O]===0;O--);if(O<W&&(W=O),O===0)return l[f++]=20971520,l[f++]=20971520,y.bits=1,0;for(b=1;b<O&&te[b]===0;b++);for(W<b&&(W=b),C=F=1;C<=15;C++)if(F<<=1,(F-=te[C])<0)return-1;if(0<F&&(v===0||O!==1))return-1;for(ae[1]=0,C=1;C<15;C++)ae[C+1]=ae[C]+te[C];for(A=0;A<s;A++)p[e+A]!==0&&(c[ae[p[e+A]]++]=A);if(x=v===0?($=Ee=c,19):v===1?($=u,Z-=257,Ee=o,Te-=257,256):($=d,Ee=g,-1),C=b,k=f,G=A=N=0,E=-1,w=(j=1<<(K=W))-1,v===1&&852<j||v===2&&592<j)return 1;for(;;){for(S=C-G,U=c[A]<x?(B=0,c[A]):c[A]>x?(B=Ee[Te+c[A]],$[Z+c[A]]):(B=96,0),m=1<<C-G,b=_=1<<K;l[k+(N>>G)+(_-=m)]=S<<24|B<<16|U|0,_!==0;);for(m=1<<C-1;N&m;)m>>=1;if(m!==0?(N&=m-1,N+=m):N=0,A++,--te[C]==0){if(C===O)break;C=p[e+c[A]]}if(W<C&&(N&w)!==E){for(G===0&&(G=W),k+=b,F=1<<(K=C-G);K+G<O&&!((F-=te[K+G])<=0);)K++,F<<=1;if(j+=1<<K,v===1&&852<j||v===2&&592<j)return 1;l[E=N&w]=W<<24|K<<16|k-f|0}}return N!==0&&(l[k+N]=C-G<<24|64<<16|0),y.bits=W,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var n=t("../utils/common"),u=0,o=1;function d(H){for(var J=H.length;0<=--J;)H[J]=0}var g=0,v=29,p=256,e=p+1+v,s=30,l=19,f=2*e+1,c=15,y=16,m=7,_=256,E=16,w=17,k=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(e+2));d(R);var C=new Array(2*s);d(C);var A=new Array(512);d(A);var b=new Array(256);d(b);var O=new Array(v);d(O);var W,K,G,F=new Array(s);function j(H,J,ce,he,ee){this.static_tree=H,this.extra_bits=J,this.extra_base=ce,this.elems=he,this.max_length=ee,this.has_stree=H&&H.length}function N(H,J){this.dyn_tree=H,this.max_code=0,this.stat_desc=J}function $(H){return H<256?A[H]:A[256+(H>>>7)]}function Z(H,J){H.pending_buf[H.pending++]=255&J,H.pending_buf[H.pending++]=J>>>8&255}function te(H,J,ce){H.bi_valid>y-ce?(H.bi_buf|=J<<H.bi_valid&65535,Z(H,H.bi_buf),H.bi_buf=J>>y-H.bi_valid,H.bi_valid+=ce-y):(H.bi_buf|=J<<H.bi_valid&65535,H.bi_valid+=ce)}function ae(H,J,ce){te(H,ce[2*J],ce[2*J+1])}function Ee(H,J){for(var ce=0;ce|=1&H,H>>>=1,ce<<=1,0<--J;);return ce>>>1}function Te(H,J,ce){var he,ee,Se=new Array(c+1),Le=0;for(he=1;he<=c;he++)Se[he]=Le=Le+ce[he-1]<<1;for(ee=0;ee<=J;ee++){var ke=H[2*ee+1];ke!==0&&(H[2*ee]=Ee(Se[ke]++,ke))}}function Ae(H){var J;for(J=0;J<e;J++)H.dyn_ltree[2*J]=0;for(J=0;J<s;J++)H.dyn_dtree[2*J]=0;for(J=0;J<l;J++)H.bl_tree[2*J]=0;H.dyn_ltree[2*_]=1,H.opt_len=H.static_len=0,H.last_lit=H.matches=0}function De(H){8<H.bi_valid?Z(H,H.bi_buf):0<H.bi_valid&&(H.pending_buf[H.pending++]=H.bi_buf),H.bi_buf=0,H.bi_valid=0}function ze(H,J,ce,he){var ee=2*J,Se=2*ce;return H[ee]<H[Se]||H[ee]===H[Se]&&he[J]<=he[ce]}function Ce(H,J,ce){for(var he=H.heap[ce],ee=ce<<1;ee<=H.heap_len&&(ee<H.heap_len&&ze(J,H.heap[ee+1],H.heap[ee],H.depth)&&ee++,!ze(J,he,H.heap[ee],H.depth));)H.heap[ce]=H.heap[ee],ce=ee,ee<<=1;H.heap[ce]=he}function Oe(H,J,ce){var he,ee,Se,Le,ke=0;if(H.last_lit!==0)for(;he=H.pending_buf[H.d_buf+2*ke]<<8|H.pending_buf[H.d_buf+2*ke+1],ee=H.pending_buf[H.l_buf+ke],ke++,he===0?ae(H,ee,J):(ae(H,(Se=b[ee])+p+1,J),(Le=x[Se])!==0&&te(H,ee-=O[Se],Le),ae(H,Se=$(--he),ce),(Le=S[Se])!==0&&te(H,he-=F[Se],Le)),ke<H.last_lit;);ae(H,_,J)}function $e(H,J){var ce,he,ee,Se=J.dyn_tree,Le=J.stat_desc.static_tree,ke=J.stat_desc.has_stree,Ne=J.stat_desc.elems,Ye=-1;for(H.heap_len=0,H.heap_max=f,ce=0;ce<Ne;ce++)Se[2*ce]!==0?(H.heap[++H.heap_len]=Ye=ce,H.depth[ce]=0):Se[2*ce+1]=0;for(;H.heap_len<2;)Se[2*(ee=H.heap[++H.heap_len]=Ye<2?++Ye:0)]=1,H.depth[ee]=0,H.opt_len--,ke&&(H.static_len-=Le[2*ee+1]);for(J.max_code=Ye,ce=H.heap_len>>1;1<=ce;ce--)Ce(H,Se,ce);for(ee=Ne;ce=H.heap[1],H.heap[1]=H.heap[H.heap_len--],Ce(H,Se,1),he=H.heap[1],H.heap[--H.heap_max]=ce,H.heap[--H.heap_max]=he,Se[2*ee]=Se[2*ce]+Se[2*he],H.depth[ee]=(H.depth[ce]>=H.depth[he]?H.depth[ce]:H.depth[he])+1,Se[2*ce+1]=Se[2*he+1]=ee,H.heap[1]=ee++,Ce(H,Se,1),2<=H.heap_len;);H.heap[--H.heap_max]=H.heap[1],function(et,qe){var Et,gt,Zt,ft,ki,Ut,Ft=qe.dyn_tree,Mi=qe.max_code,Ai=qe.stat_desc.static_tree,Fr=qe.stat_desc.has_stree,Ni=qe.stat_desc.extra_bits,Ci=qe.stat_desc.extra_base,Jt=qe.stat_desc.max_length,Qt=0;for(ft=0;ft<=c;ft++)et.bl_count[ft]=0;for(Ft[2*et.heap[et.heap_max]+1]=0,Et=et.heap_max+1;Et<f;Et++)Jt<(ft=Ft[2*Ft[2*(gt=et.heap[Et])+1]+1]+1)&&(ft=Jt,Qt++),Ft[2*gt+1]=ft,Mi<gt||(et.bl_count[ft]++,ki=0,Ci<=gt&&(ki=Ni[gt-Ci]),Ut=Ft[2*gt],et.opt_len+=Ut*(ft+ki),Fr&&(et.static_len+=Ut*(Ai[2*gt+1]+ki)));if(Qt!==0){do{for(ft=Jt-1;et.bl_count[ft]===0;)ft--;et.bl_count[ft]--,et.bl_count[ft+1]+=2,et.bl_count[Jt]--,Qt-=2}while(0<Qt);for(ft=Jt;ft!==0;ft--)for(gt=et.bl_count[ft];gt!==0;)Mi<(Zt=et.heap[--Et])||(Ft[2*Zt+1]!==ft&&(et.opt_len+=(ft-Ft[2*Zt+1])*Ft[2*Zt],Ft[2*Zt+1]=ft),gt--)}}(H,J),Te(Se,Ye,H.bl_count)}function D(H,J,ce){var he,ee,Se=-1,Le=J[1],ke=0,Ne=7,Ye=4;for(Le===0&&(Ne=138,Ye=3),J[2*(ce+1)+1]=65535,he=0;he<=ce;he++)ee=Le,Le=J[2*(he+1)+1],++ke<Ne&&ee===Le||(ke<Ye?H.bl_tree[2*ee]+=ke:ee!==0?(ee!==Se&&H.bl_tree[2*ee]++,H.bl_tree[2*E]++):ke<=10?H.bl_tree[2*w]++:H.bl_tree[2*k]++,Se=ee,Ye=(ke=0)===Le?(Ne=138,3):ee===Le?(Ne=6,3):(Ne=7,4))}function fe(H,J,ce){var he,ee,Se=-1,Le=J[1],ke=0,Ne=7,Ye=4;for(Le===0&&(Ne=138,Ye=3),he=0;he<=ce;he++)if(ee=Le,Le=J[2*(he+1)+1],!(++ke<Ne&&ee===Le)){if(ke<Ye)for(;ae(H,ee,H.bl_tree),--ke!=0;);else ee!==0?(ee!==Se&&(ae(H,ee,H.bl_tree),ke--),ae(H,E,H.bl_tree),te(H,ke-3,2)):ke<=10?(ae(H,w,H.bl_tree),te(H,ke-3,3)):(ae(H,k,H.bl_tree),te(H,ke-11,7));Se=ee,Ye=(ke=0)===Le?(Ne=138,3):ee===Le?(Ne=6,3):(Ne=7,4)}}d(F);var ne=!1;function Y(H,J,ce,he){te(H,(g<<1)+(he?1:0),3),function(ee,Se,Le,ke){De(ee),ke&&(Z(ee,Le),Z(ee,~Le)),n.arraySet(ee.pending_buf,ee.window,Se,Le,ee.pending),ee.pending+=Le}(H,J,ce,!0)}r._tr_init=function(H){ne||(function(){var J,ce,he,ee,Se,Le=new Array(c+1);for(ee=he=0;ee<v-1;ee++)for(O[ee]=he,J=0;J<1<<x[ee];J++)b[he++]=ee;for(b[he-1]=ee,ee=Se=0;ee<16;ee++)for(F[ee]=Se,J=0;J<1<<S[ee];J++)A[Se++]=ee;for(Se>>=7;ee<s;ee++)for(F[ee]=Se<<7,J=0;J<1<<S[ee]-7;J++)A[256+Se++]=ee;for(ce=0;ce<=c;ce++)Le[ce]=0;for(J=0;J<=143;)R[2*J+1]=8,J++,Le[8]++;for(;J<=255;)R[2*J+1]=9,J++,Le[9]++;for(;J<=279;)R[2*J+1]=7,J++,Le[7]++;for(;J<=287;)R[2*J+1]=8,J++,Le[8]++;for(Te(R,e+1,Le),J=0;J<s;J++)C[2*J+1]=5,C[2*J]=Ee(J,5);W=new j(R,x,p+1,e,c),K=new j(C,S,0,s,c),G=new j(new Array(0),B,0,l,m)}(),ne=!0),H.l_desc=new N(H.dyn_ltree,W),H.d_desc=new N(H.dyn_dtree,K),H.bl_desc=new N(H.bl_tree,G),H.bi_buf=0,H.bi_valid=0,Ae(H)},r._tr_stored_block=Y,r._tr_flush_block=function(H,J,ce,he){var ee,Se,Le=0;0<H.level?(H.strm.data_type===2&&(H.strm.data_type=function(ke){var Ne,Ye=4093624447;for(Ne=0;Ne<=31;Ne++,Ye>>>=1)if(1&Ye&&ke.dyn_ltree[2*Ne]!==0)return u;if(ke.dyn_ltree[18]!==0||ke.dyn_ltree[20]!==0||ke.dyn_ltree[26]!==0)return o;for(Ne=32;Ne<p;Ne++)if(ke.dyn_ltree[2*Ne]!==0)return o;return u}(H)),$e(H,H.l_desc),$e(H,H.d_desc),Le=function(ke){var Ne;for(D(ke,ke.dyn_ltree,ke.l_desc.max_code),D(ke,ke.dyn_dtree,ke.d_desc.max_code),$e(ke,ke.bl_desc),Ne=l-1;3<=Ne&&ke.bl_tree[2*U[Ne]+1]===0;Ne--);return ke.opt_len+=3*(Ne+1)+5+5+4,Ne}(H),ee=H.opt_len+3+7>>>3,(Se=H.static_len+3+7>>>3)<=ee&&(ee=Se)):ee=Se=ce+5,ce+4<=ee&&J!==-1?Y(H,J,ce,he):H.strategy===4||Se===ee?(te(H,2+(he?1:0),3),Oe(H,R,C)):(te(H,4+(he?1:0),3),function(ke,Ne,Ye,et){var qe;for(te(ke,Ne-257,5),te(ke,Ye-1,5),te(ke,et-4,4),qe=0;qe<et;qe++)te(ke,ke.bl_tree[2*U[qe]+1],3);fe(ke,ke.dyn_ltree,Ne-1),fe(ke,ke.dyn_dtree,Ye-1)}(H,H.l_desc.max_code+1,H.d_desc.max_code+1,Le+1),Oe(H,H.dyn_ltree,H.dyn_dtree)),Ae(H),he&&De(H)},r._tr_tally=function(H,J,ce){return H.pending_buf[H.d_buf+2*H.last_lit]=J>>>8&255,H.pending_buf[H.d_buf+2*H.last_lit+1]=255&J,H.pending_buf[H.l_buf+H.last_lit]=255&ce,H.last_lit++,J===0?H.dyn_ltree[2*ce]++:(H.matches++,J--,H.dyn_ltree[2*(b[ce]+p+1)]++,H.dyn_dtree[2*$(J)]++),H.last_lit===H.lit_bufsize-1},r._tr_align=function(H){te(H,2,3),ae(H,_,R),function(J){J.bi_valid===16?(Z(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):8<=J.bi_valid&&(J.pending_buf[J.pending++]=255&J.bi_buf,J.bi_buf>>=8,J.bi_valid-=8)}(H)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(n){(function(u,o){if(!u.setImmediate){var d,g,v,p,e=1,s={},l=!1,f=u.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(u);c=c&&c.setTimeout?c:u,d={}.toString.call(u.process)==="[object process]"?function(E){process.nextTick(function(){m(E)})}:function(){if(u.postMessage&&!u.importScripts){var E=!0,w=u.onmessage;return u.onmessage=function(){E=!1},u.postMessage("","*"),u.onmessage=w,E}}()?(p="setImmediate$"+Math.random()+"$",u.addEventListener?u.addEventListener("message",_,!1):u.attachEvent("onmessage",_),function(E){u.postMessage(p+E,"*")}):u.MessageChannel?((v=new MessageChannel).port1.onmessage=function(E){m(E.data)},function(E){v.port2.postMessage(E)}):f&&"onreadystatechange"in f.createElement("script")?(g=f.documentElement,function(E){var w=f.createElement("script");w.onreadystatechange=function(){m(E),w.onreadystatechange=null,g.removeChild(w),w=null},g.appendChild(w)}):function(E){setTimeout(m,0,E)},c.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var w=new Array(arguments.length-1),k=0;k<w.length;k++)w[k]=arguments[k+1];var x={callback:E,args:w};return s[e]=x,d(e),e++},c.clearImmediate=y}function y(E){delete s[E]}function m(E){if(l)setTimeout(m,0,E);else{var w=s[E];if(w){l=!0;try{(function(k){var x=k.callback,S=k.args;switch(S.length){case 0:x();break;case 1:x(S[0]);break;case 2:x(S[0],S[1]);break;case 3:x(S[0],S[1],S[2]);break;default:x.apply(o,S)}})(w)}finally{y(E),l=!1}}}}function _(E){E.source===u&&typeof E.data=="string"&&E.data.indexOf(p)===0&&m(+E.data.slice(p.length))}})(typeof self=="undefined"?n===void 0?this:n:self)}).call(this,typeof cn!="undefined"?cn:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(Ql);var rs=Ql.exports;const Ji=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:globalThis;function wp(h,a){return typeof a=="undefined"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob([String.fromCharCode(65279),h],{type:h.type}):h}function ns(h,a,t){var i=new XMLHttpRequest;i.open("GET",h),i.responseType="blob",i.onload=function(){iu(i.response,a,t,void 0)},i.onerror=function(){console.error("could not download file")},i.send()}function eu(h){var a=new XMLHttpRequest;a.open("HEAD",h,!1);try{a.send()}catch(t){}return a.status>=200&&a.status<=299}function En(h){try{h.dispatchEvent(new MouseEvent("click"))}catch(t){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(a)}}var tu=Ji.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Tp=/SamsungBrowser/.test(navigator.userAgent);const iu=(()=>"download"in HTMLAnchorElement.prototype&&!tu?function(h,a,t){var i=Ji.URL||Ji.webkitURL,r=document.createElement("a");a=a||h.name||"download",r.download=a,r.rel="noopener",typeof h=="string"?(r.href=h,r.origin!==location.origin?eu(r.href)?ns(h,a,t):(r.target="_blank",En(r)):En(r)):(r.href=i.createObjectURL(h),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),Tp?En(r):setTimeout(function(){En(r)},0))}:"msSaveOrOpenBlob"in navigator?function(h,a,t){if(a=a||h.name||"download",typeof h=="string")if(eu(h))ns(h,a,t);else{var i=document.createElement("a");i.href=h,i.target="_blank",setTimeout(function(){En(i)})}else Ji.navigator.msSaveOrOpenBlob(wp(h,t),a)}:function(h,a,t,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof h=="string")return ns(h,a,t);var r=h.type==="application/octet-stream",n=/constructor/i.test(Ji.HTMLElement)||Ji.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&n||tu)&&typeof FileReader!="undefined"){var o=new FileReader;o.onloadend=function(){var v=o.result;v=u?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=v:Ji.location=v,i=null},o.readAsDataURL(h)}else{var d=Ji.URL||Ji.webkitURL,g=d.createObjectURL(h);i?i.location=g:location.href=g,i=null,setTimeout(function(){d.revokeObjectURL(g)},4e4)}})();function Sp(){const h=je({start:void 0,end:void 0}),a=je(!1),t={limitStart:null,limitEnd:null,confirmFn:null};return{rangeInputFormData:h,isshowRangeInputModal:a,openRangeInputModal:(n,u,o)=>oe(this,null,function*(){h.value.start=n,h.value.end=u,t.limitStart=n,t.limitEnd=u,t.confirmFn=o,a.value=!0}),beforeCloseRangeInputModal:n=>oe(this,null,function*(){if(n==="confirm"){let u=parseInt(h.value.start),o=parseInt(h.value.end);if(u!=u||o!=o)return Fe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;const{limitStart:d,limitEnd:g}=t;if(u<d||o>g||u>o)return Fe({message:"\u5DF2\u8D85\u51FA\u533A\u95F4\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165",position:"top"}),!1;t.confirmFn&&t.confirmFn(u,o)}return!0})}}function kp(){const h=je({isShow:!1,data:[]});return{sheet:h,open:i=>{h.value.data=i,h.value.isShow=!0,hn().then(()=>{document.querySelector(".list-action-sheet-box .active").scrollIntoView()})},close:()=>{h.value.isShow=!1}}}class Ap{constructor(){ge(this,"axios")}getVsongData(){return oe(this,null,function*(){let a="/main/get-data",t=null;return Ar()?t=yield Gt.getBody(a):(t=yield this.axios.get(a),Gt.setBody(a,t,180*Tr)),t.data||{collect:{\u559C\u6B22\u7684\u97F3\u4E50:[]},settings:{loopMode:"listloop",showVideo:!0,proxyUrl:"",alistConfig:{url:"",username:"",password:""}}}})}setVsongData(a){return oe(this,null,function*(){let t="/main/get-data";if(Ar()){let i=yield Gt.getBody(t);i.data=a,Gt.setBody(t,i,180*Tr),Fa(!0);return}yield this.axios.post("/main/set-data",a)})}saveSettings(a){return oe(this,null,function*(){let t=yield this.getVsongData();Object.keys(a).forEach(i=>{t.settings[i]=a[i]}),yield this.setVsongData(t)})}syncVsongData(){return oe(this,null,function*(){let a="/main/get-data",t=yield Gt.getBody(a);!t||(yield this.setVsongData(t.data))})}getOssList(){return oe(this,null,function*(){return(yield this.axios.get("/vsong/oss-list")).data})}unbindAccount(a){return oe(this,null,function*(){yield this.axios.post("/vsong/unbind-account",{platform:a})})}setAxios(a){this.axios=a}getAxios(){return this.axios}}var ut=new Ap,bn={},Cp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ru={},fi={};let as;const Dp=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];fi.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17};fi.getSymbolTotalCodewords=function(a){return Dp[a]};fi.getBCHDigit=function(h){let a=0;for(;h!==0;)a++,h>>>=1;return a};fi.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');as=a};fi.isKanjiModeEnabled=function(){return typeof as!="undefined"};fi.toSJIS=function(a){return as(a)};var ea={};(function(h){h.L={bit:1},h.M={bit:0},h.Q={bit:3},h.H={bit:2};function a(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return h.L;case"m":case"medium":return h.M;case"q":case"quartile":return h.Q;case"h":case"high":return h.H;default:throw new Error("Unknown EC Level: "+t)}}h.isValid=function(i){return i&&typeof i.bit!="undefined"&&i.bit>=0&&i.bit<4},h.from=function(i,r){if(h.isValid(i))return i;try{return a(i)}catch(n){return r}}})(ea);function nu(){this.buffer=[],this.length=0}nu.prototype={get:function(h){const a=Math.floor(h/8);return(this.buffer[a]>>>7-h%8&1)==1},put:function(h,a){for(let t=0;t<a;t++)this.putBit((h>>>a-t-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(h){const a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),h&&(this.buffer[a]|=128>>>this.length%8),this.length++}};var Rp=nu;function wn(h){if(!h||h<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=h,this.data=new Uint8Array(h*h),this.reservedBit=new Uint8Array(h*h)}wn.prototype.set=function(h,a,t,i){const r=h*this.size+a;this.data[r]=t,i&&(this.reservedBit[r]=!0)};wn.prototype.get=function(h,a){return this.data[h*this.size+a]};wn.prototype.xor=function(h,a,t){this.data[h*this.size+a]^=t};wn.prototype.isReserved=function(h,a){return this.reservedBit[h*this.size+a]};var Up=wn,au={};(function(h){const a=fi.getSymbolSize;h.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,n=a(i),u=n===145?26:Math.ceil((n-13)/(2*r-2))*2,o=[n-7];for(let d=1;d<r-1;d++)o[d]=o[d-1]-u;return o.push(6),o.reverse()},h.getPositions=function(i){const r=[],n=h.getRowColCoords(i),u=n.length;for(let o=0;o<u;o++)for(let d=0;d<u;d++)o===0&&d===0||o===0&&d===u-1||o===u-1&&d===0||r.push([n[o],n[d]]);return r}})(au);var su={};const Lp=fi.getSymbolSize,ou=7;su.getPositions=function(a){const t=Lp(a);return[[0,0],[t-ou,0],[0,t-ou]]};var lu={};(function(h){h.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};h.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},h.from=function(r){return h.isValid(r)?parseInt(r,10):void 0},h.getPenaltyN1=function(r){const n=r.size;let u=0,o=0,d=0,g=null,v=null;for(let p=0;p<n;p++){o=d=0,g=v=null;for(let e=0;e<n;e++){let s=r.get(p,e);s===g?o++:(o>=5&&(u+=a.N1+(o-5)),g=s,o=1),s=r.get(e,p),s===v?d++:(d>=5&&(u+=a.N1+(d-5)),v=s,d=1)}o>=5&&(u+=a.N1+(o-5)),d>=5&&(u+=a.N1+(d-5))}return u},h.getPenaltyN2=function(r){const n=r.size;let u=0;for(let o=0;o<n-1;o++)for(let d=0;d<n-1;d++){const g=r.get(o,d)+r.get(o,d+1)+r.get(o+1,d)+r.get(o+1,d+1);(g===4||g===0)&&u++}return u*a.N2},h.getPenaltyN3=function(r){const n=r.size;let u=0,o=0,d=0;for(let g=0;g<n;g++){o=d=0;for(let v=0;v<n;v++)o=o<<1&2047|r.get(g,v),v>=10&&(o===1488||o===93)&&u++,d=d<<1&2047|r.get(v,g),v>=10&&(d===1488||d===93)&&u++}return u*a.N3},h.getPenaltyN4=function(r){let n=0;const u=r.data.length;for(let d=0;d<u;d++)n+=r.data[d];return Math.abs(Math.ceil(n*100/u/5)-10)*a.N4};function t(i,r,n){switch(i){case h.Patterns.PATTERN000:return(r+n)%2==0;case h.Patterns.PATTERN001:return r%2==0;case h.Patterns.PATTERN010:return n%3==0;case h.Patterns.PATTERN011:return(r+n)%3==0;case h.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case h.Patterns.PATTERN101:return r*n%2+r*n%3==0;case h.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case h.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+i)}}h.applyMask=function(r,n){const u=n.size;for(let o=0;o<u;o++)for(let d=0;d<u;d++)n.isReserved(d,o)||n.xor(d,o,t(r,d,o))},h.getBestMask=function(r,n){const u=Object.keys(h.Patterns).length;let o=0,d=1/0;for(let g=0;g<u;g++){n(g),h.applyMask(g,r);const v=h.getPenaltyN1(r)+h.getPenaltyN2(r)+h.getPenaltyN3(r)+h.getPenaltyN4(r);h.applyMask(g,r),v<d&&(d=v,o=g)}return o}})(lu);var ta={};const hr=ea,ia=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ra=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];ta.getBlocksCount=function(a,t){switch(t){case hr.L:return ia[(a-1)*4+0];case hr.M:return ia[(a-1)*4+1];case hr.Q:return ia[(a-1)*4+2];case hr.H:return ia[(a-1)*4+3];default:return}};ta.getTotalCodewordsCount=function(a,t){switch(t){case hr.L:return ra[(a-1)*4+0];case hr.M:return ra[(a-1)*4+1];case hr.Q:return ra[(a-1)*4+2];case hr.H:return ra[(a-1)*4+3];default:return}};var uu={},na={};const Tn=new Uint8Array(512),aa=new Uint8Array(256);(function(){let a=1;for(let t=0;t<255;t++)Tn[t]=a,aa[a]=t,a<<=1,a&256&&(a^=285);for(let t=255;t<512;t++)Tn[t]=Tn[t-255]})();na.log=function(a){if(a<1)throw new Error("log("+a+")");return aa[a]};na.exp=function(a){return Tn[a]};na.mul=function(a,t){return a===0||t===0?0:Tn[aa[a]+aa[t]]};(function(h){const a=na;h.mul=function(i,r){const n=new Uint8Array(i.length+r.length-1);for(let u=0;u<i.length;u++)for(let o=0;o<r.length;o++)n[u+o]^=a.mul(i[u],r[o]);return n},h.mod=function(i,r){let n=new Uint8Array(i);for(;n.length-r.length>=0;){const u=n[0];for(let d=0;d<r.length;d++)n[d]^=a.mul(r[d],u);let o=0;for(;o<n.length&&n[o]===0;)o++;n=n.slice(o)}return n},h.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let n=0;n<i;n++)r=h.mul(r,new Uint8Array([1,a.exp(n)]));return r}})(uu);const fu=uu;function ss(h){this.genPoly=void 0,this.degree=h,this.degree&&this.initialize(this.degree)}ss.prototype.initialize=function(a){this.degree=a,this.genPoly=fu.generateECPolynomial(this.degree)};ss.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(a.length+this.degree);t.set(a);const i=fu.mod(t,this.genPoly),r=this.degree-i.length;if(r>0){const n=new Uint8Array(this.degree);return n.set(i,r),n}return i};var Pp=ss,du={},pr={},os={};os.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40};var Ii={};const cu="[0-9]+",Bp="[A-Z $%*+\\-./:]+";let Sn="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Sn=Sn.replace(/u/g,"\\u");const Fp="(?:(?![A-Z0-9 $%*+\\-./:]|"+Sn+`)(?:.|[\r
]))+`;Ii.KANJI=new RegExp(Sn,"g");Ii.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Ii.BYTE=new RegExp(Fp,"g");Ii.NUMERIC=new RegExp(cu,"g");Ii.ALPHANUMERIC=new RegExp(Bp,"g");const Op=new RegExp("^"+Sn+"$"),Ip=new RegExp("^"+cu+"$"),Mp=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Ii.testKanji=function(a){return Op.test(a)};Ii.testNumeric=function(a){return Ip.test(a)};Ii.testAlphanumeric=function(a){return Mp.test(a)};(function(h){const a=os,t=Ii;h.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]},h.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]},h.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]},h.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]},h.MIXED={bit:-1},h.getCharCountIndicator=function(n,u){if(!n.ccBits)throw new Error("Invalid mode: "+n);if(!a.isValid(u))throw new Error("Invalid version: "+u);return u>=1&&u<10?n.ccBits[0]:u<27?n.ccBits[1]:n.ccBits[2]},h.getBestModeForData=function(n){return t.testNumeric(n)?h.NUMERIC:t.testAlphanumeric(n)?h.ALPHANUMERIC:t.testKanji(n)?h.KANJI:h.BYTE},h.toString=function(n){if(n&&n.id)return n.id;throw new Error("Invalid mode")},h.isValid=function(n){return n&&n.bit&&n.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return h.NUMERIC;case"alphanumeric":return h.ALPHANUMERIC;case"kanji":return h.KANJI;case"byte":return h.BYTE;default:throw new Error("Unknown mode: "+r)}}h.from=function(n,u){if(h.isValid(n))return n;try{return i(n)}catch(o){return u}}})(pr);(function(h){const a=fi,t=ta,i=ea,r=pr,n=os,u=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,o=a.getBCHDigit(u);function d(e,s,l){for(let f=1;f<=40;f++)if(s<=h.getCapacity(f,l,e))return f}function g(e,s){return r.getCharCountIndicator(e,s)+4}function v(e,s){let l=0;return e.forEach(function(f){l+=g(f.mode,s)+f.getBitsLength()}),l}function p(e,s){for(let l=1;l<=40;l++)if(v(e,l)<=h.getCapacity(l,s,r.MIXED))return l}h.from=function(s,l){return n.isValid(s)?parseInt(s,10):l},h.getCapacity=function(s,l,f){if(!n.isValid(s))throw new Error("Invalid QR Code version");typeof f=="undefined"&&(f=r.BYTE);const c=a.getSymbolTotalCodewords(s),y=t.getTotalCodewordsCount(s,l),m=(c-y)*8;if(f===r.MIXED)return m;const _=m-g(f,s);switch(f){case r.NUMERIC:return Math.floor(_/10*3);case r.ALPHANUMERIC:return Math.floor(_/11*2);case r.KANJI:return Math.floor(_/13);case r.BYTE:default:return Math.floor(_/8)}},h.getBestVersionForData=function(s,l){let f;const c=i.from(l,i.M);if(Array.isArray(s)){if(s.length>1)return p(s,c);if(s.length===0)return 1;f=s[0]}else f=s;return d(f.mode,f.getLength(),c)},h.getEncodedBits=function(s){if(!n.isValid(s)||s<7)throw new Error("Invalid QR Code version");let l=s<<12;for(;a.getBCHDigit(l)-o>=0;)l^=u<<a.getBCHDigit(l)-o;return s<<12|l}})(du);var hu={};const ls=fi,pu=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,Np=1<<14|1<<12|1<<10|1<<4|1<<1,gu=ls.getBCHDigit(pu);hu.getEncodedBits=function(a,t){const i=a.bit<<3|t;let r=i<<10;for(;ls.getBCHDigit(r)-gu>=0;)r^=pu<<ls.getBCHDigit(r)-gu;return(i<<10|r)^Np};var vu={};const zp=pr;function Yr(h){this.mode=zp.NUMERIC,this.data=h.toString()}Yr.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)};Yr.prototype.getLength=function(){return this.data.length};Yr.prototype.getBitsLength=function(){return Yr.getBitsLength(this.data.length)};Yr.prototype.write=function(a){let t,i,r;for(t=0;t+3<=this.data.length;t+=3)i=this.data.substr(t,3),r=parseInt(i,10),a.put(r,10);const n=this.data.length-t;n>0&&(i=this.data.substr(t),r=parseInt(i,10),a.put(r,n*3+1))};var Vp=Yr;const Hp=pr,us=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Xr(h){this.mode=Hp.ALPHANUMERIC,this.data=h}Xr.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)};Xr.prototype.getLength=function(){return this.data.length};Xr.prototype.getBitsLength=function(){return Xr.getBitsLength(this.data.length)};Xr.prototype.write=function(a){let t;for(t=0;t+2<=this.data.length;t+=2){let i=us.indexOf(this.data[t])*45;i+=us.indexOf(this.data[t+1]),a.put(i,11)}this.data.length%2&&a.put(us.indexOf(this.data[t]),6)};var jp=Xr,Gp=function(a){for(var t=[],i=a.length,r=0;r<i;r++){var n=a.charCodeAt(r);if(n>=55296&&n<=56319&&i>r+1){var u=a.charCodeAt(r+1);u>=56320&&u<=57343&&(n=(n-55296)*1024+u-56320+65536,r+=1)}if(n<128){t.push(n);continue}if(n<2048){t.push(n>>6|192),t.push(n&63|128);continue}if(n<55296||n>=57344&&n<65536){t.push(n>>12|224),t.push(n>>6&63|128),t.push(n&63|128);continue}if(n>=65536&&n<=1114111){t.push(n>>18|240),t.push(n>>12&63|128),t.push(n>>6&63|128),t.push(n&63|128);continue}t.push(239,191,189)}return new Uint8Array(t).buffer};const $p=Gp,Wp=pr;function Kr(h){this.mode=Wp.BYTE,typeof h=="string"&&(h=$p(h)),this.data=new Uint8Array(h)}Kr.getBitsLength=function(a){return a*8};Kr.prototype.getLength=function(){return this.data.length};Kr.prototype.getBitsLength=function(){return Kr.getBitsLength(this.data.length)};Kr.prototype.write=function(h){for(let a=0,t=this.data.length;a<t;a++)h.put(this.data[a],8)};var Yp=Kr;const Xp=pr,Kp=fi;function qr(h){this.mode=Xp.KANJI,this.data=h}qr.getBitsLength=function(a){return a*13};qr.prototype.getLength=function(){return this.data.length};qr.prototype.getBitsLength=function(){return qr.getBitsLength(this.data.length)};qr.prototype.write=function(h){let a;for(a=0;a<this.data.length;a++){let t=Kp.toSJIS(this.data[a]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),h.put(t,13)}};var qp=qr,yu={exports:{}};(function(h){var a={single_source_shortest_paths:function(t,i,r){var n={},u={};u[i]=0;var o=a.PriorityQueue.make();o.push(i,0);for(var d,g,v,p,e,s,l,f,c;!o.empty();){d=o.pop(),g=d.value,p=d.cost,e=t[g]||{};for(v in e)e.hasOwnProperty(v)&&(s=e[v],l=p+s,f=u[v],c=typeof u[v]=="undefined",(c||f>l)&&(u[v]=l,o.push(v,l),n[v]=g))}if(typeof r!="undefined"&&typeof u[r]=="undefined"){var y=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(y)}return n},extract_shortest_path_from_predecessor_list:function(t,i){for(var r=[],n=i;n;)r.push(n),n=t[n];return r.reverse(),r},find_path:function(t,i,r){var n=a.single_source_shortest_paths(t,i,r);return a.extract_shortest_path_from_predecessor_list(n,r)},PriorityQueue:{make:function(t){var i=a.PriorityQueue,r={},n;t=t||{};for(n in i)i.hasOwnProperty(n)&&(r[n]=i[n]);return r.queue=[],r.sorter=t.sorter||i.default_sorter,r},default_sorter:function(t,i){return t.cost-i.cost},push:function(t,i){var r={value:t,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};h.exports=a})(yu);(function(h){const a=pr,t=Vp,i=jp,r=Yp,n=qp,u=Ii,o=fi,d=yu.exports;function g(y){return unescape(encodeURIComponent(y)).length}function v(y,m,_){const E=[];let w;for(;(w=y.exec(_))!==null;)E.push({data:w[0],index:w.index,mode:m,length:w[0].length});return E}function p(y){const m=v(u.NUMERIC,a.NUMERIC,y),_=v(u.ALPHANUMERIC,a.ALPHANUMERIC,y);let E,w;return o.isKanjiModeEnabled()?(E=v(u.BYTE,a.BYTE,y),w=v(u.KANJI,a.KANJI,y)):(E=v(u.BYTE_KANJI,a.BYTE,y),w=[]),m.concat(_,E,w).sort(function(x,S){return x.index-S.index}).map(function(x){return{data:x.data,mode:x.mode,length:x.length}})}function e(y,m){switch(m){case a.NUMERIC:return t.getBitsLength(y);case a.ALPHANUMERIC:return i.getBitsLength(y);case a.KANJI:return n.getBitsLength(y);case a.BYTE:return r.getBitsLength(y)}}function s(y){return y.reduce(function(m,_){const E=m.length-1>=0?m[m.length-1]:null;return E&&E.mode===_.mode?(m[m.length-1].data+=_.data,m):(m.push(_),m)},[])}function l(y){const m=[];for(let _=0;_<y.length;_++){const E=y[_];switch(E.mode){case a.NUMERIC:m.push([E,{data:E.data,mode:a.ALPHANUMERIC,length:E.length},{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.ALPHANUMERIC:m.push([E,{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.KANJI:m.push([E,{data:E.data,mode:a.BYTE,length:g(E.data)}]);break;case a.BYTE:m.push([{data:E.data,mode:a.BYTE,length:g(E.data)}])}}return m}function f(y,m){const _={},E={start:{}};let w=["start"];for(let k=0;k<y.length;k++){const x=y[k],S=[];for(let B=0;B<x.length;B++){const U=x[B],R=""+k+B;S.push(R),_[R]={node:U,lastCount:0},E[R]={};for(let C=0;C<w.length;C++){const A=w[C];_[A]&&_[A].node.mode===U.mode?(E[A][R]=e(_[A].lastCount+U.length,U.mode)-e(_[A].lastCount,U.mode),_[A].lastCount+=U.length):(_[A]&&(_[A].lastCount=U.length),E[A][R]=e(U.length,U.mode)+4+a.getCharCountIndicator(U.mode,m))}}w=S}for(let k=0;k<w.length;k++)E[w[k]].end=0;return{map:E,table:_}}function c(y,m){let _;const E=a.getBestModeForData(y);if(_=a.from(m,E),_!==a.BYTE&&_.bit<E.bit)throw new Error('"'+y+'" cannot be encoded with mode '+a.toString(_)+`.
 Suggested mode is: `+a.toString(E));switch(_===a.KANJI&&!o.isKanjiModeEnabled()&&(_=a.BYTE),_){case a.NUMERIC:return new t(y);case a.ALPHANUMERIC:return new i(y);case a.KANJI:return new n(y);case a.BYTE:return new r(y)}}h.fromArray=function(m){return m.reduce(function(_,E){return typeof E=="string"?_.push(c(E,null)):E.data&&_.push(c(E.data,E.mode)),_},[])},h.fromString=function(m,_){const E=p(m,o.isKanjiModeEnabled()),w=l(E),k=f(w,_),x=d.find_path(k.map,"start","end"),S=[];for(let B=1;B<x.length-1;B++)S.push(k.table[x[B]].node);return h.fromArray(s(S))},h.rawSplit=function(m){return h.fromArray(p(m,o.isKanjiModeEnabled()))}})(vu);const sa=fi,fs=ea,Zp=Rp,Jp=Up,Qp=au,eg=su,ds=lu,cs=ta,tg=Pp,oa=du,ig=hu,rg=pr,hs=vu;function ng(h,a){const t=h.size,i=eg.getPositions(a);for(let r=0;r<i.length;r++){const n=i[r][0],u=i[r][1];for(let o=-1;o<=7;o++)if(!(n+o<=-1||t<=n+o))for(let d=-1;d<=7;d++)u+d<=-1||t<=u+d||(o>=0&&o<=6&&(d===0||d===6)||d>=0&&d<=6&&(o===0||o===6)||o>=2&&o<=4&&d>=2&&d<=4?h.set(n+o,u+d,!0,!0):h.set(n+o,u+d,!1,!0))}}function ag(h){const a=h.size;for(let t=8;t<a-8;t++){const i=t%2==0;h.set(t,6,i,!0),h.set(6,t,i,!0)}}function sg(h,a){const t=Qp.getPositions(a);for(let i=0;i<t.length;i++){const r=t[i][0],n=t[i][1];for(let u=-2;u<=2;u++)for(let o=-2;o<=2;o++)u===-2||u===2||o===-2||o===2||u===0&&o===0?h.set(r+u,n+o,!0,!0):h.set(r+u,n+o,!1,!0)}}function og(h,a){const t=h.size,i=oa.getEncodedBits(a);let r,n,u;for(let o=0;o<18;o++)r=Math.floor(o/3),n=o%3+t-8-3,u=(i>>o&1)==1,h.set(r,n,u,!0),h.set(n,r,u,!0)}function ps(h,a,t){const i=h.size,r=ig.getEncodedBits(a,t);let n,u;for(n=0;n<15;n++)u=(r>>n&1)==1,n<6?h.set(n,8,u,!0):n<8?h.set(n+1,8,u,!0):h.set(i-15+n,8,u,!0),n<8?h.set(8,i-n-1,u,!0):n<9?h.set(8,15-n-1+1,u,!0):h.set(8,15-n-1,u,!0);h.set(i-8,8,1,!0)}function lg(h,a){const t=h.size;let i=-1,r=t-1,n=7,u=0;for(let o=t-1;o>0;o-=2)for(o===6&&o--;;){for(let d=0;d<2;d++)if(!h.isReserved(r,o-d)){let g=!1;u<a.length&&(g=(a[u]>>>n&1)==1),h.set(r,o-d,g),n--,n===-1&&(u++,n=7)}if(r+=i,r<0||t<=r){r-=i,i=-i;break}}}function ug(h,a,t){const i=new Zp;t.forEach(function(d){i.put(d.mode.bit,4),i.put(d.getLength(),rg.getCharCountIndicator(d.mode,h)),d.write(i)});const r=sa.getSymbolTotalCodewords(h),n=cs.getTotalCodewordsCount(h,a),u=(r-n)*8;for(i.getLengthInBits()+4<=u&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(0);const o=(u-i.getLengthInBits())/8;for(let d=0;d<o;d++)i.put(d%2?17:236,8);return fg(i,h,a)}function fg(h,a,t){const i=sa.getSymbolTotalCodewords(a),r=cs.getTotalCodewordsCount(a,t),n=i-r,u=cs.getBlocksCount(a,t),o=i%u,d=u-o,g=Math.floor(i/u),v=Math.floor(n/u),p=v+1,e=g-v,s=new tg(e);let l=0;const f=new Array(u),c=new Array(u);let y=0;const m=new Uint8Array(h.buffer);for(let x=0;x<u;x++){const S=x<d?v:p;f[x]=m.slice(l,l+S),c[x]=s.encode(f[x]),l+=S,y=Math.max(y,S)}const _=new Uint8Array(i);let E=0,w,k;for(w=0;w<y;w++)for(k=0;k<u;k++)w<f[k].length&&(_[E++]=f[k][w]);for(w=0;w<e;w++)for(k=0;k<u;k++)_[E++]=c[k][w];return _}function dg(h,a,t,i){let r;if(Array.isArray(h))r=hs.fromArray(h);else if(typeof h=="string"){let g=a;if(!g){const v=hs.rawSplit(h);g=oa.getBestVersionForData(v,t)}r=hs.fromString(h,g||40)}else throw new Error("Invalid data");const n=oa.getBestVersionForData(r,t);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(!a)a=n;else if(a<n)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+n+`.
`);const u=ug(a,t,r),o=sa.getSymbolSize(a),d=new Jp(o);return ng(d,a),ag(d),sg(d,a),ps(d,t,0),a>=7&&og(d,a),lg(d,u),isNaN(i)&&(i=ds.getBestMask(d,ps.bind(null,d,t))),ds.applyMask(i,d),ps(d,t,i),{modules:d,version:a,errorCorrectionLevel:t,maskPattern:i,segments:r}}ru.create=function(a,t){if(typeof a=="undefined"||a==="")throw new Error("No input text");let i=fs.M,r,n;return typeof t!="undefined"&&(i=fs.from(t.errorCorrectionLevel,fs.M),r=oa.from(t.version),n=ds.from(t.maskPattern),t.toSJISFunc&&sa.setToSJISFunction(t.toSJISFunc)),dg(a,r,i,n)};var mu={},gs={};(function(h){function a(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let i=t.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+t);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(n){return[n,n]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}h.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin=="undefined"||i.margin===null||i.margin<0?4:i.margin,n=i.width&&i.width>=21?i.width:void 0,u=i.scale||4;return{width:n,scale:n?4:u,margin:r,color:{dark:a(i.color.dark||"#000000ff"),light:a(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},h.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},h.getImageWidth=function(i,r){const n=h.getScale(i,r);return Math.floor((i+r.margin*2)*n)},h.qrToImageData=function(i,r,n){const u=r.modules.size,o=r.modules.data,d=h.getScale(u,n),g=Math.floor((u+n.margin*2)*d),v=n.margin*d,p=[n.color.light,n.color.dark];for(let e=0;e<g;e++)for(let s=0;s<g;s++){let l=(e*g+s)*4,f=n.color.light;if(e>=v&&s>=v&&e<g-v&&s<g-v){const c=Math.floor((e-v)/d),y=Math.floor((s-v)/d);f=p[o[c*u+y]?1:0]}i[l++]=f.r,i[l++]=f.g,i[l++]=f.b,i[l]=f.a}}})(gs);(function(h){const a=gs;function t(r,n,u){r.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=u,n.width=u,n.style.height=u+"px",n.style.width=u+"px"}function i(){try{return document.createElement("canvas")}catch(r){throw new Error("You need to specify a canvas element")}}h.render=function(n,u,o){let d=o,g=u;typeof d=="undefined"&&(!u||!u.getContext)&&(d=u,u=void 0),u||(g=i()),d=a.getOptions(d);const v=a.getImageWidth(n.modules.size,d),p=g.getContext("2d"),e=p.createImageData(v,v);return a.qrToImageData(e.data,n,d),t(p,g,v),p.putImageData(e,0,0),g},h.renderToDataURL=function(n,u,o){let d=o;typeof d=="undefined"&&(!u||!u.getContext)&&(d=u,u=void 0),d||(d={});const g=h.render(n,u,d),v=d.type||"image/png",p=d.rendererOpts||{};return g.toDataURL(v,p.quality)}})(mu);var _u={};const cg=gs;function xu(h,a){const t=h.a/255,i=a+'="'+h.hex+'"';return t<1?i+" "+a+'-opacity="'+t.toFixed(2).slice(1)+'"':i}function vs(h,a,t){let i=h+a;return typeof t!="undefined"&&(i+=" "+t),i}function hg(h,a,t){let i="",r=0,n=!1,u=0;for(let o=0;o<h.length;o++){const d=Math.floor(o%a),g=Math.floor(o/a);!d&&!n&&(n=!0),h[o]?(u++,o>0&&d>0&&h[o-1]||(i+=n?vs("M",d+t,.5+g+t):vs("m",r,0),r=0,n=!1),d+1<a&&h[o+1]||(i+=vs("h",u),u=0)):r++}return i}_u.render=function(a,t,i){const r=cg.getOptions(t),n=a.modules.size,u=a.modules.data,o=n+r.margin*2,d=r.color.light.a?"<path "+xu(r.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",g="<path "+xu(r.color.dark,"stroke")+' d="'+hg(u,n,r.margin)+'"/>',v='viewBox="0 0 '+o+" "+o+'"',p=r.width?'width="'+r.width+'" height="'+r.width+'" ':"",e='<svg xmlns="http://www.w3.org/2000/svg" '+p+v+' shape-rendering="crispEdges">'+d+g+`</svg>
`;return typeof i=="function"&&i(null,e),e};const pg=Cp,ys=ru,Eu=mu,gg=_u;function ms(h,a,t,i,r){const n=[].slice.call(arguments,1),u=n.length,o=typeof n[u-1]=="function";if(!o&&!pg())throw new Error("Callback required as last argument");if(o){if(u<2)throw new Error("Too few arguments provided");u===2?(r=t,t=a,a=i=void 0):u===3&&(a.getContext&&typeof r=="undefined"?(r=i,i=void 0):(r=i,i=t,t=a,a=void 0))}else{if(u<1)throw new Error("Too few arguments provided");return u===1?(t=a,a=i=void 0):u===2&&!a.getContext&&(i=t,t=a,a=void 0),new Promise(function(d,g){try{const v=ys.create(t,i);d(h(v,a,i))}catch(v){g(v)}})}try{const d=ys.create(t,i);r(null,h(d,a,i))}catch(d){r(d)}}bn.create=ys.create;bn.toCanvas=ms.bind(null,Eu.render);bn.toDataURL=ms.bind(null,Eu.renderToDataURL);bn.toString=ms.bind(null,function(h,a,t){return gg.render(h,t)});function vg({listParam:h,currentList:a,currentListTitle:t,currentFolderList:i,addFolderToCollect:r,getListByCollect:n,addSongToCollect:u}){const o=je({url:""}),d=je(!1),g=je(null);return{addFormData:o,isshowAddModal:d,addFieldRef:g,openAddModal:()=>oe(this,null,function*(){o.value={url:""},d.value=!0,yield hn(),g.value.focus()}),beforeCloseAddModal:e=>oe(this,null,function*(){if(e==="confirm"){let s=o.value;if(!s.url)return Fe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;let l=s.url.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:?&@=/%#,;]*/g);if(!l)return Fe({message:"\u65E0\u6548\u8F93\u5165",position:"top"}),!1;l=Array.from(new Set(l));let f=l[0];if(f.startsWith("https://v.douyin.com")&&(f=yield wt.getRedirectInfo(f)),f.startsWith("https://www.douyin.com/user")||f.startsWith("https://www.iesdouyin.com/share/user")){let _=f.match(/user\/([^?\/]*)/);if(_)try{let E=_[1],w=yield li.getUserInfo({sec_uid:E});yield r(t.value,{vsongFolderId:`dyAwemeFolder_${E}`,vsongFolderType:"dyAwemeFolder",title:w.name,sec_uid:E});let{folderList:k}=yield n(h.value);return i.value=k,!0}catch(E){return Fe({message:E.message,position:"top"}),!1}}f.startsWith("https://b23.tv/")&&(f=yield At.parseShortUrl(f));let c=f.match(/video\/([^?\/]*)/);if(!c)return Fe({message:"\u5B58\u5728\u65E0\u6CD5\u89E3\u6790\u7684\u94FE\u63A5",position:"top"}),!1;let y=c[1];if(a.value.find(_=>_.bvid===y))return Fe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90",position:"top"}),!1;let m=`https://www.bilibili.com/video/${y}/`;try{yield u(t.value,m);let{songList:_}=yield n(h.value);a.value=_}catch(_){return!1}}return!0})}}function yg(){Zs("$axios");const h=()=>oe(this,null,function*(){return{bilibiliUser:null,alipanUser:null}}),a=je(!1),t=je({bilibiliUser:null,alipanUser:null,playVideoInfo:null});return{isshowPersonalMgModal:a,personalMgModalInfo:t,openPersonalMgModal:()=>oe(this,null,function*(){let r=yield h();t.value.bilibiliUser=r.bilibiliUser,t.value.alipanUser=r.alipanUser;let n=Array.from(document.querySelectorAll("video")).find(u=>!u.paused);n?t.value.playVideoInfo={videoWidth:n.videoWidth,videoHeight:n.videoHeight}:t.value.playVideoInfo=null,a.value=!0})}}function mg({collectList:h,archiveList:a,listType:t,listParam:i}){const r=Da(),n=je({name:void 0}),u=je(!1);let o=je({isEdit:!1,orgName:void 0});return{addCollectFormData:n,isshowAddCollectModal:u,addCollectModalInfo:o,openAddCollectModal:v=>{n.value={name:v},o.value.isEdit=!!v,o.value.orgName=v,u.value=!0},beforeCloseAddCollectModal:v=>oe(this,null,function*(){if(v==="confirm"){let p=n.value.name;if(!p)return Fe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;if(o.value.isEdit){if(h.value.filter(l=>l!=o.value.orgName).includes(p))return Fe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u6536\u85CF\u5217\u8868",position:"top"}),!1;let e=yield ut.getVsongData(),s={};if(Object.keys(e.collect).forEach(l=>{l==o.value.orgName?s[p]=e.collect[l]:s[l]=e.collect[l]}),e.collect=s,a.value.includes(o.value.orgName)){let l=e.archive.find(c=>c.name=="\u5F52\u6863"),f=l.list.findIndex(c=>c.name==o.value.orgName);f>=0&&(l.list[f].name=p,a.value=l.list.map(c=>c.name))}yield ut.setVsongData(e),h.value=Object.keys(e.collect),t.value=="collect"&&i.value==o.value.orgName&&r.replace({path:"/home",query:{ltype:"collect",lparam:p}})}else{if(h.value.includes(p))return Fe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u6536\u85CF\u5217\u8868",position:"top"}),!1;let e=yield ut.getVsongData();e.collect[p]=[],yield ut.setVsongData(e),h.value.push(p)}}return!0})}}function _g({listType:h,alipanlistParams:a,listAlipanParam:t}){const i=Da(),r=je({keyword:""}),n=je(!1),u=je(null),o=()=>oe(this,null,function*(){h.value=="alipan"&&(r.value.keyword=a.value.keyword),n.value=!0,yield hn(),u.value.focus()}),d=v=>oe(this,null,function*(){if(v==="confirm"){let p=r.value.keyword;p||(p=""),h.value=="alipan"&&(t.value.keyword==p||(p?t.value.keyword?i.replace({path:"/home",query:{ltype:"alipan",lparam:`${t.value.folderId},${p}`}}):i.push({path:"/home",query:{ltype:"alipan",lparam:`${t.value.folderId},${p}`}}):i.back()))}return!0});return{keywordFormData:r,isshowKeywordModal:n,keywordFieldRef:u,openKeywordModal:o,beforeCloseKeywordModal:d,submitKeywordModal:()=>oe(this,null,function*(){n.value=!(yield d("confirm"))})}}function xg({loopMode:h,showVideo:a,proxyUrl:t}){const i=je({loopMode:h.value,showVideo:a.value,proxyUrl:t.value}),r=je(!1);return{psetFormData:i,isshowPsetModal:r,openPsetModal:()=>{i.value={loopMode:h.value,showVideo:a.value,proxyUrl:t.value},r.value=!0},beforeClosePsetModal:o=>oe(this,null,function*(){return o==="confirm"&&(h.value=i.value.loopMode,a.value=i.value.showVideo,t.value=i.value.proxyUrl,yield ut.saveSettings({loopMode:h.value,showVideo:a.value,proxyUrl:t.value})),!0})}}function Eg({pauseAudio:h}){let a=null;const t=je({afterTime:void 0}),i=je(!1);return{clockFormData:t,isshowClockModal:i,openClockModal:()=>{t.value={afterTime:void 0},i.value=!0},beforeCloseClockModal:u=>oe(this,null,function*(){return u==="confirm"&&(a&&clearTimeout(a),t.value.afterTime?(Fe({message:`\u5C06\u5728${t.value.afterTime}\u5206\u949F\u540E\u5173\u95ED`,position:"top"}),a=setTimeout(()=>{h(),location.replace("./close.html")},parseInt(t.value.afterTime)*6e4)):Fe({message:"\u5DF2\u53D6\u6D88\u5B9A\u65F6\u5173\u95ED",position:"top"})),!0})}}function bg(){const h=je({}),a=je(!1),t=je({type:"",qrcode:"",key:"",bindSuccessCb:null}),i=(o,d)=>oe(this,null,function*(){h.value={},t.value.type=o,t.value.qrcode="",t.value.bindSuccessCb=d,a.value=!0;let g;if(o=="alipan")g=yield ut.getAxios().get("/vsong/alipan-qrcode");else if(o=="bilibili")g=yield ut.getAxios().get("/vsong/bilibili-qrcode");else throw new Error("unknow type!");t.value.key=g.data.key,t.value.qrcode=yield bn.toDataURL(g.data.codeContent,{margin:0}),n=!0,u()}),r=o=>oe(this,null,function*(){return n=!1,!0});let n=!1;const u=()=>oe(this,null,function*(){let o;if(t.value.type=="alipan"?o=yield ut.getAxios().post("/vsong/try-bind-alipan",{key:t.value.key}):t.value.type=="bilibili"&&(o=yield ut.getAxios().post("/vsong/try-bind-bilibili",{key:t.value.key})),!!n){if(o.data.status=="expired"){n=!1,a.value=!1;return}else if(o.data.status=="success"){n=!1,a.value=!1,t.value.bindSuccessCb();return}setTimeout(()=>{!n||u()},1e3)}});return{bindQrcodeFormData:h,isshowBindQrcodeModal:a,bindQrcodeModalInfo:t,openBindQrcodeModal:i,beforeCloseBindQrcodeModal:r}}Xs("data-v-1b2dae07");const wg={class:"listbar"},Tg={class:"listbar-num",tabxxindexxx:"1"},Sg={class:"listbar-action"},kg=Ge("div",{class:"listitem-idx"},"F",-1),Ag={class:"listitem-info"},Cg=["onClick","onKeydown"],Dg=Ge("div",{class:"listitem-idx"},"F",-1),Rg={class:"listitem-info"},Ug=["onClick","onKeydown"],Lg=Ge("div",{class:"listitem-idx"},"F",-1),Pg={class:"listitem-info"},Bg=["onClick","onKeydown"],Fg={class:"listitem-idx"},Og={class:"listitem-info"},Ig=["onClick","onKeydown"],Mg=Ge("div",null,null,-1),Ng=["onClick","onKeydown"],zg={key:0,class:"listitem-info-t2",style:{"margin-left":"12px",cursor:"default"}},Vg={key:1,class:"listitem-info-t2",style:{"margin-left":"12px",cursor:"default"}},Hg={class:"playbar"},jg=["src"],Gg={class:"playbar-title"},$g=Ge("div",{class:"playbar-button"},null,-1),Wg={key:0},Yg={class:"action-sheet-title"},Xg={class:"action-sheet-title-t1"},Kg={class:"action-sheet-item"},qg=Ge("div",{class:"action-sheet-item-title"},"\u52A0\u5165\u6536\u85CF",-1),Zg=Ge("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u6536\u85CF",-1),Jg={key:1},Qg={class:"action-sheet-title"},ev={class:"action-sheet-title-t1"},tv=Ge("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u5F52\u6863",-1),iv={key:2},rv={class:"action-sheet-title"},nv={class:"action-sheet-title-t1"},av=Ge("div",{class:"action-sheet-item-title"},"\u524D\u5F80\u5408\u96C6",-1),sv=Ge("div",{class:"action-sheet-item-title"},"\u524D\u5F80\u6E90\u7AD9",-1),ov={class:"action-sheet-item"},lv=Ge("div",{class:"action-sheet-item-title"},"\u52A0\u5165\u6536\u85CF",-1),uv=Ge("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u6536\u85CF",-1),fv=Ge("div",{class:"action-sheet-item-title"},"\u91CD\u65B0\u7F13\u5B58",-1),dv=Ge("div",{class:"action-sheet-item-title"},"\u7F13\u5B58\u8D44\u6E90",-1),cv=Ge("div",{class:"action-sheet-item-title"},"\u5220\u9664\u7F13\u5B58",-1),hv=Ge("div",{class:"action-sheet-item-title"},"\u590D\u5236\u4FE1\u606F",-1),pv={class:"list-action-sheet-box hide-scrollbar"},gv=["onClick"],vv={class:"action-sheet-item-idx"},yv={class:"action-sheet-item-title"},mv=["src"],_v=Ge("div",null,"\u5206\u949F\u540E\u5173\u95ED",-1),xv={style:{display:"flex","flex-flow":"column nowarp",width:"80%",margin:"0.5em auto"}},Ev=lr("\u626B\u7801\u7ED1\u5B9A"),bv=lr("\u89E3\u9664\u7ED1\u5B9A"),wv={key:0},Tv={key:1},Sv=lr("\u626B\u7801\u7ED1\u5B9A"),kv=lr("\u89E3\u9664\u7ED1\u5B9A"),Av={key:0},Cv={key:1},Dv=lr("\u9000\u51FA\u767B\u5F55"),Rv={key:0},Uv=Ge("div",{style:{height:"0.5em"}},null,-1),Lv=["posterxxx"],Pv={key:0,class:"full-screen-tabactions"};Ks();var Bv=qs({setup(h){const a=Zs("$axios"),t=Da(),i=Zu(),r=Ju();let n=je(i.query.ltype||"collect"),u=je(i.query.lparam||"\u559C\u6B22\u7684\u97F3\u4E50"),o=je({folderId:"",keyword:""}),d=je({folderId:""}),g=je({upmidList:[],dysecuidList:[]});const v=()=>[n.value,u.value];pi.setAxios(a),gi.setAxios(a),At.setAxios(a),ut.setAxios(a),vn.setAxios(dn.create());const p=je(location.search.includes("ossmg"));je(location.search.includes("d=tv")).value&&document.body.classList.add("device-tv");const s=(z,ie=null)=>oe(this,null,function*(){ie||(ie=yield ut.getVsongData());let re=[],ue=[];return ie.collect[z]&&ie.collect[z].forEach(_e=>{_e.vsongFolderType?ue.push(_e):re.push(_e)}),{songList:re,folderList:ue}}),l=(z=null)=>oe(this,null,function*(){return z||(z=yield ut.getVsongData()),z.archive.find(re=>re.name=="\u5F52\u6863").list.map(re=>re.name)}),f=()=>K.value.filter(z=>!te.value.includes(z)),c=z=>oe(this,null,function*(){yield wr.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u8BE5\u6536\u85CF\u5F52\u6863\u5417\uFF1F",beforeClose:ie=>oe(this,null,function*(){if(ie==="cancel")return!0;try{let re=yield ut.getVsongData(),ue=re.archive.find(_e=>_e.name=="\u5F52\u6863");if(ue.list.some(_e=>_e.name==z))throw new Error("\u8BE5\u6536\u85CF\u5DF2\u7ECF\u5F52\u6863");return ue.list.push({name:z,list:[]}),yield ut.setVsongData(re),te.value=ue.list.map(_e=>_e.name),Fe({message:"\u5F52\u6863\u6210\u529F",position:"top"}),!0}catch(re){return Fe({message:re.message,position:"top"}),!1}})})}),y=z=>oe(this,null,function*(){yield wr.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u8BE5\u6536\u85CF\u53D6\u6D88\u5F52\u6863\u5417\uFF1F",beforeClose:ie=>oe(this,null,function*(){if(ie==="cancel")return!0;try{let re=yield ut.getVsongData(),ue=re.archive.find(ve=>ve.name=="\u5F52\u6863"),_e=ue.list.findIndex(ve=>ve.name==z);if(_e==-1)throw new Error("\u8BE5\u6536\u85CF\u672A\u5F52\u6863");return ue.list.splice(_e,1),yield ut.setVsongData(re),te.value=ue.list.map(ve=>ve.name),Fe({message:"\u53D6\u6D88\u6210\u529F",position:"top"}),n.value==="archive"&&(Qe.value.isShow=!1,R.value=te.value.map(ve=>({title:ve,name:ve}))),!0}catch(re){return Fe({message:re.message,position:"top"}),!1}})})}),m=z=>{let ie={};return z.vsongType==="biAweme"?ie={bvid:z.bvid,mid:z.mid}:z.vsongType==="dyAweme"?ie={sec_uid:z.sec_uid,aweme_id:z.aweme_id,min_cursor:z.min_cursor}:z.vsongType==="alipanAweme"?ie={fileId:z.fileId,parentId:z.parentId,category:z.category,mime_type:z.mime_type,audio_code_name:z.audio_code_name,video_code_name:z.video_code_name}:z.vsongType==="alistAweme"&&(ie={fileId:z.fileId,filePath:z.filePath,category:z.category,fileType:z.fileType,parentPath:z.parentPath}),wi({vsongId:z.vsongId,vsongType:z.vsongType,author:z.author,title:z.title,coverUrl:z.coverUrl,originUrl:z.originUrl},ie)},_=z=>{let ie={};return z.vsongFolderType==="biAwemeFolder"?ie={mid:z.mid}:z.vsongFolderType==="dyAwemeFolder"?ie={sec_uid:z.sec_uid}:z.vsongFolderType==="alipanAwemeFolder"?ie={folderId:z.folderId}:z.vsongFolderType==="alistAwemeFolder"&&(ie={folderId:z.folderId,folderPath:z.folderPath}),wi({vsongFolderId:z.vsongFolderId,vsongFolderType:z.vsongFolderType,title:z.title},ie)},E=(z,ie)=>oe(this,null,function*(){let re;if(typeof ie=="string"?re=(yield At.parseUrl(ie)).vsongItem:re=ie,re.vsongType=="dyAweme"&&re.min_cursor==0)throw new Error("\u6682\u65F6\u65E0\u6CD5\u6DFB\u52A0\u8BE5\u9879\u8FDB\u5165\u6536\u85CF");let ue=yield ut.getVsongData();if(ue.collect[z]||(ue.collect[z]=[]),ue.collect[z].find(_e=>_e.vsongId==re.vsongId))throw new Error("\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90");ue.collect[z].push(m(re)),yield ut.setVsongData(ue)}),w=(z,ie)=>oe(this,null,function*(){let re=yield ut.getVsongData();re.collect[z]||(re.collect[z]=[]);let ue=re.collect[z].findIndex(ve=>ve.vsongId===ie);if(ue==-1){Fe({message:"\u6B4C\u66F2\u4E0D\u5B58\u5728",position:"top"});return}re.collect[z].splice(ue,1),yield ut.setVsongData(re),Fe({message:"\u5DF2\u79FB\u51FA",position:"top"});let{songList:_e}=yield s(z,re);U.value=_e,Qe.value.isShow=!1}),k=(z,ie)=>oe(this,null,function*(){let re=yield ut.getVsongData();if(re.collect[z]||(re.collect[z]=[]),re.collect[z].find(ue=>ue.vsongFolderId==ie.vsongFolderId))throw new Error("\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90");re.collect[z].push(_(ie)),yield ut.setVsongData(re)}),x=(z,ie)=>oe(this,null,function*(){let re=yield ut.getVsongData();re.collect[z]||(re.collect[z]=[]);let ue=re.collect[z].findIndex(ve=>ve.vsongFolderId===ie);if(ue==-1){Fe({message:"\u76EE\u5F55\u4E0D\u5B58\u5728",position:"top"});return}re.collect[z].splice(ue,1),yield ut.setVsongData(re),Fe({message:"\u5DF2\u79FB\u51FA",position:"top"});let{folderList:_e}=yield s(z,re);R.value=_e,Qe.value.isShow=!1}),S=je(null),B=je(""),U=je([]),R=je([]),C=je([]),A=je({}),b=je("random"),O=je(!0);let W=je(""),K=je([]);const G=je({order:"pubdate",page:1,count:50,forceRefresh:!1,isPageEnd:!1}),F=je({order:"pubdate",max_cursor:"",count:50,forceRefresh:!1,isPageEnd:!1}),j=je({nextMarker:"",keyword:"",forceRefresh:!1,isPageEnd:!1}),N=je({nextMarker:"",forceRefresh:!1,isPageEnd:!1}),$=je({page:1,count:250,forceRefresh:!1,isPageEnd:!1});let Z=[],te=je([]);const ae=kp(),Ee=ae.sheet,{rangeInputFormData:Te,isshowRangeInputModal:Ae,openRangeInputModal:De,beforeCloseRangeInputModal:ze}=Sp(),{addFormData:Ce,isshowAddModal:Oe,addFieldRef:$e,openAddModal:D,beforeCloseAddModal:fe}=vg({listParam:u,currentList:U,currentListTitle:B,currentFolderList:R,addFolderToCollect:k,addSongToCollect:E,getListByCollect:s}),{isshowPersonalMgModal:ne,personalMgModalInfo:Y,openPersonalMgModal:H}=yg(),{addCollectFormData:J,isshowAddCollectModal:ce,addCollectModalInfo:he,openAddCollectModal:ee,beforeCloseAddCollectModal:Se}=mg({archiveList:te,collectList:K,listType:n,listParam:u}),{keywordFormData:Le,isshowKeywordModal:ke,keywordFieldRef:Ne,openKeywordModal:Ye,beforeCloseKeywordModal:et,submitKeywordModal:qe}=_g({listType:n,alipanlistParams:j,listAlipanParam:o}),{psetFormData:Et,isshowPsetModal:gt,openPsetModal:Zt,beforeClosePsetModal:ft}=xg({loopMode:b,showVideo:O,proxyUrl:W}),ki=[{label:"\u968F\u673A\u64AD\u653E",key:"random"},{label:"\u5217\u8868\u5FAA\u73AF",key:"listloop"},{label:"\u5355\u66F2\u5FAA\u73AF",key:"oneloop"},{label:"\u5217\u8868\u64AD\u653E",key:"listplay"}],{clockFormData:Ut,isshowClockModal:Ft,openClockModal:Mi,beforeCloseClockModal:Ai}=Eg({pauseAudio:()=>ci}),{bindQrcodeFormData:Fr,isshowBindQrcodeModal:Ni,bindQrcodeModalInfo:Ci,openBindQrcodeModal:Jt,beforeCloseBindQrcodeModal:Qt}=bg(),zi=je(null),Vi=je(null);Qu(()=>{vt.bind(ii.value,Gi.value);var z=new Ki.exports.Manager(zi.value),ie=new Ki.exports.Swipe({event:"swipe",pointers:1,direction:Ki.exports.DIRECTION_ALL}),re=new Ki.exports.Tap({event:"doubleTap",pointers:1,taps:2,interval:600}),ue=new Ki.exports.Press({event:"press",time:600});z.add([ie,re,ue]),z.on("swipeleft",function(pe){if(document.fullscreenElement){ae.open(U.value);return}S.value&&kt("song",S.value)}),z.on("swiperight",function(pe){if(document.fullscreenElement){ae.open(U.value);return}_t()}),z.on("swipeup",function(pe){vt.playNextAduio()}),z.on("swipedown",function(pe){try{vt.playPrevAudio()}catch(xe){Fe({message:xe.message,position:"top"})}}),z.on("doubleTap",function(pe){!S.value||(S.value.isPlay?ci():Li())}),z.on("press",function(pe){document.pictureInPictureElement?document.exitPictureInPicture():ii.value.paused?Gi.value.querySelector("video").paused||Gi.value.querySelector("video").requestPictureInPicture():ii.value.requestPictureInPicture()});var _e=new Ki.exports.Manager(Vi.value),ve=new Ki.exports.Swipe({event:"swipe",pointers:1,direction:Ki.exports.DIRECTION_HORIZONTAL});_e.add([ve]),_e.on("swipeleft",function(pe){_t()}),_e.on("swiperight",function(pe){mt.value.show=!0}),window.addEventListener("keydown",function(pe){let xe=pe.target.nodeName.toLowerCase();if(!(xe=="input"||xe=="textarea"))if(pe.keyCode==219)try{vt.playPrevAudio()}catch(Ie){Fe({message:Ie.message,position:"top"})}else pe.keyCode==221?vt.playNextAduio():pe.keyCode==32?(S.value&&!S.value.isPlay?Li():S.value&&S.value.isPlay&&ci(),pe.preventDefault()):pe.keyCode==39||pe.keyCode==37||pe.keyCode==38||pe.keyCode==40})});let gr=!1,Qi=0;const vr=z=>{bt.value.scrollTop==0?(gr=!0,Qi=z.touches[0].clientY):gr=!1},Zr=z=>{let{clientY:ie}=z.touches[0];gr&&bt.value.scrollTop==0&&ie>Qi&&z.preventDefault()};let Hi=!1;const yi=z=>oe(this,null,function*(){!dt.value||Hi||bt.value.scrollHeight-bt.value.clientHeight-bt.value.scrollTop>=bt.value.clientHeight||(Hi=!0,yield yr(),Hi=!1)});let ei=!1;const St=()=>oe(this,null,function*(){if(ei)return;if(ji().isPageEnd){Fe({message:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86",position:"top"});return}ei=!0;let z=Fe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});yield yr(),setTimeout(()=>{z.clear()}),ei=!1}),yr=()=>oe(this,null,function*(){var z,ie,re,ue;if(n.value==="up"&&!G.value.isPageEnd){G.value.page+=1;let _e=yield At.getAwemeList({mid:u.value},G.value);U.value=U.value.concat(_e),_e.length==0&&(G.value.isPageEnd=!0)}else if(n.value==="dy"&&!F.value.isPageEnd){let _e=yield li.getAwemeList({sec_uid:u.value},F.value);U.value=U.value.concat(_e),Re(),_e.length==0&&(F.value.isPageEnd=!0)}else if(n.value==="alipan"&&!j.value.isPageEnd&&!o.value.keyword)try{let _e=yield pi.getAwemeList({folderId:o.value.folderId},j.value);U.value=U.value.concat(_e.awemeList),R.value=R.value.concat(_e.folderList)}catch(_e){((ie=(z=_e==null?void 0:_e.response)==null?void 0:z.data)==null?void 0:ie.msg)=="AlipanNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}else if(n.value==="alipan_open"&&!N.value.isPageEnd)try{let _e=yield gi.getAwemeList({folderId:d.value.folderId},N.value);U.value=U.value.concat(_e.awemeList),R.value=R.value.concat(_e.folderList)}catch(_e){((ue=(re=_e==null?void 0:_e.response)==null?void 0:re.data)==null?void 0:ue.msg)=="AlipanOpenNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}else if(n.value==="release"){g.value.upmidList.forEach(pe=>{pe.listParams.isPageEnd||(pe.listParams.page+=1)});let _e=yield Promise.all([].concat(g.value.upmidList.filter(pe=>!pe.isPageEnd).map(pe=>At.getAwemeList(pe.listQuery,pe.listParams)),g.value.dysecuidList.filter(pe=>!pe.isPageEnd).map(pe=>li.getAwemeList(pe.listQuery,pe.listParams)))),ve=[].concat(..._e).sort((pe,xe)=>pe.created<xe.created?1:-1);U.value=U.value.concat(ve)}else if(n.value==="alist"&&!$.value.isPageEnd)try{$.value.page+=1;let _e=yield vn.getAwemeList({path:u.value},$.value);U.value=U.value.concat(_e.awemeList),R.value=R.value.concat(_e.folderList),_e.awemeList.length+_e.folderList.length==0&&($.value.isPageEnd=!0)}catch(_e){Fe({message:_e.message,position:"top",duration:3e3})}}),ji=()=>n.value==="up"?{has:!0,isPageEnd:G.value.isPageEnd}:n.value==="dy"?{has:!0,isPageEnd:F.value.isPageEnd}:n.value==="alipan"&&!o.value.keyword?{has:!0,isPageEnd:j.value.isPageEnd}:n.value==="alipan_open"?{has:!0,isPageEnd:N.value.isPageEnd}:n.value==="release"?{has:!0,isPageEnd:!1}:n.value==="alist"?{has:!0,isPageEnd:$.value.isPageEnd}:{has:!1,isPageEnd:!0},mi=z=>oe(this,null,function*(){if(z.vsongType=="alipanAweme"&&z.category=="video"&&!pi.isSupportMime(z.mime_type,z.audio_code_name,z.video_code_name)){Fe({message:`\u6682\u4E0D\u652F\u6301\u7F13\u5B58\u6B64\u683C\u5F0F(${z.mime_type})`,position:"top",duration:3e3});return}Qe.value.isShow=!1,Fe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"});let ie=Date.now();yield st.addRow("vsong_cache",Mn(wi({create_time:ie},m(z)),{cacheStatus:"waiting"})),ti()}),er=z=>oe(this,null,function*(){Qe.value.isShow=!1,Fe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"});let ie=yield st.getOneByIndex("vsong_cache","vsongId",z.vsongId);ie.cacheStatus="waiting",yield st.updateRow("vsong_cache",ie),ti()}),Or=z=>oe(this,null,function*(){let[ie,re,ue]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",z.vsongId),st.getOneByIndex("vsong_video","vsongId",z.vsongId),st.getOneByIndex("vsong_cover","vsongId",z.vsongId)]),_e=Z.find(pe=>pe.vsongId==z.vsongId),ve=[st.delRow("vsong_cache",_e.id)];ie&&ve.push(st.delRow("vsong_audio",ie.id)),re&&ve.push(st.delRow("vsong_video",re.id)),ue&&ve.push(st.delRow("vsong_cover",ue.id)),yield Promise.all(ve),Qe.value.isShow=!1,ti()}),tr=z=>oe(this,null,function*(){let ie,re,ue;if(z.vsongType=="biAweme"){let Ze=yield $t(z,{video:!0,audio:!0,cover:!0});ie=Ze.audioUrl,re=Ze.coverUrl,ue=Ze.videoUrl}else if(z.vsongType=="dyAweme"){let Ze=yield $t(z,{video:!0,cover:!0});re=Ze.coverUrl,ue=Ze.videoUrl}else if(z.vsongType=="alipanAweme"){let Ze=yield $t(z,{video:!0,audio:!0});z.category=="video"?ue=Ze.videoUrl:z.category=="audio"&&(ie=Ze.audioUrl),re=Ze.coverUrl}else if(z.vsongType=="alistAweme"){let Ze=yield $t(z,{video:!0,audio:!0});z.category=="video"?ue=Ze.videoUrl:z.category=="audio"&&(ie=Ze.audioUrl),re=Ze.coverUrl}const _e=()=>oe(this,null,function*(){if(!ie)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u97F3\u9891\u8D44\u6E90`);let Ze=yield ri(ie).get(ie,{headers:{Range:"bytes=0-"},responseType:"arraybuffer"});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u97F3\u9891\u8D44\u6E90 `),Ze.data}),ve=()=>oe(this,null,function*(){if(!re)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90`);try{let Ze=yield ri(re).get(re,{responseType:"arraybuffer",noErrorToast:!0});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90 `),Ze.data}catch(Ze){return console.log(`[${new Date().toLocaleString()}] \u5931\u8D25\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90 `),null}}),pe=()=>oe(this,null,function*(){if(!ue)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u89C6\u9891\u8D44\u6E90`);let Ze=yield ri(ue).get(ue,{headers:{Range:"bytes=0-"},responseType:"arraybuffer"});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u89C6\u9891\u8D44\u6E90 `),Ze.data});let[xe,Ie,we]=yield Promise.all([_e(),pe(),ve()]);if(!Z.find(Ze=>Ze.vsongId==z.vsongId))throw console.log("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01"),new Error("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01");let ot=Date.now();console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u5B58\u5165indexDb`);let it=[];xe&&it.push(st.addRow("vsong_audio",{create_time:ot,vsongId:z.vsongId,arraybuffer:xe})),Ie&&it.push(st.addRow("vsong_video",{create_time:ot,vsongId:z.vsongId,arraybuffer:Ie})),we&&it.push(st.addRow("vsong_cover",{create_time:ot,vsongId:z.vsongId,arraybuffer:we})),yield Promise.all(it),console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u5B58\u5165indexDb`)}),ir={waiting:"\u7B49\u5F85\u7F13\u5B58",cacheing:"\u7F13\u5B58\u4E2D",succeed:"\u5DF2\u7F13\u5B58",failed:"\u7F13\u5B58\u5931\u8D25"};let mr=!1;const _r=()=>oe(this,null,function*(){if(mr)return;mr=!0;let z=yield st.getAll("vsong_cache");yield Promise.all(z.filter(re=>re.cacheStatus=="cacheing").map(re=>oe(this,null,function*(){re.cacheStatus="failed",yield st.updateRow("vsong_cache",re)})));const ie=()=>oe(this,null,function*(){let ue=(yield st.getAll("vsong_cache")).filter(ve=>ve.cacheStatus=="waiting");if(ue.length>0){let ve=ue[0];ve.cacheStatus="cacheing",yield st.updateRow("vsong_cache",ve),ti();try{yield tr(ve),ve.cacheStatus="succeed",yield st.updateRow("vsong_cache",ve)}catch(pe){if(!Z.find(xe=>xe.vsongId==ve.vsongId)){console.log("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01");return}ve.cacheStatus="failed",yield st.updateRow("vsong_cache",ve),ef({type:"danger",message:`\u7F13\u5B58\u5931\u8D25\uFF1A${ve.title}`})}ti()}let _e=3e3;return ue.length>1&&(_e=0),setTimeout(ie,_e)});setTimeout(ie,3e3)}),ti=()=>oe(this,null,function*(){Z=yield st.getAll("vsong_cache"),Z.sort((z,ie)=>z.create_time-ie.create_time),n.value=="cache"?U.value=Z:r.proxy.$forceUpdate()}),Nt=z=>!Z.find(re=>re.vsongId==z),_i=z=>{let ie=Z.find(re=>re.vsongId==z);return ie==null?void 0:ie.cacheStatus},ii=je(null),Di=je(null),xi=je(null),Gi=je(null),$t=(ve,pe)=>oe(this,[ve,pe],function*(z,{video:ie=!1,audio:re=!1,cover:ue=!1,makeCross:_e=!0}){let xe={videoUrl:null,audioUrl:null,coverUrl:null},Ie=!1;if(ie&&(xe.videoUrl=yield Si.getMediaUrl(z.vsongId,"video"),xe.videoUrl||(Ie=!0)),re&&(xe.audioUrl=yield Si.getMediaUrl(z.vsongId,"audio"),xe.audioUrl||(Ie=!0)),ue&&(xe.coverUrl=yield Si.getMediaUrl(z.vsongId,"cover"),xe.coverUrl||(Ie=!0)),!Ie)return xe;if(z.vsongType=="biAweme"){let we=yield At.getMediaUrl({url:z.originUrl});_e&&(we.audioUrl&&(we.audioUrl=At.makeCrossUrl(we.audioUrl,{cache:"max-age=86400"})),we.videoUrl&&(we.videoUrl=At.makeCrossUrl(we.videoUrl,{cache:"max-age=86400"})),we.coverUrl&&(we.coverUrl=At.makeCrossUrl(we.coverUrl,{cache:"max-age=86400"}))),re&&!xe.audioUrl&&(xe.audioUrl=we.audioUrl),ie&&!xe.videoUrl&&(xe.videoUrl=we.videoUrl),ue&&!xe.coverUrl&&(xe.coverUrl=we.coverUrl)}else if(z.vsongType=="dyAweme"){let we=yield li.getMediaUrl({sec_uid:z.sec_uid,min_cursor:z.min_cursor,aweme_id:z.aweme_id});_e&&(we.videoUrl&&(we.videoUrl=li.makeCrossUrl(we.videoUrl,{cache:"max-age=86400"})),we.coverUrl&&(we.coverUrl=li.makeCrossUrl(we.coverUrl,{cache:"max-age=86400"}))),ie&&!xe.videoUrl&&(xe.videoUrl=we.videoUrl),ue&&!xe.coverUrl&&(xe.coverUrl=we.coverUrl)}else if(z.vsongType=="alipanAweme"){let we=yield gi.getMediaUrl({fileId:z.fileId,category:z.category,fileName:z.title,mime_type:z.mime_type,audio_code_name:z.audio_code_name,video_code_name:z.video_code_name});we.coverUrl=z.coverUrl,_e&&(we.videoUrl&&(we.videoUrl.includes(".m3u8")?we.videoUrl=gi.makeCrossM3u8(we.videoUrl,{}):we.videoUrl=gi.makeCrossUrl(we.videoUrl,{})),we.audioUrl&&(we.audioUrl=gi.makeCrossUrl(we.audioUrl,{withToken:!0})),we.coverUrl&&(we.coverUrl=gi.makeCrossUrl(we.coverUrl,{}))),re&&!xe.audioUrl&&we.audioUrl&&(xe.audioUrl=we.audioUrl),ie&&!xe.videoUrl&&we.videoUrl&&(xe.videoUrl=we.videoUrl),ue&&!xe.coverUrl&&z.coverUrl&&(xe.coverUrl=we.coverUrl)}else if(z.vsongType=="alistAweme"){let we=yield vn.getMediaUrl({fileName:z.title,filePath:z.filePath,category:z.category});we.coverUrl=z.coverUrl,_e&&we.videoUrl&&we.videoUrl.includes(".m3u8")&&(we.videoUrl=gi.makeCrossM3u8(we.videoUrl,{})),re&&!xe.audioUrl&&we.audioUrl&&(xe.audioUrl=we.audioUrl),ie&&!xe.videoUrl&&we.videoUrl&&(xe.videoUrl=we.videoUrl),ue&&!xe.coverUrl&&z.coverUrl&&(xe.coverUrl=we.coverUrl)}else if(z.vsongType=="alipanAweme"){let we=yield pi.getMediaUrl({fileId:z.fileId,category:z.category,fileName:z.title,mime_type:z.mime_type,audio_code_name:z.audio_code_name,video_code_name:z.video_code_name});we.coverUrl=z.coverUrl,_e&&(we.videoUrl&&(we.videoUrl.includes(".m3u8")?we.videoUrl=pi.makeCrossM3u8(we.videoUrl,{}):we.videoUrl=pi.makeCrossUrl(we.videoUrl,{})),we.audioUrl&&(we.audioUrl=pi.makeCrossUrl(we.audioUrl,{withToken:!0})),we.coverUrl&&(we.coverUrl=pi.makeCrossUrl(we.coverUrl,{}))),re&&!xe.audioUrl&&we.audioUrl&&(xe.audioUrl=we.audioUrl),ie&&!xe.videoUrl&&we.videoUrl&&(xe.videoUrl=we.videoUrl),ue&&!xe.coverUrl&&z.coverUrl&&(xe.coverUrl=we.coverUrl)}return xe}),ri=z=>Si.isOssMediaUrl(z)?Si.getAxios():wt.getAxios(),zt=z=>oe(this,null,function*(){let ie=yield ri(z).get(z,{responseType:"blob",noErrorToast:!0});return Qs(ie.data)}),Ei=z=>oe(this,null,function*(){let ie=Fe.loading({message:"\u590D\u5236\u4E2D...",forbidClick:!0,duration:0}),re=m(z),ue={vsongItem:re,mediaUrl:yield $t(re,{video:!0,audio:!0,cover:!0,makeCross:!1})},_e;re.vsongType=="biAweme"?_e=At.makeCrossUrl:re.vsongType=="dyAweme"?_e=li.makeCrossUrl:re.vsongType=="alipanAweme"?_e=gi.makeCrossUrl:re.vsongType=="alistAweme"?_e=null:re.vsongType=="alipanAweme"&&(_e=pi.makeCrossUrl),ue.mediaUrl.videoUrl&&!Si.isOssMediaUrl(ue.mediaUrl.videoUrl)&&(ue.mediaUrl.videoUrl=_e(ue.mediaUrl.videoUrl,{cache:"max-age=3600",withToken:!0})),ue.mediaUrl.audioUrl&&!Si.isOssMediaUrl(ue.mediaUrl.audioUrl)&&(ue.mediaUrl.audioUrl=_e(ue.mediaUrl.audioUrl,{cache:"max-age=3600",withToken:!0})),ue.mediaUrl.coverUrl&&!Si.isOssMediaUrl(ue.mediaUrl.coverUrl)&&(ue.mediaUrl.coverUrl=_e(ue.mediaUrl.coverUrl,{cache:"max-age=3600",withToken:!0})),yield af(JSON.stringify(ue,null,2)),Fe({message:"\u5DF2\u590D\u5236",position:"top"}),setTimeout(()=>{ie.clear()}),Qe.value.isShow=!1}),dt=je(!0);let Vt=0;const bt=je(null),_t=()=>{dt.value&&(Vt=bt.value.scrollTop),dt.value=!dt.value,dt.value&&hn(()=>bt.value.scrollTop=Vt)};let Ot;oi(()=>dt.value,()=>{document.fullscreenElement||(dt.value==!1?Ot=eo(()=>{dt.value||_t()}):Ot&&Ot())}),oi(()=>[G.value.order],()=>{Vt=0,bt.value.scrollTop=Vt});const vt=new bp;oi(()=>b.value,()=>{vt.setLoopMode(b.value)},{immediate:!0}),oi(()=>U.value,()=>{vt.setPlayList(U.value)},{immediate:!0}),oi(()=>O.value,()=>{vt.setVideoShow(O.value)},{immediate:!0}),vt.setPlayHandler(z=>oe(this,null,function*(){let ie=Z.filter(re=>re.cacheStatus=="succeed").find(re=>re.vsongId==z.vsongId);if(ie){let re=yield st.getOneByIndex("vsong_audio","vsongId",ie.vsongId),ue=yield st.getOneByIndex("vsong_video","vsongId",ie.vsongId);if(z.vsongType=="biAweme")return{type:"arraybuffer",data:{audio:re.arraybuffer,video:ue.arraybuffer}};if(z.vsongType=="dyAweme")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(z.vsongType=="alipanAweme"){if(z.category=="video")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(z.category=="audio")return{type:"arraybuffer",data:{audio:re.arraybuffer,video:null}}}else if(z.vsongType=="alistAweme"){if(z.category=="video")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(z.category=="audio")return{type:"arraybuffer",data:{audio:re.arraybuffer,video:null}}}}else if(z.vsongType=="biAweme"){let{audioUrl:re,videoUrl:ue}=yield $t(z,{video:!0,audio:!0});return{type:"rangeurl",data:{audio:re,video:ue}}}else if(z.vsongType=="dyAweme"){let{videoUrl:re}=yield $t(z,{video:!0});return{type:"mixedurl",data:{url:re}}}else if(z.vsongType=="alipanAweme"){let{audioUrl:re,videoUrl:ue}=yield $t(z,{video:!0,audio:!0});if(z.category=="video"&&ue.includes(".m3u8"))return{type:"hlsurl",data:{url:ue}};if(z.category=="video")return{type:"mixedurl",data:{url:ue}};if(z.category=="audio")return{type:"url",data:{audio:re,video:""}}}else if(z.vsongType=="alistAweme"){let{audioUrl:re,videoUrl:ue}=yield $t(z,{video:!0,audio:!0});if(z.category=="video"&&ue.includes(".m3u8"))return{type:"hlsurl",data:{url:ue}};if(z.category=="video")return{type:"mixedurl",data:{url:ue}};if(z.category=="audio")return{type:"url",data:{audio:re,video:""}}}})),vt.setPlayInfoIdKey("vsongId"),vt.on("changePlayInfo",z=>oe(this,null,function*(){document.title=`VOSNG-${z.title}`;const ie=r.proxy.$assets("/default_cover.png");S.value=Mn(wi({},z),{isPlay:!0,crossCoverUrl:ie});let re=Z.filter(ue=>ue.cacheStatus=="succeed").find(ue=>ue.vsongId==z.vsongId);if(re){let ue=yield st.getOneByIndex("vsong_cover","vsongId",re.vsongId);ue&&(S.value.crossCoverUrl=yield Qs(new Blob([ue.arraybuffer])))}if(S.value.crossCoverUrl==ie&&S.value.coverUrl){let ue="";S.value.vsongType=="biAweme"?ue=At.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="dyAweme"?ue=li.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="alipanAweme"?ue=gi.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="alipanAweme"&&(ue=pi.makeCrossUrl(S.value.coverUrl,{}));let _e=yield zt(ue);S.value.crossCoverUrl=_e}})),vt.on("timeupdate",({audioEl:z,setCurrentTimeRateing:ie})=>{ie||Un(z.duration,z.currentTime)}),vt.on("play",()=>{S.value.isPlay=!0}),vt.on("pause",()=>{S.value.isPlay=!1});let xr=!0;const rr=()=>oe(this,null,function*(){var ie,re,ue,_e;let z;if(xr){xr=!1,yield _r(),Z=yield st.getAll("vsong_cache"),Z.sort((pe,xe)=>pe.create_time-xe.create_time),yield wt.init("",pe=>{vt.setAxios(wt.getAxios()),pe==="default"?(Fe({message:"\u5728\u7EBF\u6A21\u5F0F",position:"top"}),ut.setAxios(wt.getAxios()),At.setAxios(wt.getAxios()),Ar(!1)):pe==="failed"&&(Fe({message:"\u79BB\u7EBF\u6A21\u5F0F",position:"top"}),Ar(!0))}),Ar()===!1&&Fa()===!0&&(yield wr.confirm({title:"\u5728\u7EBF\u540C\u6B65",teleport:"html",message:"\u68C0\u6D4B\u5230\u672C\u5730\u79BB\u7EBF\u6570\u636E\u53D1\u751F\u53D8\u66F4\uFF0C\u662F\u5426\u4FDD\u5B58\u8BE5\u53D8\u66F4\uFF1F",beforeClose:pe=>oe(this,null,function*(){return console.log(pe),pe==="cancel"||(yield ut.syncVsongData()),!0})}).catch(pe=>{}),Fa(!1));let ve=yield ut.getVsongData();K.value=Object.keys(ve.collect),b.value=ve.settings.loopMode,O.value=ve.settings.showVideo,W.value=ve.settings.proxyUrl,te.value=yield l(ve),vn.setConfig(ve.settings.alistConfig),z=Si.init("http://192.168.3.116:11180/moss/vsong").then(()=>oe(this,null,function*(){const pe=yield ut.getOssList();let xe=[],Ie={};pe.forEach(we=>{xe.push(we.vsongId),Ie[we.vsongType]||(Ie[we.vsongType]={}),Ie[we.vsongType][we.author]||(Ie[we.vsongType][we.author]=[]),Ie[we.vsongType][we.author].push(we)}),console.log(Ie),A.value=Ie,C.value=xe}))}if(n.value==="up")try{G.value.page=1,G.value.forceRefresh=!1,G.value.isPageEnd=!1;let[ve,pe]=yield Promise.all([At.getUserInfo({mid:u.value}),At.getAwemeList({mid:u.value},G.value)]);B.value=ve.name,U.value=pe,R.value=[]}catch(ve){B.value="\u4E00\u4E00",U.value=[],R.value=[],Fe({message:"\u9519\u8BEF",position:"top",duration:3e3})}else if(n.value==="collect"){let{songList:ve,folderList:pe}=yield s(u.value);B.value=u.value,U.value=ve,R.value=pe}else if(n.value==="cache")B.value="\u7F13\u5B58\u7BA1\u7406",U.value=Z,R.value=[];else if(n.value==="release"){let ve=[],pe=[],{songList:xe,folderList:Ie}=yield s(u.value);xe.forEach(it=>{it.vsongType=="biAweme"?ve.push(it.mid.toString()):it.vsongType=="dyAweme"&&pe.push(it.sec_uid)}),Ie.forEach(it=>{it.vsongFolderType=="biAwemeFolder"?ve.push(it.mid.toString()):it.vsongFolderType=="dyAwemeFolder"&&pe.push(it.sec_uid)}),ve=Array.from(new Set(ve)),pe=Array.from(new Set(pe)),ve=ve.map(it=>({listQuery:{mid:it},listParams:{page:1,order:"pubdate",count:3,forceRefresh:!1,isPageEnd:!1}})),pe=pe.map(it=>({listQuery:{sec_uid:it},listParams:{count:3,max_cursor:"",forceRefresh:!1,isPageEnd:!1}})),g.value.upmidList=ve,g.value.dysecuidList=pe;let we=yield Promise.all([].concat(g.value.upmidList.map(it=>At.getAwemeList(it.listQuery,it.listParams)),g.value.dysecuidList.map(it=>li.getAwemeList(it.listQuery,it.listParams)))),ot=[].concat(...we).sort((it,Ze)=>it.created<Ze.created?1:-1);B.value=`\u52A8\u6001-${u.value}`,U.value=ot,R.value=[]}else if(n.value!=="custom"){if(n.value==="dy"){F.value.order="pubdate",F.value.max_cursor="",F.value.forceRefresh=!1,F.value.isPageEnd=!1;let[ve,pe]=yield Promise.all([li.getUserInfo({sec_uid:u.value}),li.getAwemeList({sec_uid:u.value},F.value)]);B.value=ve.name,U.value=pe,R.value=[],Re()}else if(n.value==="alipan"){let ve=u.value.split(",");o.value.folderId=ve[0],o.value.keyword=ve[1],j.value.nextMarker="",j.value.keyword=o.value.keyword,j.value.forceRefresh=!1,j.value.isPageEnd=!1;let pe=[],xe=[];try{let Ie=yield pi.getAwemeList({folderId:o.value.folderId},j.value);pe=Ie.awemeList,xe=Ie.folderList}catch(Ie){((re=(ie=Ie==null?void 0:Ie.response)==null?void 0:ie.data)==null?void 0:re.msg)=="AlipanNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}B.value="\u963F\u91CC\u4E91\u76D8",U.value=pe,R.value=xe}else if(n.value==="alipan_open"){let ve=u.value.split(",");d.value.folderId=ve[0],N.value.nextMarker="",N.value.forceRefresh=!1,N.value.isPageEnd=!1;let pe=[],xe=[];try{let Ie=yield gi.getAwemeList({folderId:d.value.folderId},N.value);pe=Ie.awemeList,xe=Ie.folderList}catch(Ie){((_e=(ue=Ie==null?void 0:Ie.response)==null?void 0:ue.data)==null?void 0:_e.msg)=="AlipanOpenNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}B.value="\u963F\u91CC\u4E91\u76D8Open",U.value=pe,R.value=xe}else if(n.value==="bilipage")try{let{title:ve,list:pe}=yield At.getPageList({bvid:u.value},{forceRefresh:!1});B.value=`\u5408\u96C6-${ve}`,U.value=pe,R.value=[]}catch(ve){B.value="\u5408\u96C6",U.value=[],R.value=[],Fe({message:"\u9519\u8BEF",position:"top",duration:3e3})}else if(n.value==="bilidyn"){let ve=yield At.getDynamicList();B.value="B\u7AD9\u52A8\u6001",U.value=ve,R.value=[]}else if(n.value==="alist"){$.value.page=1,$.value.isPageEnd=!1;let ve=[],pe=[];try{let xe=yield vn.getAwemeList({path:u.value},$.value);ve=xe.awemeList,pe=xe.folderList}catch(xe){Fe({message:xe.message,position:"top",duration:3e3})}B.value="Alist",U.value=ve,R.value=pe}else if(n.value==="archive")B.value="\u5F52\u6863\u5217\u8868",U.value=[],R.value=te.value.map(ve=>({title:ve,name:ve}));else if(n.value==="osslist"){yield z;let ve=u.value.split(","),pe=ve[0],xe=ve[1],Ie=[],we=[];xe?Ie=A.value[pe][xe]:pe?we=Object.keys(A.value[pe]).map(ot=>({title:ot,parent:pe,vsongFolderType:"osslistFolder"})):we=Object.keys(A.value).map(ot=>({title:ot,parent:"",vsongFolderType:"osslistFolder"})),B.value="OSS\u5217\u8868",U.value=Ie,R.value=we}}hn(()=>{history.state.listScrollTop?bt.value.scrollTop=history.state.listScrollTop:bt.value.scrollTop=0})});let Lt=null;const Ri=()=>{Lt=eo(()=>{Fe({message:"\u518D\u6309\u4E00\u904D\u5173\u95ED",position:"top",duration:2e3}),setTimeout(()=>{history.state.back===null?Ri():Lt=null},2e3)})};oi(()=>i.query,()=>oe(this,null,function*(){console.log("route.query change",i.query);let z=i.query.ltype||"collect",ie=i.query.lparam;z=="collect"&&!ie&&(ie="\u559C\u6B22\u7684\u97F3\u4E50"),n.value=z,u.value=ie,history.state.back===null&&!Lt&&Ri()}),{immediate:!0}),oi(v,()=>oe(this,null,function*(){console.log(n.value,u.value),console.log("listType,listParam change",i.query),dt.value=!0;let z=Fe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});try{yield rr()}catch(ie){}setTimeout(()=>{z.clear()})}),{immediate:!0});const di=z=>oe(this,null,function*(){if(history.replaceState(Mn(wi({},history.state),{listScrollTop:bt.value.scrollTop}),""),console.log(z),z.vsongFolderType=="alipanAwemeFolder")t.push({path:"/home",query:{ltype:"alipan_open",lparam:`${z.folderId}`}});else if(z.vsongFolderType=="biAwemeFolder")t.push({path:"/home",query:{ltype:"up",lparam:`${z.mid}`}});else if(z.vsongFolderType=="dyAwemeFolder")t.push({path:"/home",query:{ltype:"dy",lparam:`${z.sec_uid}`}});else if(z.vsongFolderType=="alistAwemeFolder")t.push({path:"/home",query:{ltype:"alist",lparam:`${z.folderPath}`}});else if(z.vsongFolderType=="osslistFolder"){let ie="",re="";z.parent?(ie=z.parent,re=z.title):ie=z.title,t.push({path:"/home",query:{ltype:"osslist",lparam:`${ie},${re}`}})}else z.vsongFolderType==null&&t.push({path:"/home",query:{ltype:"collect",lparam:z.name}})}),Ui=z=>oe(this,null,function*(){vt.selectToPlay(z),ae.close()}),Li=()=>oe(this,null,function*(){vt.play()}),ci=()=>oe(this,null,function*(){vt.pause()}),$i=()=>oe(this,null,function*(){S.value.isPlay?ci():Li()}),Wt=()=>oe(this,null,function*(){vt.playNextAduio()}),Jr=()=>oe(this,null,function*(){vt.playPrevAudio()}),nr=()=>oe(this,null,function*(){ai.value+=5,ai.value>100&&(ai.value=100),en()}),ni=()=>oe(this,null,function*(){ai.value-=5,ai.value<0&&(ai.value=0),en()}),Qe=je({isShow:!1,type:"",data:null}),kt=(z,ie)=>{Qe.value.type=z,Qe.value.data=ie,Qe.value.isShow=!0};oi(v,()=>oe(this,null,function*(){Qe.value.isShow=!1}));const ar=z=>{window.open(z)},M=z=>{t.push({path:"/home",query:{ltype:"bilipage",lparam:z}})},V=z=>{if(Qe.value.isShow=!1,z.vsongType=="biAweme"){if(n.value=="up"&&u.value==z.mid)return;t.push({path:"/home",query:{ltype:"up",lparam:z.mid}})}else if(z.vsongType=="dyAweme"){if(n.value=="dy"&&u.value==z.sec_uid)return;t.push({path:"/home",query:{ltype:"dy",lparam:z.sec_uid}})}else if(z.vsongType=="alipanAweme"){if(!z.parentId||n.value=="alipan_open"&&u.value==`${z.parentId}`)return;t.push({path:"/home",query:{ltype:"alipan_open",lparam:`${z.parentId}`}})}else if(z.vsongType=="alistAweme"){if(n.value=="alist"&&u.value==`${z.parentPath}`)return;t.push({path:"/home",query:{ltype:"alist",lparam:`${z.parentPath}`}})}else if(z.vsongType=="alipanAweme"){if(!z.parentId||n.value=="alipan"&&u.value==`${z.parentId},`)return;t.push({path:"/home",query:{ltype:"alipan",lparam:`${z.parentId},`}})}},q=je({isShow:!1,iframeUrl:""}),le=()=>oe(this,null,function*(){G.value.order=="pubdate"?G.value.order="click":G.value.order="pubdate",G.value.page=1,G.value.isPageEnd=!1;let z=yield At.getAwemeList({mid:u.value},G.value);U.value=z}),be=()=>oe(this,null,function*(){F.value.order=="pubdate"?F.value.order="digg":F.value.order="pubdate",Re()}),Re=()=>{F.value.order=="pubdate"?U.value.sort((z,ie)=>ie.created-z.created):U.value.sort((z,ie)=>ie.digg_count-z.digg_count)},tt=()=>oe(this,null,function*(){var ie,re,ue,_e;let z=Fe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});if(n.value=="up")G.value.page=1,G.value.forceRefresh=!0,G.value.isPageEnd=!1,U.value=yield At.getAwemeList({mid:u.value},G.value);else if(n.value=="bilipage")U.value=(yield At.getPageList({bvid:u.value},{forceRefresh:!0})).list;else if(n.value=="release"){g.value.upmidList.forEach(xe=>{xe.listParams.page=1,xe.listParam.forceRefresh=!0,xe.listParams.isPageEnd=!1}),g.value.dysecuidList.forEach(xe=>{xe.listParams.max_cursor="",xe.listParams.forceRefresh=!0,xe.listParams.isPageEnd=!1});let ve=yield Promise.all([].concat(g.value.upmidList.map(xe=>At.getAwemeList(xe.listQuery,xe.listParams)),g.value.dysecuidList.map(xe=>li.getAwemeList(xe.listQuery,xe.listParams)))),pe=[].concat(...ve).sort((xe,Ie)=>xe.created<Ie.created?1:-1);U.value=pe}else if(n.value=="dy")F.value.max_cursor="",F.value.forceRefresh=!0,F.value.isPageEnd=!1,U.value=yield li.getAwemeList({sec_uid:u.value},F.value),Re();else if(n.value=="alipan"){j.value.nextMarker="",j.value.forceRefresh=!0,j.value.isPageEnd=!1;try{let ve=yield pi.getAwemeList({folderId:o.value.folderId},j.value);U.value=ve.awemeList,R.value=ve.folderList}catch(ve){((re=(ie=ve==null?void 0:ve.response)==null?void 0:ie.data)==null?void 0:re.msg)=="AlipanNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}}else if(n.value=="alipan_open"){N.value.nextMarker="",N.value.forceRefresh=!0,N.value.isPageEnd=!1;try{let ve=yield gi.getAwemeList({folderId:d.value.folderId},N.value);U.value=ve.awemeList,R.value=ve.folderList}catch(ve){((_e=(ue=ve==null?void 0:ve.response)==null?void 0:ue.data)==null?void 0:_e.msg)=="AlipanOpenNoBind"&&Fe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}}z.clear()}),lt=je({show:!1,actions:[{text:"\u64AD\u653E\u8BBE\u7F6E",icon:"more-o",key:"playSetting"},{text:"\u5B9A\u65F6\u5173\u95ED",icon:"clock-o",key:"clockSetting"},{text:"\u4E2A\u4EBA\u4E2D\u5FC3",icon:"user-circle-o",key:"personalMg"}]}),yt=ie=>oe(this,[ie],function*({key:z}){z=="playSetting"?Zt():z=="clockSetting"?Mi():z=="personalMg"&&H()});oi(v,()=>oe(this,null,function*(){lt.value.show=!1}));const mt=je({show:!1,actions:[]}),Ht=()=>{let z=[...f().map(ie=>({text:ie,key:ie})),{text:"B\u7AD9\u52A8\u6001",key:"bilidynList",isNeedOnline:!0},{text:"\u963F\u91CC\u4E91\u76D8",key:"aliyunOpenList",isNeedOnline:!0},{text:"Alist",key:"alistList",isNeedOnline:!0},{text:"\u5F52\u6863\u5217\u8868",key:"archiveList"},{text:"\u7F13\u5B58\u7BA1\u7406",key:"cacheList"},{text:"\u521B\u5EFA",key:"createCollect"}];mt.value.actions=z.filter(ie=>!(Ar()&&ie.isNeedOnline))},Qr=({key:z})=>{if(z=="createCollect")ee();else if(z=="bilidynList")t.push({path:"/home",query:{ltype:"bilidyn",lparam:""}});else if(z=="aliyunList")t.push({path:"/home",query:{ltype:"alipan",lparam:","}});else if(z=="aliyunOpenList")t.push({path:"/home",query:{ltype:"alipan_open",lparam:","}});else if(z=="alistList")t.push({path:"/home",query:{ltype:"alist",lparam:""}});else if(z=="archiveList")t.push({path:"/home",query:{ltype:"archive"}});else if(z=="cacheList"){if(n.value=="cache")return;n.value=="collect"?t.push({path:"/home",query:{ltype:"cache"}}):t.push({path:"/home",query:{ltype:"cache"}})}else{if(n.value=="collect"&&u.value==z)return;n.value=="collect"||n.value=="cache"?t.push({path:"/home",query:{ltype:"collect",lparam:z}}):t.push({path:"/home",query:{ltype:"collect",lparam:z}})}};oi(v,()=>oe(this,null,function*(){mt.value.show=!1}));const bi=je({show:!1,actions:[...K.value.map(z=>({text:z,key:z}))]}),Ir=()=>{bi.value.actions=[...K.value.map(z=>({text:z,key:z,disabled:!1}))]},Er=ie=>oe(this,[ie],function*({key:z}){try{console.log(Qe.value.data),Qe.value.type=="folder"?yield k(z,Qe.value.data):Qe.value.type=="song"&&(yield E(z,Qe.value.data)),Qe.value.isShow=!1,Fe({message:"\u5DF2\u52A0\u5165\u6536\u85CF",position:"top"})}catch(re){Fe({message:re.message,position:"top"})}});oi(v,()=>oe(this,null,function*(){bi.value.show=!1}));const Wi=je({show:!1,actions:[]}),la=()=>{let z=[];n.value=="collect"?(z.push({text:"\u6700\u65B0\u52A8\u6001",key:"toNewRelease"}),u.value!=="\u559C\u6B22\u7684\u97F3\u4E50"&&(z.push({text:"\u91CD\u547D\u540D\u6536\u85CF",key:"renameCollect"},{text:"\u5220\u9664\u6536\u85CF",key:"deleteCollect"}),te.value.includes(u.value)?z.push({text:"\u53D6\u6D88\u5F52\u6863",key:"moveoutArchive"}):z.push({text:"\u5F52\u6863",key:"moveinArchive"})),z.push({text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"})):n.value=="up"?z=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"},{text:"\u66F4\u591A\u64CD\u4F5C",key:"showMoreAction"}]:n.value=="bilipage"?z=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="bilidyn"?z=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="dy"?z=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"},{text:"\u66F4\u591A\u64CD\u4F5C",key:"showMoreAction"}]:n.value=="cache"?z=[{text:"\u7EDF\u8BA1\u7F13\u5B58",key:"statCacheList"},{text:"\u91CD\u65B0\u7F13\u5B58",key:"retryCacheList"},{text:"\u5BFC\u5165\u7F13\u5B58",key:"importCacheList"},{text:"\u5BFC\u51FA\u7F13\u5B58",key:"exportCacheList"},{text:"\u6E05\u7A7A\u7F13\u5B58",key:"clearCacheList"},{text:"OSS\u5217\u8868",key:"toOsslist"}]:n.value=="release"?z=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="custom"?z=[]:n.value=="alipan"?z=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="alipan_open"?z=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="alist"?z=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="osslist"&&(z=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]),Wi.value.actions=z},ua=ie=>oe(this,[ie],function*({key:z}){if(z==="renameCollect")ee(u.value);else if(z==="deleteCollect")yield wr.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u6536\u85CF\u5417\uFF1F",beforeClose:re=>oe(this,null,function*(){if(re==="cancel")return!0;try{let ue=u.value,_e=yield ut.getVsongData();if(delete _e.collect[ue],te.value.includes(ue)){let ve=_e.archive.find(xe=>xe.name=="\u5F52\u6863"),pe=ve.list.findIndex(xe=>xe.name==ue);pe>=0&&(ve.list.splice(pe,1),te.value=ve.list.map(xe=>xe.name))}return yield ut.setVsongData(_e),K.value=Object.keys(_e.collect),t.replace({path:"/home"}),Fe({message:"\u5220\u9664\u6210\u529F",position:"top"}),!0}catch(ue){return Fe({message:ue.message,position:"top"}),!1}})});else if(z==="moveinArchive")yield c(u.value);else if(z==="moveoutArchive")yield y(u.value);else if(z==="froceRefreshList")tt();else if(z==="cacheCurrentList")De(1,U.value.length,(re,ue)=>oe(this,null,function*(){try{let _e=0;for(let ve=re-1;ve<ue;ve++){const pe=U.value[ve];Nt(pe.vsongId)&&(_e++,yield mi(pe))}return _e>0?Fe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"}):Fe({message:"\u5F53\u524D\u5217\u8868\u5DF2\u7F13\u5B58",position:"top"}),!0}catch(_e){return Fe({message:_e.message,position:"top"}),!1}}));else if(z==="uplistBeCollect")yield wr.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u5F53\u524D\u5217\u8868\u521B\u5EFA\u65B0\u6536\u85CF\u5417\uFF1F",beforeClose:re=>oe(this,null,function*(){if(re==="cancel")return!0;try{let ue=B.value,_e=U.value.map(pe=>m(pe));if(K.value.includes(ue))throw new Error("\u5DF2\u5B58\u5728\u540C\u540D\u6536\u85CF\u5217\u8868");let ve=yield ut.getVsongData();return ve.collect[ue]=_e,yield ut.setVsongData(ve),K.value.push(ue),Fe({message:"\u521B\u5EFA\u6210\u529F",position:"top"}),!0}catch(ue){return Fe({message:ue.message,position:"top"}),!1}})});else if(z==="statCacheList"){let re=Fe.loading({message:"\u7EDF\u8BA1\u4E2D...",forbidClick:!0,duration:0}),ue=[...Z.filter(ve=>ve.cacheStatus=="succeed")],_e=0;for(let ve=0;ve<ue.length;ve++){const pe=ue[ve];let[xe,Ie,we]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",pe.vsongId),st.getOneByIndex("vsong_video","vsongId",pe.vsongId),st.getOneByIndex("vsong_cover","vsongId",pe.vsongId)]);xe&&(_e+=xe.arraybuffer.byteLength),Ie&&(_e+=Ie.arraybuffer.byteLength),we&&(_e+=we.arraybuffer.byteLength)}setTimeout(()=>{re.clear()},0),yield wr.alert({title:"\u7EDF\u8BA1\u7F13\u5B58\u4FE1\u606F",message:`\u8D44\u6E90\u603B\u6570\uFF1A${ue.length}
\u8D44\u6E90\u603B\u5927\u5C0F\uFF1A${nf(_e)}`,messageAlign:"left"})}else if(z==="retryCacheList"){let re=Z.filter(ue=>ue.cacheStatus=="failed");for(let ue=0;ue<re.length;ue++)yield er(re[ue]);Fe({message:`\u91CD\u65B0\u7F13\u5B58\uFF1A${re.length}`,position:"top"})}else if(z==="importCacheList"){let re=yield Pn(),ue=Fe.loading({message:"\u5BFC\u5165\u4E2D...",forbidClick:!0,duration:0});try{let _e=0,ve=0;const pe=yield rs.loadAsync(re);for(const xe in pe.files){const Ie=pe.files[xe];if(Ie.dir){let we=yield pe.files[`${Ie.name}vsong_cache.json`].async("string"),ot=JSON.parse(we);if(Z.find(it=>it.vsongId==ot.vsongId))ve++;else{if(delete ot.id,yield st.addRow("vsong_cache",ot),pe.files[`${Ie.name}vsong_audio.json`]){let it=yield pe.files[`${Ie.name}vsong_audio.json`].async("string"),Ze=JSON.parse(it);delete Ze.id,Ze.arraybuffer=yield pe.files[`${Ie.name}vsong_audio.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_audio",Ze)}if(pe.files[`${Ie.name}vsong_video.json`]){let it=yield pe.files[`${Ie.name}vsong_video.json`].async("string"),Ze=JSON.parse(it);delete Ze.id,Ze.arraybuffer=yield pe.files[`${Ie.name}vsong_video.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_video",Ze)}if(pe.files[`${Ie.name}vsong_cover.json`]){let it=yield pe.files[`${Ie.name}vsong_cover.json`].async("string"),Ze=JSON.parse(it);delete Ze.id,Ze.arraybuffer=yield pe.files[`${Ie.name}vsong_cover.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_cover",Ze)}_e++}}}ti(),setTimeout(()=>{ue.clear()},0),Fe({message:`\u5BFC\u5165\u5B8C\u6210\uFF0C\u65B0\u589E\uFF1A${_e}\uFF0C\u5FFD\u7565\uFF1A${ve}`,position:"top",duration:3e3})}catch(_e){throw ti(),setTimeout(()=>{ue.clear()},0),Fe({message:`\u5BFC\u5165\u5F02\u5E38(${_e.message})`,position:"top"}),_e}}else if(z==="exportCacheList")De(1,Z.length,(re,ue)=>oe(this,null,function*(){let _e=Fe.loading({message:"\u5BFC\u51FA\u4E2D...",forbidClick:!0,duration:0}),ve=Date.now(),pe=new rs,xe=1,Ie=0;console.log(ue);for(let we=re-1;we<ue;we++){const ot=Z[we];let[it,Ze,si]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",ot.vsongId),st.getOneByIndex("vsong_video","vsongId",ot.vsongId),st.getOneByIndex("vsong_cover","vsongId",ot.vsongId)]);if(pe.folder(ot.vsongId),pe.file(`${ot.vsongId}/vsong_cache.json`,JSON.stringify(ot,null,2)),it&&(Ie+=it.arraybuffer.byteLength,pe.file(`${ot.vsongId}/vsong_audio.arraybuffer`,it.arraybuffer),it.arraybuffer=null,pe.file(`${ot.vsongId}/vsong_audio.json`,JSON.stringify(it,null,2))),Ze&&(Ie+=Ze.arraybuffer.byteLength,pe.file(`${ot.vsongId}/vsong_video.arraybuffer`,Ze.arraybuffer),Ze.arraybuffer=null,pe.file(`${ot.vsongId}/vsong_video.json`,JSON.stringify(Ze,null,2))),si&&(Ie+=si.arraybuffer.byteLength,pe.file(`${ot.vsongId}/vsong_cover.arraybuffer`,si.arraybuffer),si.arraybuffer=null,pe.file(`${ot.vsongId}/vsong_cover.json`,JSON.stringify(si,null,2))),Ie/1024/1024>1024||we==ue-1){let br=yield pe.generateAsync({type:"blob"});iu(br,`vsong_cache_${ve}_part${xe}.zip`),pe=new rs,xe++,Ie=0}}setTimeout(()=>{_e.clear()},0)}));else if(z==="clearCacheList")De(1,Z.length,(re,ue)=>oe(this,null,function*(){yield wr.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u6E05\u7A7A\u6240\u9009\u7F13\u5B58\u5417\uFF1F",beforeClose:_e=>oe(this,null,function*(){if(_e==="cancel")return!0;try{let ve=[...Z.slice(re-1,ue)];for(let pe=0;pe<ve.length;pe++){const xe=ve[pe];yield Or(xe)}return Fe({message:"\u5DF2\u6E05\u7A7A\u6240\u9009\u7F13\u5B58",position:"top"}),!0}catch(ve){return Fe({message:ve.message,position:"top"}),!1}})})}));else if(z==="toOsslist")t.push({path:"/home",query:{ltype:"osslist",lparam:","}});else if(z==="toNewRelease")t.push({path:"/home",query:{ltype:"release",lparam:u.value}});else if(z==="showMoreAction"){let re;n.value=="up"?re={vsongFolderId:`biAwemeFolder_${u.value}`,vsongFolderType:"biAwemeFolder",title:B.value,mid:u.value}:n.value=="dy"&&(re={vsongFolderId:`dyAwemeFolder_${u.value}`,vsongFolderType:"dyAwemeFolder",title:B.value,sec_uid:u.value}),kt("folder",re)}});oi(v,()=>oe(this,null,function*(){Wi.value.show=!1}));const kn=()=>oe(this,null,function*(){Fe.loading({message:"\u9000\u51FA\u767B\u5F55\u4E2D...",forbidClick:!0,duration:0}),yield Gt.clear(),localStorage.removeItem("vsong_token"),location.reload()}),An=()=>oe(this,null,function*(){Jt("bilibili",()=>{Fe({message:"\u7ED1\u5B9A\u6210\u529F",position:"middle"}),ne.value&&H()})}),Cn=()=>oe(this,null,function*(){yield ut.unbindAccount("bilibili"),Fe({message:"\u89E3\u7ED1\u6210\u529F",position:"middle"}),ne.value&&H()}),Dn=()=>oe(this,null,function*(){Jt("alipan",()=>{Fe({message:"\u7ED1\u5B9A\u6210\u529F",position:"middle"}),ne.value&&H()})}),Rn=()=>oe(this,null,function*(){yield ut.unbindAccount("alipan"),Fe({message:"\u89E3\u7ED1\u6210\u529F",position:"middle"}),ne.value&&H()}),ai=je(0),Un=(z,ie)=>{let re=Math.round(ie/z*100);re>100&&(re=100),re!==re&&(re=0),ai.value=re},en=()=>{vt.setCurrentTimeRate(ai.value)},Ln=je(null),Pn=()=>oe(this,null,function*(){let z=Ln.value;return z.value="",z.click(),new Promise((ie,re)=>{const ue=()=>{console.log("fileInputDom change"),z.removeEventListener("change",ue),window.removeEventListener("focus",focus),ie(z.files[0])},_e=()=>{setTimeout(()=>{console.log("fileInputDom blur"),z.removeEventListener("change",ue),window.removeEventListener("focus",focus),re(new Error("cancel"))},300)};z.addEventListener("change",ue,{once:!0}),window.addEventListener("focus",_e,{once:!0})})}),tn=z=>{if(z.keyCode==13){if(document.fullscreenElement)return;_t()}},rn=z=>{z.keyCode==13&&nr()};let nn=!1;document.addEventListener("fullscreenchange",z=>{document.fullscreenElement==null&&nn&&_t(),document.fullscreenElement==null&&ae.close()});const fa=z=>{nn=dt.value,xi.value.requestFullscreen({navigationUI:"hide"}).then(()=>{dt.value&&_t()})};return(z,ie)=>{const re=jt("van-icon"),ue=jt("van-popover"),_e=jt("van-tag"),ve=jt("van-slider"),pe=jt("van-action-sheet"),xe=jt("van-dialog"),Ie=jt("van-field"),we=jt("van-switch"),ot=jt("van-form"),it=jt("van-loading"),Ze=jt("van-image"),si=jt("van-button"),br=jt("van-cell"),da=jt("van-cell-group");return nt(),ct(Yi,null,[Ge("div",{class:zr(["listbox",{unexpand:!dt.value}]),ref:(ye,ht)=>{ht.listBoxRef=ye,bt.value=ye},onScroll:yi},[Ge("div",wg,[He(ue,{show:mt.value.show,"onUpdate:show":ie[0]||(ie[0]=ye=>mt.value.show=ye),actions:mt.value.actions,offset:[-8,8],onOpen:Ht,onSelect:Qr,overlay:"",placement:"right-start","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[He(re,{class:"listbar-icon",name:"label-o",tabxxindexxx:"1"})]),_:1},8,["show","actions","overlay-style"]),Ge("div",{class:"listbar-title",onClick:ie[1]||(ie[1]=ye=>Wi.value.show=!0),tabxxindexxx:"1"},xt(B.value),1),He(ue,{show:Wi.value.show,"onUpdate:show":ie[2]||(ie[2]=ye=>Wi.value.show=ye),actions:Wi.value.actions,offset:[0,8],onOpen:la,onSelect:ua,overlay:"",placement:"bottom","overlay-style":{backgroundColor:"rgba(0,0,0,0)"}},{reference:at(()=>[Ge("div",Tg,"("+xt(R.value.length)+"/"+xt(U.value.length)+")",1)]),_:1},8,["show","actions","overlay-style"]),Ge("div",Sg,[We(n)=="up"?(nt(),Bi(_e,{key:0,style:{cursor:"pointer",background:"transparent"},color:"#ffffff",plain:"",onClick:le,tabxxindexxx:"1"},{default:at(()=>[lr(xt(G.value.order=="pubdate"?"\u6700\u65B0":"\u6700\u70ED"),1)]),_:1})):Pt("",!0),We(n)=="dy"?(nt(),Bi(_e,{key:1,style:{cursor:"pointer",background:"transparent"},color:"#ffffff",plain:"",onClick:be,tabxxindexxx:"1"},{default:at(()=>[lr(xt(F.value.order=="pubdate"?"\u6700\u65B0":"\u6700\u70ED"),1)]),_:1})):Pt("",!0),ji().has?(nt(),Bi(re,{key:2,class:"listbar-action-icon",style:{transform:"rotateZ(180deg)"},onClick:St,name:"back-top",tabxxindexxx:"1"})):Pt("",!0),We(n)=="alipan"?(nt(),Bi(re,{key:3,class:"listbar-action-icon",name:"search",onClick:We(Ye),tabxxindexxx:"1"},null,8,["onClick"])):Pt("",!0),We(n)=="collect"?(nt(),Bi(re,{key:4,class:"listbar-action-icon",name:"add-o",onClick:We(D),tabxxindexxx:"1"},null,8,["onClick"])):Pt("",!0),He(ue,{show:lt.value.show,"onUpdate:show":ie[3]||(ie[3]=ye=>lt.value.show=ye),actions:lt.value.actions,offset:[-8,0],onSelect:yt,overlay:"",placement:"left-start","overlay-style":{backgroundColor:"rgba(0,0,0,0)"}},{reference:at(()=>[He(re,{class:"listbar-action-icon",name:"setting-o",tabxxindexxx:"1"})]),_:1},8,["show","actions","overlay-style"]),He(re,{class:"listbar-action-icon",name:"bars",onClick:_t,tabxxindexxx:"1"})])]),zn(Ge("div",{ref:(ye,ht)=>{ht.listboxListRef=ye,Vi.value=ye},style:{"min-height":"100%"},onTouchstart:vr,onTouchmove:Zr},[(nt(!0),ct(Yi,null,Ra(R.value,(ye,ht)=>(nt(),ct("div",{class:"listitem",key:ht},[We(n)=="archive"?(nt(),ct(Yi,{key:0},[kg,Ge("div",Ag,[Ge("div",{class:"listitem-info-t1",onClick:Yt=>di(ye),onKeydown:Ti(Yt=>di(ye),["enter"]),tabxxindexxx:"1"},xt(ye.title),41,Cg)]),He(re,{class:"listitem-action",name:"ellipsis",onClick:Hn(Yt=>kt("archiveFolder",ye),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],64)):We(n)=="osslist"?(nt(),ct(Yi,{key:1},[Dg,Ge("div",Rg,[Ge("div",{class:"listitem-info-t1",onClick:Yt=>di(ye),onKeydown:Ti(Yt=>di(ye),["enter"]),tabxxindexxx:"1"},xt(ye.title),41,Ug)])],64)):(nt(),ct(Yi,{key:2},[Lg,Ge("div",Pg,[Ge("div",{class:"listitem-info-t1",onClick:Yt=>di(ye),onKeydown:Ti(Yt=>di(ye),["enter"]),tabxxindexxx:"1"},xt(ye.title),41,Bg)]),He(re,{class:"listitem-action",name:"ellipsis",onClick:Hn(Yt=>kt("folder",ye),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],64))]))),128)),(nt(!0),ct(Yi,null,Ra(U.value,(ye,ht)=>(nt(),ct("div",{class:zr(["listitem",{active:S.value&&ye.vsongId==S.value.vsongId}]),key:ht},[Ge("div",Fg,xt(ht+1),1),Ge("div",Og,[Ge("div",{class:"listitem-info-t1",onClick:Yt=>Ui(ye),onKeydown:Ti(Yt=>Ui(ye),["enter"]),tabxxindexxx:"1"},xt(ye.title||"\u65E0\u6807\u9898"),41,Ig),Mg,Ge("div",{class:"listitem-info-t2",onClick:Hn(Yt=>V(ye),["stop"]),onKeydown:Ti(Yt=>V(ye),["enter"]),tabxxindexxx:"1"},xt(ye.author),41,Ng),Nt(ye.vsongId)?Pt("",!0):(nt(),ct("div",zg,xt(ir[_i(ye.vsongId)]),1)),C.value.includes(ye.vsongId)?(nt(),ct("div",Vg,"oss")):Pt("",!0)]),He(re,{class:"listitem-action",name:"ellipsis",onClick:Hn(Yt=>kt("song",ye),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],2))),128))],544),[[Vn,dt.value]])],34),Ge("div",Hg,[S.value?(nt(),ct(Yi,{key:0},[Ge("img",{class:zr(["playbar-cover",{rotate:S.value.isPlay}]),src:S.value.crossCoverUrl,onClick:fa,tabxxindexxx:"1"},null,10,jg),Ge("div",Gg,xt(S.value.title),1),zn(He(re,{class:"playbar-action",name:"play-circle-o",onClick:Li,tabxxindexxx:"1"},null,512),[[Vn,!S.value.isPlay]]),zn(He(re,{class:"playbar-action",name:"pause-circle-o",onClick:ci,tabxxindexxx:"1"},null,512),[[Vn,S.value.isPlay]]),Ge("div",{class:"playbar-slider",onKeydown:rn,tabxxindexxx:"1"},[He(ve,{modelValue:ai.value,"onUpdate:modelValue":ie[4]||(ie[4]=ye=>ai.value=ye),"bar-height":"100%",onChange:en},{button:at(()=>[$g]),_:1},8,["modelValue"])],32)],64)):Pt("",!0)]),He(pe,{show:Qe.value.isShow,"onUpdate:show":ie[17]||(ie[17]=ye=>Qe.value.isShow=ye),class:"action-sheet"},{default:at(()=>[Qe.value.type=="folder"?(nt(),ct("div",Wg,[Ge("div",Yg,[Ge("div",Xg,xt(Qe.value.data.title),1)]),He(ue,{show:bi.value.show,"onUpdate:show":ie[5]||(ie[5]=ye=>bi.value.show=ye),actions:bi.value.actions,onOpen:Ir,onSelect:Er,overlay:"",placement:"right-end","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[Ge("div",Kg,[He(re,{class:"action-sheet-item-icon",name:"label-o"}),qg])]),_:1},8,["show","actions","overlay-style"]),We(n)==="collect"?(nt(),ct("div",{key:0,class:"action-sheet-item",onClick:ie[6]||(ie[6]=ye=>x(B.value,Qe.value.data.vsongFolderId))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),Zg])):Pt("",!0)])):Qe.value.type=="archiveFolder"?(nt(),ct("div",Jg,[Ge("div",Qg,[Ge("div",ev,xt(Qe.value.data.title),1)]),Ge("div",{class:"action-sheet-item",onClick:ie[7]||(ie[7]=ye=>y(Qe.value.data.name))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),tv])])):Qe.value.type=="song"?(nt(),ct("div",iv,[Ge("div",rv,[Ge("div",nv,"\u6B4C\u66F2\uFF1A"+xt(Qe.value.data.title),1),Ge("div",{class:"action-sheet-title-t2",onClick:ie[8]||(ie[8]=ye=>V(Qe.value.data))},xt(Qe.value.data.author),1)]),We(n)!=="bilipage"&&Qe.value.data.vsongType==="biAweme"?(nt(),ct("div",{key:0,class:"action-sheet-item",onClick:ie[9]||(ie[9]=ye=>M(Qe.value.data.bvid))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),av])):Pt("",!0),Ge("div",{class:"action-sheet-item",onClick:ie[10]||(ie[10]=ye=>ar(Qe.value.data.originUrl))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),sv]),He(ue,{show:bi.value.show,"onUpdate:show":ie[11]||(ie[11]=ye=>bi.value.show=ye),actions:bi.value.actions,onOpen:Ir,onSelect:Er,overlay:"",placement:"right-end","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[Ge("div",ov,[He(re,{class:"action-sheet-item-icon",name:"label-o"}),lv])]),_:1},8,["show","actions","overlay-style"]),We(n)==="collect"?(nt(),ct("div",{key:1,class:"action-sheet-item",onClick:ie[12]||(ie[12]=ye=>w(B.value,Qe.value.data.vsongId))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),uv])):Pt("",!0),_i(Qe.value.data.vsongId)=="failed"?(nt(),ct("div",{key:2,class:"action-sheet-item",onClick:ie[13]||(ie[13]=ye=>er(Qe.value.data))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),fv])):Pt("",!0),Nt(Qe.value.data.vsongId)?(nt(),ct("div",{key:3,class:"action-sheet-item",onClick:ie[14]||(ie[14]=ye=>mi(Qe.value.data))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),dv])):(nt(),ct("div",{key:4,class:"action-sheet-item",onClick:ie[15]||(ie[15]=ye=>Or(Qe.value.data))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),cv])),p.value?(nt(),ct("div",{key:5,class:"action-sheet-item",onClick:ie[16]||(ie[16]=ye=>Ei(Qe.value.data))},[He(re,{class:"action-sheet-item-icon",name:"label-o"}),hv])):Pt("",!0)])):Pt("",!0)]),_:1},8,["show"]),xi.value?(nt(),Bi(pe,{key:0,show:We(Ee).isShow,"onUpdate:show":ie[18]||(ie[18]=ye=>We(Ee).isShow=ye),class:"action-sheet",teleport:".full-screen-warpbox"},{default:at(()=>[Ge("div",pv,[(nt(!0),ct(Yi,null,Ra(We(Ee).data,(ye,ht)=>(nt(),ct("div",{class:zr(["action-sheet-item",{active:S.value&&ye.vsongId==S.value.vsongId}]),onClick:Yt=>Ui(ye),key:ht},[Ge("div",vv,xt(ht+1),1),Ge("div",yv,xt(ye.title),1)],10,gv))),128))])]),_:1},8,["show"])):Pt("",!0),He(xe,{show:q.value.isShow,"onUpdate:show":ie[19]||(ie[19]=ye=>q.value.isShow=ye),"show-confirm-button":!1,"close-on-click-overlay":!0,class:"video-dialog","overlay-style":{background:"rgba(0,0,0,0.7)"}},{default:at(()=>[q.value.isShow?(nt(),ct("iframe",{key:0,width:"100%",height:"100%",src:q.value.iframeUrl,scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}," ",8,mv)):Pt("",!0)]),_:1},8,["show","overlay-style"]),He(xe,{show:We(Oe),"onUpdate:show":ie[21]||(ie[21]=ye=>or(Oe)?Oe.value=ye:null),title:"\u6DFB\u52A0","show-cancel-button":"","close-on-click-overlay":"","before-close":We(fe)},{default:at(()=>[He(Ie,{ref:(ye,ht)=>{ht.addFieldRef=ye},modelValue:We(Ce).url,"onUpdate:modelValue":ie[20]||(ie[20]=ye=>We(Ce).url=ye),rows:"4",autosize:"",type:"textarea",placeholder:"\u8F93\u5165\u94FE\u63A5(B\u7AD9\u89C6\u9891\u94FE\u63A5/\u6296\u97F3\u4E3B\u9875)"},null,8,["modelValue"])]),_:1},8,["show","before-close"]),He(xe,{show:We(Ft),"onUpdate:show":ie[23]||(ie[23]=ye=>or(Ft)?Ft.value=ye:null),title:"\u5B9A\u65F6\u5173\u95ED","show-cancel-button":"","close-on-click-overlay":"","before-close":We(Ai)},{default:at(()=>[He(Ie,{modelValue:We(Ut).afterTime,"onUpdate:modelValue":ie[22]||(ie[22]=ye=>We(Ut).afterTime=ye),"input-align":"right",label:"\u65F6\u95F4",placeholder:"\u8BF7\u8F93\u5165",type:"digit","label-width":"4em"},{button:at(()=>[_v]),_:1},8,["modelValue"])]),_:1},8,["show","before-close"]),He(xe,{show:We(gt),"onUpdate:show":ie[27]||(ie[27]=ye=>or(gt)?gt.value=ye:null),title:"\u64AD\u653E\u8BBE\u7F6E","show-cancel-button":"","close-on-click-overlay":"","before-close":We(ft)},{default:at(()=>[He(Ie,{label:"\u5FAA\u73AF\u6A21\u5F0F","label-width":"4em","input-align":"right"},{input:at(()=>[He(io,{modelValue:We(Et).loopMode,"onUpdate:modelValue":ie[24]||(ie[24]=ye=>We(Et).loopMode=ye),columns:ki},{default:at(ye=>[lr(xt(ye.label),1)]),_:1},8,["modelValue"])]),_:1}),He(Ie,{label:"\u5C55\u793A\u89C6\u9891","label-width":"4em","input-align":"right"},{input:at(()=>[He(we,{modelValue:We(Et).showVideo,"onUpdate:modelValue":ie[25]||(ie[25]=ye=>We(Et).showVideo=ye),size:"20"},null,8,["modelValue"])]),_:1}),He(Ie,{modelValue:We(Et).proxyUrl,"onUpdate:modelValue":ie[26]||(ie[26]=ye=>We(Et).proxyUrl=ye),label:"\u4EE3\u7406\u94FE\u63A5","label-width":"4em","input-align":"left",rows:"2",autosize:"",type:"textarea",placeholder:"\u53EF\u63D0\u4F9B\u4EE3\u7406\uFF0C\u4F7F\u64AD\u653E\u66F4\u6D41\u7545"},null,8,["modelValue"])]),_:1},8,["show","before-close"]),He(xe,{show:We(ce),"onUpdate:show":ie[29]||(ie[29]=ye=>or(ce)?ce.value=ye:null),title:We(he).isEdit?"\u91CD\u547D\u540D\u6536\u85CF":"\u521B\u5EFA\u6536\u85CF\u5217\u8868","show-cancel-button":"","close-on-click-overlay":"","before-close":We(Se)},{default:at(()=>[He(Ie,{modelValue:We(J).name,"onUpdate:modelValue":ie[28]||(ie[28]=ye=>We(J).name=ye),"input-align":"right",label:"\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165","label-width":"4em"},null,8,["modelValue"])]),_:1},8,["show","title","before-close"]),He(xe,{show:We(ke),"onUpdate:show":ie[31]||(ie[31]=ye=>or(ke)?ke.value=ye:null),title:"\u641C\u7D22","show-cancel-button":"","close-on-click-overlay":"","before-close":We(et)},{default:at(()=>[He(ot,{onSubmit:We(qe)},{default:at(()=>[He(Ie,{ref:(ye,ht)=>{ht.keywordFieldRef=ye},modelValue:We(Le).keyword,"onUpdate:modelValue":ie[30]||(ie[30]=ye=>We(Le).keyword=ye),"input-align":"center",label:"",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1},8,["show","before-close"]),He(xe,{show:We(Ni),"onUpdate:show":ie[32]||(ie[32]=ye=>or(Ni)?Ni.value=ye:null),title:We(Ci).type=="alipan"?"\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8":"\u7ED1\u5B9AB\u7AD9","show-cancel-button":!1,"show-confirm-button":!1,"close-on-click-overlay":"","before-close":We(Qt)},{default:at(()=>[He(Ze,{class:"bind-qrcode",src:We(Ci).qrcode},{loading:at(()=>[He(it,{type:"spinner",size:"20"})]),_:1},8,["src"])]),_:1},8,["show","title","before-close"]),He(xe,{show:We(Ae),"onUpdate:show":ie[35]||(ie[35]=ye=>or(Ae)?Ae.value=ye:null),title:"\u9009\u62E9\u533A\u95F4","show-cancel-button":"","close-on-click-overlay":"","before-close":We(ze)},{default:at(()=>[He(ot,null,{default:at(()=>[Ge("div",xv,[He(Ie,{modelValue:We(Te).start,"onUpdate:modelValue":ie[33]||(ie[33]=ye=>We(Te).start=ye),type:"digit","input-align":"center","label-width":"1em",label:"\u4ECE",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"]),He(Ie,{modelValue:We(Te).end,"onUpdate:modelValue":ie[34]||(ie[34]=ye=>We(Te).end=ye),type:"digit","input-align":"center","label-width":"1em",label:"\u81F3",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])])]),_:1})]),_:1},8,["show","before-close"]),He(xe,{show:We(ne),"onUpdate:show":ie[36]||(ie[36]=ye=>or(ne)?ne.value=ye:null),title:"\u4E2A\u4EBA\u4E2D\u5FC3","show-cancel-button":!1,"show-confirm-button":!1,"close-on-click-overlay":""},{default:at(()=>[He(da,{border:!1},{default:at(()=>[He(br,{title:"B\u7AD9",center:""},{value:at(()=>[We(Y).bilibiliUser?(nt(),Bi(si,{key:1,onClick:Cn,plain:"",type:"danger",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[bv]),_:1})):(nt(),Bi(si,{key:0,onClick:An,plain:"",type:"primary",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[Ev]),_:1}))]),label:at(()=>[We(Y).bilibiliUser?(nt(),ct("span",Tv,"\u5DF2\u7ED1\u5B9A("+xt(We(Y).bilibiliUser.name)+")",1)):(nt(),ct("span",wv,"\u672A\u7ED1\u5B9A"))]),_:1}),He(br,{title:"\u963F\u91CC\u4E91\u76D8",center:""},{value:at(()=>[We(Y).alipanUser?(nt(),Bi(si,{key:1,onClick:Rn,plain:"",type:"danger",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[kv]),_:1})):(nt(),Bi(si,{key:0,onClick:Dn,plain:"",type:"primary",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[Sv]),_:1}))]),label:at(()=>[We(Y).alipanUser?(nt(),ct("span",Cv,"\u5DF2\u7ED1\u5B9A("+xt(We(Y).alipanUser.name)+")",1)):(nt(),ct("span",Av,"\u672A\u7ED1\u5B9A"))]),_:1}),He(br,{title:"VSONG",center:""},{value:at(()=>[He(si,{plain:"",type:"primary",size:"mini",onClick:kn,style:{border:"none",padding:"0"}},{default:at(()=>[Dv]),_:1})]),label:at(()=>[Ge("div",null,[We(Y).playVideoInfo?(nt(),ct("div",Rv,"\u89C6\u9891:"+xt(We(Y).playVideoInfo.videoWidth)+"x"+xt(We(Y).playVideoInfo.videoHeight),1)):Pt("",!0)])]),_:1})]),_:1}),Uv]),_:1},8,["show"]),Ge("div",{class:"full-screen-warpbox",ref:(ye,ht)=>{ht.fullSreenWarpboxRef=ye,xi.value=ye}},[Ge("video",{class:zr(["bg-video",{high:!dt.value}]),ref:(ye,ht)=>{ht.bgVideoRef=ye,ii.value=ye},posterxxx:S.value&&S.value.crossCoverUrl,muted:""},null,10,Lv),Ge("div",{class:"bg-danmu",ref:(ye,ht)=>{ht.bgDanmuRef=ye,Di.value=ye}},null,512),Ge("div",{class:zr(["bg-xgplayer",{high:!dt.value}])},[Ge("div",{ref:(ye,ht)=>{ht.bgXgplayerRef=ye,Gi.value=ye},style:{background:"transparent",display:"none"}},null,512)],2),S.value?(nt(),ct("div",Pv,[He(re,{class:"tabaction-item",name:"arrow-up",onKeydown:Ti(Jr,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),He(re,{class:"tabaction-item",name:"arrow-left",onKeydown:Ti(ni,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),He(re,{class:"tabaction-item",name:S.value.isPlay?"pause-circle-o":"play-circle-o",onKeydown:Ti($i,["enter"]),tabxxindexxx:"1"},null,8,["name","onKeydown"]),He(re,{class:"tabaction-item",name:"arrow",onKeydown:Ti(nr,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),He(re,{class:"tabaction-item",name:"arrow-down",onKeydown:Ti(Wt,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),He(re,{class:"tabaction-item",name:"bars",onKeydown:ie[37]||(ie[37]=Ti(ye=>We(ae).open(U.value),["enter"])),tabxxindexxx:"1"})])):Pt("",!0),zn(Ge("div",{ref:(ye,ht)=>{ht.listboxMaskRef=ye,zi.value=ye},class:"listbox-mask",onKeydown:tn,tabxxindexxx:"1"},null,544),[[Vn,!dt.value]])],512),Ge("input",{ref:(ye,ht)=>{ht.fileInputRef=ye,Ln.value=ye},type:"file",accept:".zip",hidden:""},null,512)],64)}}});Bv.__scopeId="data-v-1b2dae07";export{Bv as default};
